/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","promise","ojs/ojcomponentcore"],function(a,g){a.Sd={};o_("PullToRefreshUtils",a.Sd,a);a.Sd.xJa=function(c,b,d){var e,f,h,k,l,m,s,t,r,n,p,q;e=g(document.createElement("div"));a.Sd.VAa(e,b,d);f=g(document.createElement("div")).addClass("oj-pulltorefresh-panel");e.append(f);h=g(c);h.prepend(e);h.on("touchstart.pulltorefresh",function(b){null==g.data(f[0],"data-pullstart")&&0===h[0].scrollTop&&(a.Sd.F8(b,f,d),s=f.find(".oj-pulltorefresh-icon"),0<s.length&&(t=s.parent().outerHeight(!0)),
d&&!isNaN(d.threshold)&&(k=parseInt(d.threshold,10)),k=isNaN(k)?f.outerHeight(!0):Math.max(0,Math.min(k,f.outerHeight(!0))),f.css("height",0),f.removeClass("oj-pulltorefresh-transition"),g.data(f[0],"data-pullstart",b.originalEvent.touches[0].clientY))}).on("touchmove.pulltorefresh",function(b){l=g.data(f[0],"data-pullstart");null!=l&&(m=b.originalEvent.touches[0].clientY-parseInt(l,10),0>m||(b.preventDefault(),null!=g.data(f[0],"data-loading")?f.css("height",Math.max(m,k)):(f.css("height",m),a.Sd.AI(b,
"pull",f,m),null!=s&&0<s.length&&(r=g.data(f[0],"data-lasticonclass"),null!=r&&s.removeClass(r),p=10*Math.round(m/k*10),100<=p?(q="oj-pulltorefresh-icon-full",n=a.va.F("oj-pullToRefresh.titleIconFull")):(q="oj-pulltorefresh-icon-"+p+"-percent",n=a.va.F("oj-pullToRefresh.titleIcon"+p+"percent")),s.addClass(q),s.attr("title",n),g.data(f[0],"data-lasticonclass",q),a.Sd.LCa(f,m>t)))))}).on("touchcancel.pulltorefresh",function(){a.Sd.mo(f)}).on("touchend.pulltorefresh",function(c){l=g.data(f[0],"data-pullstart");
null!=l&&null==g.data(f[0],"data-loading")&&(f.outerHeight()<k?(f.addClass("oj-pulltorefresh-transition").css("height",0),a.Sd.mo(f)):a.Sd.G8(c,f,b))})};o_("PullToRefreshUtils.setupPullToRefresh",a.Sd.xJa,a);a.Sd.F8=function(c,b,d){var e,f;a.Sd.AI(c,"pull",b,0);0==b.children().length&&(d&&(e=d.primaryText,f=d.secondaryText),a.Sd.kqa(b,e,f));b.prev().text(a.va.F("oj-pullToRefresh.ariaRefreshingLink"));b.css("height","auto");g.data(b[0],"data-panelheight",b.outerHeight())};a.Sd.G8=function(c,b,d){var e,
f,h,k;e=g.data(b[0],"data-panelheight");b.addClass("oj-pulltorefresh-transition").css("height",e);a.Sd.AI(c,"release",b,e);g.data(b[0],"data-loading",!0);f=b.find(".oj-pulltorefresh-icon");0<f.length&&(h=g.data(b[0],"data-lasticonclass"),null!=h&&f.removeClass(h),f.addClass("oj-pulltorefresh-icon-full"));d().then(function(){k=function(){a.Sd.AI(c,"complete",b,e);a.Sd.mo(b);b.off("transitionend",k);b.prev().text("")};b.prev().text(a.va.F("oj-pullToRefresh.ariaRefreshCompleteLink"));b.prev().prev().css("position",
"");b.on("transitionend",k);b.css("height",0)})};a.Sd.MJa=function(a){g(a).children().first().remove();g(a).off(".pulltorefresh")};o_("PullToRefreshUtils.tearDownPullToRefresh",a.Sd.MJa,a);a.Sd.AI=function(a,b,d,e){b=g.Event("oj"+b);b.originalEvent=a;d.trigger(b,{content:d,distance:e})};a.Sd.kqa=function(a,b,d){var e,f;a.addClass("oj-pulltorefresh-content").attr("aria-hidden","true");e=g(document.createElement("div"));e.addClass("oj-pulltorefresh-icon oj-pulltorefresh-icon-initial");f=g(document.createElement("div"));
f.addClass("oj-pulltorefresh-icon-container");f.append(e);g.data(a[0],"data-lasticonclass","oj-pulltorefresh-icon-initial");a.append(f);null!=b&&(b=g(document.createElement("div")).addClass("oj-pulltorefresh-primary-text").text(b),a.append(b),null!=d&&(d=g(document.createElement("div")).addClass("oj-pulltorefresh-secondary-text").text(d),a.append(d)))};a.Sd.LCa=function(a,b){var d,e;d=a.find(".oj-pulltorefresh-primary-text");e=a.find(".oj-pulltorefresh-secondary-text");b?(d&&d.show(),e&&e.show()):
(d&&d.hide(),e&&e.hide())};a.Sd.VAa=function(c,b,d){var e,f,h;e=g(document.createElement("a"));e.text(a.va.F("oj-pullToRefresh.ariaRefreshLink"));e.addClass("oj-helper-hidden-accessible").attr("href","#").focus(function(){e.css("position","static")}).blur(function(a){null!=a.relatedTarget&&e.css("position","")}).click(function(e){f=c.children().last();a.Sd.F8(e,f,d);a.Sd.G8(e,f,b);b()});h=g(document.createElement("div"));h.addClass("oj-helper-hidden-accessible").attr("aria-live","polite");c.append(e);
c.append(h)};a.Sd.mo=function(a){g.removeData(a[0],"data-pullstart");g.removeData(a[0],"data-loading");0<a.find(".oj-pulltorefresh-icon").length&&a.empty()}});