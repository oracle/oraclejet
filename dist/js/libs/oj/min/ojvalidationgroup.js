/**
 * @license
 * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["ojs/ojcore","ojs/ojcontext","ojs/ojcomponentcore","ojs/ojlogger"],(function(n,e,t,i){"use strict";var o={properties:{valid:{type:"string",writeback:!0,enumValues:["invalidHidden","invalidShown","pending","valid"],readOnly:!0}},methods:{setProperty:{},getProperty:{},setProperties:{},showMessages:{},focusOn:{},getNodeBySubId:{},getSubIdByNode:{}},extension:{}};function r(o){var r,d=this,a=o.element,s=[];function l(){s=[],function n(e){var t,i=[],o=e.childNodes,r=o.length;for(t=0;t<r;t++){var d=o[t];g(d)?s.push(d):i.push(d)}for(r=i.length,t=0;t<r;t++)n(i[t])}(a),o.props.valid=h();for(var n=s.length,e=0;e<n;e++)u(s[e])}function u(n){n.addEventListener("validChanged",f.bind(this)),n.addEventListener("disabledChanged",c.bind(this)),n.addEventListener("readonlyChanged",c.bind(this))}function v(n){n.removeEventListener("validChanged",f),n.removeEventListener("disabledChanged",c),n.removeEventListener("readonlyChanged",c)}function f(){o.props.valid=h()}function c(n){var e=n.target,t=e.valid,i=!(e.readonly||e.disabled);"valid"===t||(o.props.valid=i&&"invalidShown"===t?"invalidShown":h())}function h(){for(var n="valid",e=s.length,t=0;t<e&&"invalidShown"!==n;t++){var i=s[t];if(y(i)){var o=i.valid,r=i.disabled,d=i.readonly;r||d||("invalidShown"===o?n="invalidShown":"invalidHidden"===o?n="invalidHidden":"pending"===o&&"valid"===n&&(n="pending"))}}return n}function g(n){if(1===n.nodeType&&-1!==n.tagName.indexOf("-")&&"valid"in n&&(y(n)&&void 0!==n.valid))return!0;return!1}function p(n,e){var t=e.length;if(g(n))return!0;for(var i=0;i<t;i++)if(g(e[i]))return!0;return!1}function m(n){var e=s.length;if(1!==n.nodeType)return!1;for(var t=0;t<e;t++){if(s[t].contains(n))return!0}return!1}function O(n){for(var e=s.length,t=0;t<n.length;t++){var i=n[t];if(1===i.nodeType){if(-1!==s.indexOf(i))return!0;for(var o=0;o<e;o++)if(i.contains(s[o]))return!0}}return!1}function y(e){var i,o=n.BaseCustomElementBridge.getInstance(e)._WIDGET_ELEM;return void 0!==o&&(i=t.__GetWidgetConstructor(o)),!(void 0!==o&&!i)}d._rootElementMutationObserver=new MutationObserver((function(n){if(document.body.contains(a)){for(var e=n.length,t=!1,i=0;i<e&&!t;i++){var o=n[i],r=o.target,d=o.removedNodes,s=o.addedNodes;if(!(t=O(d))&&s.length>0)!m(r)&&p(r,s)&&(t=!0)}t&&(!function(n){for(var e=n.length,t=0;t<e;t++)for(var i=n[t],o=i.removedNodes.length,r=0;r<o;r++){var d=i.removedNodes[r];1===d.nodeType&&v(d)}}(n),l())}else this.disconnect()})),d.createDOM=function(){for(a.classList.add("oj-validation-group"),(r=document.createElement("div")).setAttribute("data-oj-context","");a.firstChild;)r.appendChild(a.firstChild);a.appendChild(r)},d.updateDOM=function(){e.getContext(r).getBusyContext().whenReady().then((function(){for(var n=s.length,e=0;e<n;e++)v(s[e]);l(),d._rootElementMutationObserver.observe(a,{childList:!0,subtree:!0})}))},d.handlePropertyChanged=function(n,e){return!0},d.showMessages=function(){for(var n=0;n<s.length;n++){var e=s[n];e.disabled||e.readonly||"showMessages"in e&&e.showMessages()}},d.focusOn=function(n){var e=null,t=null;"@firstInvalidShown"===n?(t=function(){var n=[];if("invalidShown"!==a.valid)return null;for(var e=s.length,t=0;t<e;t++){var i=s[t];i.disabled||i.readonly||"invalidShown"===i.valid&&n.push(i)}if(0===n.length)return null;return n.sort((function(n,e){return n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1})),n[0]}())&&("focusOn"in t?t.focusOn("@firstInvalidShown"):t.focus()):void 0===n?(e=function(){for(var n=null,e=s.length,t=0;t<e;t++)if(!(n=s[t]).readonly&&!n.disabled)return n;return null}())&&("focusOn"in e?e.focusOn():e.focus()):i.info("focusOn's parameter value is not '@firstInvalidShown' or empty, so it's a no-op.")}}o.extension._CONSTRUCTOR=r,Object.freeze(o),n.CustomElementBridge.register("oj-validation-group",{metadata:o})}));