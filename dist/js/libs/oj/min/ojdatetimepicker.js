/**
 * @license
 * Copyright (c) 2014, 2018, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";define(["ojs/ojcore","jquery","hammerjs","ojs/ojeditablevalue","ojs/ojinputtext","ojs/ojvalidation-datetime","ojs/ojpopup","ojs/ojbutton","ojs/ojanimation"],function(e,t,i,n,r,a){var o,s,l=e.ThemeUtils.parseJSONFromFontFamily("oj-datepicker-config")||{},c=((s=l.dateTimePickerDropDownThresholdWidth)&&(o="(min-width: "+s+")"),window.matchMedia(o||e.ResponsiveUtils.getFrameworkQuery(e.ResponsiveUtils.FRAMEWORK_QUERY_KEY.MD_UP)||"(min-width: 768px)")),h=c.matches,d=function(){h=c.matches};function u(t,i){i=t.parse(i);var n=e.IntlConverterUtils._dateTime(i,["date","fullYear","month","hours","minutes","seconds"],!0),r=new Date;return r.setFullYear(n.fullYear),r.setDate(n.date),r.setMonth(n.month),r.setHours(n.hours),r.setMinutes(n.minutes),r.setSeconds(n.seconds),r.setMilliseconds(0),r}function p(e){return this.options.converter.parse(e)}function _(i,n,r){var a=i.translations.dateTimeRange||{},o=[{category:"hint",entries:["min","max","inRange"]},{category:"messageDetail",entries:["rangeUnderflow","rangeOverflow"]},{category:"messageSummary",entries:["rangeUnderflow","rangeOverflow"]}],s={min:i.min,max:i.max,converter:n,translationKey:{"oj-inputdatetime":"datetime","oj-inputtime":"time","oj-inputdate":"date"}[r]};if(!t.isEmptyObject(a))for(var l=0,c=o.length;l<c;l++){var h=a[o[l].category];if(h){for(var d={},u=o[l].entries,p=0,_=u.length;p<_;p++)d[u[p]]=h[u[p]];s[o[l].category]=d}}return e.Validation.validatorFactory(e.ValidatorFactory.VALIDATOR_TYPE_DATETIMERANGE).createValidator(s)}function m(e,t){var i=e.filter("span");t?i.addClass("oj-disabled").removeClass("oj-enabled oj-default"):i.removeClass("oj-disabled").addClass("oj-enabled oj-default")}function f(e,t,i){if(!e||t===i.length)return e;var n=t+1;return f(e[i[t]],n,i)||f(e["*"],n,i)}function v(e){var i;i=e._isInLine?t(e.element[0]).parent():t(e.element[0]).parent().parent(),e._AddActiveable(i)}function g(e){return"native"===e.options.renderMode&&window.cordova&&window.datePicker}window.addEventListener("resize",d,!1);var y=e.Validation.converterFactory(e.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter({year:"numeric"});function k(e){var t=e.split(":");if(4!==t.length)throw new Error("timeIncrement value should be in the format of hh:mm:ss:SSS");var i={hourIncr:parseInt(t[0].substring(0),10),minuteIncr:parseInt(t[1],10),secondIncr:parseInt(t[2],10),millisecondIncr:parseInt(t[3],10)},n=0;for(var r in i)n+=i[r];if(0===n)throw new Error("timeIncrement must have a non 00:00:00:000 value");return i}function D(i,n){var r,a,o=i.resolvedOptions(),s={},l=["hour","hour12","minute","second","millisecond","timeFormat","timeZone","timeZoneName","isoStrFormat","dst"];for(r=0,a=l.length;r<a;r++)l[r]in o&&("timeFormat"===l[r]&&(s.formatType="time"),s[l[r]]=o[l[r]]);var c={};if(t.extend(c,s),delete c.isoStrFormat,delete c.dst,t.isEmptyObject(c))throw new Error("Empty object for creating a time picker converter");return t.extend(s,n||{}),e.Validation.converterFactory(e.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter(s)}function E(e,n,r){var a,o,s,l,c,h=7,d=2,u=[.152,.362,.638,.848],p=.007,_=8,m=38,f=40,v=[],g=!n&&"oj-timepicker-meridian"===r;!function(t){(a=document.createElement("div")).classList.add("oj-timepicker-wheel"),t&&a.classList.add(t);a.setAttribute("id","_ojWheel"+E.counter++),a.setAttribute("tabIndex","0"),a.setAttribute("role","spinbutton"),e.wheel=a}(r);var y,k=t(a);return a.ojSpinUp=w,a.ojSpinDown=C,a.ojRefresh=j,a.ojDestroy=D,a.ojLinked=function(){return e.linked},y={recognizers:[[i.Pan,{direction:i.DIRECTION_VERTICAL}],[i.Tap],[i.Swipe,{direction:i.DIRECTION_VERTICAL}]]},k.ojHammer(y).on("tap",T).on("swipeup",P).on("swipedown",O).on("panstart",A).on("panend pancancel",M).on("panup pandown",L),a.addEventListener("wheel",N,!1),a.addEventListener("keydown",I,!1),a.addEventListener("focus",R,!1),a.addEventListener("blur",V,!1),j(),a;function D(){k.ojHammer().off("tap",T).off("swipeup",P).off("swipedown",O).off("panstart",A).off("panend pancancel",M).off("panup pandown",L),k.ojHammer("destroy")}function w(){if(v[h+1]){S(1);var t=v.shift();t&&a.removeChild(t);var i=b(e,h,g);i&&a.appendChild(i),v.push(i)}}function C(){if(v[h-1]){S(-1);var t=v.pop();t&&a.removeChild(t);var i=b(e,-h,g);i&&a.insertBefore(i,v[0]),v.unshift(i)}}function S(t){for(var i=0;i<v.length;i++){var n=v[i];n&&n.ojUpdatePosition(i-h-t)}a.setAttribute("aria-valuenow",e.getText(0))}function j(){v.forEach(function(e){e&&a.removeChild(e)}),v=[];for(var t=-h;t<=h;t++){var i=b(e,t,g);i&&a.appendChild(i),v.push(i)}a.setAttribute("aria-valuenow",e.getText(0))}function I(t){var i=t.keyCode;switch(i){case m:e.position++,t.preventDefault();break;case f:e.position--,t.preventDefault();break;case _:e.keyboardValue=e.keyboardValue.slice(0,-1),t.preventDefault();break;default:(i>47&&i<58||i>95&&i<112||!n&&i>64&&i<91)&&(e.keyboardValue+=t.key)}}function T(t){a.focus();for(var i=(t.gesture.center.y-a.getBoundingClientRect().top)/k.height(),n=0;n<4&&i>u[n];)n++;2!==n&&(e.position+=n-2)}function P(e){a.focus();var t=e.gesture.velocityY,i=t*t/p;c=Math.floor(i/k.height()*5),e.preventDefault()}function O(e){a.focus();var t=e.gesture.velocityY,i=t*t/p;c=-Math.floor(i/k.height()*5),e.preventDefault()}function A(e){a.focus(),o=s=e.gesture.center.y,l=0,c=0}function M(t){a.focus(),c&&(e.position+=c),o=s=null,l=null}function L(t){a.focus();var i=t.gesture.center.y,n=Math.round((o-i)/k.height()*5);n!==l&&Math.abs(s-i)>d&&(s=i,e.position+=n-l,l=n),t.preventDefault()}function N(t){t.deltaY&&(t.currentTarget.focus(),t.preventDefault()),t.deltaY<0&&e.position++,t.deltaY>0&&e.position--}function R(){e.keyboardValue="",a.classList.add("oj-focus")}function V(){a.classList.remove("oj-focus"),e.update()}}function b(e,i,n){var r,a,o=!1;function s(){r.parentNode.focus()}var l=e.getText(i);if(l){(r=document.createElement("div")).classList.add("oj-timepicker-wheel-item"),r.classList.add("oj-timepicker-wheel-item-position"+i),a=i,e.isDisabled(i)&&(o=!0,r.classList.add("oj-disabled")),r.ojUpdatePosition=function(e){return r.classList.remove("oj-timepicker-wheel-item-position"+a),r.classList.add("oj-timepicker-wheel-item-position"+e),a=e,Promise.resolve()};var c=document.createElement("div");c.textContent=l,c.classList.add("oj-timepicker-wheel-item-content"),n&&c.setAttribute("title",l),r.appendChild(c),Object.defineProperty(r,"ojDisabled",{enumerable:!0,get:function(){return o},set:function(e){e!==o&&(t(r).toggleClass("oj-disabled"),o=e)}}),r.addEventListener("focus",s,!1),c.addEventListener("focus",s,!1)}return r}function w(e,t){var i,n,r,a,o,s,l,c=[150,100,50,25,16],h=0,d=0,u=0,p=1,_=1,m=1,f="",v=1,g=!1,y=this;function k(e){if(e)for(var t in e)y[t]=e[t]}function D(){var t=!1,l=e.value;y.value=C(l);var c,h=e.max;c=S(l)===S(h)?C(h)+1:_,r!==c&&(t=!0,r=c);var d,u=e.min;d=S(l)===S(u)?C(u):0,n!==d&&(t=!0,n=d);var p=e.increment,f=function e(t,i){if(0===i)return t;return e(i,t%i)}(p,s);f===s?(n=0,r=1,t=!0):y.linked&&p>o?f=p:0===b(f,o)?f/=o:f=1,m!==f&&(m=f,t=!0),i=Math.floor(_/m),a=i>4,y.wheel&&t&&y.wheel.ojRefresh()}function E(){s=o*_,l=v*p}function b(e,t){return(e%t+t)%t}function w(e,t){return Math.floor(e/s)*s+b(t,_)*o+b(e,o)}function C(e){return b(Math.floor(e/o),_)}function S(e){return Math.floor(e/s)}Object.defineProperty(y,"position",{enumerable:!0,get:function(){return d},set:function(e){var t=b(e,i)*m;t>=n&&t<r&&e!==d&&(y.value+=(e-d)*m)}}),Object.defineProperty(y,"value",{enumerable:!0,get:function(){return h},set:function(t){(function(e){return!!a||n<=e&&e<r})(t=Math.round(t/m)*m)&&h!==t&&(h=b(t,_),function(){var t,n=b((t=h,Math.floor(t/m)),i),r=b(y.position,i),o=n-r;a&&(n>r?r+i-n<Math.abs(o)&&(o=n-r-i):n+i-r<Math.abs(o)&&(o=n+i-r)),0!==o&&(d+=o,y.wheel?g||(g=!0,function t(){if(y.wheel){c.forEach(function(e){y.wheel.classList.remove("oj-timepicker-wheel-spin-"+e)});var i,n=Math.abs(d-u);if(0!==n)n--,n=Math.min(n,c.length-1),i=c[n],y.wheel.classList.add("oj-timepicker-wheel-spin-"+c[n]),d>u&&(u++,y.wheel.ojSpinUp()),d<u&&(u--,y.wheel.ojSpinDown()),i&&(e.disableSpin?t.call(y):setTimeout(t.bind(y),i));else g=!1}}.call(y)):u=d)}(),y.linked&&(2==_&&(e.disableSpin=!0),e.value=w(e.value,h),e.disableSpin=!1))}}),Object.defineProperty(y,"increment",{enumerable:!0,get:function(){return m},set:function(e){m!==e&&(m=e,E())}}),Object.defineProperty(y,"valueMultiplier",{enumerable:!0,get:function(){return o},set:function(e){o!==e&&(o=e,E())}}),Object.defineProperty(y,"valueRange",{enumerable:!0,get:function(){return _},set:function(e){_!==e&&(_=e,E())}}),Object.defineProperty(y,"displayMultiplier",{enumerable:!0,get:function(){return v},set:function(e){v!==e&&(v=e,E())}}),Object.defineProperty(y,"displayRange",{enumerable:!0,get:function(){return p},set:function(e){p!==e&&(p=e,E())}}),Object.defineProperty(y,"keyboardValue",{enumerable:!0,get:function(){return f},set:function(e){if(f=e,y.parser&&f){var t=y.parser(f);t>=0&&(i=h,a=t,t=Math.floor(i/l)*l+b(a,p)*v+b(i,v),n<=t&&t<r&&(y.value=t)),f.length>=2?f="":setTimeout(function(){f=""},1e3)}var i,a}}),y.getText=function(e){var t,n=b(u,i)+e,r=a||n>=0&&n<i;if(y.formatter&&r){var o=function(e){return t=function(e){return b(b(e,i)*m,_)}(e),b(Math.floor(t/v),p);var t}(u+e);t=y.formatter(o)}return t},y.isDisabled=function(e){var t=b(u+e,i)*m;return 0!==n&&t<n||r!==_&&t>=r},y.update=function(){e.value=w(e.value,h)},y.refresh=D,y.setProperties=k,k(t)}e.__registerWidget("oj.ojInputDate",t.oj.inputBase,{widgetEventPrefix:"oj",_CLASS_NAMES:"oj-inputdatetime-input",_WIDGET_CLASS_NAMES:"oj-inputdatetime-date-only oj-component oj-inputdatetime",_ELEMENT_TRIGGER_WRAPPER_CLASS_NAMES:"",_INPUT_HELPER_KEY:"inputHelp",_ATTR_CHECK:[{attr:"type",setMandatory:"text"}],_GET_INIT_OPTIONS_PROPS_FOR_WIDGET:[{attribute:"disabled",validateOption:!0},{attribute:"pattern"},{attribute:"title"},{attribute:"placeholder"},{attribute:"value",coerceDomValue:p},{attribute:"required",coerceDomValue:!0,validateOption:!0},{attribute:"readonly",option:"readOnly",validateOption:!0},{attribute:"min",coerceDomValue:p},{attribute:"max",coerceDomValue:p}],_TRIGGER_CLASS:"oj-inputdatetime-input-trigger",_TRIGGER_CALENDAR_CLASS:"oj-inputdatetime-calendar-icon",_CURRENT_CLASS:"oj-datepicker-current-day",_DAYOVER_CLASS:"oj-datepicker-days-cell-over",_UNSELECTABLE_CLASS:"oj-datepicker-unselectable",_DATEPICKER_DIALOG_DESCRIPTION_ID:"oj-datepicker-dialog-desc",_DATEPICKER_DESCRIPTION_ID:"oj-datepicker-desc",_CALENDAR_DESCRIPTION_ID:"oj-datepicker-calendar",_MAIN_DIV_ID:"oj-datepicker-div",_INLINE_CLASS:"oj-datepicker-inline",_INPUT_CONTAINER_CLASS:" oj-inputdatetime-input-container",_INLINE_WIDGET_CLASS:" oj-inputdatetime-inline",_ON_CLOSE_REASON_SELECTION:"selection",_ON_CLOSE_REASON_CANCELLED:"cancelled",_ON_CLOSE_REASON_TAB:"tab",_ON_CLOSE_REASON_CLOSE:"close",_KEYBOARD_EDIT_OPTION_ENABLED:"enabled",_KEYBOARD_EDIT_OPTION_DISABLED:"disabled",options:{datePicker:{footerLayout:"",changeMonth:"select",changeYear:"select",currentMonthPos:0,daysOutsideMonth:"hidden",numberOfMonths:1,showOn:"focus",stepMonths:"numberOfMonths",stepBigMonths:12,weekDisplay:"none",yearRange:"c-10:c+10"},converter:e.Validation.converterFactory(e.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter({day:"2-digit",month:"2-digit",year:"2-digit"}),keyboardEdit:"enabled",max:void 0,min:void 0,pickerAttributes:null,renderMode:"jet",dayFormatter:null},_InitBase:function(){this._triggerNode=null,this._inputContainer=null,this._redirectFocusToInputContainer=!1,this._isMobile=!1,this._ignoreShow=!1,this._nativePickerShowing=!1,this._maxRows=4,this._currentDay=0,this._drawMonth=this._currentMonth=0,this._drawYear=this._currentYear=0,this._datePickerDefaultValidators={},this._nativePickerConverter=null;var i,n,r=this.element[0].nodeName.toLowerCase();if(this._isInLine="div"===r||"span"===r,this._dpDiv=(i=t('<div class="oj-datepicker-popup" style="display:none"><div id="'+this._GetSubId(this._MAIN_DIV_ID)+'" role="region" aria-describedby="'+this._GetSubId(this._DATEPICKER_DESCRIPTION_ID)+'" class="oj-datepicker-content"></div></div>'),n=".oj-datepicker-prev-icon, .oj-datepicker-prev-icon .oj-clickable-icon-nocontext.oj-component-icon, .oj-datepicker-next-icon, .oj-datepicker-next-icon .oj-clickable-icon-nocontext.oj-component-icon, .oj-datepicker-calendar td a",i.delegate(n,"mouseout",function(){t(this).removeClass("oj-hover")}).delegate(n,"mouseover",function(){t(this).addClass("oj-hover")}).delegate(n,"focus",function(){t(this).addClass("oj-focus")}).delegate(n,"blur",function(){t(this).removeClass("oj-focus")})),t("body").append(this._dpDiv),this._isInLine)this._WIDGET_CLASS_NAMES+=this._INLINE_WIDGET_CLASS,this._CLASS_NAMES="";else{this._ELEMENT_TRIGGER_WRAPPER_CLASS_NAMES+=this._INPUT_CONTAINER_CLASS;var a=this;this._popUpDpDiv=this._dpDiv.ojPopup({initialFocus:"none",role:"dialog",modality:h?"modeless":"modal",open:function(){a._popUpDpDiv.attr("aria-describedby",a._GetSubId(a._DATEPICKER_DIALOG_DESCRIPTION_ID)),"image"===a.options.datePicker.showOn&&a._dpDiv.find(".oj-datepicker-calendar").focus()},animateStart:function(t,i){"open"===i.action&&(t.preventDefault(),e.AnimationUtils.slideIn(i.element,{offsetY:i.element.offsetHeight+"px"}).then(i.endCallback))},animation:{open:null,close:null}}).attr("data-oj-internal",""),this.element.attr("data-oj-popup-"+this._popUpDpDiv.attr("id")+"-parent","");var o=this.options.pickerAttributes;o&&e.EditableValueUtils.setPickerAttributes(this._popUpDpDiv.ojPopup("widget"),o)}},_ComponentCreate:function(){this._InitBase();var e,t=this._super();if(this.options.dayMetaData&&(this.options.dayFormatter=(e=this.options.dayMetaData,function(t){return f(e,0,[t.fullYear,t.month,t.date])})),this.options.value){var i=this._GetConverter().format(this.options.value);this._SetValue(i,{})}return this._setCurrentDate(this._getDateIso()),this._isInLine?(this.element.append(this._dpDiv),this.element.addClass(this._INLINE_CLASS),this._dpDiv.css("display","block")):(this._processReadOnlyKeyboardEdit(),this._attachTrigger()),this._registerSwipeHandler(),v(this),t},_AfterCreate:function(){var t=this._superApply(arguments);if(this._disableEnable(this.options.disabled),this._IsCustomElement()){if(this._inputContainer){var i=this.uuid+"_Label";(r=e.EditableValueUtils.getOjLabelId(this.widget(),i))&&this._inputContainer.attr("aria-labelledby",r)}}else{var n=this.$label;if(this._inputContainer&&n&&1===n.length){var r=n.attr("id");this._inputContainer.attr("aria-labelledby",r)}}return t},_setOption:function(t,i,n){var r=null;if("value"===t){if(i||(i=null),r=this._super(t,i,n),this._setCurrentDate(i),this._datepickerShowing()){var a=!(this._isInLine&&this._timePicker&&this._timePicker[0]===document.activeElement);this._updateDatepicker(a)}return r}if("dayMetaData"!==t){r=this._super(t,i,n),"disabled"===t?this._disableEnable(i):"max"===t||"min"===t?(this._datePickerDefaultValidators[e.ValidatorFactory.VALIDATOR_TYPE_DATETIMERANGE]=this._getValidator("min"),this._AfterSetOptionValidators()):"readOnly"===t?(this._processReadOnlyKeyboardEdit(),i&&this._hide(this._ON_CLOSE_REASON_CLOSE),this._AfterSetOptionDisabledReadOnly("readOnly",e.EditableValueUtils.readOnlyOptionOptions)):"keyboardEdit"===t?this._processReadOnlyKeyboardEdit():"dayFormatter"===t?(this._datePickerDefaultValidators[e.ValidatorFactory.VALIDATOR_TYPE_DATERESTRICTION]=this._getValidator("dayFormatter"),this._AfterSetOptionValidators()):"converter"===t&&(this._nativePickerConverter=null),"datePicker"===t&&"currentMonthPos"===n.subkey&&this._setCurrentDate(this._getDateIso());return this._datepickerShowing()&&t in{max:!0,min:!0,dayFormatter:!0,datePicker:!0,translations:!0}&&this._updateDatepicker(),r}this.option("dayFormatter",function(e){return f(i,0,[e.fullYear,e.month,e.date])},n)},_processReadOnlyKeyboardEdit:function(){var e=this.options.readOnly||this._isKeyboardEditDisabled();this.element.prop("readOnly",!!e)},_isKeyboardEditDisabled:function(){return this.options.keyboardEdit===this._KEYBOARD_EDIT_OPTION_DISABLED},_AppendInputHelperParent:function(){return this._triggerNode},_destroy:function(){return this._cleanUpDateResources(),this._super()},_datepickerShowing:function(){return this._isInLine||e.Components.isComponentInitialized(this._popUpDpDiv,"ojPopup")&&this._popUpDpDiv.ojPopup("isOpen")||this._nativePickerShowing},_SetupResources:function(){return this._isInLine||(this._resizePopupBind=function(){e.Components.isComponentInitialized(this._popUpDpDiv,"ojPopup")&&this._popUpDpDiv.ojPopup("option","modality",h?"modeless":"modal")}.bind(this),window.addEventListener("resize",this._resizePopupBind,!1)),this._super()},_ReleaseResources:function(){return this._IsCustomElement()&&this._cleanUpListeners(),this._super()},_cleanUpDateResources:function(){var i;i=this._isInLine?t(this.element[0]).parent():t(this.element[0]).parent().parent(),this._RemoveActiveable(i),this.element.off("focus touchstart"),this._wrapper.off("touchstart"),this._triggerNode&&this._triggerNode.remove(),this._isInLine&&(this.element.removeProp("disabled"),this.element.removeProp("readonly")),this._cleanUpListeners(),this._animationResolve&&(this._animationResolve(),this._animationResolve=null),this._popUpDpDiv&&e.Components.isComponentInitialized(this._popUpDpDiv,"ojPopup")&&this._popUpDpDiv.ojPopup("destroy"),this._dpDiv.remove()},_cleanUpListeners:function(){this._resizePopupBind&&window.removeEventListener("resize",this._resizePopupBind),window.removeEventListener("resize",d)},_WrapElement:function(){this._inputContainer=this._superApply(arguments),this._inputContainer.attr({role:"combobox","aria-haspopup":"true",tabindex:"-1"})},_onElementFocus:function(){var e=this.options.datePicker.showOn;this._redirectFocusToInputContainer?(this._redirectFocusToInputContainer=!1,this._inputContainer.focus()):"focus"===e?this.show():this._datepickerShowing()&&this._hide(this._ON_CLOSE_REASON_CLOSE)},_OnElementTouchStart:function(){if("focus"===this.options.datePicker.showOn)if(this._datepickerShowing())this._ignoreShow=!0,this._hide(this._ON_CLOSE_REASON_CLOSE);else{var e=this.element[0]===document.activeElement;this.show(),this._redirectFocusToInputContainer=!0,e&&this._inputContainer.focus()}},_attachTrigger:function(){var e=this.options.datePicker.showOn,i=t("<span>").addClass(this._TRIGGER_CLASS),n=t("<span title='"+this._GetCalendarTitle()+"'/>").addClass(this._TRIGGER_CALENDAR_CLASS+" oj-clickable-icon-nocontext oj-component-icon");i.append(n),this.element.on("focus",t.proxy(this._onElementFocus,this)),this.element.on("touchstart",t.proxy(this._OnElementTouchStart,this));var r=this;this._wrapper.on("touchstart",function(e){r._isMobile=!0}),"image"===e&&(n.css("display","block"),this._IsRTL()?(this.element.css("border-top-left-radius",0),this.element.css("border-bottom-left-radius",0)):(this.element.css("border-top-right-radius",0),this.element.css("border-bottom-right-radius",0))),n.on("click",function(){return r._datepickerShowing()?r._hide(r._ON_CLOSE_REASON_CLOSE):(r.show(),r._dpDiv.find(".oj-datepicker-calendar").focus()),!1}),this._AddHoverable(n),this._AddActiveable(n),this._triggerIcon=n,this._triggerNode=i,this.element.after(i)},_doCalendarKeyDown:function(e){var i,n=!1,r=t.ui.keyCode,a=this._IsRTL();if(this._datepickerShowing())switch(e.keyCode){case 84:e.altKey&&e.ctrlKey&&(this._dpDiv.find(".oj-datepicker-current").focus(),n=!0);break;case r.TAB:break;case r.SPACE:case r.ENTER:return(i=t("td."+this._DAYOVER_CLASS,this._dpDiv))[0]&&this._selectDay(this._currentMonth,this._currentYear,i[0],e),e.preventDefault(),e.stopPropagation(),!1;case r.ESCAPE:this._hide(this._ON_CLOSE_REASON_CANCELLED),n=!0;break;case r.PAGE_UP:e.ctrlKey&&e.altKey?this._adjustDate(-this.options.datePicker.stepBigMonths,"M",!0):e.altKey?this._adjustDate(-1,"Y",!0):this._adjustDate(-this._getStepMonths(),"M",!0),n=!0;break;case r.PAGE_DOWN:e.ctrlKey&&e.altKey?this._adjustDate(+this.options.datePicker.stepBigMonths,"M",!0):e.altKey?this._adjustDate(1,"Y",!0):this._adjustDate(+this._getStepMonths(),"M",!0),n=!0;break;case r.END:this._currentDay=this._getDaysInMonth(this._currentYear,this._currentMonth),this._changeCurrentDay(),n=!0;break;case r.HOME:this._currentDay=1,this._changeCurrentDay(),n=!0;break;case r.LEFT:e.originalEvent&&e.originalEvent.altKey||e.altKey?this._adjustDate(e.ctrlKey?-this.options.datePicker.stepBigMonths:-this._getStepMonths(),"M",!0):this._adjustDate(a?1:-1,"D",!0),n=!0;break;case r.UP:this._adjustDate(-7,"D",!0),n=!0;break;case r.RIGHT:e.originalEvent&&e.originalEvent.altKey||e.altKey?this._adjustDate(e.ctrlKey?+this.options.datePicker.stepBigMonths:+this._getStepMonths(),"M",!0):this._adjustDate(a?-1:1,"D",!0),n=!0;break;case r.DOWN:this._adjustDate(7,"D",!0),n=!0}n&&(e.preventDefault(),e.stopPropagation())},_changeCurrentDay:function(){var e=t("."+this._DAYOVER_CLASS,this._dpDiv),i=this._currentDay+"";1===e.length&&e.removeClass(this._DAYOVER_CLASS);var n=t("table.oj-datepicker-calendar",this._dpDiv);if(1===(e=t("a.oj-enabled:contains("+this._currentDay+")",n).filter(function(){return t(this).text()===i})).length){var r=e.parent();n.addClass("oj-focus-highlight"),n.attr("aria-activedescendant",r.attr("id")+""),r.addClass(this._DAYOVER_CLASS)}},_doMonthViewKeyDown:function(e){var i,n=!1,r=t.ui.keyCode,a=this._IsRTL();if(this._datepickerShowing())switch(e.keyCode){case 84:e.altKey&&e.ctrlKey&&(this._dpDiv.find(".oj-datepicker-current").focus(),n=!0);break;case r.SPACE:case r.ENTER:return(i=t("td."+this._DAYOVER_CLASS,this._dpDiv))[0]&&this._selectMonthYear(i[0],"M"),e.preventDefault(),e.stopPropagation(),!1;case r.ESCAPE:this.hide(),n=!0;break;case r.PAGE_UP:e.ctrlKey&&e.altKey?this._adjustDate(-this.options.datePicker.stepBigMonths,"M",!0,"month"):e.altKey?this._adjustDate(-1,"Y",!0,"month"):this._adjustDate(-this._getStepMonths(),"M",!0,"month"),n=!0;break;case r.PAGE_DOWN:e.ctrlKey&&e.altKey?this._adjustDate(+this.options.datePicker.stepBigMonths,"M",!0,"month"):e.altKey?this._adjustDate(1,"Y",!0,"month"):this._adjustDate(+this._getStepMonths(),"M",!0,"month"),n=!0;break;case r.END:this._currentMonth=11,this._updateDatepicker(!0,"month"),n=!0;break;case r.HOME:this._currentMonth=0,this._updateDatepicker(!0,"month"),n=!0;break;case r.LEFT:this._adjustDate(a?1:-1,"M",!0,"month"),n=!0;break;case r.UP:this._adjustDate(-3,"M",!0,"month"),n=!0;break;case r.RIGHT:this._adjustDate(a?-1:1,"M",!0,"month"),n=!0;break;case r.DOWN:this._adjustDate(3,"M",!0,"month"),n=!0}n&&(e.preventDefault(),e.stopPropagation())},_doYearViewKeyDown:function(e){var i,n=!1,r=t.ui.keyCode,a=this._IsRTL();if(this._datepickerShowing())switch(e.keyCode){case 84:e.altKey&&e.ctrlKey&&(this._dpDiv.find(".oj-datepicker-current").focus(),n=!0);break;case r.SPACE:case r.ENTER:return(i=t("td."+this._DAYOVER_CLASS,this._dpDiv))[0]&&this._selectMonthYear(i[0],"Y"),e.preventDefault(),e.stopPropagation(),!1;case r.ESCAPE:this.hide(),n=!0;break;case r.PAGE_UP:e.altKey&&this._adjustDate(-1,"Y",!0,"year"),n=!0;break;case r.PAGE_DOWN:e.altKey&&this._adjustDate(1,"Y",!0,"year"),n=!0;break;case r.END:this._currentYear=10*Math.floor(this._currentYear/10)+9,this._updateDatepicker(!0,"year"),n=!0;break;case r.HOME:this._currentYear=10*Math.floor(this._currentYear/10),this._updateDatepicker(!0,"year"),n=!0;break;case r.LEFT:this._adjustDate(a?1:-1,"Y",!0,"year"),n=!0;break;case r.UP:this._adjustDate(-3,"Y",!0,"year"),n=!0;break;case r.RIGHT:this._adjustDate(a?-1:1,"Y",!0,"year"),n=!0;break;case r.DOWN:this._adjustDate(3,"Y",!0,"year"),n=!0}n&&(e.preventDefault(),e.stopPropagation())},_getDatepickerContent:function(){return t(this._dpDiv.find(".oj-datepicker-content")[0])},_isDateTimeSwitcher:function(){return this._dateTimeSwitcherActive},_updateDatepicker:function(t,i,n){var r;this._maxRows=4,(r="year"===i?this._generateViewHTML("Y"):"month"===i?this._generateViewHTML("M"):this._generateViewHTML("D")).html="<div"+(this._isDateTimeSwitcher()?"":" class='oj-datepicker-wrapper'")+">"+r.html+"</div>",this._currentView=i;var a=this._getDatepickerContent();if(n){var o=a.children().first();o.css({position:"absolute",left:0,top:0}),a.prepend(r.html);var s=a.children().first(),l="previous"==n?"end":"start";if(!this._animationResolve){var c=e.Context.getContext(this.element[0]).getBusyContext();this._animationResolve=c.addBusyState({description:"The datepicker id='"+this.element.attr("id")+"' is animating."})}e.AnimationUtils.startAnimation(s[0],"open",{effect:"slideIn",direction:l});var h=e.AnimationUtils.startAnimation(o[0],"close",{effect:"slideOut",direction:l,persist:"all"}),d=this;h.then(function(){o&&o.remove(),d._setupNewView(t,i,r.dayOverId),d._animationResolve(),d._animationResolve=null})}else a.empty().append(r.html),this._setupNewView(t,i,r.dayOverId)},_setupNewView:function(e,t,i){this._attachHandlers(),i&&this._dpDiv.find(".oj-datepicker-calendar").attr("aria-activedescendant",i);var n=this._getNumberOfMonths(),r=n[1],a=275;if(this._dpDiv.removeClass("oj-datepicker-multi-2 oj-datepicker-multi-3 oj-datepicker-multi-4").width(""),"year"===t||"month"===t)this._dpDiv.removeClass("oj-datepicker-multi");else{if((r=(n=this._getNumberOfMonths())[1])>1){var o=this._dpDiv.find(".oj-datepicker-calendar"),s=o.find("tbody a"),l=parseFloat(s.css("width")),c=parseFloat(o.css("margin-left"));isNaN(l)||isNaN(c)||(a=l*("number"===this.options.datePicker.weekDisplay?8:7)+2*c),this._dpDiv.addClass("oj-datepicker-multi-"+r).css("width",a*r+(this._isInLine?2:0)+"px")}this._dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("oj-datepicker-multi")}this._datepickerShowing()&&this.element.is(":visible")&&!this.element.is(":disabled")&&(e?this._placeFocusOnCalendar():this._isInLine||this.element[0]===document.activeElement||this.element.focus())},_placeFocusOnCalendar:function(){var e=this._dpDiv.find(".oj-datepicker-calendar");e[0]!==document.activeElement&&t(e[0]).focus()},_adjustDate:function(e,t,i,n,r){if(!this.options.disabled){var a=this._currentMonth,o=this._currentYear;this._adjustInstDate(e+("M"===t?this.options.datePicker.currentMonthPos:0),t),"D"===t&&a===this._currentMonth&&o===this._currentYear?this._changeCurrentDay():this._updateDatepicker(i,n,r)}},_gotoToday:function(){var e=new Date;this._currentDay=e.getDate(),this._drawMonth=this._currentMonth=e.getMonth(),this._drawYear=this._currentYear=e.getFullYear(),this._adjustDate(null,null,!0,"day")},_selectMonthYear:function(i,n){var r,a=e.IntlConverterUtils,o=this._getDateIso(),s=i.getAttribute("data-year");s&&(r=parseInt(s,10),this._currentYear=this._drawYear=r),"M"===n?(r=parseInt(i.getAttribute("data-month"),10),this._currentMonth=this._drawMonth=r,o=a._dateTime(o,{fullYear:this._currentYear,month:this._currentMonth})):o=a._dateTime(o,{fullYear:this._currentYear}),t("#"+this._GetSubId(this._CALENDAR_DESCRIPTION_ID)).html(this._EscapeXSS(this.options.monthWide[this._drawMonth])+" "+y.format(e.IntlConverterUtils.dateToLocalIso(new Date(this._drawYear,this._drawMonth,1)))),this._adjustDate(0,0,!0,"M"===n?"day":this._toYearFromView)},_selectDay:function(i,n,r,a){if(!t(r).hasClass(this._UNSELECTABLE_CLASS)&&!this.options.disabled){this._isDateTimeSwitcher()||this._hide(this._ON_CLOSE_REASON_SELECTION),this._currentDay=t("a",r).html(),this._currentMonth=i,this._currentYear=n;var o=e.IntlConverterUtils,s=this.options.value,l=new Date(this._currentYear,this._currentMonth,this._currentDay);s=s?o._dateTime(s,{fullYear:l.getFullYear(),month:l.getMonth(),date:l.getDate()}):o.dateToLocalIso(l),this._setDisplayAndValue(s,{}),this._isDateTimeSwitcher()&&this._placeFocusOnCalendar()}},_setDisplayAndValue:function(e,t){if(this._isDateTimeSwitcher()){if(this._switcherDateValue=e,this._setCurrentDate(e),this._datepickerShowing()){var i=!(this._isInLine&&this._timePicker&&this._timePicker[0]===document.activeElement);this._updateDatepicker(i)}}else{var n=this._GetConverter().format(e);this._SetDisplayValue(n),this._SetValue(n,t)}},_getDefaultIsoDate:function(){return e.IntlConverterUtils.dateToLocalIso(this._getTodayDate())},_setCurrentDate:function(t){var i=e.IntlConverterUtils._dateTime(t||this._getDefaultIsoDate(),["fullYear","month","date"],!0);this._currentDay=i.date,this._currentMonth=i.month,this._isMultiMonth()||(this._drawMonth=i.month),this._drawYear=this._currentYear=i.fullYear,this._adjustInstDate()},_getStepMonths:function(){var e=this.options.datePicker.stepMonths;return t.isNumeric(e)?e:this.options.datePicker.numberOfMonths},_isButtonActivated:function(e){return!this.options.disabled&&("click"===e.type||"keydown"===e.type&&(32===e.keyCode||13===e.keyCode))},_gotoPrev:function(e){"year"===this._currentView?this._adjustDate(-10,"Y",!0,"year","previous"):"month"===this._currentView?this._adjustDate(-1,"Y",!0,"month","previous"):this._adjustDate(-e,"M",!0,"day","previous")},_gotoNext:function(e){"year"===this._currentView?this._adjustDate(10,"Y",!0,"year","next"):"month"===this._currentView?this._adjustDate(1,"Y",!0,"month","next"):this._adjustDate(+e,"M",!0,"day","next")},_attachHandlers:function(){var i=this._getStepMonths(),n=this,r=function(e){var i=!1;return"keydown"===e.type&&e.keyCode===t.ui.keyCode.TAB&&(i=!0),i};this._dpDiv.find("[data-handler]").map(function(){var e={prev:function(e){return n._isButtonActivated(e)&&n._gotoPrev(i),r(e)},next:function(e){return n._isButtonActivated(e)&&n._gotoNext(i),r(e)},today:function(e){return n._isButtonActivated(e)&&n._gotoToday(),r(e)},selectDay:function(e){return n._isButtonActivated(e)&&n._selectDay(+this.getAttribute("data-month"),+this.getAttribute("data-year"),this,e),r(e)},selectMonth:function(e){return n._isButtonActivated(e)&&n._selectMonthYear(this,"M"),r(e)},selectYear:function(e){return n._isButtonActivated(e)&&n._selectMonthYear(this,"Y"),r(e)},calendarKey:function(e){"year"===n._currentView?n._doYearViewKeyDown(e):"month"===n._currentView?n._doMonthViewKeyDown(e):n._doCalendarKeyDown(e)},selectMonthHeader:function(e){return n._isButtonActivated(e)&&("month"===n._currentView?n._updateDatepicker(!0,"day"):n._updateDatepicker(!0,"month")),r(e)},selectYearHeader:function(e){return n._isButtonActivated(e)&&("year"===n._currentView?n._updateDatepicker(!0,"day"):(n._toYearFromView=n._currentView,n._updateDatepicker(!0,"year"))),r(e)}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])}),this._dpDiv.find(".oj-datepicker-calendar").map(function(){e.DomUtils.makeFocusable({element:t(this),applyHighlight:!0})});var a=this._dpDiv.find(".oj-datepicker-header a, .oj-datepicker-buttonpane a");this._AddHoverable(a),this._AddActiveable(a)},_registerSwipeHandler:function(){if(e.DomUtils.isTouchSupported()){var t=this,n=this._getStepMonths(),r=this._IsRTL(),a={recognizers:[[i.Swipe,{direction:i.DIRECTION_HORIZONTAL}]]};this._dpDiv.ojHammer(a).on(r?"swiperight":"swipeleft",function(e){return t._gotoNext(n),!1}).on(r?"swipeleft":"swiperight",function(e){return t._gotoPrev(n),!1})}},_getMinMaxDateIso:function(t){var i=this.options[t];if(i){var n=this._getDateIso();i=e.IntlConverterUtils._minMaxIsoString(i,n)}return i},_generateHeader:function(e,t,i,n,r){var a,o,s,l,c,h=this._IsRTL();return o=this._EscapeXSS(this.getTranslatedString("prevText")),s=n?"<a role='button' href='#' onclick='return false;' class='oj-datepicker-prev-icon oj-enabled oj-default oj-component-icon oj-clickable-icon-nocontext' data-handler='prev' data-event='click keydown' aria-label='"+o+"'></a>":"<a class='oj-datepicker-prev-icon oj-disabled oj-component-icon oj-clickable-icon-nocontext' title='"+o+"'></a>",l=this._EscapeXSS(this.getTranslatedString("nextText")),c=r?"<a role='button' href='#' onclick='return false;' class='oj-datepicker-next-icon oj-enabled oj-default oj-component-icon oj-clickable-icon-nocontext' data-handler='next' data-event='click keydown' aria-label='"+l+"'></a>":"<a class='oj-datepicker-next-icon oj-disabled oj-component-icon oj-clickable-icon-nocontext' title='"+l+"'></a>",a="<div class='oj-datepicker-header"+(this.options.disabled?" oj-disabled ":" oj-enabled oj-default ")+"'>",a+=/all|left/.test(i)?h?c:s:"",a+=/all|right/.test(i)?h?s:c:"",a+=this._generateMonthYearHeader(e,t),a+="</div>"},_generateFooter:function(e,t){var i="",n=this._EscapeXSS(this.getTranslatedString("currentText")),r=(this.options.disabled,"<a role='button' href='#' onclick='return false;' class='oj-datepicker-current oj-priority-secondary "+(this.options.disabled?"oj-disabled' disabled":"oj-enabled'")+" data-handler='today' data-event='click keydown'>"+n+"</a>");if(e.length>1){var a=0,o=[{index:e.indexOf("today"),content:this._isInRange(t)?r:""}];for(o.sort(function(e,t){return e.index-t.index});a<o.length&&o[a].index<0;)a++;for(;a<o.length;)i+=o[a++].content;i.length>0&&(i="<div class='oj-datepicker-buttonpane'>"+i+"</div>")}return i},_isMultiMonth:function(){var e=this._getNumberOfMonths();return 1!==e[0]||1!==e[1]},_generateViewHTML:function(t){var i,n,r,a,o,s,l,c=e.IntlConverterUtils,h=["date","month","fullYear"],d=this._GetConverter(),u=new Date,p=new Date(u.getFullYear(),u.getMonth(),u.getDate()),_=this._IsRTL(),m=this.options.datePicker.footerLayout,f=this._getNumberOfMonths(),v=this.options.datePicker.currentMonthPos,g=this._isMultiMonth(),y=this._getMinMaxDateIso("min"),k=this._getMinMaxDateIso("max"),D=this._drawMonth-v,E=this._drawYear,b=new Date(this._currentYear,this._currentMonth,this._currentDay),w=this._getDateIso(),C=c._dateTime(w,h,!0),S=C.fullYear,j=C.date,I=C.month,T=new Date(S,I,j),P=this.options.disabled,O=this._EscapeXSS(this.getTranslatedString("weekText"));if(y&&(y=d.parse(y),s=c._dateTime(y,h,!0)),k&&(k=d.parse(k),l=c._dateTime(k,h,!0)),w=c._clearTime(w),D<0&&(D+=12,E--),s){var A=new Date(s.fullYear,s.month,s.date);for(l&&d.compareISODates(k,y)<0&&(A=new Date(l.fullYear,l.month,l.date));new Date(E,D,this._getDaysInMonth(E,D))<A;)++D>11&&(D=0,E++)}if(l)for(i=new Date(l.fullYear,l.month-f[0]*f[1]+1,l.date),s&&d.compareISODates(k,y)<0&&(i=new Date(s.fullYear,s.month,s.date));new Date(E,D,1)>i;)--D<0&&(D=11,E--);return this._drawMonth=D,this._drawYear=E,n=this._canAdjustMonth(-1,E,D)&&!P,r=this._canAdjustMonth(1,E,D)&&!P,a=this._generateFooter(m,p),o=this.options.datePicker.weekDisplay,"D"===t?this._generateDayHTMLContent(n,r,c,d,a,o,p,_,f,g,s,l,D,E,b,C,S,j,I,T,P,O):"M"===t?this._generateMonthHTMLContent(n,r,d,a,s,l,D,E,T,P):this._generateYearHTMLContent(n,r,c,a,s,l,D,E,T,P)},_generateDayHTMLContent:function(e,t,i,n,r,a,o,s,l,c,h,d,u,p,_,m,f,v,g,y,k,D){var E,b,w,C,S,j,I,T,P,O,A,M,L,N,R,V,x,Y,G,F,U,H,W,B,K=this.options.dayWide,z=this.options.dayNarrow,X=this.options.firstDayOfWeek,q="",J=this.options.dayFormatter,$=null;E=this.options.datePicker.daysOutsideMonth,b="";var Z="all";for(C=0;C<l[0];C++){for(S="",this._maxRows=4,j=0;j<l[1];j++){if(Z=0===C?"all":"",A="",c){if(A+="<div class='oj-datepicker-group",l[1]>1)switch(j){case 0:A+=" oj-datepicker-group-first",Z=0===C?s?"right":"left":"";break;case l[1]-1:A+=" oj-datepicker-group-last",Z=0===C?s?"left":"right":"";break;default:A+=" oj-datepicker-group-middle",Z=""}A+="'>"}for(A+=this._generateHeader(u,p,Z,e,t),A+="<table class='oj-datepicker-calendar"+("number"===a?" oj-datepicker-weekdisplay":"")+(k?" oj-disabled ":" oj-enabled oj-default ")+"' tabindex=-1 data-handler='calendarKey' data-event='keydown' aria-readonly='true' role='grid' aria-labelledby='"+this._GetSubId(this._CALENDAR_DESCRIPTION_ID)+"'><thead role='presentation'><tr role='row'>",M="number"===a?"<th class='oj-datepicker-week-col'>"+this._EscapeXSS(this.getTranslatedString("weekHeader"))+"</th>":"",w=0;w<7;w++)M+="<th role='columnheader' aria-label='"+K[L=(w+parseInt(X,10))%7]+"'"+((w+X+6)%7>=5?" class='oj-datepicker-week-end'":"")+"><span title='"+K[L]+"'>"+z[L]+"</span></th>";for(A+=M+"</tr></thead><tbody role='presentation'>",N=this._getDaysInMonth(p,u),p===f&&u===g&&(v=Math.min(v,N)),R=(this._getFirstDayOfMonth(p,u)-X+7)%7,V=Math.ceil((R+N)/7),x=c&&this._maxRows>V?this._maxRows:V,this._maxRows=x,Y=new Date(p,u,1-R),G=0;G<x;G++){for(A+="<tr role='row'>",B=this._GetConverter().calculateWeek(i.dateToLocalIso(Y)),F="none"===a?"":"<td class='oj-datepicker-week-col' role='rowheader' aria-label='"+D+" "+B+"'>"+B+"</td>",w=0;w<7;w++){H=Y.getMonth()!==u,I=Y.getTime()===y.getTime(),T="oj-dp-"+this.uuid+"-"+G+"-"+w+"-"+C+"-"+j,(P=Y.getTime()===_.getTime()&&u===this._currentMonth)?(q=T,O=" "+this._DAYOVER_CLASS):O="",U=[!0,""];var Q=Y.getFullYear(),ee=Y.getMonth(),te=Y.getDate();J&&($=J({fullYear:Q,month:ee+1,date:te}))&&(U=[!$.disabled,$.className||""],$.tooltip&&U.push($.tooltip));var ie=Y.getTime()===y.getTime();F+="<td role='gridcell' aria-disabled='"+!!(W=H&&"selectable"!==E||!U[0]||this._outSideMinMaxRange(Y,h,d))+"' aria-selected='"+I+"' id='"+T+"' class='"+((w+X+6)%7>=5?" oj-datepicker-week-end":"")+(H?" oj-datepicker-other-month":"")+O+(W||k?" "+this._UNSELECTABLE_CLASS+" oj-disabled":" oj-enabled ")+(H&&"hidden"===E?"":" "+U[1]+(I?" "+this._CURRENT_CLASS:"")+(Y.getTime()===o.getTime()?" oj-datepicker-today":""))+"'"+(H&&"hidden"===E||!U[2]?"":" title='"+U[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+Y.getMonth()+"' data-year='"+Y.getFullYear()+"'")+">"+(H&&"hidden"===E?"&#xa0;":W||k?"<span class='oj-disabled'>"+Y.getDate()+"</span>":"<a role='button' class='oj-enabled"+(ie?" oj-selected":"")+(H?" oj-priority-secondary":"")+"' "+(P?"":"tabindex='-1' ")+" onclick='return false;' href='#'>"+Y.getDate()+"</a>")+"</td>",Y.setDate(Y.getDate()+1)}A+=F+"</tr>"}++u>11&&(u=0,p++),S+=A+="</tbody></table>"+(c?"</div>"+(l[0]>0&&j===l[1]-1?"<div class='oj-datepicker-row-break'></div>":""):"")}b+=S}return{html:b+=r,dayOverId:q}},_generateMonthYearHeader:function(t,i){var n=this.options.datePicker.changeMonth,r=this.options.datePicker.changeYear,a=e.LocaleData.isMonthPriorToYear()?"before":"after",o="<div class='oj-datepicker-title'>",s="",l=e.IntlConverterUtils,c=this.options.monthWide,h=this.options.disabled;return c&&("none"===n?s+="<span class='oj-datepicker-month'>"+c[t]+"</span>":(s+="<a role='button' onclick='return false;' href='#' data-handler='selectMonthHeader' data-event='click keydown' class='oj-datepicker-month "+(h?"oj-disabled' disabled":"oj-enabled'")+">",s+=c[t]+"</a>"),"before"===a&&(o+=s+("select"!==n||"select"!==r?"&#xa0;":""))),this.yearshtml||(this.yearshtml="","none"===r?o+="<span class='oj-datepicker-year'>"+y.format(l.dateToLocalIso(new Date(i,t,1)))+"</span>":(o+="<a role='button' onclick='return false;' href='#' data-handler='selectYearHeader' data-event='click keydown' class='oj-datepicker-year "+(h?"oj-disabled' disabled":"oj-enabled'")+">",o+=y.format(l.dateToLocalIso(new Date(i,t,1)))+"</a>",this.yearshtml=null)),c&&"after"===a&&(o+=("select"!==n||"select"!==r?"&#xa0;":"")+s),o+="<span aria-hidden='true' class='oj-helper-hidden-accessible' id='"+this._GetSubId(this._DATEPICKER_DIALOG_DESCRIPTION_ID)+"'>",o+=this._EscapeXSS(this.getTranslatedString("picker"))+"</span>",o+="<span aria-hidden='true' class='oj-helper-hidden-accessible' id='"+this._GetSubId(this._CALENDAR_DESCRIPTION_ID)+"'>",o+=(c?c[t]+" ":"")+y.format(l.dateToLocalIso(new Date(i,t,1)))+"</span>",o+="<span aria-hidden='true' class='oj-helper-hidden-accessible' id='"+this._GetSubId(this._DATEPICKER_DESCRIPTION_ID)+"'>"+this._EscapeXSS(this.getTranslatedString("datePicker"))+"</span>",o+="</div>"},_adjustInstDate:function(e,t){var i=this._drawYear+("Y"===t?e:0),n=this._drawMonth+("M"===t?e:0),r=Math.min(this._currentDay,this._getDaysInMonth(i,n))+("D"===t?e:0),a=new Date(i,n,r);this._currentDay=a.getDate(),this._drawMonth=this._currentMonth=a.getMonth(),this._drawYear=this._currentYear=a.getFullYear()},_generateMonthHTMLContent:function(e,t,i,n,r,a,o,s,l,c){this.options.monthWide;var h,d,u,p,_,m,f,v,g,y,k,D=this.options.monthAbbreviated,E="";for(e=this._canAdjustYear(-1,s)&&!c,t=this._canAdjustYear(1,s)&&!c,h="",this._maxRows=4,f="",f+=this._generateHeader(o,s,"all",e,t),f+="<table class='oj-datepicker-calendar oj-datepicker-monthview"+(c?" oj-disabled ":" oj-enabled oj-default ")+"' tabindex=-1 data-handler='calendarKey' data-event='keydown' aria-readonly='true' role='grid' aria-labelledby='"+this._GetSubId(this._CALENDAR_DESCRIPTION_ID)+"'>",f+="<tbody role='presentation'>",v=new Date(s,0,1),g=0;g<4;g++){for(f+="<tr role='row'>",y="",d=0;d<3;d++){var b=3*g+d;u=v.getMonth()===l.getMonth(),p="oj-dp-"+this.uuid+"-"+g+"-"+d+"-0-0",(_=b===this._currentMonth)?(E=p,m=" "+this._DAYOVER_CLASS):m="";var w=v.getMonth()===l.getMonth(),C=r&&r.fullYear===s,S=a&&a.fullYear===s;y+="<td role='gridcell' aria-disabled='"+!!(k=!((!C||b>=r.month)&&(!S||b<=a.month)))+"' aria-selected='"+u+"' id='"+p+"' class='"+m+(k||c?" "+this._UNSELECTABLE_CLASS+" oj-disabled":" oj-enabled ")+(u?" "+this._CURRENT_CLASS:"")+"'"+(k?"":" data-handler='selectMonth' data-event='click' data-month='"+v.getMonth()+"' data-year='"+v.getFullYear()+"'")+">"+(k||c?"<span class='oj-disabled'>"+D[b]+"</span>":"<a role='button' class='oj-enabled"+(w?" oj-selected":"")+"' "+(_?"":"tabindex='-1' ")+" onclick='return false;' href='#'>"+D[b]+"</a>")+"</td>",v.setMonth(v.getMonth()+1)}f+=y+"</tr>"}return++o>11&&(o=0,s++),h+=f+="</tbody></table>",{html:h+=n,dayOverId:E}},_generateYearHTMLContent:function(e,t,i,n,r,a,o,s,l,c){var h,d,u,p,_,m,f,v,g,k,D,E="";e=this._canAdjustDecade(-1,s)&&!c,t=this._canAdjustDecade(1,s)&&!c,h="",this._maxRows=4,f="",f+=this._generateHeader(o,s,"all",e,t),f+="<table class='oj-datepicker-calendar oj-datepicker-yearview"+(c?" oj-disabled ":" oj-enabled oj-default ")+"' tabindex=-1 data-handler='calendarKey' data-event='keydown' aria-readonly='true' role='grid' aria-labelledby='"+this._GetSubId(this._CALENDAR_DESCRIPTION_ID)+"'>",f+="<tbody role='presentation'>";var b=this._getYearRange(s,r,a),w=10*Math.floor(s/10);for(v=new Date(w,o,1),g=0;g<4;g++){for(f+="<tr role='row'>",k="",d=0;d<3&&(3!=g||1!=d);d++){var C=w+3*g+d;u=v.getFullYear()===l.getFullYear(),p="oj-dp-"+this.uuid+"-"+g+"-"+d+"-0-0",(_=C===this._currentYear)?(E=p,m=" "+this._DAYOVER_CLASS):m="";var S=v.getFullYear()===l.getFullYear(),j=y.format(i.dateToLocalIso(new Date(C,o,1)));k+="<td role='gridcell' aria-disabled='"+!!(D=C<b.startYear||C>b.endYear)+"' aria-selected='"+u+"' id='"+p+"' class='"+m+(D||c?" "+this._UNSELECTABLE_CLASS+" oj-disabled":" oj-enabled ")+(u?" "+this._CURRENT_CLASS:"")+"'"+(D?"":" data-handler='selectYear' data-event='click' data-month='"+v.getMonth()+"' data-year='"+v.getFullYear()+"'")+">"+(D||c?"<span class='oj-disabled'>"+j+"</span>":"<a role='button' class='oj-enabled"+(S?" oj-selected":"")+"' "+(_?"":"tabindex='-1' ")+" onclick='return false;' href='#'>"+j+"</a>")+"</td>",v.setFullYear(v.getFullYear()+1)}f+=k+"</tr>"}return++o>11&&(o=0,s++),h+=f+="</tbody></table>",{html:h+=n,dayOverId:E}},_getYearRange:function(e,t,i){var n,r,a,o,s;return n=this.options.datePicker.yearRange.split(":"),r=(new Date).getFullYear(),o=(a=function(t){var i=t.match(/c[+\-].*/)?e+parseInt(t.substring(1),10):t.match(/[+\-].*/)?r+parseInt(t,10):parseInt(t,10);return isNaN(i)?r:i})(n[0]),s=Math.max(o,a(n[1]||"")),{startYear:o=t?Math.max(o,t.fullYear):o,endYear:s=i?Math.min(s,i.fullYear):s}},_getNumberOfMonths:function(){var e=this.options.datePicker.numberOfMonths;return null==(e="string"==typeof e?parseInt(e,10):e)?[1,1]:"number"==typeof e?[1,e]:e},_getDaysInMonth:function(e,t){return 32-new Date(e,t,32).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i){var n=this._getNumberOfMonths(),r=new Date(t,i+(e<0?e:n[0]*n[1]),1);return e<0&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(r)},_canAdjustYear:function(e,t){var i;return e<0?(i=new Date(t+e,12,1)).setDate(this._getDaysInMonth(i.getFullYear(),i.getMonth())):i=new Date(t+e,1,1),this._isInRange(i)},_canAdjustDecade:function(e,t){var i,n=10*Math.floor(t/10);return e<0?(i=new Date(n+9+10*e,12,1)).setDate(this._getDaysInMonth(i.getFullYear(),i.getMonth())):i=new Date(n+10*e,1,1),this._isInRange(i)},_outSideMinMaxRange:function(e,t,i){var n=t?new Date(t.fullYear,t.month,t.date):null,r=i?new Date(i.fullYear,i.month,i.date):null;return null!==n&&e<n||null!==r&&e>r},_isInRange:function(t){var i,n,r,a,o=e.IntlConverterUtils,s=this._GetConverter(),l=this._getMinMaxDateIso("min"),c=null,h=this._getMinMaxDateIso("max"),d=null,u=this.options.datePicker.yearRange;if(u&&(i=u.split(":"),n=(new Date).getFullYear(),c=parseInt(i[0],10),d=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(c+=n),i[1].match(/[+\-].*/)&&(d+=n)),l){l=s.parse(l);var p=o._dateTime(l,["fullYear","month","date"],!0);r=new Date(p.fullYear,p.month,p.date)}if(h){h=s.parse(h);var _=o._dateTime(h,["fullYear","month","date"],!0);a=new Date(_.fullYear,_.month,_.date)}return(!r||t.getTime()>=r.getTime())&&(!a||t.getTime()<=a.getTime())&&(!c||t.getFullYear()>=c)&&(!d||t.getFullYear()<=d)},_GetCalendarTitle:function(){return this._EscapeXSS(this.getTranslatedString("tooltipCalendar"+(this.options.disabled?"Disabled":"")))},_disableEnable:function(e){this._triggerNode&&(m(this._triggerNode.children(),e),this._triggerNode.find("."+this._TRIGGER_CALENDAR_CLASS).attr("title",this._GetCalendarTitle())),e&&this._hide(this._ON_CLOSE_REASON_CLOSE),this._isInLine&&this._updateDatepicker()},_AppendInputHelper:function(){this._isInLine||this._superApply(arguments)},_onBlurHandler:function(e){this._isInLine||this._superApply(arguments)},_onKeyDownHandler:function(i){if(!this._isInLine){this._superApply(arguments);var n=t.ui.keyCode,r=!1;if(this._datepickerShowing())switch(i.keyCode){case n.TAB:this._hide(this._ON_CLOSE_REASON_TAB);break;case n.ESCAPE:this._hide(this._ON_CLOSE_REASON_CANCELLED),r=!0;break;case n.UP:case n.DOWN:var a=this._dpDiv.find(".oj-datepicker-calendar")[0];e.FocusUtils.focusFirstTabStop(a)||a.focus(),r=!0}else switch(i.keyCode){case n.UP:case n.DOWN:this._SetValue(this._GetDisplayValue(),i),this.show(),r=!0}return r?(i.preventDefault(),i.stopPropagation(),!1):void 0}},_SetDisplayValue:function(e){if(this._isInLine||this._superApply(arguments),this._setCurrentDate(this._getDateIso()),this._datepickerShowing()){var t=!(this._isInLine&&this._timePicker&&this._timePicker[0]===document.activeElement);this._updateDatepicker(t)}},_GetConverter:function(){return this.options.converter?this._superApply(arguments):t.oj.ojInputDate.prototype.options.converter},_GetElementValue:function(){return this.options.value||""},_GetDefaultStyleClass:function(){return"oj-inputdate"},_GetImplicitValidators:function(){var i=this._superApply(arguments);return null==this.options.min&&null==this.options.max||(this._datePickerDefaultValidators[e.ValidatorFactory.VALIDATOR_TYPE_DATETIMERANGE]=this._getValidator("min")),null!=this.options.dayFormatter&&(this._datePickerDefaultValidators[e.ValidatorFactory.VALIDATOR_TYPE_DATERESTRICTION]=this._getValidator("dayFormatter")),t.extend(this._datePickerDefaultValidators,i)},_NotifyDetached:function(){this._hide(this._ON_CLOSE_REASON_CLOSE),this._superApply(arguments)},_NotifyHidden:function(){this._hide(this._ON_CLOSE_REASON_CLOSE),this._superApply(arguments)},_getValidator:function(i){var n=null;if("min"===i||"max"===i)n=_(this.options,this._GetConverter(),this._GetDefaultStyleClass());else if("dayFormatter"===i){var r={dayFormatter:this.options.dayFormatter,converter:this._GetConverter()};t.extend(r,this.options.translations.dateRestriction||{}),n=e.Validation.validatorFactory(e.ValidatorFactory.VALIDATOR_TYPE_DATERESTRICTION).createValidator(r)}return n},_getTodayDate:function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},_getDateIso:function(){var e=this.options.value||this._getDefaultIsoDate();return this._isDateTimeSwitcher()&&this._switcherDateValue&&(e=this._switcherDateValue),e},getNodeBySubId:function(e){var i=null,n=e&&e.subId,r=this._dpDiv,a=this._getDatepickerContent();if(n)switch(n){case"oj-datepicker-content":i=a[0];break;case"oj-inputdatetime-calendar-icon":i=t(".oj-inputdatetime-calendar-icon",this._triggerNode)[0];break;case"oj-datepicker-prev-icon":i=t(".oj-datepicker-prev-icon",r)[0];break;case"oj-datepicker-next-icon":i=t(".oj-datepicker-next-icon",r)[0];break;case"oj-datepicker-month":i=t(".oj-datepicker-month",r)[0];break;case"oj-datepicker-year":i=t(".oj-datepicker-year",r)[0];break;case"oj-datepicker-current":i=t(".oj-datepicker-current",r)[0];break;case"oj-inputdatetime-date-input":i=this._isInLine?null:this.element[0];break;default:i=null}return i||this._superApply(arguments)},getSubIdByNode:function(e){var i=this._dpDiv,n=null,r=[{selector:".oj-inputdatetime-calendar-icon",ele:this._triggerNode},{selector:".oj-datepicker-prev-icon",ele:i},{selector:".oj-datepicker-next-icon",ele:i},{selector:".oj-datepicker-month",ele:i},{selector:".oj-datepicker-year",ele:i},{selector:".oj-datepicker-current",ele:i}];if(e===i[0])return"oj-datepicker-content";if(!this._isInLine&&e===this.element[0])return"oj-inputdatetime-date-input";for(var a=0,o=r.length;a<o;a++){var s=r[a],l=t(s.selector,s.ele);if(1===l.length&&l[0]===e){n=s.selector.substr(1);break}}return n||this._superApply(arguments)},hide:function(){return this._hide(this._ON_CLOSE_REASON_CLOSE)},_hide:function(e){return g(this)||!this._datepickerShowing()||this._isInLine||(this._popUpDpDiv.ojPopup("close"),this._onClose(e)),this},_onClose:function(e){this._isMobile&&"focus"===this.options.datePicker.showOn?this._inputContainer.focus():("focus"===this.options.datePicker.showOn&&(this._ignoreShow=!0),this.element.focus())},refresh:function(){return this._triggerNode&&this._triggerNode.find("."+this._TRIGGER_CALENDAR_CLASS).attr("title",this._GetCalendarTitle()),this._superApply(arguments)||this},show:function(){if(!(this._datepickerShowing()||this.options.disabled||this.options.readOnly)){if(!this._ignoreShow){if(g(this)){this.element.blur();var e={};return e.date=u(this._getNativeDatePickerConverter(),this._getDateIso()),e.mode="date",this._ShowNativeDatePicker(e)}return this._ShowHTMLDatePicker()}this._ignoreShow=!1}},_getNativeDatePickerConverter:function(){if(null===this._nativePickerConverter){var i=this._GetConverter().resolvedOptions(),n={};t.extend(n,i,{isoStrFormat:"offset"}),this._nativePickerConverter=e.Validation.converterFactory(e.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter(n)}return this._nativePickerConverter},_ShowNativeDatePicker:function(i){var n=this._getMinMaxDateIso("min"),r=this._getMinMaxDateIso("max"),a=this._getNativeDatePickerConverter();n&&(i.minDate=u(a,n).valueOf()),r&&(i.maxDate=u(a,n).valueOf());var o=this;o._nativePickerShowing=!0,window.datePicker.show(i,t.proxy(this._OnDatePicked,this),function(t){o._nativePickerShowing=!1,t.startsWith("cancel")?o._onClose(o._ON_CLOSE_REASON_CANCELLED):e.Logger.log("Error: native date or time picker failed: "+t)})},_OnDatePicked:function(t){if(this._nativePickerShowing=!1,t){var i=e.IntlConverterUtils._dateTime(this._getDateIso(),{month:t.getMonth(),date:t.getDate(),fullYear:t.getFullYear()}),n=this._GetConverter().format(i);this._SetValue(n,{})}this._onClose(this._ON_CLOSE_REASON_SELECTION)},_ShowHTMLDatePicker:function(){var t=this._IsRTL();if(this._switcherPrevValue=this._getDateIso(),this._switcherPrevDay=this._currentDay,this._switcherPrevMonth=this._currentMonth,this._switcherPrevYear=this._currentYear,this._getDatepickerContent().empty(),this._updateDatepicker(),h){var i=e.PositionUtils.normalizeHorizontalAlignment({my:"start top",at:"start bottom",of:this.element,collision:"flipfit flipfit"},t);this._popUpDpDiv.ojPopup("open",this.element.parent(),i)}else this._popUpDpDiv.ojPopup("open",this.element.parent(),{my:{horizontal:"center",vertical:"bottom"},at:{horizontal:"center",vertical:"bottom"},of:window,collision:"flipfit flipfit"}),this._dpDiv.find(".oj-datepicker-calendar").focus();return this}}),e.Components.setDefaultOptions({ojInputDate:{firstDayOfWeek:e.Components.createDynamicPropertyGetter(function(){return e.LocaleData.getFirstDayOfWeek()}),dayWide:e.Components.createDynamicPropertyGetter(function(){return e.LocaleData.getDayNames("wide")}),dayNarrow:e.Components.createDynamicPropertyGetter(function(){return e.LocaleData.getDayNames("narrow")}),monthWide:e.Components.createDynamicPropertyGetter(function(){return e.LocaleData.getMonthNames("wide")}),monthAbbreviated:e.Components.createDynamicPropertyGetter(function(){return e.LocaleData.getMonthNames("abbreviated")}),datePicker:e.Components.createDynamicPropertyGetter(function(){return(e.ThemeUtils.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).datePicker}),renderMode:e.Components.createDynamicPropertyGetter(function(){return(e.ThemeUtils.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).renderMode}),keyboardEdit:e.Components.createDynamicPropertyGetter(function(){return(e.ThemeUtils.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).keyboardEdit})}}),e.__registerWidget("oj.ojInputTime",t.oj.inputBase,{widgetEventPrefix:"oj",_CLASS_NAMES:"oj-inputdatetime-input",_WIDGET_CLASS_NAMES:"oj-inputdatetime-time-only oj-component oj-inputdatetime",_INPUT_CONTAINER_CLASS:"oj-inputdatetime-input-container",_ELEMENT_TRIGGER_WRAPPER_CLASS_NAMES:"",_INPUT_HELPER_KEY:"inputHelp",_ATTR_CHECK:[{attr:"type",setMandatory:"text"}],_GET_INIT_OPTIONS_PROPS_FOR_WIDGET:[{attribute:"disabled",validateOption:!0},{attribute:"pattern"},{attribute:"title"},{attribute:"placeholder"},{attribute:"value",coerceDomValue:p},{attribute:"required",coerceDomValue:!0,validateOption:!0},{attribute:"readonly",option:"readOnly",validateOption:!0},{attribute:"min",coerceDomValue:p},{attribute:"max",coerceDomValue:p}],_TIME_PICKER_ID:"ojInputTime",_TRIGGER_CLASS:"oj-inputdatetime-input-trigger",_TRIGGER_TIME_CLASS:"oj-inputdatetime-time-icon",_ON_CLOSE_REASON_SELECTION:"selection",_ON_CLOSE_REASON_CANCELLED:"cancelled",_ON_CLOSE_REASON_TAB:"tab",_ON_CLOSE_REASON_CLOSE:"close",_KEYBOARD_EDIT_OPTION_ENABLED:"enabled",_KEYBOARD_EDIT_OPTION_DISABLED:"disabled",options:{converter:e.Validation.converterFactory(e.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter({hour:"2-digit",minute:"2-digit"}),keyboardEdit:"enabled",max:void 0,min:void 0,datePickerComp:null,pickerAttributes:null,renderMode:"jet",timePicker:{footerLayout:"",timeIncrement:"00:05:00:00",showOn:"focus"}},_InitOptions:function(t,i){this._super(t,i),null!==this.options.datePickerComp||this._IsCustomElement()||e.EditableValueUtils.initializeOptionsFromDom(this._GET_INIT_OPTIONS_PROPS_FOR_WIDGET,i,this)},_getPrependNode:function(){return this._isIndependentInput()?t("body"):t(".oj-popup-content",this._datePickerComp.widget._popUpDpDiv.ojPopup("widget"))},_InitBase:function(){this._timePickerDefaultValidators={},this._datePickerComp=this.options.datePickerComp,this._inputContainer=null,this._redirectFocusToInputContainer=!1,this._isMobile=!1,this._ignoreShow=!1,this._nativePickerShowing=!1;var i=this.options.pickerAttributes;if(this._wheelPicker=t('<div class="oj-timepicker-popup" style="display:none"><div id="'+this._GetSubId(this._TIME_PICKER_ID)+'" class="oj-timepicker-content"></div></div>'),this._getPrependNode().prepend(this._wheelPicker),this._isIndependentInput()){this._popUpWheelPicker=this._wheelPicker.ojPopup({initialFocus:"none",role:"dialog",chrome:"default",modality:h?"modeless":"modal",open:function(){},beforeClose:function(){},animateStart:function(t,i){"open"===i.action&&(t.preventDefault(),e.AnimationUtils.slideIn(i.element,{offsetY:i.element.offsetHeight+"px"}).then(i.endCallback))},animation:{open:null,close:null}}).attr("data-oj-internal",""),this.element.attr("data-oj-popup-"+this._popUpWheelPicker.attr("id")+"-parent",""),i&&e.EditableValueUtils.setPickerAttributes(this._popUpWheelPicker.ojPopup("widget"),i)}this._isIndependentInput()&&(this._ELEMENT_TRIGGER_WRAPPER_CLASS_NAMES+=this._INPUT_CONTAINER_CLASS)},_timepickerShowing:function(){if(this._isIndependentInput()){var t=this._popUpWheelPicker;return e.Components.isComponentInitialized(t,"ojPopup")&&t.ojPopup("isOpen")||this._nativePickerShowing}var i=this._datePickerComp.widget;t=i._popUpDpDiv;return i._isShowingDatePickerSwitcher()&&e.Components.isComponentInitialized(t,"ojPopup")&&t.ojPopup("isOpen")||this._nativePickerShowing},_ComponentCreate:function(){this._InitBase();var e=this._superApply(arguments);if(this._isContainedInDateTimePicker()&&!this._isDatePickerInline())this._CLASS_NAMES="";else{if(this.options.value){var t=this._GetConverter().format(this.options.value);this._SetValue(t,{})}v(this)}return this._processReadOnlyKeyboardEdit(),this._isIndependentInput()&&this._attachTrigger(),e},_AfterCreate:function(){var t=this._superApply(arguments);if(this._isIndependentInput())if(m(this._triggerNode.children(),this.options.disabled),this._IsCustomElement()){if(this._inputContainer){var i=this.uuid+"_Label";(r=e.EditableValueUtils.getOjLabelId(this.widget(),i))&&this._inputContainer.attr("aria-labelledby",r)}}else{var n=this.$label;if(this._inputContainer&&n&&1===n.length){var r=n.attr("id");this._inputContainer.attr("aria-labelledby",r)}}return t},_setOption:function(t,i,n){var r,a=null;if("value"===t)return i||(i=null),a=this._super(t,i,n),this._createWheelPickerDom(!0),a;"timePicker"===t&&void 0===i.footerLayout&&(r=this.options.timePicker.footerLayout),a=this._superApply(arguments),r&&(this.options.timePicker.footerLayout=r),"disabled"===t&&this._isIndependentInput()?(i&&this._hide(this._ON_CLOSE_REASON_CLOSE),this._triggerNode.find("."+this._TRIGGER_TIME_CLASS).attr("title",this._getTimeTitle()),m(this._triggerNode.children(),i)):"max"!==t&&"min"!==t||this._isContainedInDateTimePicker()?"readOnly"===t?(this._processReadOnlyKeyboardEdit(),i&&this._hide(this._ON_CLOSE_REASON_CLOSE),this._AfterSetOptionDisabledReadOnly("readOnly",e.EditableValueUtils.readOnlyOptionOptions)):"keyboardEdit"===t&&this._processReadOnlyKeyboardEdit():(this._timePickerDefaultValidators[e.ValidatorFactory.VALIDATOR_TYPE_DATETIMERANGE]=_(this.options,this._GetConverter(),this._GetDefaultStyleClass()),this._AfterSetOptionValidators());return t in{max:!0,min:!0,converter:!0,timePicker:!0}&&this._createWheelPickerDom(),a},_destroy:function(){return this._cleanUpTimeResources(),this._super()},_clearWheelModels:function(){var e=this._timePickerModel;if(e){var t=e.getWheelModel("hour");t&&(t.wheel=void 0),(t=e.getWheelModel("minute"))&&(t.wheel=void 0),(t=e.getWheelModel("ampm"))&&(t.wheel=void 0)}},_destroyHammer:function(){if(this._wheelGroup&&this._wheelGroup.length)for(var e=this._wheelGroup[0].children,t=0;t<e.length;t++)e[t].ojDestroy()},_SetupResources:function(){return this._resizePopupBind=function(){t(".oj-timepicker-content",this._wheelPicker)[h?"removeClass":"addClass"]("oj-timepicker-fixedheight"),this._isIndependentInput()&&e.Components.isComponentInitialized(this._popUpWheelPicker,"ojPopup")&&this._popUpWheelPicker.ojPopup("option","modality",h?"modeless":"modal")}.bind(this),window.addEventListener("resize",this._resizePopupBind,!1),this._super()},_ReleaseResources:function(){return this._IsCustomElement()&&this._cleanUpListeners(),this._super()},_cleanUpTimeResources:function(){this._isIndependentInput()&&(this.element.off("focus touchstart"),this._wrapper.off("touchstart")),this._triggerNode&&this._triggerNode.remove(),this._cleanUpListeners(),this._destroyHammer(),this._wheelPicker&&(this._wheelPicker.remove(),this._clearWheelModels()),this._isIndependentInput()&&e.Components.isComponentInitialized(this._popUpWheelPicker,"ojPopup")&&this._popUpWheelPicker.ojPopup("destroy")},_cleanUpListeners:function(){this._resizePopupBind&&window.removeEventListener("resize",this._resizePopupBind),window.removeEventListener("resize",d)},_processReadOnlyKeyboardEdit:function(){if(this._isIndependentInput()){var e=this.options.readOnly||this._isKeyboardEditDisabled();this.element.prop("readOnly",!!e)}},_isKeyboardEditDisabled:function(){return this.options.keyboardEdit===this._KEYBOARD_EDIT_OPTION_DISABLED},_AppendInputHelper:function(){this._isIndependentInput()&&this._superApply(arguments)},_onKeyDownHandler:function(e){if(this._isIndependentInput()){this._superApply(arguments);var i=t.ui.keyCode,n=!1;if(this._timepickerShowing())switch(e.keyCode){case i.TAB:this._hide(this._ON_CLOSE_REASON_TAB);break;case i.ESCAPE:this._hide(this._ON_CLOSE_REASON_CANCELLED),n=!0;break;case i.UP:case i.DOWN:this._wheelGroup.children().first().focus(),n=!0}else switch(e.keyCode){case i.UP:case i.DOWN:this._SetValue(this._GetDisplayValue(),e),this.show(),n=!0}if(n||e.keyCode===i.ENTER)return e.preventDefault(),e.stopPropagation(),!1}},_getTimeTitle:function(){return this._EscapeXSS(this.getTranslatedString("tooltipTime"+(this.options.disabled?"Disabled":"")))},_WrapElement:function(){this._inputContainer=this._superApply(arguments),this._inputContainer.attr({role:"combobox","aria-haspopup":"true",tabindex:"-1"})},_onElementFocus:function(){var e=this.options.timePicker.showOn;this._redirectFocusToInputContainer?(this._redirectFocusToInputContainer=!1,g(this)?this._inputContainer.focus():this._wheelGroup.children().first().focus()):"focus"===e?this.show():this._timepickerShowing()&&this._hide(this._ON_CLOSE_REASON_CLOSE)},_OnElementTouchStart:function(){if("focus"===this.options.timePicker.showOn)if(this._timepickerShowing())this._ignoreShow=!0,this._hide(this._ON_CLOSE_REASON_CLOSE);else{var e=this.element[0]===document.activeElement;this.show(),this._redirectFocusToInputContainer=!0,g(this)&&e&&this._inputContainer.focus()}},_attachTrigger:function(){var e=this.options.timePicker.showOn,i=t("<span>").addClass(this._TRIGGER_CLASS),n=t("<span title='"+this._getTimeTitle()+"'/>").addClass(this._TRIGGER_TIME_CLASS+" oj-clickable-icon-nocontext oj-component-icon"),r=this;this.element.on("focus",t.proxy(this._onElementFocus,this)),this.element.on("touchstart",t.proxy(this._OnElementTouchStart,this)),this._wrapper.on("touchstart",function(e){r._isMobile=!0}),"image"===e&&(n.css("display","block"),this._IsRTL()?(this.element.css("border-top-left-radius",0),this.element.css("border-bottom-left-radius",0)):(this.element.css("border-top-right-radius",0),this.element.css("border-bottom-right-radius",0))),g(this)||(i.append(n),n.on("click",function(){r._timepickerShowing()?r._hide(r._ON_CLOSE_REASON_CLOSE):(r.show(),r._wheelGroup.children().first().focus())}),this._AddHoverable(n),this._AddActiveable(n),this._triggerIcon=n),this._triggerNode=i,this.element.after(i)},_getValue:function(){return this._isContainedInDateTimePicker()?this._datePickerComp.widget.getValueForInputTime():this.options.value},_onBlurHandler:function(e){this._isIndependentInput()&&this._superApply(arguments)},show:function(){if(!(this._timepickerShowing()||this.options.disabled||this.options.readOnly)){if(!this._ignoreShow)return g(this)?(this.element.blur(),this._showNativeTimePicker()):this._showWheelPicker();this._ignoreShow=!1}},_showNativeTimePicker:function(){var t={},i=D(this._GetConverter(),{isoStrFormat:"offset"}),n=u(i,this._getIsoDateValue(i));t.date=n,t.mode="time";var r=k(this.options.timePicker.timeIncrement);t.minuteInterval=0===r.hourIncr?r.minuteIncr:1;var a=this._isContainedInDateTimePicker()?this._datePickerComp.widget.options.min:this.options.min,o=this._isContainedInDateTimePicker()?this._datePickerComp.widget.options.max:this.options.max;if(a){var s=u(i,e.IntlConverterUtils._minMaxIsoString(a,this._getIsoDateValue(i)));t.minDate=s.valueOf()}if(o){var l=u(i,e.IntlConverterUtils._minMaxIsoString(o,this._getIsoDateValue(i)));t.maxDate=l.valueOf()}var c=this;this._nativePickerShowing=!0,window.datePicker.show(t,function(t){if(c._nativePickerShowing=!1,t){var i=D(c._GetConverter(),{isoStrFormat:"offset"}),n=e.IntlConverterUtils._dateTime(c._getIsoDateValue(i),{hours:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds()}),r=c._GetConverter().format(n);c._SetValue(r,{})}c._onClose(c._ON_CLOSE_REASON_SELECTION)},function(t){c._nativePickerShowing=!1,t.startsWith("cancel")?c._onClose(c._ON_CLOSE_REASON_CANCELLED):e.Logger.log("Error: native time picker failed: "+t)})},hide:function(){return this._hide(this._ON_CLOSE_REASON_CLOSE)},_hide:function(e){return!g(this)&&this._timepickerShowing()&&(this._popUpWheelPicker.ojPopup("close"),this._onClose(e)),this},_onClose:function(e){this._isMobile&&"focus"===this.options.timePicker.showOn?(this._isIndependentInput()?this._inputContainer:this._datePickerComp.widget._inputContainer).focus():("focus"===this.options.timePicker.showOn&&(this._isIndependentInput()?this._ignoreShow=!0:this._datePickerComp.widget._ignoreShow=!0),this.element.focus())},refresh:function(){return this._triggerNode&&this._triggerNode.find("."+this._TRIGGER_TIME_CLASS).attr("title",this._getTimeTitle()),this._superApply(arguments)||this},_SetDisplayValue:function(e){this._isIndependentInput()&&this._superApply(arguments),this._timepickerShowing()&&this._createWheelPickerDom(!0)},_SetValue:function(t,i,n){var r=!1;if(this._isContainedInDateTimePicker())try{var a,o=this._datePickerComp.widget,s=(a=i&&i.target&&i.target===this.element[0]&&!this._isDatePickerInline()?o._GetConverter():this._GetConverter()).parse(t),l=e.IntlConverterUtils,c=o.getValueForInputTime()||l.dateToLocalIso(new Date);if(s&&0===a.compareISODates(c,s))return!1;var h=l._copyTimeOver(s||l.dateToLocalIso(new Date),c);o.timeSelected(h,i),this._isDatePickerInline()&&(r=this._super(t,null,n))}catch(e){r=this._super(t,null,n)}else r=this._superApply(arguments);return r},_DoWrapElement:function(){return this._isIndependentInput()},_isIndependentInput:function(){return!this._isContainedInDateTimePicker()||this._isDatePickerInline()},_GetDefaultStyleClass:function(){return"oj-inputtime"},_GetElementValue:function(){return this.options.value||""},_GetImplicitValidators:function(){var i=this._superApply(arguments);return null==this.options.min&&null==this.options.max||this._isContainedInDateTimePicker()||(this._timePickerDefaultValidators[e.ValidatorFactory.VALIDATOR_TYPE_DATETIMERANGE]=_(this.options,this._GetConverter(),this._GetDefaultStyleClass())),t.extend(this._timePickerDefaultValidators,i)},_GetConverter:function(){return this.options.converter?this._superApply(arguments):t.oj.ojInputTime.prototype.options.converter},_isContainedInDateTimePicker:function(){return null!==this._datePickerComp},_isDatePickerInline:function(){return this._datePickerComp.inline},_NotifyDetached:function(){this._hide(this._ON_CLOSE_REASON_CLOSE),this._superApply(arguments)},_NotifyHidden:function(){this._hide(this._ON_CLOSE_REASON_CLOSE),this._superApply(arguments)},_generateHeader:function(){this._IsRTL();var e=this._EscapeXSS(this.getTranslatedString("cancelText")),t="<a role='button' onclick='return false;' href='#' class='oj-enabled oj-default oj-timepicker-cancel-button' aria-label='"+e+"'>"+e+"</a>",i=this._EscapeXSS(this.getTranslatedString("okText")),n="<a role='button' onclick='return false;' href='#' class='oj-enabled oj-default oj-timepicker-ok-button' aria-label='"+i+"'>"+i+"</a>",r="<div class='oj-timepicker-header"+(this.options.disabled?" oj-disabled ":" oj-enabled oj-default ")+"'>";return r+=t,r+=n,r+="</div>"},_generateFooter:function(e,t){var i="",n="<a role='button' onclick='return false;' href='#' class='oj-timepicker-now oj-priority-secondary oj-enabled'>"+this._EscapeXSS(this.getTranslatedString("currentTimeText"))+"</a>";if(e&&e.length>1){var r=0,a=[{index:e.indexOf("now"),content:t?n:""}];for(a.sort(function(e,t){return e.index-t.index});r<a.length&&a[r].index<0;)r++;for(;r<a.length;)i+=a[r++].content;i.length>0&&(i="<div class='oj-timepicker-footer'>"+i+"</div>")}return i},_getIsoDateLimit:function(t,i,n){var r=this._isContainedInDateTimePicker()?this._datePickerComp.widget.options[i]:this.options[i],a=(r=(r=r?e.IntlConverterUtils._minMaxIsoString(r,this._getValue()):r)?t.parse(r):r)?e.IntlConverterUtils._clearTime(r):null;return n&&a&&n.substring(0,n.indexOf("T"))!==a.substring(0,a.indexOf("T"))&&(r=null),r},_getIsoDateValue:function(t){var i=this._getValue();return i||((i=new Date).setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i=e.IntlConverterUtils.dateToLocalIso(i)),i=t.parse(i)},_getAmPmStrings:function(){var t=e.Validation.converterFactory(e.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter({pattern:"a"});return[t.format("2016-01-01T01:00:00Z"),t.format("2016-01-01T13:00:00Z")]},_getWheelPickerContent:function(e){return e?t(e.find(".oj-timepicker-content")[0]):null},_createWheelPickerDom:function(i){i||this._detachWheelHandler();var n=this._wheelPicker,r=this._getWheelPickerContent(n);this._destroyHammer(),i?t(".oj-timepicker-wheel-group",r).remove():r.empty();var a=this._GetConverter(),o=t.extend({},a.resolvedOptions());"zulu"===o.isoStrFormat&&(o.isoStrFormat="offset",o=(a=e.Validation.converterFactory(e.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter(o)).resolvedOptions());var s=e.IntlConverterUtils,l=this._getValue(),c=new Date;l||(l=e.IntlConverterUtils.dateToLocalIso(c)),l=a.parse(l);var h=s._clearTime(l),d=this._getIsoDateLimit(a,"min",h),u=this._getIsoDateLimit(a,"max",h),p=this.options.timePicker.footerLayout,_=this._timePickerModel=new function(e){var t,i,n,r=/^.*T(\d{2})(?::?(\d{2}).*$)/,a=720,o={h:function(e){return 0===e?"12":""+e},hh:function(e){return 0===e?"12":(e="0"+e).slice(-2)},H:function(e){return""+e},HH:j,k:function(e){return 0===e?"24":""+e},kk:function(e){return 0===e?"24":(e="0"+e).slice(-2)},K:function(e){return""+e},KK:function(e){return(e="0"+e).slice(-2)},mm:I},s={h:P,hh:P,H:T,HH:T,k:O,kk:O,K:T,KK:T,mm:T},l=0,c=0,h=0,d=1440,u=1440,p="auto",_="",m=["AM","PM"],f=new w(this,{valueRange:60,displayRange:60,valueMultiplier:1,displayMultiplier:1}),v=new w(this,{valueMultiplier:60,displayMultiplier:1}),g=new w(this,{valueRange:2,displayRange:2,formatter:function(e){return m[e]},parser:function(e){return"a"===(e=e.toLowerCase().charAt())?0:"p"===e?1:-1},valueMultiplier:a,displayMultiplier:1}),y=[f,v,g],k=!1,D=this;function E(e){try{if(k=!0,e)for(var t in e)D[t]=e[t]}finally{k=!1,b()}}function b(){if(!k){if(h=Math.ceil(c/t)*t,(u=Math.ceil((d-1)/t)*t)<h)throw new Error("Invalid min and max settings with current increment: "+c+" "+d+ +t);if(l<h&&(l=h),l>u&&(l=u),l=Math.round(l/t)*t,n){v.displayRange=12;var e=p;if("auto"===e){var i=A(t,60);i===t||60===i?e="hoursMeridiem":(i=A(t,a),e="all")}switch(e){case"all":f.displayMultiplier=1,f.valueMultiplier=1,f.valueRange=1440,f.linked=!0,v.displayMultiplier=60,v.valueMultiplier=1,v.valueRange=1440,v.linked=!0,g.displayMultiplier=1,g.valueMultiplier=720,g.valueRange=2,g.linked=!0;break;case"hoursMeridiem":f.displayMultiplier=1,f.valueMultiplier=1,f.valueRange=60,f.linked=!1,v.displayMultiplier=1,v.valueMultiplier=60,v.valueRange=24,v.linked=!0,g.displayMultiplier=1,g.valueMultiplier=720,g.valueRange=2,g.linked=!0}}else{v.displayRange=24;var e=p;if("auto"===e){var i=A(t,60);e=i===t||60===i?"none":"all"}switch(e){case"none":case"hoursMeridiem":f.displayMultiplier=1,f.valueMultiplier=1,f.valueRange=60,f.linked=!1,v.displayMultiplier=1,v.valueMultiplier=60,v.valueRange=24,v.linked=!1;break;case"all":case"hoursMinutes":f.displayMultiplier=1,f.valueMultiplier=1,f.valueRange=1440,f.linked=!0,v.displayMultiplier=60,v.valueMultiplier=1,v.valueRange=1440,v.linked=!0}}for(var r=0;r<y.length;r++)y[r].refresh()}}function C(e){var t=r.exec(e),i=parseInt(t[1],10),n=parseInt(t[2],10);return 60*i+n}function S(e){e=Math.floor(e);var t=Math.floor(e/60);return e%=60,"T"+j(t)+":"+I(e)}function j(e){return(e="0"+e).slice(-2)}function I(e){return(e="0"+e).slice(-2)}function T(e){return e.match(/^\d+$/)?parseInt(e,10):-1}function P(e){if(e.match(/^\d+$/)){var t=parseInt(e,10);return 0===t&&(t=-1),24===t&&(t=0),t}return-1}function O(e){if(e.match(/^\d+$/)){var t=parseInt(e,10);return 0===t&&(t=-1),24===t&&(t=0),t}return-1}function A(e,t){return 0===t?e:A(t,e%t)}k=!0,Object.defineProperty(D,"increment",{enumerable:!0,get:function(){return t},set:function(e){t=Math.floor(e),b()}}),D.increment=1,Object.defineProperty(D,"grouped",{enumerable:!0,get:function(){return p},set:function(e){switch(e){case"auto":case"all":case"none":case"hoursMinutes":case"hoursMeridiem":p=e;break;default:throw new Error("invalid grouped value: "+e)}b()}}),Object.defineProperty(D,"min",{enumerable:!0,get:function(){return c},set:function(e){c=Math.floor(e),b()}}),Object.defineProperty(D,"isoMin",{enumerable:!0,get:function(){return S(c)},set:function(e){var t=C(e);isNaN(t)?console.log("Invalid ISO min time: "+e):D.min=t}}),Object.defineProperty(D,"max",{enumerable:!0,get:function(){return d-1},set:function(e){d=Math.floor(e)+1,b()}}),Object.defineProperty(D,"isoMax",{enumerable:!0,get:function(){return S(d)},set:function(e){var t=C(e);isNaN(t)?console.log("Invalid ISO max time: "+e):D.max=t}}),Object.defineProperty(D,"value",{enumerable:!0,get:function(){return l},set:function(e){l=Math.floor(e),b()}}),Object.defineProperty(D,"isoValue",{enumerable:!0,get:function(){return S(l)},set:function(e){var t=C(e);isNaN(t)?console.log("Invalid ISO value time: "+e):D.value=t}}),Object.defineProperty(D,"format",{enumerable:!0,get:function(){return i},set:function(e){i=e;var t=(e=e.replace(/\'[^']*\'/g,"").replace(/[^hHkKma]*/g,"")).match(/([hHkK]+)/),r=t[1];v.formatter=o[r],v.parser=s[r];var a=(t=e.match(/(m+)/))[1];f.formatter=o[a],f.parser=s[a],n=_.indexOf("a")>=0,b()}}),Object.defineProperty(D,"wheelOrder",{enumerable:!0,get:function(){return _},set:function(e){_=e}}),Object.defineProperty(D,"ampmStrings",{enumerable:!0,get:function(){return m},set:function(e){m=e}}),k=!1,D.setProperties=E,E(e),D.getWheelModel=function(e){switch(e){case"hour":return v;case"minute":return f;case"ampm":return n?g:null}}}(null),m=["","","",""],f=a._getTimePositioning();for(var v in f)m[f[v]]=v;_.wheelOrder=m.filter(function(e){return!!e}).join("");var g=o.pattern||o.patternFromOptions;g&&(_.format=g),_.ampmStrings=this._getAmPmStrings();var y=this.options.timePicker.timeIncrement;if(y){var D=k(y);_.increment=60*D.hourIncr+D.minuteIncr}_.isoValue=this._getIsoDateValue(a),d&&(_.isoMin=d),u&&(_.isoMax=u),!this._isIndependentInput()||i&&0!==t(".oj-timepicker-header",r).length||r.append(t(this._generateHeader(n))),this._wheelGroup=t(function(e){var i,n=37,r=39,a=[];return(i=document.createElement("div")).classList.add("oj-timepicker-wheel-group"),i.ojRefresh=c,i.addEventListener("keydown",o,!1),c(),i;function o(e){var i=e.target,a=e.keyCode;switch(a){case n:t(i).prev().focus();break;case r:t(i).next().focus()}}function s(e){var t=e.target;if(t.ojLinked())for(var i=0;i<a.length;i++)a[i].ojLinked()&&a[i].classList.add("oj-active");else t.classList.add("oj-active")}function l(){for(var e=0;e<a.length;e++)a[e].classList.remove("oj-active")}function c(){for(var t;t=i.firstChild;)t.ojDestroy(),i.removeChild(t);a=[],function(){var t,n,r=e.wheelOrder,o=E(e.getWheelModel("hour"),!0,"oj-timepicker-hour"),c=E(e.getWheelModel("minute"),!0,"oj-timepicker-minute");r.indexOf("a")>=0&&(t=e.getWheelModel("ampm"),n=E(t,!1,"oj-timepicker-meridian"));var h,d=r.split("");for(h=0;h<d.length;h++)switch(d[h]){case"h":a.push(o);break;case"m":a.push(c);break;case"a":a.push(n);break;default:console.log("Unknown wheelOrder code: "+d[h])}for(h=0;h<a.length;h++){var u=a[h];u.addEventListener("focus",s,!1),u.addEventListener("blur",l,!1),i.appendChild(u)}}()}}(_)),this._isIndependentInput()?this._wheelGroup.insertAfter(t(".oj-timepicker-header",r)):r.append(this._wheelGroup),i&&0!==t(".oj-timepicker-footer",r).length||r.append(t(this._generateFooter(p,c))),r.find(".oj-timepicker-hour").attr("aria-label",this.getTranslatedString("hourWheelLabel")),r.find(".oj-timepicker-minute").attr("aria-label",this.getTranslatedString("minuteWheelLabel")),r.find(".oj-timepicker-meridian").attr("aria-label",this.getTranslatedString("ampmWheelLabel")),i||this._attachWheelHandler()},_detachWheelHandler:function(){this._wheelPicker.find(".oj-timepicker-now").off("click"),this._isIndependentInput()?(this._wheelPicker.find(".oj-timepicker-cancel-button").off("click"),this._wheelPicker.find(".oj-timepicker-ok-button").off("click"),this._wheelPicker.off("keydown")):this._wheelPicker.find(".oj-timepicker-wheel").off("blur")},_attachWheelHandler:function(){var i=this;if(this._wheelPicker.find(".oj-timepicker-now").on("click",function(t){var n=e.IntlConverterUtils.dateToLocalIso(new Date);n=i._GetConverter().parse(n),i._timePickerModel.isoValue=n,i._isIndependentInput()||i._SetValue(i._timePickerModel.isoValue,t),t.preventDefault()}),!this._isIndependentInput())return this._wheelPicker.find(".oj-timepicker-wheel").on("blur",function(e){i._SetValue(i._timePickerModel.isoValue,e)}),this._datePickerComp.widget._togglePicker(),void this._wheelGroup.children().first().focus();this._wheelPicker.find(".oj-timepicker-cancel-button").on("click",function(e){e.preventDefault(),i._hide(i._ON_CLOSE_REASON_CANCELLED)}),this._wheelPicker.find(".oj-timepicker-ok-button").on("click",function(e){i._hide(i._ON_CLOSE_REASON_SELECTION),i._SetValue(i._timePickerModel.isoValue,e),e.preventDefault()}),this._wheelPicker.on("keydown",function(e){e.keyCode==t.ui.keyCode.ESCAPE&&(e.preventDefault(),i._hide(i._ON_CLOSE_REASON_CANCELLED))})},_showWheelPicker:function(){this._createWheelPickerDom();var t=this._popUpWheelPicker;if(t)if(h){var i=e.PositionUtils.normalizeHorizontalAlignment({my:"start top",at:"start bottom",of:this.element,collision:"flipfit flipfit"},this._IsRTL());t.ojPopup("open",this.element.parent(),i)}else t.ojPopup("open",this.element.parent(),{my:{horizontal:"center",vertical:"bottom"},at:{horizontal:"center",vertical:"bottom"},of:window,collision:"flipfit flipfit"}),this._wheelGroup.children().first().focus()},getNodeBySubId:function(e){var i=null,n=e&&e.subId,r=this._wheelPicker,a=this._getWheelPickerContent(r);if(n)switch(n){case"oj-inputdatetime-time-icon":i=t(".oj-inputdatetime-time-icon",this._triggerNode)[0];break;case"oj-inputdatetime-time-input":i=this.element[0];break;case"oj-timepicker-content":i=a?a[0]:null;break;case"oj-timepicker-cancel-button":i=t(".oj-timepicker-cancel-button",r)[0];break;case"oj-timepicker-ok-button":i=t(".oj-timepicker-ok-button",r)[0];break;case"oj-timepicker-hour":i=t(".oj-timepicker-hour",r)[0];break;case"oj-timepicker-minute":i=t(".oj-timepicker-minute",r)[0];break;case"oj-timepicker-meridian":i=t(".oj-timepicker-meridian",r)[0];break;case"oj-timepicker-now":i=t(".oj-timepicker-now",r)[0];break;default:i=null}return i||this._superApply(arguments)},getSubIdByNode:function(e){var i=t(".oj-inputdatetime-time-icon",this._triggerNode),n=null,r=this._wheelPicker,a=this._getWheelPickerContent(r),o=[{selector:".oj-timepicker-cancel-button",ele:r},{selector:".oj-timepicker-ok-button",ele:r},{selector:".oj-timepicker-hour",ele:r},{selector:".oj-timepicker-minute",ele:r},{selector:".oj-timepicker-meridian",ele:r},{selector:".oj-timepicker-now",ele:r}];if(e===i[0])n="oj-inputdatetime-time-icon";else if(e===this.element[0])n="oj-inputdatetime-time-input";else if(a&&e===a[0])n="oj-timepicker-content";else for(var s=0;s<o.length;s++){var l=o[s],c=t(l.selector,l.ele);if(1===c.length&&c[0]===e){n=l.selector.substr(1);break}}return n||this._superApply(arguments)},widget:function(){return this._isIndependentInput()?this._super():this._datePickerComp.widget.widget()}}),e.Components.setDefaultOptions({ojInputTime:{renderMode:e.Components.createDynamicPropertyGetter(function(){return(e.ThemeUtils.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).renderMode}),keyboardEdit:e.Components.createDynamicPropertyGetter(function(){return(e.ThemeUtils.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).keyboardEdit}),timePicker:e.Components.createDynamicPropertyGetter(function(){return(e.ThemeUtils.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).timePicker})}}),E.counter=0;var C=t.oj.ojInputDate.prototype.options.converter,S=t.oj.ojInputTime.prototype.options.converter;e.__registerWidget("oj.ojInputDateTime",t.oj.ojInputDate,{widgetEventPrefix:"oj",_WIDGET_CLASS_NAMES:"oj-inputdatetime-date-time oj-component oj-inputdatetime",_INPUT_HELPER_KEY:"inputHelpBoth",_TRIGGER_CALENDAR_CLASS:"oj-inputdatetime-calendar-clock-icon",options:{converter:e.Validation.converterFactory(e.ConverterFactory.CONVERTER_TYPE_DATETIME).createConverter({day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}),renderMode:"jet",timePicker:{timeIncrement:"00:05:00:00",showOn:"focus"}},_InitBase:function(){if(this._super(),this._timePickerElement=this.element,this._timePicker=null,this._timeConverter=null,this._previousValue=null,this._switcherDiv=null,this._switcherPrevValue=null,this._switcherPrevDay=null,this._switcherPrevMonth=null,this._switcherPrevYear=null,this._switcherDateValue=null,this._switcherTimeValue=null,this._dateTimeSwitcherActive=null,!this._isInLine){this._switcherDiv=t(this._generateSwitcher()),t(".oj-popup-content",this._popUpDpDiv.ojPopup("widget")).append(this._switcherDiv);var i=this;this._popUpDpDiv.on("ojclose",function(e,t){null===i._switcherDateValue&&null===i._switcherTimeValue||(i._currentDay=i._switcherPrevDay,i._drawMonth=i._currentMonth=i._switcherPrevMonth,i._drawYear=i._currentYear=i._switcherPrevYear,i._SetValue(i._switcherPrevValue),i._switcherTimeValue=i._switcherDateValue=i._switcherPrevDay=i._switcherPrevMonth=i._switcherPrevYear=i._switcherPrevValue=null)}),this._switcherDiv.find("[data-handler]").map(function(){var n={switchMe:function(e){var n=e.keyCode;if("keydown"===e.type&&(t.ui.keyCode.ENTER===n||t.ui.keyCode.SPACE===n)||"click"===e.type)return i._isShowingDatePickerSwitcher()?(i.show(),i._placeFocusOnCalendar()):i._timePicker.ojInputTime("show"),!1},switchDone:function(n){var r=n.keyCode;if("keydown"===n.type&&(t.ui.keyCode.ENTER===r||t.ui.keyCode.SPACE===r)||"click"===n.type){var a=i._getDateIso();i._switcherDateValue&&(a=i._switcherDateValue),i._switcherTimeValue&&(a=e.IntlConverterUtils._copyTimeOver(i._switcherTimeValue,a));var o=i._GetConverter().format(a);return i._SetDisplayValue(o),i._SetValue(o,{}),i._switcherTimeValue=i._switcherDateValue=i._switcherPrevDay=i._switcherPrevMonth=i._switcherPrevYear=i._switcherPrevValue=null,i._hide(i._ON_CLOSE_REASON_SELECTION),!1}},switchCancel:function(e){var n=e.keyCode;if("keydown"===e.type&&(t.ui.keyCode.ENTER===n||t.ui.keyCode.SPACE===n)||"click"===e.type)return i._hide(i._ON_CLOSE_REASON_CANCELLED),!1}};t(this).bind(this.getAttribute("data-event"),n[this.getAttribute("data-handler")])})}},_ComponentCreate:function(){var e=this._super(),i=null;try{i=this._getTimePickerConverter(this._GetConverter())}finally{if(null===i)throw new Error("Please use ojInputDate if your converter doesn't specify a time format.")}if(this._isInLine){var n=t("<input type='text'>");n.insertAfter(this.element),this._timePickerElement=n}else{var r=this._switcherDiv.find("a");this._AddHoverable(r),this._AddActiveable(r)}for(var a=["title","placeholder","disabled","required","readOnly","keyboardEdit","pickerAttributes"],o={},s=0,l=a.length;s<l;s++)o[a[s]]=this.options[a[s]];var c=this.options.displayOptions.messages,h=this.options.timePicker;return this._isInLine||t.extend(h,{footerLayout:"now"}),this._timePicker=this._timePickerElement.ojInputTime(t.extend(o,{converter:i,displayOptions:{converterHint:"none",title:"none",messages:c},value:this.options.value,timePicker:h,datePickerComp:{widget:this,inline:this._isInLine}})),e},_AfterCreate:function(){var e=this._superApply(arguments);return this._dateTimeSwitcherActive=!g(this)&&this._timePicker&&!this._isInLine,e},_setOption:function(e,t,i){var n=this._superApply(arguments);if("value"===e&&(this._previousValue=this.options.value),this._timePicker){e in{disabled:!0,readOnly:!0,keyboardEdit:!0}?this._timePicker.ojInputTime("option",e,t):"timePicker"===e?this._timePicker.ojInputTime("option","timePicker.timeIncrement",t.timeIncrement):"converter"===e&&(this._timeConverter=null,this._timePicker.ojInputTime("option",e,this._getTimePickerConverter(this._GetConverter())))}return n},_destroy:function(){return this._cleanUpDateTimeResources(),this._super()},_cleanUpDateTimeResources:function(){if(this._timePicker.ojInputTime("destroy"),this._isInLine)this._timePickerElement.remove();else{var e=this._switcherDiv.find("a");this._RemoveActiveable(e),this._RemoveHoverable(e),this._switcherDiv&&this._switcherDiv.remove()}},_GetCalendarTitle:function(){return this._EscapeXSS(this.getTranslatedString("tooltipCalendarTime"+(this.options.disabled?"Disabled":"")))},_generateSwitcher:function(){return"<div class='oj-datetimepicker-switcher'><div data-handler='switchMe' data-event='click keydown'><div class='oj-inputdatetime-time-icon oj-clickable-icon-nocontext oj-component-icon oj-enabled oj-default'></div><a onclick='return false;' href='#' class='oj-enabled oj-datetimepicker-switcher-text' role='button'></a></div><div class='oj-datetimepicker-switcher-buttons'><a onclick='return false;' href='#' class='oj-enabled' data-handler='switchDone' data-event='click keydown' role='button'>"+this._EscapeXSS(this.getTranslatedString("done"))+"</a><a onclick='return false;' href='#' class='oj-enabled' data-handler='switchCancel' data-event='click keydown' role='button'>"+this._EscapeXSS(this.getTranslatedString("cancel"))+"</a></div></div>"},_updateSwitcherText:function(){var e="";e=this._isShowingDatePickerSwitcher()?C.format(this._switcherDateValue||this._getDateIso()):S.format(this._switcherTimeValue||this._getDateIso()),t(".oj-datetimepicker-switcher-text",this._switcherDiv).text(e)},_isShowingDatePickerSwitcher:function(){return!this._switcherDiv||0===t(".oj-inputdatetime-time-icon",this._switcherDiv).length},_togglePicker:function(){var e,i,n,r,a,o=this._switcherDiv,s=!this._isShowingDatePickerSwitcher();s?(r="oj-inputdatetime-calendar-icon",n="oj-inputdatetime-time-icon",a="Set Date"):(r="oj-inputdatetime-time-icon",n="oj-inputdatetime-calendar-icon",a="Set Time");var l=t(o.children()[0]).children();t(l[0]).removeClass(n).addClass(r),t(l[1]).text(a),(l=t(".oj-popup-content",this._popUpDpDiv.ojPopup("widget")).children())[0].classList.contains("oj-datepicker-popup")?(e=t(l[0]),i=t(l[1])):(e=t(l[1]),i=t(l[0])),s?(e.css("display","none"),i.css("display","block")):(i.css("display","none"),e.css("display","block")),this._updateSwitcherText()},_getTimePickerConverter:function(e){return null!==this._timeConverter?this._timeConverter:(this._timeConverter=D(e),this._timeConverter)},timeSelected:function(e,t){if(this._dateTimeSwitcherActive)this._switcherTimeValue=e;else{var i=this._GetConverter().format(e);this._SetDisplayValue(i),this._SetValue(i,t)}},getValueForInputTime:function(){var t=null;if(this.isValid())t=this.options.value;else if(this._previousValue)try{t=this._GetConverter().parse(this._previousValue)}catch(e){t=this.options.value}else t=null;return this._isDateTimeSwitcher()&&(t=this._switcherDateValue||t,this._switcherTimeValue&&t&&(t=e.IntlConverterUtils._copyTimeOver(this._switcherTimeValue,t))),t},_SetValue:function(e,t,i){var n=this._superApply(arguments);return this._previousValue=e,n},_SetDisplayValue:function(e){if(this._isInLine){var t=!(this._isInLine&&this._timePicker&&this._timePicker[0]===document.activeElement);this._updateDatepicker(t)}else this._superApply(arguments),this._updateSwitcherText();this._switcherTimeValue=null},_onKeyDownHandler:function(e){var i=t.ui.keyCode,n=!1;switch(e.keyCode){case i.UP:case i.DOWN:e.shiftKey&&(this._SetValue(this._GetDisplayValue(),e),this._timePicker.ojInputTime("show"),n=!0)}return n?(e.preventDefault(),e.stopPropagation(),!1):this._superApply(arguments)},show:function(){return this._isShowingDatePickerSwitcher()&&this._togglePicker(),this._super()},_ShowNativeDatePicker:function(e){e.mode="datetime";var t=k(this.options.timePicker.timeIncrement);return e.minuteInterval=0===t.hourIncr?t.minuteIncr:1,this._super(e)},_OnDatePicked:function(t){if(this._nativePickerShowing=!1,t){var i=e.IntlConverterUtils._dateTime(this._getDateIso(),{month:t.getMonth(),date:t.getDate(),fullYear:t.getFullYear(),hours:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds()}),n=this._GetConverter().format(i);this._SetValue(n,{})}this._onClose(this._ON_CLOSE_REASON_SELECTION)},_ShowHTMLDatePicker:function(){var e=this._superApply(arguments);return this._switcherPrevValue=this.options.value?this._getDateIso():"",this._switcherPrevDay=this._currentDay,this._switcherPrevMonth=this._currentMonth,this._switcherPrevYear=this._currentYear,this._updateSwitcherText(),e},showTimePicker:function(){this._datepickerShowing()||this.show(),this._isShowingDatePickerSwitcher()||this._timePicker.ojInputTime("show")},hideTimePicker:function(){return this.hide()},refresh:function(){var e=this._superApply(arguments)||this;return this._timePicker.ojInputTime("refresh"),this._switcherDiv&&(t("a[data-handler='switchDone']",this._switcherDiv).text(this.getTranslatedString("done")),t("a[data-handler='switchCancel']",this._switcherDiv).text(this.getTranslatedString("cancel"))),e},getNodeBySubId:function(e){var i=e&&e.subId,n=null;return i&&(n="oj-inputdatetime-date-input"===i?this._isInLine?this._timePickerElement[0]:this.element[0]:"oj-inputdatetime-calendar-clock-icon"===i?t(".oj-inputdatetime-calendar-clock-icon",this._triggerNode)[0]:this._timePicker.ojInputTime("getNodeBySubId",e)),n||this._superApply(arguments)},getSubIdByNode:function(e){var i=null;return this._isInLine?e===this._timePickerElement[0]&&(i="oj-inputdatetime-date-input"):e===this.element[0]?i="oj-inputdatetime-date-input":e===t(".oj-inputdatetime-calendar-clock-icon",this._triggerNode)[0]&&(i="oj-inputdatetime-calendar-clock-icon"),i||this._timePicker.ojInputTime("getSubIdByNode",e)||this._superApply(arguments)},_GetConverter:function(){return this.options.converter?this._superApply(arguments):t.oj.ojInputDateTime.prototype.options.converter},_NotifyDetached:function(){this._timePicker&&this.hideTimePicker(),this._superApply(arguments)},_NotifyHidden:function(){this._timePicker&&this.hideTimePicker(),this._superApply(arguments)},_GetMessagingLauncherElement:function(){return this._isInLine?this._timePickerElement:this._super()},_GetDefaultStyleClass:function(){return"oj-inputdatetime"},_GetTranslationsSectionName:function(){return"oj-ojInputDate"}}),e.CustomElementBridge.registerMetadata("oj-input-time","inputBase",{properties:{converter:{type:"Object"},keyboardEdit:{type:"string"},pickerAttributes:{type:"Object"},renderMode:{type:"string"},min:{type:"string"},max:{type:"string"},timePicker:{type:"Object",properties:{footerLayout:{type:"string"},timeIncrement:{type:"string"},showOn:{type:"string"}}},value:{type:"string",writeback:!0},translations:{type:"Object",properties:{ampmWheelLabel:{type:"string",value:"AMPM"},cancelText:{type:"string",value:"Prev"},currentTimeText:{type:"string",value:"Now"},dateTimeRange:{type:"Object",properties:{hint:{type:"Object",properties:{inRange:{type:"string"},max:{type:"string"},min:{type:"string"}}},messageDetail:{type:"Object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}},messageSummary:{type:"Object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}}}},hourWheelLabel:{type:"string",value:"Hour"},minuteWheelLabel:{type:"string",value:"Minute"},okText:{type:"string",value:"OK"},regexp:{type:"Object",properties:{messageDetail:{type:"string"},messageSummary:{type:"string"}}},required:{type:"Object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},tooltipTime:{type:"string",value:"Select Time"},tooltipTimeDisabled:{type:"string",value:"Select Time Disabled"}}}},methods:{hide:{},show:{}},extension:{_WIDGET_NAME:"ojInputTime"}}),e.CustomElementBridge.register("oj-input-time",{metadata:e.CustomElementBridge.getMetadata("oj-input-time")}),function(){e.CustomElementBridge.registerMetadata("oj-input-date","inputBase",{properties:{converter:{type:"Object"},datePicker:{type:"Object",properties:{footerLayout:{type:"string"},changeMonth:{type:"string"},changeYear:{type:"string"},currentMonthPos:{type:"number"},daysOutsideMonth:{type:"string"},numberOfMonths:{type:"number"},showOn:{type:"string"},stepMonths:{type:"string"},stepBigMonths:{type:"number"},weekDisplay:{type:"string"},yearRange:{type:"string"}}},min:{type:"string"},max:{type:"string"},dayFormatter:{type:"function"},dayMetaData:{type:"Object"},keyboardEdit:{type:"string"},pickerAttributes:{type:"Object"},renderMode:{type:"string"},translations:{type:"Object",properties:{currentText:{type:"string",value:"Today"},dateRestriction:{type:"Object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},dateTimeRange:{type:"Object",properties:{hint:{type:"Object",properties:{inRange:{type:"string"},max:{type:"string"},min:{type:"string"}}},messageDetail:{type:"Object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}},messageSummary:{type:"Object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}}}},nextText:{type:"string",value:"Next"},prevText:{type:"string",value:"Prev"},regexp:{type:"Object",properties:{messageDetail:{type:"string"},messageSummary:{type:"string"}}},required:{type:"Object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},tooltipCalendar:{type:"string",value:"Select Date"},tooltipCalendarDisabled:{type:"string",value:"Select Date Disabled"},tooltipCalendarTime:{type:"string",value:"Select Date Time"},tooltipCalendarTimeDisabled:{type:"string",value:"Select Date Time Disabled"},weekHeader:{type:"string",value:"Wk"}}},value:{type:"string",writeback:!0}},methods:{hide:{},show:{}},extension:{_WIDGET_NAME:"ojInputDate"}}),e.CustomElementBridge.register("oj-input-date",{metadata:e.CustomElementBridge.getMetadata("oj-input-date")});var t=e.CollectionUtils.copyInto({},e.CustomElementBridge.getMetadata("oj-input-date"),void 0,!0);t.extension._INNER_ELEM="div",e.CustomElementBridge.register("oj-date-picker",{metadata:t})}(),function(){e.CustomElementBridge.registerMetadata("oj-input-date-time","oj-input-date",{properties:{timePicker:{type:"Object",properties:{footerLayout:{type:"string"},timeIncrement:{type:"string"},showOn:{type:"string"}}},translations:{type:"Object",properties:{cancel:{type:"string",value:"Cancel"},currentText:{type:"string",value:"Today"},dateRestriction:{type:"Object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},dateTimeRange:{type:"Object",properties:{hint:{type:"Object",properties:{inRange:{type:"string"},max:{type:"string"},min:{type:"string"}}},messageDetail:{type:"Object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}},messageSummary:{type:"Object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}}}},done:{type:"string",value:"Done"},nextText:{type:"string",value:"Next"},prevText:{type:"string",value:"Prev"},regexp:{type:"Object",properties:{messageDetail:{type:"string"},messageSummary:{type:"string"}}},required:{type:"Object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},tooltipCalendar:{type:"string",value:"Select Date"},tooltipCalendarDisabled:{type:"string",value:"Select Date Disabled"},tooltipCalendarTime:{type:"string",value:"Select Date Time"},tooltipCalendarTimeDisabled:{type:"string",value:"Select Date Time Disabled"},weekHeader:{type:"string",value:"Wk"}}}},methods:{hideTimePicker:{},showTimePicker:{}},extension:{_WIDGET_NAME:"ojInputDateTime"}}),e.CustomElementBridge.register("oj-input-date-time",{metadata:e.CustomElementBridge.getMetadata("oj-input-date-time")});var t=e.CollectionUtils.copyInto({},e.CustomElementBridge.getMetadata("oj-input-date-time"),void 0,!0);t.extension._INNER_ELEM="div",e.CustomElementBridge.register("oj-date-time-picker",{metadata:t})}()});