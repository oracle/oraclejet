/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","promise"],function(a,f){a.Y=window.oj.Events={on:function(b,a,c){return this.vl(b,a,c,!1,!1)},off:function(b,a,c){return this.RK(b,a,c,!1)},trigger:function(b){var d=Array.prototype.slice.call(arguments);d.unshift(!1);return a.Y.Kb.apply(this,d)},once:function(b,a,c){return this.yZ(b,a,c,!1,null)},listenTo:function(b,d,c){var e,g,f,k,l={};d.constructor===String?l[d]=c:l=d;for(k in l)if(l.hasOwnProperty(k))for(d=a.Y.nq(k),c=0;c<d.length;c+=1)e=d[c].event,g=d[c].W,f={event:e,
W:g,object:b,Db:l[k]},this.JH(this._listeningTo,f,a.Y.YY),e=g?e+":"+g:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(f),b.vl(e,l[k],null,!0,!1);return this},listenToOnce:function(b,d,c){var e,g,f,k,l={};d.constructor===String?l[d]=c:l=d;for(k in l)if(l.hasOwnProperty(k))for(d=a.Y.nq(k),c=0;c<d.length;c+=1)e=d[c].event,g=d[c].W,f={event:e,W:g,object:b,Db:l[k]},this.JH(this._listeningTo,f,a.Y.YY),e=g?e+":"+g:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(f),
b.yZ(e,l[k],null,!0,this);return this},stopListening:function(b,d,c){var e,g={},f,k,l,m,n,p,r,s,q;if(null==arguments||1>=arguments.length){p=this._listeningTo?this._listeningTo.length:0;for(s=0;s<p;s++)if(m=this._listeningTo[s],n=b?b===m.object:!0)n=m.object.RK,n.apply(m.object,[m.event,m.Db,m.context,!0]);this._listeningTo=[];return this}e=d;b&&b.constructor===String&&(e=b);e.constructor===String?g[e]=c:g=e;for(q in g)if(g.hasOwnProperty(q))for(e=a.Y.nq(q),f=0;f<e.length;f+=1)for(k=e[f].event,l=
e[f].W,p=this._listeningTo?this._listeningTo.length:0,s=p-1;0<=s;s-=1)m=this._listeningTo[s],n=b?b===m.object:!0,p=k?k===m.event:!0,r=c?g[q]===m.Db:!0,m=l?l===m.W:!0,n&&p&&r&&m&&(n=this._listeningTo[s].object.RK,n.apply(this._listeningTo[s].object,[this._listeningTo[s].event,this._listeningTo[s].Db,this._listeningTo[s].context,!0]),this._listeningTo.splice(s,1));return this}};a.Y.bind=a.Y.on;a.Y.unbind=a.Y.off;a.Y.D={ADD:"add",ALLADDED:"alladded",REMOVE:"remove",RESET:"reset",REFRESH:"refresh",SORT:"sort",
CHANGE:"change",DESTROY:"destroy",ALLREMOVED:"allremoved",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",READY:"ready",ALL:"all"};o_("Events.EventType",a.Y.D,a);a.Y.CF=function(b,a){var c,e=a||this;for(c in e)"function"===typeof e[c]&&(b[c]=e[c]);b.ad={};b._listeningTo=[]};a.Y.yZ=function(b,a,c,e,g){var f,k,l,m;l=this.ZI(b,a);for(m in l)if(l.hasOwnProperty(m))for(b=this.nq(m),a=0;a<b.length;a+=1)f=b[a].event,k=b[a].W,void 0===this.ad&&(this.ad=[]),void 0===this.ad[f]&&(this.ad[f]=[]),
this.ad[f].push({Db:l[m],context:c,W:k,Lm:!0,fired:!1,Vo:e,iz:g});return this};a.Y.H0=function(b){return b.Lm?b.fired?!1:b.fired=!0:!0};a.Y.eW=function(b,a){return a.context||a.iz||b};a.Y.Kb=function(b,d){var c=this.nq(d),e,g,f,k,l,m;k=[];for(e=0;e<c.length;e+=1)g=c[e].event,f=c[e].W,k.push({event:g,W:f});for(e=0;e<k.length;e+=1){l=this.NB(this.ad,a.Y.D.ALL);c=a.Y.NB(this.ad,k[e].event,!1);for(g=0;g<(c?c.length:0);g+=1)c[g].W===k[e].W&&c[g].Db&&(f=Array.prototype.slice.call(arguments),c&&c[g]&&c[g].Lm&&
(this.x_(a.Y.NB(this.ad,k[e].event,!0),c[g]),c[g].iz&&c[g].iz.stopListening(this,d,c[g].Db)),c&&c[g]&&this.H0(c[g])&&(m=c[g].Db,b&&!c[g].Z3||m.apply(a.Y.eW(this,c[g]),f.slice(2))));for(g=0;g<(l?l.length:0);g+=1)f=Array.prototype.slice.call(arguments),0<f.length&&(f[1]=k[e].W?k[e].event+":"+k[e].W:k[e].event),l&&l[g]&&l[g].Db&&this.H0(l[g])&&(m=l[g].Db,b&&!l[g].Z3||m.apply(a.Y.eW(this,l[g]),f.slice(1))),l&&l[g]&&l[g].Lm&&(this.x_(this.NB(this.ad,a.Y.D.ALL,!0),l[g]),l[g].iz&&l[g].iz.stopListening(this,
a.Y.D.ALL,l[g].Db))}return this};a.Y.vl=function(b,d,c,e,g){var f,k,l,m;b=this.ZI(b,d);for(f in b)if(b.hasOwnProperty(f))for(d=this.nq(f),k=0;k<d.length;k+=1)l=d[k].event,m=d[k].W,void 0===this.ad&&(this.ad=[]),void 0===this.ad[l]&&(this.ad[l]=[]),m={Db:b[f],context:c,W:m,Vo:e,Z3:g},-1===this.JH(this.ad[l],m,a.Y.yga)&&this.ad[l].push(m);return this};a.Y.RK=function(b,a,c,e){var g,f;if(null==arguments||0==arguments.length)return this.ad={},this;if(null==b)return this.w_(b,a,c,e),this;g=this.ZI(b,a);
for(f in g)g.hasOwnProperty(f)&&this.w_(f,g[f],c,e);return this};a.Y.ZI=function(b,a){var c={};b.constructor===String?c[b]=a:c=b;return c};a.Y.w_=function(b,d,c,e){var g=[],f,k,l,m,n,p,r,s;if(b)g=a.Y.nq(b);else if(void 0!==this.ad)for(k in this.ad)this.ad.hasOwnProperty(k)&&g.push({event:k});for(b=0;b<g.length;b+=1)if(k=g[b].event,l=g[b].W,void 0!==this.ad&&this.ad[k]instanceof Array){m=this.ad[k];for(f=m.length-1;0<=f;f-=1)n=void 0===d||null===d||m[f].Db==d,p=void 0===c||null===c||m[f].context==
c,r=void 0===l||null===l||m[f].W==l,s=void 0===e||null===e||m[f].Vo==e,n&&p&&r&&s&&m.splice(f,1);0===m.length&&delete this.ad[k]}};a.Y.x_=function(b,a){var c,e,g,f,k,l;if(b)for(c=b.length-1;0<=c;c-=1)e=void 0===a.Db||null===a.Db||b[c].Db==a.Db,g=void 0===a.context||null===a.context||b[c].context==a.context,f=void 0===a.W||null===a.W||b[c].W==a.W,k=void 0===a.Vo||null===a.Vo||b[c].Vo==a.Vo,l=void 0===a.Lm||null===a.Lm||b[c].Lm==a.Lm,e&&g&&f&&k&&l&&b.splice(c,1)};a.Y.nq=function(b){b=b?b.split(" "):
[];var a=[],c,e,g;for(c=0;c<b.length;c+=1)e=b[c].split(":"),g=e[0],e=1<e.length?e[1]:null,a.push({event:g,W:e});return a};a.Y.yga=function(b,a){return b.Db===a.Db&&b.W===a.W&&b.context===a.context&&b.Vo===a.Vo&&b.Lm===a.Lm};a.Y.YY=function(b,a){return b.event===a.event&&b.W===a.W&&b.context===a.context&&b.object===a.object};a.Y.JH=function(b,a,c){var e;if(void 0===b)return-1;for(e=0;e<b.length;e+=1)if(c(b[e],a))return e;return-1};a.Y.NB=function(b,a,c){if(b&&b[a]instanceof Array){if(c)return b[a];
c=[];var e;for(e=0;e<b[a].length;e++)c.push(b[a][e]);return c}return null};a.t=function(b,d){a.t._init(this,b,d,null)};o_("Model",a.t,a);a.b.ga(a.t,a.b,"oj.Model");a.t.prototype.Init=function(){a.t.r.Init.call(this)};a.t.prototype.attributes={};a.b.g("Model.prototype.attributes",{attributes:a.t.prototype.attributes});a.t.prototype.hc={};a.b.g("Model.prototype.defaults",{hc:a.t.prototype.hc});a.t.prototype.id=null;a.b.g("Model.prototype.id",{id:a.t.prototype.id});a.t.prototype.Y3="id";a.b.g("Model.prototype.idAttribute",
{Y3:a.t.prototype.Y3});a.t.prototype.m6=null;a.b.g("Model.prototype.urlRoot",{m6:a.t.prototype.m6});a.t.prototype.Hj=null;a.b.g("Model.prototype.customURL",{Hj:a.t.prototype.Hj});a.t.kK=0;a.t._init=function(b,d,c,e){var g=null,h;if(!a.t.lx){b.Init();a.Y.CF(b);b.Rs();b.UO={};b.FE=!1;b.index=-1;c=c||{};b.attributes={};b.defaults&&!c.vpa&&(b.attributes=a.t.VA(f.isFunction(b.defaults)?b.defaults():b.defaults,null));for(g in e)e.hasOwnProperty(g)&&(b[g]=e[g]);if(d)if(e=c.parse,f.isFunction(e)&&(b.parse=
e),h=a.t.VA(d,b.attributes),h=e?b.parse(h):h,null==h||void 0===h)b.attributes={};else for(g in h)h.hasOwnProperty(g)&&b.TL(g,h[g],!1,!1,c);b.Ez();b.wv(c.collection);c.customURL&&(b.customURL=c.customURL);c.url&&(b.url=c.url);c.urlRoot&&(b.urlRoot=c.urlRoot);b.initialize&&b.initialize(d,c);b.dk()}};a.t.extend=function(b,d){a.t.lx=!0;var c,e;c=new a.t;a.t.lx=!1;f.extend(c,this.prototype);b=b||{};for(e in b)b.hasOwnProperty(e)&&(c[e]=b[e]);var g;g=b&&b.constructor&&b.hasOwnProperty("constructor")?b.constructor:
function(d,c){a.t._init(this,d,c,b)};f.extend(g,this);g.prototype=c;g.extend=a.t.extend;g.prototype.constructor=g;a.Y.CF(g,this);if(d)for(e in d)d.hasOwnProperty(e)&&(g[e]=d[e]);return g};o_("Model.extend",a.t.extend,a);a.t.prototype.Kb=function(){};a.t.prototype.Ez=function(){this.tp()||(this.cid="id"+a.t.kK,a.t.kK+=1)};a.t.prototype.tp=function(){return this.cid};a.t.prototype.xv=function(b){this.index=b};a.t.prototype.N6=function(){return this.index};a.t.prototype.IF=function(b){this.Zpa=b};a.t.prototype.Fz=
function(b){var a=this.VO;this.VO=b;return a};a.t.prototype.a7=function(b,d,c){var e,g=!1,f=a.Ea.qd(d),k,l=!1;for(e in b.attributes)b.attributes.hasOwnProperty(e)&&(k=this.attributes[e]!=b.attributes[e],f?e===d&&k&&(g=!0):k&&(g=!0),k&&(l=!0,this.attributes[e]=b.attributes[e],this.YG(e,b.attributes[e]),this.sB(e,this.attributes[e],null,c)));this.dk();l&&this.tB(null,c);return g};a.t.iC=function(b){var a;if(b&&b instanceof Object)for(a in b)if(b.hasOwnProperty(a))return!0;return!1};a.t.prototype.wv=
function(b){null==b?delete this.collection:(this.collection=b,this.dk())};a.t.prototype.jv=function(){return this.collection};a.t.prototype.sB=function(b,d,c,e){null!=b&&this.Kb(e,a.Y.D.CHANGE+":"+b,this,d,c)};a.t.prototype.tB=function(b,d){this.Kb(d,a.Y.D.CHANGE,this,b,null)};a.t.prototype.dk=function(){var b=null;this.collection&&this.collection.modelId&&(b=this.collection.modelId,b=f.isFunction(b)?b.call(this.collection,this.attributes):b);b||(b=this.eJ(),b=null!=this.attributes?this.attributes[b]:
null);this.id=b};a.t.prototype.Dla=function(b,d,c){var e=a.b.Vv(this.attributes[b],d);return c||!e?(this.attributes[b]=d,this.dk(),!e):!1};a.t.prototype.Rs=function(){this.changed={}};a.t.prototype.YG=function(b,a){this.changed[b]=a};a.t.prototype.TL=function(b,d,c,e,g){if(null==b)return!0;var f={},k,l=this.FE;if(e)for(k in b)b.hasOwnProperty(k)&&(f[k]=b[k]);else f[b]=d;b=g||{};if(!this.kw(f,{validate:b.validate},!1))return!1;l||(this.Rs(),this.Jo=[]);this.FE||(this.UO=a.t.VA(this.attributes,null));
this.FE=!0;for(k in f)f.hasOwnProperty(k)&&(this.Dla(k,f[k],c)?(this.YG(k,f[k]),this.Jo.push(k)):delete f[k]);c=b.silent;for(k in f)f.hasOwnProperty(k)&&(!c&&(0<this.Jo.length||l&&-1===this.Jo.indexOf(k))&&(this.a5=!0,this.fqa=b),this.sB(k,f[k],b,c));if(l)return!0;if(!c&&!l)for(;this.a5;)this.a5=!1,this.tB(this.fqa,c);this.FE=!1;return!0};a.t.prototype.clear=function(b){var d,c={silent:!0},e;b=b||{};e=b.silent;c.validate=b.validate;this.Rs();for(d in this.attributes)if(this.attributes.hasOwnProperty(d)){if(!this.AD(d,
c,!0))return!1;this.Kb(e,a.Y.D.CHANGE+":"+d,this,void 0,null)}this.attributes={};this.dk();this.sB(null,null,null,e);this.tB(null,e);return this};a.b.g("Model.prototype.clear",{clear:a.t.prototype.clear});a.t.VA=function(b,d){d=d||{};for(var c in b)d.hasOwnProperty(c)&&b.hasOwnProperty(c)&&void 0===b[c]&&delete b[c];a.zc.Lf(d,b,void 0,!0,1E4);return d};a.t.prototype.clone=function(){var b=new this.constructor,d;for(d in this)this.hasOwnProperty(d)&&this[d]!==this.attributes&&(b[d]=this[d]);b.attributes=
a.t.VA(this.attributes,null);delete b.cid;b.Ez();b.dk();return b};a.b.g("Model.prototype.clone",{clone:a.t.prototype.clone});a.t.prototype.yp=function(b,a){var c=this.eg();if(void 0!==c&&c==b)return!0;c=this.cid;return void 0!==c&&c==a?!0:!1};a.t.prototype.set=function(b,d,c){var e=c||{},g,f=!0;if(arguments&&0<arguments.length)if(a.Ea.qd(b))e.unset?this.AD(b,null,!1):this.TL(b,d,!1,!1,e)||(f=!1);else if(e=d||{},e.unset)for(g in b)b.hasOwnProperty(g)&&this.AD(g,null,!1);else this.TL(b,null,!0,!0,e)||
(f=!1);return f?this:!1};a.b.g("Model.prototype.set",{set:a.t.prototype.set});a.t.prototype.k6=function(b,a){return this.AD(b,a,!1)};a.b.g("Model.prototype.unset",{k6:a.t.prototype.k6});a.t.prototype.AD=function(b,a,c){a=a||{};var e=a.silent,g={};if(this.has(b)){if(!this.kw(g,a,!1))return!1;c||this.Rs();delete this.attributes[b];this.YG(b,void 0);this.sB(b,null,null,e);this.tB(null,e)}this.dk();return!0};a.t.prototype.get=function(b){return this.attributes[b]};a.b.g("Model.prototype.get",{get:a.t.prototype.get});
a.t.prototype.has=function(b){return a.j.Ml(this.attributes[b])};a.b.g("Model.prototype.has",{has:a.t.prototype.has});a.t.prototype.fetch=function(b){b=b||{};var d=b.success,c=b.error,e=this,g;g=a.t.dq(b);g.error=function(d,g,f){a.t.ky(e,!1,b,g,f,d);c&&c.apply(e,arguments)};g.success=function(c){g.xhr&&(b.xhr=g.xhr);a.t.xB(e,c,g);f.isFunction(e.parse)&&e.set(e.parse(c),g);d&&d.call(e,this,c,b)};a.t.dx("read",this,g)};a.b.g("Model.prototype.fetch",{fetch:a.t.prototype.fetch});a.t.prototype.parse=function(b){return b};
a.t.prototype.url=function(){var b=this.oX(),d=this.eg();if(b)return d?b+"/"+encodeURIComponent(d):b;if(b=this.collection)return b=a.t.dn(b,"url"),d&&b?(d="/"==a.t.nea(b)?"":"/",b+d+encodeURIComponent(this.eg())):b;throw new a.nn;};a.b.g("Model.prototype.url",{url:a.t.prototype.url});a.t.prototype.keys=function(){var b,a=[];for(b in this.attributes)this.attributes.hasOwnProperty(b)&&a.push(b);return a};a.b.g("Model.prototype.keys",{keys:a.t.prototype.keys});a.t.prototype.o6=function(){var b,a=[];
for(b in this.attributes)this.attributes.hasOwnProperty(b)&&a.push(this.get(b));return a};a.b.g("Model.prototype.values",{o6:a.t.prototype.o6});a.t.prototype.X4=function(){var b,a=[],c;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(c=[],c.push(b),c.push(this.get(b)),a.push(c));return a};a.b.g("Model.prototype.pairs",{X4:a.t.prototype.X4});a.t.prototype.V4=function(b){var a=[],c,e,g={};if(b instanceof Array)a=b;else for(c=0;c<arguments.length;c++)a.push(arguments[c]);for(e in this.attributes)this.attributes.hasOwnProperty(e)&&
-1==a.indexOf(e)&&(g[e]=this.get(e));return g};a.b.g("Model.prototype.omit",{V4:a.t.prototype.V4});a.t.prototype.b5=function(b){var a=[],c,e={};if(b instanceof Array)a=b;else for(c=0;c<arguments.length;c++)a.push(arguments[c]);for(c=0;c<a.length;c++)this.attributes.hasOwnProperty(a[c])&&(e[a[c]]=this.get(a[c]));return e};a.b.g("Model.prototype.pick",{b5:a.t.prototype.b5});a.t.prototype.f4=function(){var b,a={},c;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(c=this.get(b),a[c]=b);return a};
a.b.g("Model.prototype.invert",{f4:a.t.prototype.f4});a.t.nea=function(b){return b.charAt(b.length-1)};a.t.prototype.Wka=function(){var b=this.oX();return b?b:this.jv()?this.jv().url:null};a.t.prototype.oX=function(){return a.t.dn(this,"urlRoot")};a.t.prototype.parseSave=function(b){return b};a.t.prototype.isValid=function(){var b={};b.validate=this.validate;return this.kw(this.attributes,b,!1)};a.b.g("Model.prototype.isValid",{isValid:a.t.prototype.isValid});a.t.Mha=function(b,a){b=b||{};return void 0!==
b.validate&&null!==b.validate?b.validate:a};a.t.prototype.kw=function(b,d,c){d=d||{};var e=this.validate;return e&&a.t.Mha(d,c)&&(this.validationError=e.call(this,b,d))?(this.Kb(!1,a.Y.D.INVALID,this,this.validationError,d),!1):!0};a.t.pja=function(b){var d=!1,c={},e,g={};if(b&&0<b.length){1<b.length&&b[b.length-1]&&a.t.iC(b[b.length-1])&&(d=!0,c=b[b.length-1]||{});if(null==b[0])return{attributes:null,options:c};if(a.t.iC(b[0])||a.b.ph(b[0]))for(e in b[0])b[0].hasOwnProperty(e)&&(g[e]=b[0][e]);else for(e=
0;e<b.length;e+=2)if(void 0!==b[e]||e<b.length-1||!d&&e===b.length-1)g[b[e]]=b[e+1]}return{attributes:g,options:c}};a.t.dq=function(b){var a={},c;b=b||{};for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};a.t.ky=function(b,d,c,e,g,f){c=c||{};c.textStatus=e;c.errorThrown=g;b.Kb(d,a.Y.D.ERROR,b,f,c)};a.t.prototype.save=function(b,d){var c,e,g,h,k,l;c=a.t.pja(arguments);var m,n,p;p=void 0===b?void 0:c.attributes;d=d||{};m=a.t.dq(c.options);if(!this.kw(this.attributes,m,!0))return!1;m.wait||this.set(p);
c=void 0===m.forceNew?!1:m.forceNew;h=this;k=m.error;l=m.patch;m.error=function(b,c,e){a.t.ky(h,!1,d,c,e,b);k&&k.apply(h,arguments)};m.saveAttrs=m.wait?this.jaa(p):this.attributes;n=this.attributes;this.attributes=m.saveAttrs;m.saveAttrs=this.toJSON();this.attributes=n;if(!c&&!this.tE())return e=m.success,m.success=function(b){var c;m.xhr&&(d.xhr=m.xhr);b&&(c=f.isFunction(h.parse)?h.parse(b):b,h.attributes=f.extend(!0,h.attributes,c),h.dk());a.t.xB(h,b,m);m.wait&&h.set(p);e&&e.call(a.t.$i(m,h),h,
b,d);h.Rs()},m.attrs||(m.attrs=void 0===p?void 0:l?p:m.saveAttrs),a.t.dx(l?"patch":"update",this,m);g=a.t.fX(m);m.success=function(b){var c;m.xhr&&(d.xhr=m.xhr);if(b){c=f.isFunction(h.parse)?h.parse(b):b;if(!h.kw(c,m,!0))return;h.attributes=f.extend(!0,h.attributes,c);h.dk()}m.wait&&h.set(p);a.t.xB(h,b,m);g&&g.call(a.t.$i(m,h),h,b,d);h.Rs()};m.attrs||(m.attrs=m.saveAttrs);m.parse=!0;l&&(m.saveAttrs=m.attrs);return a.t.dx("create",this,m)};a.b.g("Model.prototype.save",{save:a.t.prototype.save});a.t.prototype.jaa=
function(b){var a={},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&(a[c]=this.attributes[c]);for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};a.t.dn=function(b,a){return b?f.isFunction(b[a])?b[a]():b[a]:f.isFunction(a)?a():a};a.t.bQ=function(b){return b&&b.hasOwnProperty("value")&&b.hasOwnProperty("comparator")};a.t.prototype.Aga=function(b){for(var d in b)if(b.hasOwnProperty(d)){if(!this.attributes.hasOwnProperty(d))return!1;for(var c=Array.isArray(b[d])?b[d]:[b[d]],e=0;e<c.length;e++)if(a.t.bQ(c[e])){var g=
c[e].comparator,f=c[e].value;if(a.Ea.qd(g))throw Error("String comparator invalid for local where/findWhere");if(!g(this,d,f))return!1}else if(b[d]!==this.attributes[d])return!1}return!0};a.t.prototype.matches=function(b){a:{for(var a in b)if(this.get(a)!==b[a]){b=!1;break a}b=!0}return b};a.b.g("Model.prototype.matches",{matches:a.t.prototype.matches});a.t.prototype.z6=function(b){b=b.constructor===Array?b:[b];var a;for(a=0;a<b.length;a++)if(this.Aga(b[a]))return!0;return!1};a.t.fX=function(b){return null!=
b&&b.success?b.success:null};a.t.$i=function(b,a){return void 0!==b&&void 0!==b.context?b.context:a};a.t.prototype.tE=function(){return void 0==this.eg()};a.b.g("Model.prototype.isNew",{tE:a.t.prototype.tE});a.t.prototype.eJ=function(){return this.idAttribute||"id"};a.t.prototype.eg=function(){return this.id};a.t.prototype.gN=function(b){if(b){var d={},c;for(c in b)b.hasOwnProperty(c)&&(a.b.Vv(b[c],this.attributes[c])||(d[c]=b[c]));return a.b.ph(d)?!1:d}return a.b.ph(this.changed)?!1:this.changed};
a.b.g("Model.prototype.changedAttributes",{gN:a.t.prototype.gN});a.t.prototype.$N=function(b){return void 0!==b?a.t.iC(this.changed)&&this.changed.hasOwnProperty(b):a.t.iC(this.changed)};a.b.g("Model.prototype.hasChanged",{$N:a.t.prototype.$N});a.t.prototype.destroy=function(b){b=b||{};var d=b.wait,c,e=b.error,g=this,f,k;k=a.t.dq(b);c=a.t.fX(k);var l=this.jv();k.success=function(e){k.xhr&&(b.xhr=k.xhr);if(l){var f=a.Ea.qd(e)&&!a.Ea.ph(e)?JSON.parse(e):e;l.u0(f,null,e,!0)}d&&g.KI();a.t.xB(g,e,k);c&&
c.call(a.t.$i(k,g),g,e,b)};k.error=function(d,c,f){g.Kb(!1,a.Y.D.ERROR,g,d,b);e&&e.apply(g,arguments)};if(!this.tE())return f=a.t.dx("delete",this,k),d||this.KI(),f;d||this.KI();c&&c.call(a.t.$i(k,g),g,null,b);return!1};a.b.g("Model.prototype.destroy",{destroy:a.t.prototype.destroy});a.t.prototype.NV=function(b,d,c,e){this.Kb(e,a.Y.D.REQUEST,b,d,c)};a.t.prototype.KI=function(){this.Kb(!1,a.Y.D.DESTROY,this,this.collection,null)};a.t.xB=function(b,d,c){b.Kb(!1,a.Y.D.SYNC,b,d,c)};a.t.prototype.toJSON=
function(){var b={},a;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(Array.isArray(this.attributes[a])?b[a]=this.attributes[a].slice(0):b[a]=this.attributes[a]);return b};a.b.g("Model.prototype.toJSON",{toJSON:a.t.prototype.toJSON});a.t.prototype.Qm=function(b){return this.UO[b]};a.b.g("Model.prototype.previous",{Qm:a.t.prototype.Qm});a.t.prototype.h5=function(){return this.UO};a.b.g("Model.prototype.previousAttributes",{h5:a.t.prototype.h5});a.t.prototype.sync=function(b,a,c){return window.oj.sync(b,
a,c)};a.t.dx=function(b,d,c){c=c||{};d.oauth&&(c.oauthHeader=d.oauth.getHeader());!c.dataType&&d.dataType&&(c.dataType=d.dataType);!c.jsonpCallback&&d.jsonpCallback&&(c.jsonpCallback=d.jsonpCallback);if("create"===b||"patch"===b||"update"===b)c.RO=d.parseSave.call(d,"patch"===b?c.attrs:c.saveAttrs);var e=null;d instanceof a.t&&(e=d.eg());var g={};if(c)for(var f in c)g[f]=c[f];e=a.t.yQ(e,d,c);for(f in e)g[f]=e[f];c.xhr=d.sync(b,d,g);g.xhr&&(c.xhr=g.xhr);return c.xhr};a.t.yQ=function(b,d,c){d=d instanceof
a.j?d.e7(c):{};b&&(d.recordID=b);return d};a.pP=function(b,d,c){function e(b){d.NV(d,b,c,c.silent);return b}c=c||{};var g,f=c.success,k=c.error;g=d.customURL;if("create"===b.valueOf())return b=(b=d.Wka())?b:a.t.dn(d,"url"),g=new a.Ua(b,g),e(g.jna(c.RO,k,c,d));if("read"===b.valueOf()){if(d instanceof a.t)return b=c.url?c.url:a.t.dn(d,"url"),g=new a.Ua(b,g),e(g.TN(f,k,d.eg(),c,a.t.$i(c,d)));b=d.TP(c);g=new a.Ua(b,g);return e(g.Koa(f,k,c,d))}g=new a.Ua(a.t.dn(d,"url"),g);var l=null;d instanceof a.t&&
(l=d.eg());return"update"===b.valueOf()?e(g.l6(f,l,c.RO,k,c,d,!1)):"patch"===b.valueOf()?e(g.l6(f,l,c.RO,k,c,d,!0)):"delete"===b.valueOf()?e(g.ioa(l,k,c,d)):null};o_("sync",a.pP,a);a.t.Zma=function(b){if(!b.url)throw Error("The url property or function must be specified");};a.ajax=function(){arguments&&0<arguments.length&&a.t.Zma(arguments[0]);return f.ajax.apply(window.oj,arguments)};o_("ajax",a.ajax,a);a.nn=function(){this.name="URLError";this.message="No URL defined"};o_("URLError",a.nn,a);a.nn.prototype=
Error();a.nn.constructor=a.nn;a.Ua=function(b,a){this.lz=b;this.Hj=a;f.support.cors=!0};a.Ua.ws="headers";a.Ua.uy=function(b,d,c){var e;b=f.extend(!0,b,c);for(e in d)d.hasOwnProperty(e)&&"oauthHeader"!==e&&(b.hasOwnProperty(e)||(b[e]=d[e]),e===a.Ua.ws&&(b[e]=f.extend(!0,b[e],d[e])));if(d.oauthHeader)for(e in b[a.Ua.ws]||(b[a.Ua.ws]={}),d.oauthHeader)d.oauthHeader.hasOwnProperty(e)&&(b[a.Ua.ws].hasOwnProperty(e)||(b[a.Ua.ws][e]=d.oauthHeader[e]));return b};a.Ua.prototype.Koa=function(b,d,c,e){c=c||
{};var g="jsonp"===c.dataType,f=this.Ww("read",this.lz,this.Hj,null,e,c);b={crossDomain:c.crossDomain||!g,dataType:this.IB(c),jsonpCallback:c.jsonpCallback,context:null!==e?e:this,success:b,error:d};b=this.CA(b);b=a.Ua.uy(b,c,f);c.xhr=this.ajax(b);return c.xhr};a.Ua.prototype.CA=function(b){b[a.Ua.ws]={"Accept-Language":this.Bg()};return b};a.Ua.prototype.TN=function(b,d,c,e,g){e=e||{};var f="jsonp"===e.dataType;c=this.Ww("read",this.lz,this.Hj,c,g,e);b={crossDomain:e.crossDomain||!f,dataType:this.IB(e),
jsonpCallback:e.jsonpCallback,context:null!==g?g:this,success:b,error:d};b=this.CA(b);b=a.Ua.uy(b,e,c);e.xhr=this.ajax(b);return e.xhr};a.Ua.prototype.l6=function(b,d,c,e,g,f,k){g=g||{};var l="jsonp"===g.dataType;d=this.Ww(k?"patch":"update",this.lz,this.Hj,d,f,g);k=a.Ua.ct(g);b={crossDomain:g.crossDomain||!l,contentType:this.Qda(g),dataType:this.IB(g),jsonpCallback:g.jsonpCallback,data:this.$a(JSON.stringify(c),g,d),emulateHTTP:k,emulateJSON:a.Ua.dt(g),success:b,error:e,context:null!==f?f:this};
b=this.CA(b);b=a.Ua.uy(b,g,d);b=a.Ua.AT(k,b);g.xhr=this.ajax(b);return g.xhr};a.Ua.AT=function(b,a){if(b){var c=a.beforeSend;a.beforeSend=function(b){b.setRequestHeader("X-HTTP-Method-Override",a.Bi);if(c)return c.apply(this,arguments)}}return a};a.Ua.prototype.$a=function(b,d,c){return a.Ua.dt(d)?(d={_method:c.Bi?c.Bi:c.type},b&&(d.model=b),d):b};a.Ua.prototype.gea=function(b,d){if(d.type)return{method:d.type};var c=null;"create"===b&&(c="POST");"delete"===b&&(c="DELETE");"patch"===b&&(c="PATCH");
"update"===b&&(c="PUT");if(a.Ua.ct(d)){var e={method:"POST"};e.Bi=c;return e}null===c&&(c="GET");return{method:c}};a.Ua.ct=function(b){return b.emulateHTTP||a.emulateHTTP};a.Ua.dt=function(b){return b.emulateJSON||a.emulateJSON};a.Ua.prototype.Ww=function(b,d,c,e,g,h){var k=this.gea(b,h);if(f.isFunction(c)){b=c.call(this,b,g,a.t.yQ(e,g,h));if(a.Ea.qd(b))return d={url:b,type:k.method},k.Bi&&(d.Bi=k.Bi),d;if(b)return b.url=b.hasOwnProperty("url")?b.url:d,b.hasOwnProperty("type")||(b.type=k.method),
!b.hasOwnProperty("data")&&k.Bi&&(b.Bi=k.Bi),b}d={url:a.t.dn(null,d),type:k.method};k.Bi&&(d.Bi=k.Bi);return d};a.Ua.prototype.ioa=function(b,d,c,e){c=c||{};var g="jsonp"===c.dataType;b=this.Ww("delete",this.lz,this.Hj,b,e,c);var f=a.Ua.ct(c);d={crossDomain:c.crossDomain||!g,success:c.success,error:d,context:null!==e?e:this,emulateHTTP:f,emulateJSON:a.Ua.dt(c)};(e=this.$a(null,c,b))&&(d.data=e);d=a.Ua.uy(d,c,b);d=a.Ua.AT(f,d);c.xhr=this.ajax(d);return c.xhr};a.Ua.prototype.jna=function(b,d,c,e){c=
c||{};var g=JSON.stringify(b),f="jsonp"===c.dataType;b=this.Ww("create",this.lz,this.Hj,null,e,c);var k=a.Ua.ct(c);d={crossDomain:c.crossDomain||!f,contentType:c.contentType||"application/json",dataType:this.IB(c),jsonpCallback:c.jsonpCallback,data:this.$a(g,c,b),success:c.success,error:d,emulateHTTP:k,emulateJSON:a.Ua.dt(c),context:null!==e?e:this};d=this.CA(d);d=a.Ua.uy(d,c,b);c.xhr=this.ajax(d);return c.xhr};a.Ua.prototype.IB=function(b){return a.Ua.dt(b)&&!a.Ua.ct(b)?"application/x-www-form-urlencoded":
b.dataType||"json"};a.Ua.prototype.Qda=function(b){return a.Ua.dt(b)&&!a.Ua.ct(b)?"application/x-www-form-urlencoded":b.contentType||"application/json"};a.Ua.prototype.Bg=function(){return a.ba.Bg()};a.Ua.prototype.ajax=function(b){if(null===b.url||void 0===b.url)throw new a.nn;return window.oj.ajax(b)};a.Fb=function(b,d){d=d||{};a.Fb._init(this,d,b||"Authorization")};o_("OAuth",a.Fb,a);a.b.ga(a.Fb,a.b,"oj.OAuth");a.Fb.prototype.Init=function(){a.Fb.r.Init.call(this)};a.Fb.prototype.k3=function(){var b=
{};this.Fo.access_token||this.iN();b[this.Pk.Y1]="Bearer "+this.Fo.access_token;return b};a.b.g("OAuth.prototype.getHeader",{k3:a.Fb.prototype.k3});a.Fb.prototype.j4=function(){return this.Fo.wsa?!0:!1};a.b.g("OAuth.prototype.isInitialized",{j4:a.Fb.prototype.j4});a.Fb.prototype.iN=function(){var b={},d=this;b[d.Pk.Y1]="Basic "+a.Fb.paa(d.Pk.client_id+":"+d.Pk.client_secret);f.ajax({type:"POST",async:!1,url:this.Pk.bearer_url,data:"grant_type\x3dclient_credentials",headers:b,success:function(b){a.Fb.cx(d.Fo,
b)},error:function(b){throw Error(b.responseText);}})};a.b.g("OAuth.prototype.clientCredentialGrant",{iN:a.Fb.prototype.iN});a.Fb.prototype.x5=function(b){a.Fb.cx(this.Fo,b)};a.b.g("OAuth.prototype.setAccessTokenResponse",{x5:a.Fb.prototype.x5});a.Fb.prototype.R2=function(){return this.Fo};a.b.g("OAuth.prototype.getAccessTokenResponse",{R2:a.Fb.prototype.R2});a.Fb.prototype.g2=function(){a.Fb.WT(this.Fo)};a.b.g("OAuth.prototype.cleanAccessTokenResponse",{g2:a.Fb.prototype.g2});a.Fb.prototype.w5=function(b){a.Fb.cx(this.Pk,
b)};a.b.g("OAuth.prototype.setAccessTokenRequest",{w5:a.Fb.prototype.w5});a.Fb.prototype.Q2=function(){return this.Pk};a.b.g("OAuth.prototype.getAccessTokenRequest",{Q2:a.Fb.prototype.Q2});a.Fb.prototype.e2=function(){a.Fb.WT(this.Pk)};a.b.g("OAuth.prototype.cleanAccessTokenRequest",{e2:a.Fb.prototype.e2});a.Fb._init=function(b,d,c){b.Init();b.Pk={};b.Fo={};d.access_token?a.Fb.cx(b.Fo,d):d.client_id&&d.client_secret&&d.bearer_url&&a.Fb.cx(b.Pk,d);b.Pk.Y1=c};a.Fb.cx=function(b,a){var c;a=a||{};for(c in a)b[c]=
a[c]};a.Fb.WT=function(b){for(var a in b)b.hasOwnProperty(a)&&"auth_header"!==a&&(b[a]=null,delete b[a])};a.Fb.paa=function(b){var a,c,e,g,f=0,k=0,l=[];do a=b.charCodeAt(f++),c=b.charCodeAt(f++),e=b.charCodeAt(f++),g=a<<16|c<<8|e,a=g>>18&63,c=g>>12&63,e=g>>6&63,g&=63,l[k++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(e)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(g);while(f<b.length);l=l.join("");a=b.length%3;return(a?l.slice(0,a-3):l)+"\x3d\x3d\x3d".slice(a||3)};a.j=function(b,d){a.j.lx||a.j._init(this,b,d,null)};o_("Collection",a.j,a);a.b.ga(a.j,a.b,"oj.Collection");a.j.prototype.$o=null;a.b.g("Collection.prototype.model",{$o:a.j.prototype.$o});a.j.prototype.K4=function(b){var a=this.model;return a&&b?b[a.idAttribute||a.prototype.idAttribute||"id"]:null};a.b.g("Collection.prototype.modelId",
{K4:a.j.prototype.K4});a.j.prototype.length=void 0;a.b.g("Collection.prototype.length",{length:a.j.prototype.length});a.j.prototype.M4=void 0;a.b.g("Collection.prototype.models",{M4:a.j.prototype.M4});a.j.prototype.Xb=[];a.j.prototype.url=null;a.b.g("Collection.prototype.url",{url:a.j.prototype.url});a.j.prototype.Jo=[];a.b.g("Collection.prototype.changes",{Jo:a.j.prototype.Jo});a.j.prototype.Hj=null;a.b.g("Collection.prototype.customURL",{Hj:a.j.prototype.Hj});a.j.prototype.A2=null;a.b.g("Collection.prototype.customPagingOptions",
{A2:a.j.prototype.A2});a.j.prototype.r4=void 0;a.b.g("Collection.prototype.lastFetchSize",{r4:a.j.prototype.r4});a.j.prototype.T3=!1;a.b.g("Collection.prototype.hasMore",{T3:a.j.prototype.T3});a.j.prototype.Y5=void 0;a.b.g("Collection.prototype.totalResults",{Y5:a.j.prototype.Y5});a.j.prototype.q4=void 0;a.b.g("Collection.prototype.lastFetchCount",{q4:a.j.prototype.q4});a.j.prototype.L4=-1;a.b.g("Collection.prototype.modelLimit",{L4:a.j.prototype.L4});a.j.prototype.offset=void 0;a.b.g("Collection.prototype.offset",
{offset:a.j.prototype.offset});a.j.prototype.I2=-1;a.b.g("Collection.prototype.fetchSize",{I2:a.j.prototype.I2});a.j.prototype.jP=1;a.b.g("Collection.prototype.sortDirection",{jP:a.j.prototype.jP});a.j.prototype.kN=null;a.b.g("Collection.prototype.comparator",{kN:a.j.prototype.kN});a.j.prototype.Init=function(){a.j.r.Init.call(this)};a.j.extend=function(b,d){a.j.lx=!0;var c=new a.j;a.j.lx=!1;f.extend(c,this.prototype);var e;e=b&&b.constructor&&b.hasOwnProperty("constructor")?b.constructor:function(d,
c){a.j._init(this,d,c,b)};if(d)for(var g in d)d.hasOwnProperty(g)&&(e[g]=d[g]);if(b)for(g in b)b.hasOwnProperty(g)&&(c[g]=b[g]);f.extend(e,this);e.prototype=c;e.extend=a.j.extend;return e.prototype.constructor=e};o_("Collection.extend",a.j.extend,a);a.j._init=function(b,d,c,e){var g,f;b.Init();a.Y.CF(b);if(e)for(g in e)e.hasOwnProperty(g)&&(b[g]=e[g]);c=c||{};f=["comparator","customPagingOptions","customURL",a.j.Ld,"model","modelLimit","sortDirection","url"];for(g=0;g<f.length;g++)c.hasOwnProperty(f[g])&&
void 0!==c[f[g]]&&(b[f[g]]=c[f[g]]);void 0===b.wk(null)&&b.RE(-1);void 0===b.modelLimit&&b.dP(-1);b.hasMore=!1;b.Oi=0;b.Sq([],!0);c.parse&&(d=b.parse(d));if(null!=d)for(c.S4=!0,f=d instanceof Array?d:[d],g=0;g<f.length;g+=1)b.add(f[g],c);b.Lk();e&&e.initialize&&e.initialize.call(b,d,c)};a.j.prototype.on=function(){};a.j.prototype.vl=function(){};a.j.prototype.Kb=function(){};a.j.prototype.NV=function(b,d,c,e){this.Kb(e,a.Y.D.REQUEST,b,d,c)};a.j.prototype.Hka=function(){this.changes=[]};a.j.prototype.ML=
function(b,a){for(var c=b;c<b+a;c++)-1===this.changes.indexOf(c)&&(this.changes.push(c),this.changes.sort(function(b,a){return b-a}))};a.j.prototype.Sq=function(b,a){this.models=b;if(a)this.Xb=[],this.Hka();else for(var c=0;c<b.length;c++)b[c]&&this.Xb.push(c)};a.j.prototype.Ec=function(){return this.models};a.j.prototype.Xc=function(){return this.Ec().length};a.j.prototype.Via=function(b){return b<this.Xc()||this.Ya()&&(!this.Aq()||0===this.Xc())?!1:!0};a.j.prototype.Aq=function(){return a.j.Ml(this.totalResults)};
a.j.Ml=function(b){return null!=b};a.j.prototype.zja=function(b){this.Ec().push(b);this.Xb.push(this.Xc()-1);this.ML(this.Xc()-1,1)};a.j.prototype.Aja=function(b){this.IK(b);this.zja(b);this.Oi++;b.xv(this.Xc()-1)};a.j.prototype.YZ=function(b){if(b)for(var a=0;a<b.length;a++)b[a]&&this.Oi--};a.j.prototype.X0=function(b,a,c){for(var e=b;e<b+a;e++)this.C_(this.Pb(e));void 0===c?(this.YZ(this.Ec().splice(b,a)),this.W0(b,b+a-1)):(this.YZ(this.Ec().splice(b,a,c)),this.W0(b,b+a-1),this.nha(b),this.IK(c));
this.ML(b,a);0>this.Oi&&(this.Oi=0);this.XZ(b)};a.j.prototype.Pb=function(b){return this.Ec()[b]};a.j.prototype.XZ=function(b){for(var a,c=0;c<this.Xb.length;c++)a=this.Xb[c],a>=b&&this.Pb(a)&&this.Pb(a).xv(a)};a.j.prototype.C_=function(b){if(b){var a=b.VO;b=b.Zpa;a?a.IF(b):this.head=b;b?b.Fz(a):this.tail=a}};a.j.prototype.IK=function(b){b.IF(this.head);this.head?this.head.Fz(b):this.tail=b;b.Fz(null);this.head=b};a.j.prototype.zla=function(b){-1===this.Xb.indexOf(b)&&this.Xb.push(b)};a.j.prototype.nha=
function(b){for(var a=0;a<this.Xb.length;a++)this.Xb[a]>=b&&this.Xb[a]++;this.Xb.push(b)};a.j.prototype.W0=function(b,a){void 0===a&&(a=b);this.dU(b,a);for(var c=a-b+1,e=0;e<this.Xb.length;e++)this.Xb[e]>a&&(this.Xb[e]-=c)};a.j.prototype.dU=function(b,a){void 0===a&&(a=b);for(var c=b;c<=a;c++){var e=this.Xb.indexOf(b);-1<e&&this.Xb.splice(e,1)}};a.j.prototype.eD=function(b,a){var c=this.Pb(b);this.C_(c);c||this.Oi++;this.ML(b,1);if(this.Ec()[b]=a)this.zla(b),a.xv(b),this.IK(a)};a.j.prototype.cba=
function(b){var a=this.tail,c,e,g=0;for(this.tail=null;a&&g<b;)c=a.N6(),(e=this.Pb(c))&&e.$N()?(this.tail||(this.tail=a),a=a.VO):(this.Oi--,-1<c&&(this.eD(c,void 0),this.dU(c,c)),a.IF(null),a=a.Fz(null),g++);this.tail||(this.tail=a);0>this.Oi&&(this.Oi=0);0===this.Oi&&(this.tail=this.head=null)};a.j.prototype.Ux=function(){this.Oi=0;this.tail=this.head=null};a.j.prototype.Iq=function(b){if(this.Ya()){var a=this.GW();-1<a&&this.Oi+b>a&&this.cba(this.Oi+b-a)}};a.j.prototype.clone=function(){return this.hU(!0)};
a.b.g("Collection.prototype.clone",{clone:a.j.prototype.clone});a.j.prototype.hU=function(b){var a=new this.constructor,c;this.Ya()&&(a=this.vba(a),a.DL());a=this.wba(a);if(b){var e=[];for(b=0;b<this.Xb.length;b++)e.push(this.Xb[b]);e.sort(function(b,a){return b-a});var g;for(b=0;b<e.length;b++)g=e[b],(c=this.Hl(g,null,!0,!1))&&a.Fl(c.clone(),{at:g},!0,!1)}return a};a.j.prototype.wba=function(b){var a=["comparator","model","modelId"],c,e;for(e=0;e<a.length;e++)c=a[e],b[c]=this[c];return b};a.j.prototype.vba=
function(b){var d=["totalResults","hasMore",a.j.Ld],c,e;for(e=0;e<d.length;e++)c=d[e],b[c]=this[c];return b};a.j.prototype.fe=function(){return this.length};a.j.prototype.Lk=function(){var b=this.Xc();this.length=b;this.Ya()||(this.totalResults=b)};a.j.ZH=function(b,a,c){return b.model?f.isFunction(b.model)?new b.model(a,c):new b.model.constructor(a,c):null};a.j.prototype.xx=function(b,d,c){var e=null;d=d||{};d.vpa=c;b instanceof a.t?e=b:this.model?e=a.j.ZH(this,b,d):(d.collection=this,e=new a.t(b,
d));return d.validate&&e.validate&&(b=e.validate(e.attributes))?(d.validationError=b,this.Kb(!1,a.Y.D.INVALID,e,b,d),null):e};a.j.prototype.add=function(b,a){this.Iq(1);return this.Xw(this.Fl(b,a,!1,(a||{}).deferred))};a.b.g("Collection.prototype.add",{add:a.j.prototype.add});a.j.prototype.Fl=function(b,d,c,e){function g(b,e,g,f,h){var k,r=null;!p&&t&&g?(x=g.a7(e,b.comparator,n),r=g):(p||(k=b.BW(f))&&c&&m!==k.index&&a.q.warn("Duplicate ID fetched or added without merging, the id \x3d "+k.eg()),void 0===
k?(void 0===m?(b.Aja(f),s=b.Xc()-1,b.Pb(s).Ez()):(s=m,b.Ya()&&c?b.eD(s,f):b.X0(s,0,f),b.Pb(s).Ez(),m+=1),void 0===f.jv()&&f.wv(b),b.Lk(),b.Zha(f),u=!0,r=f):r=k);c&&(d=d||{},d.fillIn=!0);x&&void 0===k&&!v&&void 0===m&&1<b.fe()&&(-1<s&&(q=b.Pb(s).cid),e={},a.zc.Lf(e,d),e.add=!0,b.sort(e),-1<s&&(s=b.Ya()?-1:b.indexOf(b.HN(q),h)));u&&(d.at&&(d.index=s),f?(f.Kb(n,a.Y.D.ADD,f,b,d),w.push(f)):(g.Kb(n,a.Y.D.ADD,g,b,d),w.push(g)));return r}function f(b,e,h){u=!1;var q=b.xx(e,d,!1),k=null,m=null;if(null!=q){s=
-1;q.dk();k=e instanceof a.t?e:q;if(h)return p?new Promise(function(a){var d=g(b,k,void 0,q,h);y.push(d);a(d)}):b.Hh(k,{silent:!0},h,!0).then(function(a){m=a.m;a=g(b,k,m,q,h);y.push(a)});!p&&t&&(m=c?b.BW(k):b.get(k));(e=g(b,k,m,q,h))&&y.push(e)}else y.push(!1)}function k(b,a){return b.parse&&d.parse&&!d.S4?b.parse(a):a}d=d||{};var l=[],m=d.at,n=d.silent,p=d.force,r,s,q,t=d.merge||!1,v=d.sort,x=!0,u=!1,w=[],y=[];void 0!==m&&0>m&&(m+=this.fe()+1);b instanceof Array?l=b:l.push(b);if(!c&&(this.Ya()||
e)){var F=this;return new Promise(function(b,c){function e(b){return new Promise(function(a,d){f(F,l[b],!0).then(function(){a(b+1)},d)})}var g=Promise.resolve(0);l=k(F,l);for(r=0;r<l.length;r++)g=g.then(e);g.then(function(){0<w.length&&F.Kb(d.silent,a.Y.D.ALLADDED,F,w,d);b(a.j.FL(y))},c)})}l=k(this,l);for(r=0;r<l.length;r++)f(this,l[r],!1);0<w.length&&this.Kb(d.silent,a.Y.D.ALLADDED,this,w,d);return a.j.FL(y)};a.j.FL=function(b){return 1===b.length?b[0]:b};a.j.prototype.gC=function(){return a.j.Ml(this.comparator)};
a.j.prototype.sort=function(b){b=b||{};var d=b.silent,c=this.comparator,e;if(!this.gC())return null;if(this.Ya()){var g=this.totalResults;this.Aq()?this.Sq(Array(g),!0):(this.Sq([],!0),this.Ux(),this.Lk());g=b.add?{add:!0}:null;this.Kb(d,a.Y.D.SORT,this,g,null);d=b.startIndex;return void 0!==d&&null!==d?this.nz(d,this.wk(b)):null}e=this;this.Ec().sort(function(b,d){return a.j.DQ(b,d,c,e,e)});this.XZ(0);g=b.add?{add:!0}:null;this.Kb(d,a.Y.D.SORT,this,g,null);return null};a.b.g("Collection.prototype.sort",
{sort:a.j.prototype.sort});a.j.Xn=function(b,d){return b instanceof a.t?b.get(d):a.t.dn(b,d)};a.j.DQ=function(b,d,c,e,g){var h,k,l;if(f.isFunction(c)){if(1===c.length){h=c.call(g,b);k=c.call(g,d);h=a.Ea.qd(h)?h.split(","):[h];var m=a.Ea.qd(k)?k.split(","):[k];for(l=0;l<h.length;l++)if(k=a.j.Jl(h[l],m[l],e.sortDirection),0!==k)return k}return c.call(g,b,d)}if(a.Ea.qd(c))for(c=c.split(","),l=0;l<c.length;l++)if(h=a.j.Xn(b,c[l]),k=a.j.Xn(d,c[l]),k=a.j.Jl(h,k,e.sortDirection),0!==k)return k;return 0};
a.j.prototype.M5=function(b,d){var c=d?d:this.comparator,e;if(!c)return-1;this.Jf("sortedIndex");e=this;return a.j.qda(this.Ec(),b,function(b,d){var k,l;if(f.isFunction(c)){if(1===c.length){k=c.call(e,b);l=c.call(e,d);k=a.Ea.qd(k)?k.split(","):[k];l=a.Ea.qd(l)?l.split(","):[l];var m,n;for(n=0;n<k.length;n++)if(m=a.j.Jl(k[n],l[n],e.sortDirection),0!==m)return m}return c.call(e,b,d)}return a.Ea.qd(c)?(k=b.get(c),l=d.get(c),a.j.Jl(k,l,e.sortDirection)):0})};a.b.g("Collection.prototype.sortedIndex",{M5:a.j.prototype.M5});
a.j.qda=function(b,a,c){function e(g,f){var k,l;if(g>f)return-1;k=a.tp();l=a.eg();if(b[g].yp(l,k))return g;if(b[f].yp(l,k))return f;k=Math.floor((f+g)/2);return-1===c(b[k],a)?e(g+1,k):1===c(b[k],a)?e(k,f-1):k}return e(0,b.length-1)};a.j.Jl=function(b,a,c){if(-1===c){if(b<a)return 1;if(a<b)return-1}else{if(b>a)return 1;if(a>b)return-1}return 0};a.j.prototype.unshift=function(b,d){var c={};a.zc.Lf(c,d||{});c.at||(c.at=0);this.Iq(1);return this.Xw(this.Fl(b,c,!1,c.deferred))};a.b.g("Collection.prototype.unshift",
{unshift:a.j.prototype.unshift});a.j.prototype.Xw=function(b){return f.isFunction(b.then)?this.ce(function(){return b}):b};a.j.prototype.shift=function(b){b=b||{};var d=this.Df(b),c;if(this.Ya()||d){var e=this;return this.at(0,b).then(function(d){c=e.Qq(d,0,b);e.Kb(b.silent,a.Y.D.ALLREMOVED,e,[c],b);return c})}c=this.Qq(this.at(0),0,b);this.Kb(b.silent,a.Y.D.ALLREMOVED,this,[c],b);return c};a.b.g("Collection.prototype.shift",{shift:a.j.prototype.shift});a.j.prototype.qE=function(b){void 0===b&&(b=
1);this.Jf("initial");var a=[],c;for(c=0;c<this.fe()-b;c+=1)a.push(this.at(c));return a};a.b.g("Collection.prototype.initial",{qE:a.j.prototype.qE});a.j.prototype.Df=function(b){return(b||{}).deferred};a.j.prototype.last=function(b,a){var c=this.Df(a);void 0===b&&(b=1);if(1===b){var e=this.Xc();0===e&&(e=b);return 0<e?this.at(e-1,c):null}var g=[],e=this.fe();if(c||this.Ya()){var f=e-b;0>f&&(f=0);0===e&&(e=b);var k=this;return this.ce(function(){return k.Yr(f,e)})}for(c=e-b;c<e;c+=1)g.push(this.at(c));
return g};a.b.g("Collection.prototype.last",{last:a.j.prototype.last});a.j.prototype.Yr=function(b,a){var c=[],e,g=this;return new Promise(function(f,k){function l(b){return new Promise(function(a,d){g.jI(b,null).then(function(d){c.push(d);a(b+1)},d)})}var m=Promise.resolve(b);for(e=b;e<a;e++)m=m.then(l);m.then(function(){f(c)},k)})};a.j.prototype.jW=function(b){return void 0===b||null===b?this[a.j.Ld]:b};a.j.prototype.Laa=function(){var b=this.lastFetchCount;if(void 0===b||null===b)b=this[a.j.Ld];
return void 0===this.offset||null===this.offset?b:this.offset+b};a.j.prototype.next=function(b,d){d=d||{};d[a.j.Ld]=this.jW(b);var c=this.Laa(),e=this.fe();if(0===e&&0<d[a.j.Ld])c=0;else if(c>=e)return d.success&&d.success.call(a.t.$i(d,this),this,null,d),null;d.startIndex=c;return this.fetch(d)};a.b.g("Collection.prototype.next",{next:a.j.prototype.next});a.j.prototype.Maa=function(b){return void 0===this.offset||null===this.offset?0:this.offset-b};a.j.prototype.Qm=function(b,d){d=d||{};if(0===this.offset)return d.success&&
this.lastFetchCount&&d.success.call(a.t.$i(d,this),this,null,d),null;d[a.j.Ld]=this.jW(b);var c=this.Maa(d[a.j.Ld]);0>c&&(d[a.j.Ld]=this.offset,c=0);d.startIndex=c;return this.fetch(d)};a.b.g("Collection.prototype.previous",{Qm:a.j.prototype.Qm});a.j.prototype.dP=function(b){this.modelLimit=b;this.Iq(0)};a.b.g("Collection.prototype.setModelLimit",{dP:a.j.prototype.dP});a.j.prototype.GW=function(){return this.modelLimit};a.j.prototype.RE=function(b){this[a.j.Ld]=b};a.b.g("Collection.prototype.setFetchSize",
{RE:a.j.prototype.RE});a.j.prototype.r5=function(b,a){var c=this.Df(a);void 0===b&&(b=1);var e=[];if(this.Ya()||c){var g=this;return this.ce(function(){return g.Yr(b,g.fe())})}for(c=b;c<this.fe();c+=1)e.push(this.at(c));return e};a.b.g("Collection.prototype.rest",{r5:a.j.prototype.r5});a.j.prototype.remove=function(b,d){d=d||{};var c=[],e;b instanceof Array?c=b:c.push(b);var g=[];for(e=c.length-1;0<=e;e-=1)g.unshift(this.Qq(c[e],-1,d));this.Kb(d.silent,a.Y.D.ALLREMOVED,this,c,d);return a.j.FL(g)};
a.b.g("Collection.prototype.remove",{remove:a.j.prototype.remove});a.j.prototype.Qq=function(b,d,c){c=c||{};b=-1==d?this.Hh(b):a.j.Ul(d,b);var e=c.silent;d=b.index;if(-1<d){var g=b.m;void 0!==g&&g.jv()===this&&g.wv(null);this.X0(d,1);this.Lk();var f={};a.zc.Lf(f,c);f.index=d;void 0!==g&&g.Kb(e,a.Y.D.REMOVE,g,this,f);this.A1(g)}return b.m};a.j.prototype.A1=function(b){void 0!==b&&b.off(null,null,this)};a.j.prototype.Zha=function(b){b.vl(a.Y.D.ALL,this.uia,this,!1,!0)};a.j.prototype.uia=function(b,
d,c,e){b===a.Y.D.DESTROY&&this.remove(d);void 0!==c&&c instanceof a.j&&c!==this||(Array.prototype.slice.call(arguments),this.Kb(e&&e.silent,b,d,c,e))};a.j.prototype.refresh=function(b){b=b||{};var d=this;return this.ce(function(){return new Promise(function(c,e){if(!d.Ya()){var g=void 0!==b.silent&&b.silent;try{d.reset(null,{silent:!0});var f={},k;for(k in b)b.hasOwnProperty(k)&&(f[k]=b[k]);f.success=function(b,e,f){d.Kb(g,a.Y.D.REFRESH,d,f,null);c({collection:b,response:e,options:f})};f.error=function(c,
g,f){e(a.j.vw(c,g,f,d,b))};d.fetch(f);return}catch(l){if(l instanceof a.nn){d.Kb(g,a.Y.D.REFRESH,d,b,null);c({collection:d,options:b});return}throw l;}}f=b.startIndex;d.Sq([],!0);d.Ux();d.totalResults=void 0;d.Lk();g=void 0!==b.silent&&b.silent;d.Kb(g,a.Y.D.REFRESH,d,b,null);if(void 0===f||null===f)f=0;void 0!==f&&null!==f?d.y0(f,d.wk(b)).then(function(b){c(b)},function(b){e(b)}):c(void 0)})})};a.b.g("Collection.prototype.refresh",{refresh:a.j.prototype.refresh});a.j.prototype.reset=function(b,d){var c=
{};a.zc.Lf(c,d||{});c.previousModels=this.Ec();for(var e,g=0;g<this.Xb.length;g++)if(e=this.Xb[g],e=this.Pb(e))this.A1(e),e.wv(null);this.Sq([],!0);this.Ux();g=void 0!==c.silent&&c.silent;if(!b)return this.totalResults=void 0,this.Lk(),this.Kb(g,a.Y.D.RESET,this,c,null),null;e=null;c.parse&&(b=this.parse(b));this.Iq(b instanceof Array?b.length:1);c.S4=!0;e=this.Fl(b,c,!0,!1);this.Lk();this.Kb(g,a.Y.D.RESET,this,c,null);return this.Xw(e)};a.b.g("Collection.prototype.reset",{reset:a.j.prototype.reset});
a.j.prototype.at=function(b,a){return this.Hl(b,a,!1,this.Df(a))};a.b.g("Collection.prototype.at",{at:a.j.prototype.at});a.j.prototype.Hl=function(b,a,c,e){0>b&&(b+=this.fe());if(0>b||this.Via(b))return c||!this.Ya()&&!e?null:this.ce(function(){return Promise.resolve(null)});var g=this;return c||!this.Ya()&&!e?this.Pb(b):this.ce(function(){return g.jI(b,a)})};a.j.prototype.whenReady=function(){return this.to?this.to:Promise.resolve()};a.b.g("Collection.prototype.whenReady",{whenReady:a.j.prototype.whenReady});
a.j.prototype.ce=function(b){var d=this;void 0===this.to&&(this.Gx=0,this.to=Promise.resolve());this.Gx++;return this.to=this.to.then(b.bind(d)).then(function(b){d.Gx--;0===d.Gx&&(d.to=void 0,d.Kb(!1,a.Y.D.READY,d,null,null));return b},function(b){d.Gx--;0===d.Gx&&(d.to=void 0);return Promise.reject(b)})};a.j.prototype.jI=function(b,d){var c=this,e=c.Pb(b);return void 0===e?new Promise(function(e,f){var k={};a.zc.Lf(k,d||{});k.context=c;k.startIndex=b;k.error=function(b,e,g){f(a.j.vw(b,e,g,c,d))};
k.success=function(){e(c.Pb(b))};c.Ie(k,-1,!1)}):new Promise(function(b){b(e)})};a.j.prototype.HN=function(b){for(var a=this.Ec(),c,e=null,g=0;g<this.Xb.length;g++)if(c=this.Xb[g],a[c]&&b===a[c].cid){e=a[c];break}if(e)return e;if(this.Ya())throw Error("Not found locally and not supported by server for virtual collections");return null};a.b.g("Collection.prototype.getByCid",{HN:a.j.prototype.HN});a.j.prototype.get=function(b,a){var c=this.Hh(b,a,this.Df(a));if(c){if(f.isFunction(c.then))return this.ce(function(){return new Promise(function(b,
a){c.then(function(a){b(a.m)},function(b){a(b)})})});if(this.Ya())return this.ce(function(){return new Promise(function(b){b(c.m)})});if(c.hasOwnProperty("m"))return c.m}return null};a.b.g("Collection.prototype.get",{get:a.j.prototype.get});a.j.prototype.BW=function(b){return(b=this.DW(b))?b.m:null};a.j.prototype.DW=function(b){var d=b;b instanceof a.t?(d=b.tp(),b=b.eg()):a.j.Ml(b)&&void 0!==b.id&&(b=b.id);for(var c=null,e=this.Xb.length,g,f=this.Ec(),k,l=0;l<e;l++)if(k=this.Xb[l],g=f[k],void 0!==
g&&g.yp(b,d)){c=a.j.Ul(k,g);break}return c?c:a.j.Ul(-1,void 0)};a.j.prototype.Hh=function(b,d,c,e){var g=b;void 0===e&&(e=!1);b instanceof a.t?(g=b.tp(),b=b.eg()):a.j.Ml(b)&&void 0!==b.id&&(b=b.id);for(var f=null,k=this.Ec(),l,m=0;m<this.Xb.length;m++)if(l=this.Xb[m],k[l]&&k[l].yp(b,g)){f=a.j.Ul(l,k[l]);break}if(f)return c?new Promise(function(b){b(f)}):f;if(this.Ya()){if(void 0===b&&void 0!==g)return new Promise(function(b){b(a.j.Ul(-1,void 0))});var n=this;return new Promise(function(c,f){var h=
{};a.zc.Lf(h,d||{});h.context=n;h.startID=b;h.error=function(b,c,e){f(a.j.vw(b,c,e,n,d))};h.success=function(d,e){if(null!=e){var f=n.rJ(),h=n.Pb(f);void 0!==h&&h.yp(b,g)?c(a.j.Ul(f,h)):c(a.j.Ul(-1,void 0))}else c(a.j.Ul(-1,void 0))};n.Ie(h,-1,e)})}var p=a.j.Ul(-1,void 0);return c?new Promise(function(b){b(p)}):p};a.j.Ul=function(b,a){return{index:b,m:a}};a.j.prototype.parse=function(b){var a;if(b instanceof Array||!b)return b;for(a in b)if(b.hasOwnProperty(a)&&b[a]instanceof Array)return b[a];return b};
a.j.prototype.Qaa=function(b,a,c){return this.Aq()&&0<this.totalResults&&c.start+c.count>=this.totalResults?!0:c.start===b&&c.count===a};a.j.prototype.nz=function(b,a){var c=this;return this.ce(function(){return c.y0(b,a)})};a.b.g("Collection.prototype.setRangeLocal",{nz:a.j.prototype.nz});a.j.prototype.y0=function(b,a){this.Ya()&&this.DL();var c=this.QB(b,a),e=this;if(this.Qaa(b,a,c))return new Promise(function(b){b(c)});var g=this.GW();-1<g&&g<a&&(this.modelLimit=a);return new Promise(function(c,
g){e.x0(b,a,-1,{start:b,count:a},c,g,!0)})};a.j.prototype.x0=function(b,d,c,e,g,f,k){var l=this,m=b+d;this[a.j.Ld]&&this[a.j.Ld]>d&&(m=this[a.j.Ld]+b);var n=null;this.Ya()?(n=this.oW(b,m),n>b&&(b=n,m=b+d,this[a.j.Ld]&&this[a.j.Ld]>d&&(m=this[a.j.Ld]+b)),n={context:this,startIndex:b,fetchSize:m-b}):n={context:this};n.error=function(b,d,c){f(a.j.vw(b,d,c,l,null))};n.success=function(){var a=l.QB(e.start,e.count);if(k&&l.Aq()&&a.count<e.count){var c=a.start+a.count,q=b+d;q<l.totalResults?l.x0(q,d,c,
e,g,f,k):g(a)}else g(a)};try{this.Ie(n,c,-1<c)}catch(p){p instanceof a.nn&&(c=l.QB(b,d),g(c))}};a.j.vw=function(b,d,c,e,g){var f=!1;g&&g.silent&&(f=g.silent);a.t.ky(e,f,g,d,c,b);g=Error(d);g.xhr=b;g.error=c;g.collection=e;g.status=d;return g};a.j.prototype.vea=function(b,a){var c=this.Xc();return 0===c?b+a:b+a>c?c:b+a};a.j.prototype.m4=function(b,a){var c=this.QB(b,a);return 0===this.Xc()?0===a:b===c.start&&(a===c.count||b+a>this.Xc())};a.b.g("Collection.prototype.isRangeLocal",{m4:a.j.prototype.m4});
a.j.prototype.Rw=function(b,a){for(var c=[],e=this.Ec(),g=b+a,f=b;f<g;f++)c.push(e[f]);return c};a.j.prototype.QB=function(b,a){if(!this.Ya()){if(0<this.Xc()){if(b+a>this.Xc()){var c=this.Xc()-b;return{start:b,count:c,models:this.Rw(b,c)}}return{start:b,count:a,models:this.Rw(b,a)}}return{start:b,count:0,models:[]}}c=this.vea(b,a);if(!this.Aq()&&c<b+a)return{start:b,count:c-b,models:this.Rw(b,c-b)};if(0===c)return{start:b,count:0,models:[]};var e=this.oW(b,c);if(-1<e)return{start:b,count:e-b,models:this.Rw(b,
e-b)};b>c?a=0:b+a>c&&(a=c-b);return{start:b,count:a,models:this.Rw(b,a)}};a.j.prototype.oW=function(b,a){for(var c=b;c<a;c++)if(void 0===this.Pb(c))return c;return-1};a.j.prototype.fetch=function(b){var a=this.Ie(b,-1,!1);this.ce(function(){return Promise.resolve(a)});return a};a.b.g("Collection.prototype.fetch",{fetch:a.j.prototype.fetch});a.j.prototype.Ie=function(b,d,c){function e(b,a,d){b.Ya()?d||b.DL():a.add||a.xP||b.reset(null,{silent:!0})}var g=b||{},f=g.success,k,l=g.error;g.set&&(g.xP=g.set?
!0:!1);void 0===g.parse&&(g.parse=!0);k=this;g.error=function(d,c,e){a.t.ky(k,!1,b,c,e,d);l&&l.call(a.t.$i(b,k),d,c,e)};g.success=function(m){var n;try{n=k.parse(m,b)}catch(p){a.j.XC(k,p,g.error,b);return}k.u0(m,b,n,c);var r=null;if(g.add||k.model){e(k,g,c);try{q=!1,-1===d&&(q=!0,d=k.rJ()),r=k.oda(n,d,q,g)}catch(l){a.j.XC(k,l,g.error,b);return}}else if(!c)if(k.Ya()){e(k,g,c);var q=!1;-1===d&&(q=!0,d=k.rJ());r=k.Bja(n,d,q)}else g.xP?k.QL(n,!1,g,!1):k.reset(n,{silent:!0});k.Ya()&&r&&(k.lastFetchCount=
r.length);k.Kb(g.silent?!0:!1,a.Y.D.SYNC,k,m,g);f&&f.call(a.t.$i(b,k),k,m,g)};return this.BV(g)};a.j.prototype.Bja=function(b,a,c){var e;if(b){e=b instanceof Array?b:[b];b={};c&&this.Iq(e.length);c=this.Ya();for(var g=null,f=0;f<e.length;f+=1)c&&(b={at:a},g=this.Hl(a,null,!0,!1)),b.silent=!0,this.Fl(e[f],b,!0,!1),this.Hl(a,null,!0,!1)!==g&&a++}return e};a.j.prototype.oda=function(b,d,c,e){e=e||{};var g=e.parse,f=a.j.ZH(this);if(b){var k=b instanceof Array?b:[b];b={};c&&this.Iq(k.length);c=this.Ya();
if(e.xP&&!c){for(var l=0;l<k.length;l+=1)d=f&&g?f.parse(k[l]):k[l],k[l]=d;this.QL(k,!1,e,!1)}else{e=null;for(var m=d,l=0;l<k.length;l+=1)d=f&&g?f.parse(k[l]):k[l],c&&(b={at:m},e=this.Hl(m,b,!0,!1)),b.silent=!0,this.Fl(d,b,!0,!1),this.Hl(m,null,!0,!1)!==e&&m++}}return k};a.j.XC=function(b,d,c,e){a.q.error(d.toString());c&&c.call(a.t.$i(e,b),b,d,e)};a.j.prototype.lda=function(b){var d=b||{},c=d.success,e,g;void 0===d.parse&&(d.parse=!0);g=this;d.success=function(f){var k,l,m=null,n=[];try{k=g.parse(f,
b)}catch(p){a.j.XC(g,p,d.error,b);return}if(d.add||g.model)if(l=a.j.ZH(g),k)for(m=k instanceof Array?k:[k],k=0;k<m.length;k+=1){if(l&&d.parse)try{e=l.parse(m[k])}catch(r){a.j.XC(g,r,d.error,b);return}else e=m[k];n.push(g.xx(e))}g.Kb(!1,a.Y.D.SYNC,g,f,d);c&&c.call(a.t.$i(b,g),g,n,d)};this.BV(d)};a.j.prototype.BV=function(b){try{return a.t.dx("read",this,b)}catch(d){throw a.t.ky(this,!1,b,null,d,null),d;}};a.j.prototype.DL=function(){var b=this.totalResults;void 0!==b&&this.Xc()!==b&&(this.Sq(Array(b),
!0),this.Ux(),this.Lk())};a.j.prototype.wk=function(b){b=b||{};return b[a.j.Ld]||this[a.j.Ld]};a.j.prototype.Ya=function(){return-1<this.wk(null)};a.j.prototype.XB=function(b,d,c,e,g){b=parseInt(a.j.WB(b,d,c),10);return void 0===b||null===b||isNaN(b)?e?e:g:b};a.j.prototype.YT=function(b){return-1===b?void 0:b};a.j.prototype.u0=function(b,d,c,e){var g={};this.customPagingOptions&&((g=this.customPagingOptions.call(this,b))||(g={}));d=d||{};this.lastFetchSize=this.XB(g,b,"limit",d.fetchSize,this.fetchSize);
this.offset=this.XB(g,b,"offset",d.startIndex,0);this.lastFetchCount=this.XB(g,b,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=this.YT(this.XB(g,b,"totalResults",this.totalResults,this.totalResults));this.hasMore=this.hea(a.j.WB(g,b,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);e||(this.totalResults=this.Q$(this.YT(parseInt(a.j.WB(g,b,"totalResults"),10)),this.hasMore,this.offset,parseInt(a.j.WB(g,b,"count"),10),c&&Array.isArray(c)?c.length:0));!this.Ya()&&this.totalResults&&
this.totalResults!==this.lastFetchCount&&this.lastFetchSize&&this.RE(this.lastFetchSize)};a.j.prototype.Q$=function(b,a,c,e,g){return!a&&isNaN(b)?(isNaN(e)?g:e)+c:this.totalResults};a.j.prototype.hea=function(b,d,c,e){return a.j.Ml(b)?b:void 0===e||null===e?!0:d+c>e?!1:!0};a.j.WB=function(a,d,c){return a.hasOwnProperty(c)?a[c]:d?d[c]:void 0};a.j.prototype.rJ=function(){return a.j.Ml(this.offset)?this.offset:0};a.j.prototype.create=function(b,d){function c(d,c){d.save(b instanceof a.t?null:b,c);return d}
function e(a,b){if(d.wait){if(g.Ya()||f)return g.ce(function(){return Promise.resolve(void 0)})}else return g.add(a,b)}var g=this;d=d||{};var f=this.Df(d),k=this.xx(b,d,!1),l=d.success,m=d.context;d.context=this;d.success=function(a,b,c){c.xhr&&(d.xhr=c.xhr);d.wait&&g.add(k,d);l&&l.call(null!=m?m:g,a,b,d)};if(null==k)return!1;d.forceNew=null!=k.eg();var n=a.t.dq(d);k.wv(this);if(f||this.Ya())return new Promise(function(a){n.merge=!0;n.deferred=!0;e(k,n).then(function(){d.success=function(b,c,e){e.xhr&&
(d.xhr=e.xhr);d.wait?(g.Ya()&&(n.force=!0),g.add(k,n).then(function(){l&&l.call(null!=m?m:g,b,c,d);a(b)})):(l&&l.call(null!=m?m:g,b,c,d),a(b))};var b=c(k,d);b||a(b)})});n.merge=!0;e(k,n);return c(k,d)};a.b.g("Collection.prototype.create",{create:a.j.prototype.create});a.j.prototype.d5=function(a){var d=[],c;this.Jf("pluck");for(c=0;c<this.fe();c+=1)d.push(this.at(c).get(a));return d};a.b.g("Collection.prototype.pluck",{d5:a.j.prototype.d5});a.j.prototype.p6=function(a,d){return this.Xw(this.ry(a,
d))};a.b.g("Collection.prototype.where",{p6:a.j.prototype.p6});a.j.prototype.ry=function(b,d){d=d||{};var c=this.Df(d),e=this;if(this.Ya())return new Promise(function(c,g){e.lda({query:b,all:!0,success:function(a,b){c(b)},error:function(b,c,f){g(a.j.vw(b,c,f,e,d))}})});var g=[],f,k;for(f=0;f<this.fe();f+=1)k=this.at(f),k.z6(b)&&g.push(k);return c?new Promise(function(a){a(g)}):g};a.j.prototype.q6=function(b,d){d=d||{};var c=this.Df(d),e=this;if(this.Ya()||c)return e.ce(function(){return new Promise(function(a,
c){return e.ry(b,d).then(function(b){b=e.eZ(b);a(b)},function(a){c(a)})})});c=this.ry(b,d);c=this.eZ(c);c[a.j.Ld]=-1;c.Lk();return c};a.b.g("Collection.prototype.whereToCollection",{q6:a.j.prototype.q6});a.j.prototype.eZ=function(a){var d=this.hU(!1);d.Sq(a,!1);d.Ux();d.Lk();return d};a.j.prototype.Jf=function(a){if(this.Ya())throw Error(a+" not valid on a virtual Collection");};a.j.prototype.map=function(a,d){var c=[],e;this.Jf("map");this.Ec().forEach(function(g){e=a.call(d||this,g);c.push(e)});
return c};a.b.g("Collection.prototype.map",{map:a.j.prototype.map});a.j.prototype.each=function(a,d){this.Jf("each");this.Ec().forEach(a,d)};a.b.g("Collection.prototype.each",{each:a.j.prototype.each});a.j.prototype.size=function(){return this.fe()};a.b.g("Collection.prototype.size",{size:a.j.prototype.size});a.j.prototype.K5=function(b,d){var c=[],e;this.Jf("sortBy");this.Ec().forEach(function(a){c.push(a)});e=this;c.sort(function(c,h){var k,l;if(f.isFunction(b))return k=b.call(d||e,c),l=b.call(d||
e,h),a.j.Jl(k,l,e.sortDirection);k=c.get(b);l=h.get(b);return a.j.Jl(k,l,e.sortDirection)});return c};a.b.g("Collection.prototype.sortBy",{K5:a.j.prototype.K5});a.j.prototype.P3=function(a,d){var c={},e;this.Jf("groupBy");this.Ec().forEach(function(g){e=f.isFunction(a)?a.call(d||this,g):g.get(a);void 0===c[e]&&(c[e]=[]);c[e].push(g)},this);return c};a.b.g("Collection.prototype.groupBy",{P3:a.j.prototype.P3});a.j.prototype.b4=function(a,d){var c={},e;this.Jf("indexBy");this.Ec().forEach(function(g){e=
f.isFunction(a)?a.call(d||this,g):g.get(a);c[e]=g},this);return c};a.b.g("Collection.prototype.indexBy",{b4:a.j.prototype.b4});a.j.prototype.min=function(a,d){var c={},e,g;this.Jf("min");if(0==this.Xc())return null;c=this.Pb(0);e=a.call(d||this,this.Pb(0));this.Ec().forEach(function(f,k){1<=k&&(g=a.call(d||this,f),g<e&&(c=f,e=g))},this);return c};a.b.g("Collection.prototype.min",{min:a.j.prototype.min});a.j.prototype.max=function(a,d){var c={},e,g;this.Jf("max");if(0==this.Xc())return null;c=this.Pb(0);
e=a.call(d,this.Pb(0));this.Ec().forEach(function(f,k){1<=k&&(g=a.call(d||this,f),g>e&&(c=f,e=g))},this);return c};a.b.g("Collection.prototype.max",{max:a.j.prototype.max});a.j.prototype.filter=function(a,d){var c=[];this.Jf("filter");this.Ec().forEach(function(e){a.call(d||this,e)&&c.push(e)});return c};a.b.g("Collection.prototype.filter",{filter:a.j.prototype.filter});a.j.prototype.r6=function(a){var d=[],c,e,g,f;this.Jf("without");for(var k,l=0;l<this.Ec().length;l++){f=!0;k=this.Pb(l);for(c=0;c<
arguments.length;c+=1)if(g=arguments[c].tp(),e=arguments[c].eg(),k.yp(e,g)){f=!1;break}f&&d.push(k)}return d};a.b.g("Collection.prototype.without",{r6:a.j.prototype.r6});a.j.prototype.D2=function(a){var d=[],c,e,g,f,k;this.Jf("difference");for(var l,m=0;m<this.Ec().length;m++){k=!0;l=this.Pb(m);for(c=0;c<arguments.length;c+=1){for(e=0;e<arguments[c].length;e++)if(f=arguments[c][e].tp(),g=arguments[c][e].eg(),l.yp(g,f)){k=!1;break}if(!k)break}k&&d.push(l)}return d};a.b.g("Collection.prototype.difference",
{D2:a.j.prototype.D2});a.j.prototype.ph=function(){return 0===this.fe()};a.b.g("Collection.prototype.isEmpty",{ph:a.j.prototype.ph});a.j.prototype.R1=function(a,d){this.Jf("any");for(var c,e=0;e<this.Xc();e+=1)if(c=this.Pb(e),a.call(d||this,c))return!0;return!1};a.b.g("Collection.prototype.any",{R1:a.j.prototype.R1});a.j.prototype.J2=function(a,d){var c=this.Df(d),e=this;if(this.Ya()||c)return this.ce(function(){return new Promise(function(c){e.ry(a,d).then(function(a){a&&0<a.length&&c(a[0]);c(null)})})});
c=this.ry(a,d);return 0<c.length?c[0]:null};a.b.g("Collection.prototype.findWhere",{J2:a.j.prototype.J2});a.j.prototype.slice=function(a,d,c){var e=this.Df(c);c=[];if(void 0===d){if(this.Ya()&&!this.Aq())throw Error("End must be set for virtual collections with no totalResults");d=this.Xc()}if(e||this.Ya()){var g=this;return this.ce(function(){return g.Yr(a,d)})}for(e=a;e<d;e+=1)c.push(this.Pb(e));return c};a.b.g("Collection.prototype.slice",{slice:a.j.prototype.slice});a.j.prototype.set=function(a,
d){return this.QL(a,!0,d,this.Df(d)||this.Ya())};a.b.g("Collection.prototype.set",{set:a.j.prototype.set});a.j.s_=function(a,d,c,e,g){if(c)for(c=d.length-1;0<=c;c-=1)-1==e.indexOf(c)&&a.Qq(d[c],c,g)};a.j.prototype.jma=function(a,d,c,e){if(this.gC()||!c||!e)return{index:a,oP:!1};c=this.Xc();if(a>=c||d>=c)return{index:a,oP:!1};c=this.Pb(a);e=this.Pb(d);this.eD(a,e);e.xv(a);this.eD(d,c);c.xv(d);return{index:d,oP:d!==a}};a.j.prototype.QL=function(b,d,c,e){c=c||{};var g=void 0===c.add?!0:c.add,f=void 0===
c.remove?!0:c.remove,k=void 0===c.merge?!0:c.merge,l=[],m=null,n;d&&(b=this.parse(b));n=Array.isArray(b)?b:[b];if(e){var p=this;return this.ce(function(){return p.rca(n,p.Ec(),c,f,g,k)})}d=!1;for(b=0;b<n.length;b+=1)if(m=this.C1(this.xx(n[b],c,!0),g,k,e),-1!==m){var m=this.jma(m,b,f,g),r=m.index;m.oP&&(d=!0);-1===l.indexOf(r)&&l.push(r)}d&&this.Kb(c.silent,a.Y.D.SORT,this,c.add?{add:!0}:null,null);a.j.s_(this,this.Ec(),f,l,c)};a.j.prototype.rca=function(b,d,c,e,g,f){var k=[],l,m=this;return new Promise(function(n,
p){function r(a){return new Promise(function(d,e){m.C1(m.xx(b[a],c,!0),g,f,!0).then(function(b){-1!==b&&k.push(b);d(a+1)},e)})}var s=Promise.resolve(0);for(l=0;l<b.length;l+=1)s=s.then(r);s.then(function(){a.j.s_(m,d,e,k,c);n(void 0)},p)})};a.j.prototype.C1=function(a,d,c,e){function g(e,g,f){var h=g?g.index:-1;if(g&&g.m){if(c){var k={merge:c};if(f)return new Promise(function(d){e.Fl(a,k,!1,!0).then(function(){d(h)})});e.add(a,k)}}else if(d){if(f)return new Promise(function(d){e.Fl(a,k,!1,!0).then(function(){d(e.fe()-
1)})});e.add(a);h=e.fe()-1}return h}if(e||this.Ya()){var f=this;return new Promise(function(d){f.Hh(a,{silent:!0},e).then(function(a){g(f,a,!0).then(function(a){d(a)})})})}var k=this.Hh(a);return g(this,k,!1)};a.j.prototype.toJSON=function(){var a=[];this.Jf("toJSON");this.Ec().forEach(function(d){a.push(d.toJSON())});return a};a.b.g("Collection.prototype.toJSON",{toJSON:a.j.prototype.toJSON});a.j.prototype.first=function(a,d){var c=this.Df(d),e=this.fe(),g=[];a?e=a:a=1;c=this.Ya()||c;if(1===a){if(c){var f=
this;return this.ce(function(){return f.jI(0,null)})}return 0<this.Xc()?this.Pb(0):null}e>this.Xc()&&(!this.Ya()||this.Aq())&&(e=this.Xc());if(c)return f=this,this.ce(function(){return f.Yr(0,e)});for(c=0;c<e;c+=1)g.push(this.Pb(c));return g};a.b.g("Collection.prototype.first",{first:a.j.prototype.first});a.j.prototype.indexOf=function(a,d){var c=this.Df(d);if(this.Ya()||c){var e=this;return this.ce(function(){return e.Hh(a,null,!0).then(function(a){return a.index})})}return this.Hh(a).index};a.b.g("Collection.prototype.indexOf",
{indexOf:a.j.prototype.indexOf});a.j.prototype.contains=function(a,d){var c=this.Df(d);if(this.Ya()||c){var e=this;return this.ce(function(){return e.Hh(a,null,!0).then(function(a){return-1<a.index})})}return-1<this.Hh(a).index};a.b.g("Collection.prototype.contains",{contains:a.j.prototype.contains});a.j.prototype.a4=a.j.prototype.contains;a.b.g("Collection.prototype.include",{a4:a.j.prototype.a4});a.j.prototype.hia=function(a){a=this.DW(a);return void 0!==a?a.index:-1};a.j.prototype.pop=function(a){var d=
this.Df(a);if(this.Ya()||d){var c=this;return this.at(this.fe()-1,{deferred:d}).then(function(d){c.remove(d,a);return d})}d=this.at(this.fe()-1);this.remove(d,a);return d};a.b.g("Collection.prototype.pop",{pop:a.j.prototype.pop});a.j.prototype.push=function(a,d){var c=this.Df(d);this.Iq(1);return this.Xw(this.Fl(a,d,!1,c))};a.b.g("Collection.prototype.push",{push:a.j.prototype.push});a.j.prototype.lastIndexOf=function(b,d){var c;this.Jf("lastIndexOf");void 0===d&&(d=0);for(c=this.fe()-1;c>=d;c-=1)if(a.b.Vv(b,
this.at(c)))return c;return-1};a.b.g("Collection.prototype.lastIndexOf",{lastIndexOf:a.j.prototype.lastIndexOf});a.j.prototype.dX=function(a){return void 0===a?[]:a.split(",")};a.j.Pea=function(b){b=Array.isArray(b)?b:[b];var d="",c,e,g,h;for(g=0;g<b.length;g++){c=b[g];for(h in c)if(c.hasOwnProperty(h))for(var k=Array.isArray(c[h])?c[h]:[c[h]],l=0;l<k.length;l++){if(a.t.bQ(k[l])){e=k[l].value;var m=null,m=k[l].comparator,m=f.isFunction(m)?m(null,h,e):m;e=h+m+e}else e=h+"\x3d"+c[h];d+=e+"+"}d=d.substring(0,
d.length-1)+","}return","===d.substring(d.length-1)?d.substring(0,d.length-1):d};a.j.prototype.e7=function(b){var d={},c;for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);if((b=this.comparator)&&a.Ea.qd(b)){b=this.dX(b);for(c=0;c<b.length;c++)d.sort=0===c?b[c]:d.sort+(","+b[c]);d.sortDir=this.eX()}this.Ya()&&(d[a.j.Ld]=this.wk(d));return d};a.j.prototype.T6=function(){if(f.isFunction(this.customURL))return!0;var b=this.TP(null);return a.j.Ml(b)};a.j.prototype.TP=function(b){var d=a.t.dn(this,"url");if(this.Ya()){var c=
b.all,e=null;e=c?(e=this.totalResults)?e:this.wk(b):this.wk(b);d=d&&-1<d.indexOf("?")?d+"\x26":d+"?";d+="limit\x3d"+e;c||(a.j.Ml(b.startIndex)&&(d+="\x26offset\x3d"+b.startIndex),b.startID&&(d+="\x26fromID\x3d"+b.startID),b.since&&(d+="\x26since\x3d"+b.since),b.until&&(d+="\x26until\x3d"+b.until));b.query&&(b=a.j.Pea(b.query))&&0<b.length&&(d+="\x26q\x3d"+b);if((b=this.comparator)&&a.Ea.qd(b))for(b=this.dX(b),c=this.eX(),e=0;e<b.length;e++)d=0===e?d+("\x26orderBy\x3d"+b[e]+":"+c):d+(","+b[e]+":"+
c);d+="\x26totalResults\x3dtrue"}return d};a.j.prototype.eX=function(){return-1===this.sortDirection?"desc":"asc"};a.j.prototype.sync=function(a,d,c){return window.oj.sync(a,d,c)};a.j.Ld="fetchSize"});