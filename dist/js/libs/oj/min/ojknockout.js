/**
 * @license
 * Copyright (c) 2014, 2023, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["jqueryui-amd/widget","ojs/ojkoshared","ojs/ojcore","ojs/ojlogger","knockout","ojs/ojdomutils","jquery","ojs/ojcustomelement-registry","ojs/ojcustomelement-utils","ojs/ojbindpropagation","ojs/ojkeysetimpl","ojs/ojcontext","ojs/ojtemplateengine-ko","ojs/ojcore-base","ojs/ojknockouttemplateutils","ojs/ojresponsiveknockoututils"],function(e,t,n,r,i,o,a,s,u,l,d,c,p,f,h,g){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f;const m=function(e,t){this.Init(e,t)};n.Object.createSubclass(m,n.Object,"ComponentBinding.ComponentChangeTracker"),m.prototype.Init=function(e,t){m.superclass.Init.call(this),this._updateCallback=e,this._queue=t,this._changes={},this._suspendCountMap={}},m.prototype.addChange=function(e,t){this._isSuspended(e)||this._disposed||(this._changes[e]=t,this._queue.registerComponentChanges(this))},m.prototype.dispose=function(){this._disposed=!0},m.prototype.resume=function(e){var t=this._suspendCountMap[e]||0;(t-=1)<0?r.error("ComponentChangeTracker suspendCount underflow"):0===t?delete this._suspendCountMap[e]:this._suspendCountMap[e]=t},m.prototype.suspend=function(e){var t=this._suspendCountMap[e]||0;this._suspendCountMap[e]=t+1},m.prototype.applyChanges=function(e){this._disposed||this._updateCallback(e)},m.prototype.flushChanges=function(){var e=this._changes;return this._changes={},e},m.prototype._isSuspended=function(e){return(this._suspendCountMap[e]||0)>=1};const v={};var y,b;n._registerLegacyNamespaceProp("__ExpressionUtils",v),y=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,b="_ko_property_writers",v.getPropertyWriterExpression=function(e){if(null==e||["true","false","null","undefined"].indexOf(e)>=0)return null;var t=(e=e.trim()).match(y);if(null===t)return null;var n=t[1]?"Object("+t[1]+")"+t[2]:e;return"{"+b+": function(v){"+n+"=v;}}"},v.getWriter=function(e){return e[b]};const _=function(e,t){this.Init(e,t)};function C(e,t){var n="value",r={};return r[n]=t[n],r}function E(e,t,n){var r={},i=n.optionMetadata;if(i&&"shouldWrite"===i.writeback){var o=n.option;r[o]=n.value,i.readOnly&&(e.readOnlyProperties[o]=!0)}return r}var D,A,N;function x(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=r.key,o=r.value;if(null!=i&&null!=o&&t(i.trim(),o.trim()))break}}function j(e,t){return function(n){var r=e.createChildContext(n.context);return i.renderTemplate(t,r,{afterRender:function(e){a(e)._ojDetectCleanData()}},n.parentElement),null}}function P(e,t){return function(n){var r=e.createChildContext(n.data);return i.renderTemplate(t,r,{afterRender:function(e){a(e)._ojDetectCleanData()}},n.parentElement),null}}function O(e,t,n){return"tooltip"===e&&t.template&&(t._renderer=j(n,t.template)),{tooltip:t}}function w(e,t,n){return"pieCenter"===e&&t.template&&(t._renderer=j(n,t.template)),{pieCenter:t}}function T(e,t,n){if("optionTemplate"===e&&null!==t){var r=function(e,t){return function(n){var r=n.parentElement,o=e.createChildContext(n.data,null,function(e){e.$optionContext=n});return i.renderTemplate(t,o,null,r),null}}(n,String(t));return{optionRenderer:r}}return null}n.Object.createSubclass(_,n.Object,"oj.ComponentBinding"),n._registerLegacyNamespaceProp("ComponentBinding",_),_.create=function(e,t){if(null==e)throw new Error("Binding name is required!");for(var n=new _(e,t),r=i.bindingHandlers,o=Array.isArray(e)?e:[e],a=0;a<o.length;a++){var s=o[a];_._REGISTERED_NAMES.push(s),r[s]=n}return n},_.getDefaultInstance=function(){return _._INSTANCE},_.prototype.setupManagedAttributes=function(e){var t=e.for;t=null==t?"@global":t;var n=this._managedAttrOptions[t]||[];n.push(e),this._managedAttrOptions[t]=n},_.deliverChanges=function(){t.getGlobalChangeQueue().deliverChanges()},_.prototype.Init=function(e,t){_.superclass.Init.call(this),"string"==typeof t&&(t={componentName:t}),this._bindingOptions=t||{},this._bindingNames=Array.isArray(e)?e:[e],this.init=this._init.bind(this),this.update=this._update.bind(this),this._managedAttrOptions={}},_.prototype._getBindingOptions=function(){return this._bindingOptions},_.prototype._init=function(e,t,n,r,o){return i.applyBindingsToDescendants(o,e),{controlsDescendantBindings:!0}},_.prototype._update=function(e,n,o,s,u){var l,d,c=[],p=0,f=a(e);function h(e){c.forEach(function(e){e.dispose()}),c=[],e&&l&&(l("destroy"),l=null),d&&(d.dispose(),d=null),f.off(_._HANDLER_NAMESPACE)}function g(n,i,a){if(null!=n){var s=f[n];if("function"==typeof s){s=s.bind(f);d=new m(function(e){var t=_.__removeDotNotationOptions(e);s("option",e);for(var n=Object.keys(t),r=0;r<n.length;r++){var i=n[r];s("option",i,t[i])}},t.getGlobalChangeQueue());var p=Object.keys(a).filter(function(e){return!(null==e||e===i)}),h={component:s,changeTracker:d,componentName:n,specifiedOptions:p,computeds:c,valueAccessor:function(){return a},allBindingsAccessor:o,bindingContext:u,destroyCallback:function(){l=null},readOnlyProperties:{}};l=this._initComponent(e,h)}else r.error("Component %s is not found",n)}}i.ignoreDependencies(function(){i.computed(function(){var e=i.utils.unwrapObservable(n());"object"!=typeof e&&r.error("ojComponent binding should evaluate to an object");var t,o=this._bindingOptions.componentName,a=!1;if(null==o&&null!=e){for(var s=[_._COMPONENT_OPTION,"role"],u=0;!a&&u<s.length;u++)(t=s[u])in e&&(a=!0,o=e[t]);a||r.error("component attribute is required for the ojComponent binding"),o=i.utils.unwrapObservable(o)}0===p?p=1:i.ignoreDependencies(h,this,[!0]),i.ignoreDependencies(g,this,[o,t,e])},this,{disposeWhenNodeIsRemoved:e})},this),i.utils.domNodeDisposal.addDisposeCallback(e,h.bind(this,!1))},_.prototype._initComponent=function(e,t){var r=!1,o=0,s={},u=a(e),l=t.component,d=t.componentName,c=this,p="_ojDestroy",f=function(n){if(n.target&&n.target===e){t.destroyCallback();var i=c._bindingOptions.beforeDestroy;i&&i(e,l,t.valueAccessor,t.allBindingsAccessor,t.bindingContext),_._deliverCreateDestroyEventToManagedProps(!1,s,e,l,t.valueAccessor,t.allBindingsAccessor,t.bindingContext),r=!0,t.changeTracker.dispose(),e.removeEventListener(p,f)}};e.addEventListener(p,f);var h=_._resolveManagedAttributes(this._managedAttrOptions,t.specifiedOptions,d),g=_.getDefaultInstance();if(this!==g){var m=g._getManagedAttributes(t.specifiedOptions,d);n.CollectionUtils.copyInto(m,h),h=m}for(var v={},y=function(){var n=this._property,i=_._toJS(t.valueAccessor()[n]);if(0===o){var a=h[n];if(null!=a){s[n]=a;var u=a.init;if(null!=u)for(var d=u(n,i,e,l,t.valueAccessor,t.allBindingsAccessor,t.bindingContext)||{},c=Object.keys(d),p=0;p<c.length;p++){var f=c[p];v[f]=_.__cloneIfArray(d[f])}}else v[n]=_.__cloneIfArray(i)}else if(!r)if(null!=h[n]){var g=h[n].update;if(null!=g)for(var m=g(n,i,e,l,t.valueAccessor,t.allBindingsAccessor,t.bindingContext)||{},y=Object.keys(m),b=0;b<y.length;b++){var C=y[b];t.changeTracker.addChange(C,_.__cloneIfArray(m[C]))}}else t.readOnlyProperties[n]||t.changeTracker.addChange(n,_.__cloneIfArray(i))},b=0;b<t.specifiedOptions.length;b++)t.computeds.push(i.computed(y,{_property:t.specifiedOptions[b]}));o=1,_._registerWritebacks(u,t);var C=_.__removeDotNotationOptions(v);l(v),Object.keys(C).forEach(function(e){l("option",e,C[e])});var E=this._bindingOptions.afterCreate;return E&&E(e,l,t.valueAccessor,t.allBindingsAccessor,t.bindingContext),_._deliverCreateDestroyEventToManagedProps(!0,s,e,l,t.valueAccessor,t.allBindingsAccessor,t.bindingContext),v=null,l},_.prototype._getManagedAttributes=function(e,t){return _._resolveManagedAttributes(this._managedAttrOptions,e,t)},_._resolveManagedAttributes=function(e,t,n){var r={},i=[],o="attributes",s=function(t,n){var r=e[t];if(null!=r)for(var a=r.length-1;a>=0;a--){var u=r[a];if(null!=u[o]&&i.push(u),n){var l=u.use;if(null!=l){l=Array.isArray(l)?l:[l];for(var d=0;d<l.length;d++)s(l[d],!0)}}}};s(n,!0);var u=a.oj[n];if(null!=u)for(var l=Object.getPrototypeOf(u.prototype);null!=l&&"oj"===l.namespace;)s(l.widgetName,!0),l=Object.getPrototypeOf(l);if(s("@global",!1),i.length>0)for(var d=0;d<t.length;d++)for(var c=t[d],p=0;p<i.length;p++){var f=i[p];if(f[o].indexOf(c)>=0){r[c]={init:f.init,update:f.update,afterCreate:f.afterCreate,beforeDestroy:f.beforeDestroy};break}}return r},_._HANDLER_NAMESPACE=".oj_ko",_._registerWritebacks=function(e,t){for(var n={"^slider$":[{event:"slidechange",getter:C}],"^oj*":[{event:"ojoptionchange",getter:E.bind(void 0,t)}]},r={},i=Object.keys(n),o=0;o<i.length;o++){var a=i[o];if(t.componentName.match(a)){for(var s=n[a],u=0;u<s.length;u++){var l=s[u];e.on(l.event+_._HANDLER_NAMESPACE,{getter:l.getter},function(n,i){if(n.target===e[0])for(var o=n.data.getter(n,i),a=t.valueAccessor(),s=Object.keys(o),u=0;u<s.length;u++){var l=s[u];t.changeTracker.suspend(l);try{if(t.specifiedOptions.indexOf(l)>=0){var d=a[_._OPTION_MAP],c=null==d?null:d[l],p=a[l];_._writeValueToProperty(l,p,o[l],c,t.bindingContext,r)}}finally{t.changeTracker.resume(l)}}})}break}}},_._writeValueToProperty=function(e,n,r,o,a,s){if(null!=n&&i.isObservable(n))i.isWriteableObservable(n)&&n(_.__cloneIfArray(r));else{if(!(e in s)){var u=null,l=v.getPropertyWriterExpression(o);null!=l&&(u=t.createEvaluator(l,a)),s[e]=u}var d=s[e];if(d)v.getWriter(d(a))(_.__cloneIfArray(r))}},_._toJS=function(e){var t=i.utils.unwrapObservable(e);return(Array.isArray(t)||n.CollectionUtils.isPlainObject(t))&&t.ojConvertToJS&&(t=i.toJS(t)),t},_.__cloneIfArray=function(e){return Array.isArray(e)&&(e=e.slice()),e},_.__removeDotNotationOptions=function(e){for(var t={},n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];i.indexOf(".")>=0&&(t[i]=e[i],delete e[i])}return t},_._deliverCreateDestroyEventToManagedProps=function(e,t,n,r,i,o,a){for(var s=Object.keys(t),u=0;u<s.length;u++){var l=s[u],d=t[l],c=e?d.afterCreate:d.beforeDestroy;c&&c(l,n,r,i,o,a)}},_.__getKnockoutVersion=function(){return i.version},_._isNameRegistered=function(e){return _._REGISTERED_NAMES.indexOf(e)>=0},_._REGISTERED_NAMES=[],_._COMPONENT_OPTION="component",_._OPTION_MAP="_ojOptions",D="cleanExternalData",A=i.utils.domNodeDisposal,N=A[D],A[D]=function(e){var t=o?o.setInKoCleanExternal:null;t&&t(e);try{N(e)}finally{t&&t(null)}},_._INSTANCE=_.create(["__ojComponentPrivate","jqueryUI"]),t.addPostprocessor({getBindingAccessors:function(e,r,o,a){if(null==o)return null;var s=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n];if(_._isNameRegistered(r))return r}return null}(o);null!=s&&(o=function(e,r,o,a,s){var u=function(e,n,r,o){var a=null,s=t.getBindingsString(e,r,o),u=i.jsonExpressionRewriting.parseObjectLiteral(s),l=null;x(u,function(e,t){return e===n&&(l=t,!0)}),null!=l&&0===l.indexOf("{")&&(a=i.jsonExpressionRewriting.parseObjectLiteral(l));return{attrList:a,bindingExpr:l}}(e,r,o,a),l=u.attrList;if(null==l)return s;var d={};return x(l,function(e,t){d[e]=t}),s=n.CollectionUtils.copyInto({},s),s[r]=function(e,n,r){var i=function(){var r={};return Object.keys(n).forEach(function(i){var o=n[i],a=t.createEvaluator(o,e).bind(null,e);Object.defineProperty(r,i,{get:a,enumerable:!0})}),Object.defineProperty(r,_._OPTION_MAP,{value:n}),r};return i.toString=function(){return r},i}(a,d,u.bindingExpr),s}(e,s,a,r,o));return o}}),t.addPostprocessor({nodeHasBindings:function(e,t){return n.BaseCustomElementBridge?t||1===e.nodeType&&s.isElementRegistered(e.nodeName):t},getBindingAccessors:function(e,t,n){if(1===e.nodeType){var r=e.nodeName;s.isElementRegistered(r)&&((n=n||{})._ojCustomElement=function(){const e=s.isComposite(r),t=s.isVComponent(r);return{skipThrottling:e||t}})}return n}}),a.widget("oj._ojDetectCleanData",{options:{cleanParent:!1},_destroy:function(){var e=i.utils.domNodeDisposal,t="cleanExternalData",n=e[t];e[t]=function(){};try{this.options.cleanParent&&null!=this.element[0].parentNode?i.cleanNode(this.element[0].parentNode):i.cleanNode(this.element[0])}finally{e[t]=n}}}),_.getDefaultInstance().setupManagedAttributes({attributes:["tooltip"],init:function(e,t,n,r,i,o,a){return O(e,t,a)},update:function(e,t,n,r,i,o,a){return O(e,t,a)},for:"tooltipOptionRenderer"}),function(){for(var e=["ojChart","ojDiagram","ojNBox","ojPictoChart","ojSunburst","ojTagCloud","ojThematicMap","ojTreemap","ojDialGauge","ojLedGauge","ojRatingGauge","ojSparkChart","ojStatusMeterGauge","ojGantt"],t=0;t<e.length;t++)_.getDefaultInstance().setupManagedAttributes({for:e[t],use:"tooltipOptionRenderer"})}(),_.getDefaultInstance().setupManagedAttributes({attributes:["pieCenter"],init:function(e,t,n,r,i,o,a){return w(e,t,a)},update:function(e,t,n,r,i,o,a){return w(e,t,a)},for:"ojChart"}),_.getDefaultInstance().setupManagedAttributes({attributes:["optionTemplate"],init:function(e,t,n,r,i,o,a){var s=T(e,t,a);if(null!==s)return s},update:function(e,t,n,r,i,o,a){return T(e,t,a)},for:"ComboboxOptionRenderer"}),_.getDefaultInstance().setupManagedAttributes({for:"ojCombobox",use:"ComboboxOptionRenderer"}),_.getDefaultInstance().setupManagedAttributes({for:"ojSelect",use:"ComboboxOptionRenderer"}),_.getDefaultInstance().setupManagedAttributes({for:"ojInputSearch",use:"ComboboxOptionRenderer"}),i.bindingHandlers.ojContextMenu={update:function(e,t,r,s,u){var l,d,c=".ojContextMenu",p=a(e),f=750,h=!1,g=!1,m=300,v=null;p.off(c).removeClass("oj-menu-context-menu-launcher")[0].removeEventListener("click",E,!0),p[0].removeEventListener("touchstart",P,{passive:!1}),clearTimeout(l);var y=p.data("_ojLastContextMenu");y&&x(y.selector,y.id).off(c);var b=!1,_=i.utils.unwrapObservable(t()),C=a.isPlainObject(_)?e.getAttribute("contextmenu"):null;function E(e){if(h)return e.preventDefault(),e.stopPropagation(),h=!1,!1}function D(e){121===e.keyCode&&e.shiftKey&&N().is(":visible")&&e.preventDefault()}function A(){var e=n.Components.__GetWidgetConstructor(N()[0],"ojMenu"),t=e&&e("instance");if(!t)throw new Error('ojContextMenu binding bound to "'+(C||_)+'", which does not reference a valid JET Menu.');return b||(t.widget().on("ojclose"+c,function(){document.removeEventListener("keyup",D)}),b=!0),t}function N(){return x(_,C)}function x(e,t){return t?a(document.getElementById(t)):a(e).first()}function j(e,t,n){h=n;var r=A();if(h&&p.one("touchend"+c,function(){r.__contextMenuPressHoldJustEnded(!0),setTimeout(function(){r.__contextMenuPressHoldJustEnded(!1)},50)}),"touchstart"===v&&"contextmenu"===e.type||"contextmenu"===v&&"touchstart"===e.type)return v=null,void clearTimeout(d);if(!e.isDefaultPrevented()){var i={launcher:p,initialFocus:"menu",position:{mouse:{my:"start top",at:"start bottom",of:e},touch:{my:"start>40 center",at:"start bottom",of:e,collision:"flipfit"},keyboard:{my:"start top",at:"start bottom",of:"launcher"}}[t]};r.__openingContextMenu=!0,r.open(e,i),r.__openingContextMenu=!1,r.widget().is(":visible")&&(e.preventDefault(),document.addEventListener("keyup",D),"touchstart"!==e.type&&"contextmenu"!==e.type||(v=e.type,d=setTimeout(function(){v=null},m)))}}function P(e){if("touchstart"===e.type&&(e=a.Event(e)),"mousedown"!==e.type||!A().__contextMenuPressHoldJustEnded())return h=!1,"touchstart"===e.type&&(g=!0,l=setTimeout(j.bind(void 0,e,"touch",!0),f)),!0}p.data("_ojLastContextMenu",{selector:_,id:C}),e.addEventListener("click",E,!0),p[0].addEventListener("touchstart",P,{passive:!1}),p.on("mousedown"+c+" keydown"+c+" ",P).on("touchend"+c+" touchcancel"+c,function(){return g=!1,clearTimeout(l),!0}).on("keydown"+c+" contextmenu"+c,function(e){("contextmenu"===e.type||121===e.keyCode&&e.shiftKey)&&j(e,g?"touch":"keydown"===e.type?"keyboard":"mouse",!1);return!0}).addClass(o.isTouchSupported()?"oj-menu-context-menu-launcher":"")}};const I=function(e,n,o){var a=function(){if(o)return null;return new m(function(t){for(var n=Object.keys(t),r=0;r<n.length;r++){y(n[r])}try{e.setProperties(t)}finally{for(var i=0;i<n.length;i++){b(n[i])}}},t.getGlobalChangeQueue())}(),l={},d={},c={},p={},f="Changed";function h(e){return e.$current||e.$data}function g(t,n,r){var i=l[n];if(i||(i=function(e){var t,n=h(e),r=function(r){t&&t(r,n,e)};return r.setListener=function(e){t=e},r}(t),l[n]=i,e.addEventListener(n,i)),!(null==r||r instanceof Function)){var o=u.AttributeUtils.eventTypeToEventListenerProperty(n),a=`Invalid type '${typeof r}' found for attribute '${u.AttributeUtils.propertyNameToAttribute(o)}'. Expected value of type 'function'."`;if(s.isElementRegistered(e.tagName)){u.CustomElementUtils.getElementState(e).rejectBindingProvider(a)}throw new u.JetElementError(e,a)}i.setListener(r)}function y(e){var t=p[e]||0;t+=1,p[e]=t}function b(e){var t=p[e];t?(t-=1,p[e]=0===t?null:t):r.error("Property count undefrlow")}this.setupPropertyBinding=function(o,s,l,m,C){if(!l)return;var E=function(e,t){var n=e.split("."),r=t;n.shift();for(var i=0;i<n.length&&(r=r.properties);i++)r=r[n[i]];return r}(s,l);if(!E)return;var D=d[s];D&&(D.dispose(),d[s]=null);var A=c[s];if(A&&(e.removeEventListener(s+f,A),c[s]=null),l._domListener){var N=u.AttributeUtils.eventListenerPropertyToEventType(s);g(n,N,null)}let x,j,P;if(void 0===o){let e;C?n.$provided&&(e=n.$provided.get(C)):e=null,e&&(x=()=>i.unwrap(e))}else{const e=u.AttributeUtils.getExpressionInfo(o);j=e.expr,j&&(x=t.createEvaluator(j,n),P=e.downstreamOnly)}if(x){if(!l.readOnly){var O=!0;i.ignoreDependencies(function(){d[s]=i.computed(function(){var t,r,o,d=x(n),c=i.utils.unwrapObservable(d);if(l._domListener){var p=u.AttributeUtils.eventListenerPropertyToEventType(s);g(n,p,c)}else Array.isArray(c)&&(c=c.slice()),l._eventListener&&c&&c instanceof Function&&(r=c,o=h(t=n),c=function(e){r(e,o,t)}),!O&&a?a.addChange(s,c):function(t,n){y(t);try{e.setProperty(t,n)}catch(t){throw u.CustomElementUtils.getElementState(e).rejectBindingProvider(t),t}finally{b(t)}}(s,c),O&&m&&m(c)})}),O=!1}void 0!==j&&l.writeback&&!P&&(c[s]=function(o,a,s){var u=o.split("."),l=u[0],d=function(e){if(!function(e){return p[e]}(l)){var d,c=!1;i.ignoreDependencies(function(){for(var r=e.detail.value,o=1;o<u.length;o++){r=r[u[o]]}var l=s(n);if(i.isObservable(l))i.isWriteableObservable(l)?(l(_.__cloneIfArray(r)),c=!0):d="the observable is not writeable";else{var p=v.getPropertyWriterExpression(a);if(null!=p){var f=t.createEvaluator(p,n);v.getWriter(f(n))(_.__cloneIfArray(r)),c=!0}else d="the expression is not a valid update target"}}),c||d&&r.info("The expression '%s' for property '%s' was not updated because %s.",a,o,d)}};return e.addEventListener(l+f,d),d}(s,j,x))}},this.teardown=function(){var t,n=Object.keys(d);for(t=0;t<n.length;t++){var r=d[n[t]];r&&r.dispose()}for(d={},n=Object.keys(c),t=0;t<n.length;t++){var i=n[t].split(".")[0];e.removeEventListener(i+f,c[i])}for(c={},n=Object.keys(l),t=0;t<n.length;t++){var o=n[t];e.removeEventListener(o,l[o])}l={},a&&a.dispose()}},k=function(){this._resolveWhenChildrenBindingsApplied=function(e,t){var n=this._getChildrenBindingsAppliedPromises(e);if("none"===t||0===n.length)u.CustomElementUtils.getElementState(e).resolveBindingProvider(this);else{for(var r=[];n.length>0;){var i=n.shift();("nearestCustomElement"===t||"immediate"===t&&!0===i.immediate)&&r.push(i.promiseCallback)}Promise.all(r).then(function(){this._resolveWhenChildrenBindingsApplied(e,t)}.bind(this))}},this._getChildrenBindingsAppliedPromises=function(e,t){return!e._whenChildrenBindingsApplied&&t&&Object.defineProperty(e,"_whenChildrenBindingsApplied",{value:[],enumerable:!1}),e._whenChildrenBindingsApplied||[]},this.__RegisterBindingAppliedPromiseForChildren=function(e,t){var n=null;if(e){var r=new Promise(function(e){n=e});this._getChildrenBindingsAppliedPromises(e,!0),e._whenChildrenBindingsApplied.push({immediate:t,promiseCallback:r})}return n},this.__NotifyBindingsApplied=function(e){var t=u.CustomElementUtils.getElementState(e).getTrackChildrenOption();this._resolveWhenChildrenBindingsApplied(e,t)},this.__NotifyBindingsDisposed=function(e){u.CustomElementUtils.getElementState(e).disposeBindingProvider(e)},this.__GetThrottlePromise=function(){return t.getGlobalChangeQueue().getThrottlePromise()},this.__ExtendBindingContext=function(e,n,r,i,o){return t.extendBindingContext(e,n,r,i,o)},this.__ContextFor=function(e){return e.__ojBindingContext?e.__ojBindingContext:i.contextFor(e)},this.__UnwrapObservable=function(e){return i.utils.unwrapObservable(e)},this.__IsObservable=function(e){return i.isObservable(e)},this.__KoComputed=function(e,t,n){return i.computed(e,t,n)},this.__KoIsInitial=function(){return i.computedContext.isInitial()},this.__CleanNode=function(e){i.cleanNode(e)}};function B(e,t){var n={};return function(r){var i=r.parentElement,o=e.createChildContext(r.data,null,function(e){e.$key=r.key,e.$metadata=r.metadata,e.$headerContext=r});return M(r,t,i,o,n),null}}function L(e,t){var n={};return function(r){var i=r.parentElement,o=e.createChildContext(r.data,null,function(e){e.$keys=r.keys,e.$metadata=r.metadata,e.$cellContext=r,e.$cell=r.cell});return M(r,t,i,o,n),null}}function M(e,t,n,r,o){var s=function(e,t){if("function"==typeof e)return e(t);return e}(t,e),u=function(e,t){var n=t[e];null==n&&(n=i.utils.parseHtmlFragment(document.getElementById(e).innerHTML,document),t[e]=n);var r=n.map(function(e){return e.cloneNode(!0)});return r}(s,o);i.virtualElements.setDomNodeChildren(n,u),i.applyBindingsToDescendants(r,n);for(var l=0;l<n.childNodes.length;l++)if(1===n.childNodes[l].nodeType){a(n.childNodes[l])._ojDetectCleanData({cleanParent:!0});break}}function S(e,t,n){return"template"===e?{_templateFunction:P(n,t)}:null}k.getInstance=function(){return k._instance},k._instance=new k,oj._registerLegacyNamespaceProp("_KnockoutBindingProvider",k),function(){i.bindingHandlers._ojCustomElement={after:["attr"],init:function(a,d,c,p,f){var h,g;!f||!f.$provided||f.$provided instanceof Map||(f.$provided=new Map(Object.entries(f.$provided)));const m=s.getMetadata(a.tagName),v=m.properties||{},{provide:y,consume:b,cleanup:_}=function(e,i){const a=new Map,s=new Map,d=Object.create(null),c=l.getPropagationMetadataViaCache(e.localName,i);if(null!==c){const p=i.properties||{};for(const[i,[f,h]]of c){if(void 0!==f){const s=[],c=[];if(i===l.STATIC_PROPAGATION?f.forEach(e=>{a.set(e.name,e)}):f.forEach(e=>{const t=e.name;if(void 0===t)throw new Error("name attribute for the binding/provide metadata is required!");const n=e.default,i=r(e.transform,n);s.push(i),c.push({name:t,obs:i})}),c.length>0){const r=o(s);a.set(i,{set:r,vars:c});const l=n(r),f=i+t;e.addEventListener(f,l),d[f]=l;const h=u.AttributeUtils.propertyNameToAttribute(i);if(e.hasAttribute(h)){const t=e.getAttribute(h);u.AttributeUtils.getExpressionInfo(t).expr||r(u.AttributeUtils.attributeToPropertyValue(e,h,t,p[i]))}}}if(void 0!==h)if(i===l.CONSUMED_CONTEXT)s.set(i,h);else{const e=h.name;if(void 0===e)throw new Error("'name' property on the binding/consume metadata is required!");s.set(i,e)}}}function p(){Object.keys(d).forEach(t=>e.removeEventListener(t,d[t]))}return{provide:a,consume:s,cleanup:p}}(a,m);function C(){h&&(h.teardown(),h=null),g&&(a.removeEventListener(e,g),g=null),k.getInstance().__NotifyBindingsDisposed(a)}i.computed(function(){var t=d().skipThrottling;const n=i.computedContext.isInitial();n||C(),function(t,n){h=new I(a,f,t);var r={_domListener:!0};u.CustomElementUtils.getElementState(a).beginApplyingBindings();for(var o=a.attributes,s=0;s<o.length;s++){var d=o[s],c=u.AttributeUtils.attributeToPropertyName(d.nodeName);let e,t;const i=u.AttributeUtils.isEventListenerProperty(c)&&!v[c];if(!i){t=c.split(".")[0];const r=y.get(t);e=n&&r?r.set:void 0}h.setupPropertyBinding(d.value,c,i?r:v[t],e)}b.forEach((e,t)=>{if("string"!=typeof t||a.hasAttribute(u.AttributeUtils.propertyNameToAttribute(t))){if(t===l.CONSUMED_CONTEXT){const t=f.$provided,n=new Map;e.forEach(e=>{t&&t.has(e)&&n.set(e,i.unwrap(t.get(e)))}),a.setProperty("__oj_private_contexts",n)}}else{const r=y.get(t),i=n&&r?r.set:void 0;h.setupPropertyBinding(void 0,t,v[t],i,e)}}),g=function(e){var t=e.detail,n=t.attribute,i=u.AttributeUtils.attributeToPropertyName(n),o=u.AttributeUtils.isEventListenerProperty(i)&&!v[i]?r:v[i.split(".")[0]];h.setupPropertyBinding(t.value,i,o,void 0,b.get(i))},a.addEventListener(e,g)}(t,n)},null,{disposeWhenNodeIsRemoved:a}),i.utils.domNodeDisposal.addDisposeCallback(a,function(){C(),_()});const E=function(e,t){if(0===t.size)return e;const n=e.$provided,r=new Map(n);return t.forEach(e=>{if(e.vars){e.vars.forEach(e=>{const t=e.obs;r.set(e.name,t)})}else r.set(e.name,e.default)}),e.extend({$provided:r})}(f,y);return i.applyBindingsToDescendants(E,a),k.getInstance().__NotifyBindingsApplied(a),{controlsDescendantBindings:!0}}};const e="attribute-changed",t="Changed";function n(e){return t=>e(t.detail.value)}function r(e,t){const n=i.observable(t);return e?i.pureComputed({write:t=>n(e.hasOwnProperty(t)?e[t]:t),read:()=>n()}):n}function o(e){return t=>e.forEach(e=>e(t))}}(),_.getDefaultInstance().setupManagedAttributes({attributes:["header","cell"],init:function(e,t,n,r,i,o,a){if("header"===e){var s=t.row;if(null!=s){var u=s.template;null!=u&&(s.renderer=B(a,u))}var l=t.column;if(null!=l){var d=l.template;null!=d&&(l.renderer=B(a,d))}var c=t.rowEnd;if(null!=c){var p=c.template;null!=p&&(c.renderer=B(a,p))}var f=t.columnEnd;if(null!=f){var h=f.template;null!=h&&(f.renderer=B(a,h))}return{header:t}}if("cell"===e){var g=t.template;return null!=g&&(t.renderer=L(a,g)),{cell:t}}},update:function(e,t,n,r,i,o,a){if("header"===e){var s=t.row;if(null!=s){var u=s.template;null!=u&&(s.renderer=B(a,u))}var l=t.column;if(null!=l){var d=l.template;null!=d&&(l.renderer=B(a,d))}var c=t.rowEnd;if(null!=c){var p=c.template;null!=p&&(c.renderer=B(a,p))}var f=t.columnEnd;if(null!=f){var h=f.template;null!=h&&(f.renderer=B(a,h))}return{header:t}}if("cell"===e){var g=t.template;return null!=g&&(t.renderer=L(a,g)),{cell:t}}return null},for:"ojDataGrid"}),_.getDefaultInstance().setupManagedAttributes({attributes:["template"],init:function(e,t,n,r,i,o,a){return S(e,t,a)},update:function(e,t,n,r,i,o,a){return S(e,t,a)},for:"ojDiagram"}),function(){var e="_ojbindingsobj";function n(e,t,n,i){var a=o(e.getAttribute(n),i);if(a)return r(e,t,"ko "+t+":"+a)}function r(e,t,n){for(var r=e.tagName.toLowerCase(),i=r,o=e.attributes,a=0;a<o.length;a++){var s=o[a];i+=" ",i+=s.name,i+="='",i+=s.value,i+="'"}var l=e.parentNode,d=document.createComment(i),c=document.createComment("/"+r);l.insertBefore(d,e),e[u.OJ_BIND_CONVERTED_NODE]=d;var p=document.createComment(n),f=document.createComment("/ko");l.insertBefore(p,e);var h,g=[d,p];if("if"===t)for(;e.childNodes.length>0;)h=e.childNodes[0],l.insertBefore(h,e),g.push(h);else if("_ojBindForEach_"===t)for(;e.childNodes.length>0;)h=e.childNodes[0],l.insertBefore(h,e),g.push(h);return l.insertBefore(f,e),g.push(f),l.replaceChild(c,e),g.push(c),g}function o(e,t){if(null!=e){var n=u.AttributeUtils.getExpressionInfo(e).expr;return null==n&&(n=t?"'"+e+"'":e),n}return null}function a(e,n,r,o){var a,s=u.AttributeUtils.getExpressionInfo(r).expr;if(null==s){var l=u.AttributeUtils.coerceValue(n,"class",r,"any");a=function(){return Array.isArray(l)?l.join(" "):l}}else{var d=t.createEvaluator(s,o).bind(null,o);a=i.pureComputed(function(){var e=i.unwrap(d());return Array.isArray(e)?e.join(" "):e})}e.css=a}function l(e,n,r,i,o){var a=u.AttributeUtils.getExpressionInfo(r).expr;return null==a?function(){return"object"===o?u.AttributeUtils.coerceValue(e,n,r,o):r}:t.createEvaluator(a,i).bind(null,i)}function d(e){return function(){for(var t={},n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];t[i]=e[i]()}return t}}function c(t){if(1!==t.nodeType)return{};if(!t[e]){for(var n={},r=[],i=[],o=[],a=t.attributes,u=0;u<a.length;u++){var l=a[u],d=p(l.name);d&&("style"===d?n._STYLE_BIND=d:"style."===d.substring(0,6)?i.push(d):r.push(d)),s.isElementRegistered(t.nodeName)||"on-"!==l.name.substring(0,3)||o.push(l)}if(i.length){if(n._STYLE_BIND)throw new Error("Cannot have both style and style.* data bound attributes on "+t.tagName+" with id "+t.id);n._STYLE_BIND=i}r.length&&(n._ATTR_BIND=r),o.length&&(n._EVENT_BIND=o),Object.defineProperty(t,e,{value:n})}return t[e]}function p(e){return e&&":"===e.charAt(0)?e.slice(1):null}function f(e){return":"+e}t.registerPreprocessor("oj-bind-text",function(e){return n(e,"text","value",!0)}),t.registerPreprocessor("oj-bind-if",function(e){return n(e,"if","test",!1)}),t.registerPreprocessor("oj-bind-for-each",function(e){var t=e.getAttribute("data"),n=u.AttributeUtils.getExpressionInfo(t).expr;if(!n)try{var i=JSON.parse(t);if(!Array.isArray(i))throw new Error("got value "+t);n=t}catch(e){throw new Error("The value on the oj-bind-for-each data attribute should be either a JSON array or an expression : "+e)}var a=o(e.getAttribute("as"),!0);if(!n)return;var s="ko _ojBindForEach_:{data:"+n;return r(e,"_ojBindForEach_",s+=a?",as:"+a+"}":"}")}),t.addPostprocessor({nodeHasBindings:function(e,t){var n=c(e);return t||null!=n._ATTR_BIND||null!=n._STYLE_BIND||null!=n._EVENT_BIND},getBindingAccessors:function(e,t,n){if(1===e.nodeType){n=n||{};var r,o,s=c(e),p=s._STYLE_BIND;if(p){if(n.style)throw new Error("Cannot have both style data-bind and JET style binding on "+e.tagName+" with id "+e.id);if("style"===p)n[p]=l(e,p,e.getAttribute(f(p)),t,"object");else{var h={};for(r=0;r<p.length;r++){o=p[r],h[u.AttributeUtils.attributeToPropertyName(o.substring(6))]=l(e,o,e.getAttribute(f(o)),t,"string")}n.style=d(h)}}var g=s._ATTR_BIND;if(g){if(n.attr)throw new Error("Cannot have both attr data-bind and JET attribute binding on "+e.tagName+" with id "+e.id);var m={};for(r=0;r<g.length;r++)"class"===(o=g[r])?a(n,e,e.getAttribute(f(o)),t):m[o]=l(e,o,e.getAttribute(f(o)),t,"string");n.attr=d(m)}var v=s._EVENT_BIND;if(v){var y=new I(e,t,!0);for(r=0;r<v.length;r++){var b=v[r],_=u.AttributeUtils.attributeToPropertyName(b.nodeName);y.setupPropertyBinding(b.value,_,{_domListener:!0})}i.utils.domNodeDisposal.addDisposeCallback(e,function(){y&&(y.teardown(),y=null)})}}return n}})}(),
/**
   * @license
   * Copyright (c) 2014, 2023, Oracle and/or its affiliates.
   * Licensed under The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   *
   * @license
   * Knockout Fast Foreach v0.6.0 (2016-07-28T11:02:54.197Z)
   * By: Brian M Hunt (C) 2015 | License: MIT
   *
   * Adds `fastForEach` to `ko.bindingHandlers`.
   *
   * Modification notice: The code is obtained from https://github.com/brianmhunt/knockout-fast-foreach
   * and modified by Oracle JET team to be included into Oracle JET project.
   * @ignore
   */
function(){var e=document&&"function"==typeof document.createDocumentFragment;function t(e,t,n){return{status:"added",value:e,index:t,key:n}}function n(e){return{status:"deleted",value:{},index:e}}function o(e,t){var n;if(e){var r=e.length;n=new Array(r);for(var i=0;i<r;i++)n[i]=t(e[i],i,e)}return n}var a=function(e,t,n){if(Array.isArray(t)){var r=document.createDocumentFragment();for(let e=0,n=t.length;e!==n;++e)r.appendChild(t[e]);if(i.virtualElements.insertAfter(e,r,n),f.Components)for(let e=0,n=t.length;e!==n;++e)f.Components.subtreeAttached(t[e])}else i.virtualElements.insertAfter(e,t,n),f.Components&&f.Components.subtreeAttached(t)},s="_ko_ffe_pending_delete_index",l="oj-bind-for-each: abandoned promise";function h(e,n,r){this.element=n.element||e,i.applyBindingsToDescendants(r,this.element),function(e){for(var t,n,r=i.virtualElements.childNodes(e),o=0;o<r.length;o++){var a=r[o];if(1===a.nodeType&&"template"===a.nodeName.toLowerCase()){var s=u.CustomElementUtils.getSlotAssignment(a);if(t||s&&""!==s){if(n||"noData"!==s){var l;switch(s){case"":l="Multiple default templates found: oj-bind-for-each requires a single default template element as its direct child";break;case"noData":l="Multiple noData templates found: oj-bind-for-each requires a single noData template element as its direct child";break;default:l="Unknown template slot detected - "+s+": oj-bind-for-each supports a single default template and a single noData template"}throw new Error(l)}n=a}else t=a}}if(!t)throw new Error("Default template not found: oj-bind-for-each requires a single default template element as its direct child");e._templateNode=t,e._noDataTemplateNode=n}(this.element),this.element._templateNode.__ojBindingContext=i.contextFor(this.element._templateNode),this.data=n.data,this.as=n.as,this.changeQueue=[],this.firstLastNodesList=[],this.indexesToDelete=[],this.rendering_queued=!1,this.pendingDeletes=[],this.headDataPromise=null,this.tailDataPromise=null,i.virtualElements.emptyNode(this.element),this._initChildrenBindingsAppliedPromise();var a=i.unwrap(this.data);a.fetchFirst?(this.currentDataProvider=a,this.fetchData()):this.onArrayChange(o(a,t)),this.addSubscriptions()}h.PENDING_DELETE_INDEX_KEY=s,h.prototype.addSubscriptions=function(){var e=i.isObservable(this.data);this.currentDataProvider?(this.dataMutateHandler=this.handleDataMutateEvent.bind(this),this.dataRefreshHandler=this.handleDataRefreshEvent.bind(this),this.currentDataProvider.addEventListener("mutate",this.dataMutateHandler),this.currentDataProvider.addEventListener("refresh",this.dataRefreshHandler),e&&(this.changeSubs=this.data.subscribe(this.onDataChange,this,"change"))):e&&(this.data.indexOf||(this.data=this.data.extend({trackArrayChanges:!0})),this.changeArraySubs=this.data.subscribe(this.onArrayDataChange,this,"arrayChange"),this.changeSubs=this.data.subscribe(this.onDataChange,this,"change"))},h.prototype.removeSubscriptions=function(){this.changeSubs&&this.changeSubs.dispose(),this.changeArraySubs&&this.changeArraySubs.dispose(),this.currentDataProvider&&(this.currentDataProvider.removeEventListener("mutate",this.dataMutateHandler),this.currentDataProvider.removeEventListener("refresh",this.dataRefreshHandler))},h.prototype.onArrayDataChange=function(e){this.arrayChangeSet=e},h.prototype.onDataChange=function(e){this.arrayChangeSet?(this.onArrayChange(this.arrayChangeSet),this.arrayChangeSet=null):(this.setData({data:this.data,dataProvider:e.fetchFirst?e:null}),this.recreateContent(e))},h.prototype.recreateContent=function(e){this.changeQueue=[],this.firstLastNodesList=[],this.indexesToDelete=[],this.rendering_queued=!1,this.pendingDeletes=[],this._noDataNodes=null,i.virtualElements.emptyNode(this.element),e.fetchFirst?this.fetchData():this.onArrayChange(o(e,t))},h.prototype.registerBusyState=function(){var e=this.element.parentNode;return c.getContext(e).getBusyContext().addBusyState({description:"oj-bind-for-each binding on a node with the Id "+e.id+"is loading data."})},h.prototype._initChildrenBindingsAppliedPromise=function(){var e=this.element._templateNode.__ojBindingContext.$current,t=e?{_nearestCustomParent:e._nearestCustomParent,_immediate:e._immediate}:null,n=function(e,t){for(var n=e.parentNode;n&&!u.ElementUtils.isValidCustomElementName(n.localName);)n=n.parentNode;return n||(n=t?t._nearestCustomParent:null),n}(this.element,t),r=function(e,t,n){var r=!1,i=!!n;return e.parentNode===t?r=!0:i&&!e.parentNode.parentNode&&(r=n._immediate),r}(this.element,n,t);this.trackingContext={_nearestCustomParent:n,_immediate:r},this._childrenBindingsPromiseResolver=k.getInstance().__RegisterBindingAppliedPromiseForChildren(n,r)},h.prototype._resolveChildrenBindingsAppliedPromise=function(){this._childrenBindingsPromiseResolver&&(this._childrenBindingsPromiseResolver(),this._childrenBindingsPromiseResolver=null)},h.prototype.resetChainIfCompleted=function(e){e===this.tailDataPromise&&(this.headDataPromise=null,this.tailDataPromise=null)},h.prototype.promiseRejectHelper=function(e,t,n){if(t(),this.resetChainIfCompleted(n),!e._CAUGHT_PROMISE_REJECTION&&e.message!==l){if(e instanceof Error)throw e._CAUGHT_PROMISE_REJECTION=!0,e;throw new Error(e)}r.info(e)},h.prototype.fetchData=function(){var e,n,r,i=this.registerBusyState(),o=this.currentDataProvider.fetchFirst({size:-1})[Symbol.asyncIterator](),a=function(s,u,d){return function(c){if(d.headDataPromise===r){for(var p=c.value,f=s.length,h=0;h<p.metadata.length&&h<p.data.length;h++)s.push(t(p.data[h],f,p.metadata[h].key)),f+=1;c.done?(u.call(d,s),i(),e(),d.resetChainIfCompleted(r)):o.next().then(a(s,u,d),function(e){i(),n(e),d.resetChainIfCompleted(r)})}else i(),n(new Error(l))}};(r=new Promise(function(t,s){e=t,n=s,o.next().then(a([],this.onArrayChange,this),function(e){i(),n(e),this.resetChainIfCompleted(r)}.bind(this))}.bind(this))).catch(function(e){if(e.message!==l){if(e instanceof Error)throw e._CAUGHT_PROMISE_REJECTION=!0,e;throw new Error(e)}}),this.headDataPromise=r,this.tailDataPromise=r},h.prototype.getIndexesForEvent=function(e,t){var n,r=[];if(Array.isArray(e))for(n=0;n<e.length;n++)r.push(e[n]);else if(t){var i=Array.isArray(t)?t.length:t.size,o=new d(t),a=new Map,s=0;for(n=0;n<this.firstLastNodesList.length&&s<i;n++){var u=this.firstLastNodesList[n].key,l=o.get(u);l!==o.NOT_A_KEY&&(a.set(l,n),s+=1)}t.forEach(function(e){r.push(a.get(e))})}return r},h.prototype.handleDataMutateEvent=function(e){var t,n,r={},i=this;this.tailDataPromise?(t=this.registerBusyState(),(n=this.tailDataPromise.then(function(){return t(),i.getDataMutationHelper(e,r)})).catch(function(e){i.promiseRejectHelper(e,t,n)})):(n=this.getDataMutationHelper(e,r),this.headDataPromise=n),this.tailDataPromise=n,r.head=this.headDataPromise,r.current=n},h.prototype.getDataMutationHelper=function(e,r){var i,o,a=e.detail.add,s=e.detail.remove,u=e.detail.update,d=a&&a.data,c=u&&u.data,p=()=>{if(c){var e=0,r=[],i=this.getIndexesForEvent(u.indexes,u.keys);u.keys.forEach(function(o){if(void 0!==i[e]){var a=c[e];r.push(n(i[e])),r.push(t(a,i[e],o))}e+=1}),this.onArrayChange(r)}},f=()=>{if(s){var e=this.getIndexesForEvent(s.indexes,s.keys);e=e.filter(function(e){return void 0!==e}),this.onArrayChange(e.map(n))}},h=()=>{if(d){var e=this.getIndexesForEvent(a.indexes,a.addBeforeKeys?a.addBeforeKeys:a.afterKeys),n=[],r=0;a.keys.forEach(function(i){var o=d[r];n.push(t(o,function(t){var n=e.length>t?e[t]:this.firstLastNodesList.length+t;return void 0===n?this.firstLastNodesList.length:n}(r),i)),r+=1},this),this.onArrayChange(n)}};if(u&&!Array.isArray(c)||a&&!Array.isArray(d)){var g=u&&!Array.isArray(c)?this.currentDataProvider.fetchByKeys({keys:u.keys}):Promise.resolve(),m=a&&!Array.isArray(d)?this.currentDataProvider.fetchByKeys({keys:a.keys}):Promise.resolve();i=this.registerBusyState(),(o=Promise.all([g,m]).then(e=>{if(r.head!==this.headDataPromise)throw i(),new Error(l);var t=e[0];t&&t.results.size>0&&(c=[...u.keys].map(e=>t.results.get(e).data)),p(),f();var n=e[1];n&&n.results.size>0&&(d=[...a.keys].map(e=>n.results.get(e).data)),h(),i(),this.resetChainIfCompleted(r.current)})).catch(e=>{this.promiseRejectHelper(e,i,r.current)})}else p(),f(),h();return o},h.prototype.handleDataRefreshEvent=function(){this.recreateContent(this.currentDataProvider)},h.prototype._addNoData=function(){0===this.firstLastNodesList.length&&this.element._noDataTemplateNode&&(this._noDataNodes=p.execute(this.element,this.element._noDataTemplateNode,{},null),this.insertAllAfter(this._noDataNodes))},h.prototype._removeNoData=function(){this._noDataNodes&&(this._noDataNodes.forEach(e=>{p.clean(e,this.element),e.parentNode.removeChild(e)}),this._noDataNodes=null)},h.prototype.onArrayChange=function(e){this._removeNoData();for(var t={added:[],deleted:[]},n="added",r="deleted",i=0,o=e.length;i<o;i++)if(t[n].length&&e[i].status===n){var a=t[n][t[n].length-1];(a.isBatch?a.index+a.values.length-1:a.index)+1===e[i].index?(a.isBatch||(a={isBatch:!0,status:n,index:a.index,values:[a.value],keys:[a.key]},t[n].splice(t[n].length-1,1,a)),a.values.push(e[i].value),a.keys.push(e[i].key)):t[e[i].status].push(e[i])}else t[e[i].status].push(e[i]);t[r].length>0&&(this.changeQueue.push.apply(this.changeQueue,t[r]),this.changeQueue.push({status:"clearDeletedIndexes"})),this.changeQueue.push.apply(this.changeQueue,t[n]),this.changeQueue.length>0&&!this.rendering_queued&&(this.rendering_queued=!0,this.processQueue()),this._addNoData(),this._resolveChildrenBindingsAppliedPromise()},h.prototype.processQueue=function(){var e=this,t=9007199254740991;i.utils.arrayForEach(this.changeQueue,function(n){"number"==typeof n.index&&(t=Math.min(t,n.index)),e[n.status](n)}),this.flushPendingDeletes(),this.rendering_queued=!1,this.updateIndexes(t),this.changeQueue=[]},h.prototype.added=function(e){for(var t=e.index,n=e.isBatch?e.values:[e.value],r=e.isBatch?e.keys:[e.key],o=this.getLastNodeBeforeIndex(t),a=[],s=0,u=n.length;s<u;++s){var l,d,c=this.getPendingDeleteFor(n[s]);c&&c.nodesets.length?(l=c.nodesets.pop(),d=c.currentChildContext):(d={data:n[s],index:t+s,observableIndex:i.observable()},Object.defineProperties(d,{_nearestCustomParent:{value:this.trackingContext._nearestCustomParent,enumerable:!1},_immediate:{value:this.trackingContext._immediate,enumerable:!1}}),l=p.execute(this.element,this.element._templateNode,d,this.as)),a.push.apply(a,Array.prototype.slice.call(l)),this.firstLastNodesList.splice(t+s,0,{first:l[0],last:l[l.length-1],key:r?r[s]:null,currentChildContext:d})}this.insertAllAfter(a,o)},h.prototype.getNodesForIndex=function(e){var t=[],n=this.firstLastNodesList[e].first,r=this.firstLastNodesList[e].last;for(t.push(n);n&&n!==r;)n=n.nextSibling,t.push(n);return t},h.prototype.getLastNodeBeforeIndex=function(e){return e<1||e-1>=this.firstLastNodesList.length?null:this.firstLastNodesList[e-1].last},h.prototype.insertAllAfter=function(t,n){var r,i=this.element;if(1===t.length)a(i,t[0],n);else if(e)a(i,t,n);else for(r=t.length-1;r>=0;--r){var o=t[r];if(!o)break;a(i,o,n)}return t},h.prototype.shouldDelayDeletion=function(e){return e&&("object"==typeof e||"function"==typeof e)},h.prototype.getPendingDeleteFor=function(e){var t=e&&e[s];return void 0===t?null:this.pendingDeletes[t]},h.prototype.getOrCreatePendingDeleteFor=function(e){var t=this.getPendingDeleteFor(e);return t||(t={data:e,nodesets:[]},e[s]=this.pendingDeletes.length,this.pendingDeletes.push(t),t)},h.prototype.deleted=function(e){if(this.shouldDelayDeletion(e.value)){var t=this.getOrCreatePendingDeleteFor(e.value);t.nodesets.push(this.getNodesForIndex(e.index)),t.currentChildContext=this.firstLastNodesList[e.index].currentChildContext}else this.removeNodes(this.getNodesForIndex(e.index));this.indexesToDelete.push(e.index)},h.prototype.removeNodes=function(e){if(e.length){(()=>{for(var t=e[0].parentNode,n=e.length-1;n>=0;--n)p.clean(e[n],this.element),t.removeChild(e[n])})()}},h.prototype.flushPendingDeletes=function(){for(var e=0,t=this.pendingDeletes.length;e!==t;++e){for(var n=this.pendingDeletes[e];n.nodesets.length;)this.removeNodes(n.nodesets.pop());n.data&&void 0!==n.data[s]&&delete n.data[s]}this.pendingDeletes=[]},h.prototype.clearDeletedIndexes=function(){for(var e=this.indexesToDelete.length-1;e>=0;--e)this.firstLastNodesList.splice(this.indexesToDelete[e],1);this.indexesToDelete=[]},h.prototype.updateIndexes=function(e){for(var t=e,n=this.firstLastNodesList.length;t<n;++t){var r=this.firstLastNodesList[t].currentChildContext;r&&r.observableIndex&&r.observableIndex(t)}},h.prototype.getData=function(){return{data:this.data,dataProvider:this.currentDataProvider}},h.prototype.setData=function(e){this.removeSubscriptions(),this.data=e.data,this.currentDataProvider=e.dataProvider,this.addSubscriptions()},i.bindingHandlers._ojBindForEach_={init:function(e,t,n,r,o){var a,s;return i.computed(function(){if(s=t(),a){var e,n,r=s.data,o=a.getData().data;if(i.ignoreDependencies(function(){e=i.unwrap(o),n=i.unwrap(r)}),a.setData({data:r,dataProvider:n.fetchFirst?n:null}),Array.isArray(e)&&Array.isArray(n)){var u=i.utils.compareArrays(e,n,{sparse:!0,dontLimitMoves:!0});a.onArrayChange(u)}else a.recreateContent(n)}},null,{disposeWhenNodeIsRemoved:e}),a=new h(e,s,o),i.utils.domNodeDisposal.addDisposeCallback(e,function(){a.removeSubscriptions()}),{controlsDescendantBindings:!0}}},i.virtualElements.allowedBindings._ojBindForEach_=!0}();const R={};function U(e,t,n){if("item"===e){var r=t.template;return null!=r&&(t.renderer=function(e,t){return function(n){var r=n.parentElement,o=e.createChildContext(n.data,null,function(e){e.$itemContext=n});return i.renderTemplate(t,o,{afterRender:function(e){a(e)._ojDetectCleanData()}},r,"replaceNode"),null}}(n,r)),{item:t}}return null}function $(e,t,n){return"center"===e&&t.template&&(t._renderer=j(n,t.template)),{center:t}}function F(e,t,n){return"rootNodeContent"===e&&t.template&&(t._renderer=j(n,t.template)),{rootNodeContent:t}}n._registerLegacyNamespaceProp("koStringTemplateEngine",R),R.install=function(){var e=i;if(!e.templates){var t={},n={},r=new e.nativeTemplateEngine,o=function(e){this._templateName=e,this.text=function(e){if(!e)return t[this._templateName];t[this._templateName]=e},this.data=function(e,t){if(n[this._templateName]||(n[this._templateName]={}),1===arguments.length)return n[this._templateName][e];n[this._templateName][e]=t}};r.makeTemplateSource=function(t,n){if("string"==typeof t){var r=(n=n||document).getElementById(t);return r?new e.templateSources.domElement(r):new o(t)}if(t&&1===t.nodeType||8===t.nodeType)return new e.templateSources.anonymousTemplate(t)},e.templates=t,e.setTemplateEngine(r)}},_.getDefaultInstance().setupManagedAttributes({attributes:["item"],init:function(e,t,n,r,i,o,a){var s=U(e,t,a);if(null!=s)return s},update:function(e,t,n,r,i,o,a){return U(e,t,a)},for:"ojListViewRenderer"}),_.getDefaultInstance().setupManagedAttributes({for:"ojListView",use:"ojListViewRenderer"}),_.getDefaultInstance().setupManagedAttributes({for:"ojNavigationList",use:"ojListViewRenderer"}),n._registerLegacyNamespaceProp("ResponsiveKnockoutUtils",g),n._registerLegacyNamespaceProp("KnockoutTemplateUtils",h),_.getDefaultInstance().setupManagedAttributes({attributes:["center"],init:function(e,t,n,r,i,o,a){return $(e,t,a)},update:function(e,t,n,r,i,o,a){return $(e,t,a)},for:"ojStatusMeterGauge"}),_.getDefaultInstance().setupManagedAttributes({attributes:["rootNodeContent"],init:function(e,t,n,r,i,o,a){return F(e,t,a)},update:function(e,t,n,r,i,o,a){return F(e,t,a)},for:"ojSunburst"});var H="columns",G="columnsDefault",W="rowTemplate";function q(e,t,n){var r,o;return r=n,o=t,function(t){var n=null,s=null;if("header"===o)n=e.createChildContext(null,null,function(e){e.$columnIndex=t.columnIndex,e.$headerContext=t.headerContext,e.$data=t.data}),s=t.headerContext.parentElement;else if("cell"===o){var u=t.row;n=e.createChildContext(u,null,function(e){e.$columnIndex=t.columnIndex,e.$cellContext=t.cellContext}),s=t.cellContext.parentElement}"footer"===o&&(n=e.createChildContext(null,null,function(e){e.$columnIndex=t.columnIndex,e.$footerContext=t.footerContext}),s=t.footerContext.parentElement),i.renderTemplate(r,n,{afterRender:function(e){a(e)._ojDetectCleanData()}},s,"replaceNode")}}function J(e,t){return function(n){var r=n.row,o=e.createChildContext(r,null,function(e){e.$rowContext=n.rowContext});i.renderTemplate(t,o,{afterRender:function(e){a(e)._ojDetectCleanData()}},n.rowContext.parentElement,"replaceNode")}}function V(e,t,n){var r,i;if("areaLayers"===e){for(r=0;r<t.length;r++){var o=t[r].areaDataLayer;o&&null!=(i=o.template)&&(o._templateRenderer=P(n,i))}return{areaLayers:t}}if("pointDataLayers"===e){for(r=0;r<t.length;r++)null!=(i=t[r].template)&&(t[r]._templateRenderer=P(n,i));return{pointDataLayers:t}}return null}function K(e,t,n){return"nodeContent"===e&&t.template&&(t._renderer=j(n,t.template)),{nodeContent:t}}_.getDefaultInstance().setupManagedAttributes({attributes:[H,G,W],init:function(e,t,n,r,i,o,a){if(e===H||e===G){for(var s=0;s<t.length;s++){var u=t[s],l=u.template,d=u.footerTemplate,c=u.headerTemplate;null!=l&&(u.renderer=q(a,"cell",l)),null!=d&&(u.footerRenderer=q(a,"footer",d)),null!=c&&(u.headerRenderer=q(a,"header",c))}return e===H?{columns:t}:{columnsDefault:t}}if(e===W)return{rowRenderer:J(a,t)}},update:function(e,t,n,r,i,o,a){if(e===H||e===G){for(var s=0;s<t.length;s++){var u=t[s],l=u.template,d=u.footerTemplate,c=u.headerTemplate;null!=l&&(u.renderer=q(a,"cell",l)),null!=d&&(u.footerRenderer=q(a,"footer",d)),null!=c&&(u.headerRenderer=q(a,"header",c))}r(e===H?{columns:t}:{columnsDefault:t})}else if(e===W)return{rowRenderer:J(a,t)};return null},for:"ojTable"}),_.getDefaultInstance().setupManagedAttributes({attributes:["areaLayers","pointDataLayers"],init:function(e,t,n,r,i,o,a){return V(e,t,a)},update:function(e,t,n,r,i,o,a){return V(e,t,a)},for:"ojThematicMap"}),_.getDefaultInstance().setupManagedAttributes({attributes:["nodeContent"],init:function(e,t,n,r,i,o,a){return K(e,t,a)},update:function(e,t,n,r,i,o,a){return K(e,t,a)},for:"ojTreemap"})});
//# sourceMappingURL=ojknockout.js.map