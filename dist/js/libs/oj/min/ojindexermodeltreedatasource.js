/**
 * @license
 * Copyright (c) 2014, 2022, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojcore-base","ojs/ojindexer","ojs/ojdatasource-common"],function(t,e,n,i){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;const s=function(t,e,n,i){this.data=t,this.idAttr=e,this.listener=n,this.options=i,this.Init()};e._registerLegacyNamespaceProp("IndexerModelTreeDataSource",s),e.Object.createSubclass(s,e.TreeDataSource,"oj.IndexerModelTreeDataSource"),s.prototype.Init=function(){s.superclass.Init.call(this);var t=this.options.sections;if(null==t){var n=e.Translations.getTranslatedString("oj-ojIndexer.indexerCharacters");t=n.split("|")}t.push(e.IndexerModel.SECTION_OTHERS);var i=this.options.groupingStrategy;if(null==i){var r=this.options.groupingAttribute;i=function(n){var i=(n[r]?n[r]:n).toString().toUpperCase()[0];return t.indexOf(i)>-1?i:e.IndexerModel.SECTION_OTHERS}}var o,a=this.options.sortComparatorFunction;this.data=this.data.sort(function(e,n){var s=i(e),r=i(n),o=t.indexOf(s)-t.indexOf(r);return 0===o&&a?a(e,n):o});for(var u=0;u<this.data.length;u++){var l=i(this.data[u]);o!==l&&(o=l,this._set(l,u))}this.sections=t},s.prototype._set=function(t,e){null==this.pos&&(this.pos=[]),this.pos.push({key:t,value:e})},s.prototype._get=function(t){for(var e=0;e<this.pos.length;e++)if(this.pos[e].key===t)return this.pos[e].value;return null},s.prototype.getIndexableSections=function(){return this.sections.slice(0,this.sections.length-1)},s.prototype.getMissingSections=function(){if(null==this.missing){for(var t=[],e=0;e<this.sections.length-1;e++){var n=this.sections[e];null==this._get(n)&&t.push(n)}this.missing=t}return this.missing},s.prototype.setSection=function(t){return this.listener.call(this,t)},s.prototype.getChildCount=function(t){if(null==t){var n=this.sections.length-this.getMissingSections().length;return null!=this._get(e.IndexerModel.SECTION_OTHERS)?n:n-1}var i=this._get(t);if(null!=i){var s=this.sections.indexOf(t);if(s===this.sections.length-1)return this.data.length-i;s+=1;for(var r=this.sections[s],o=this._get(r);null==o&&s<this.sections.length;)s+=1,r=this.sections[s],o=this._get(r);return(isNaN(o)||null==o)&&(o=this.data.length),o-i}return 0},s.prototype.fetchChildren=function(t,e,n,i){var s,r=this;if(null==t){var o=this.sections.filter(function(t){return null!=r._get(t)});s={getParent:function(){return t},getStart:function(){return 0},getCount:function(){return o.length},getData:function(t){return o[t]},getMetadata:function(t){return{key:o[t],leaf:!1,depth:0}}}}else s={getParent:function(){return t},getStart:function(){return 0},getCount:function(){return r.getChildCount(t)},getData:function(e){return r.data[r._get(t)+e]},getMetadata:function(e){var n=r.data[r._get(t)+e];return{key:null!=r.idAttr?n[r.idAttr]:n,leaf:!0,depth:1}}};null!=n&&null!=n.success&&n.success.call(null,s)},s.prototype.getSortCriteria=function(){return{key:null,direction:"none"}},t.IndexerModelTreeDataSource=s,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojindexermodeltreedatasource.js.map