/**
 * @license
 * Copyright (c) 2014, 2023, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","preact/jsx-runtime","preact","ojs/ojthemeutils","ojs/ojlabel","ojs/ojcustomelement-utils","ojs/ojdomutils"],function(t,e,l,o,s,n,a){"use strict";function r(t){const s=function(t,e){let l=t;if(e>1){const s=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/,n=t.match(s),a=parseFloat(n[1]);switch(n[2]){case"vw":case"vmin":case"vmax":case"%":if(e>1){l="calc((("+t+" / "+e+") - (("+o.parseJSONFromFontFamily("oj-form-layout-option-defaults").columnGap+" * ("+(e-1)+") * "+a/e/100+")))"}}}return l}(t.labelWidth,t.colspan),n="calc(100% - "+s+")",a={flexGrow:"0",flexShrink:"0",flexBasis:s,width:s,maxWidth:s},r={flexGrow:"1",flexShrink:"1",flexBasis:n,width:n,maxWidth:n};return Array.isArray(t.children)||(t.children.props.labelEdge="provided"),e.jsxs(l.Fragment,{children:[e.jsx("div",{class:"oj-formlayout-inline-label",style:a,children:e.jsx("oj-label",{for:t.forid,children:t.labelText})}),e.jsx("div",{class:"oj-formlayout-inline-value",style:r,children:t.children})]})}function i(t){return Array.isArray(t.children)||(t.children.props.labelEdge="provided"),e.jsxs(l.Fragment,{children:[e.jsx("oj-label",{for:t.forid,children:t.labelText}),t.children]})}const m="nowrap",c="truncate",u="wrap",d="efficient",p="start",h="top";function f(t){let o,s=!1,a=t.children;if(a){const m=!Array.isArray(a);return m&&(o=n.ElementUtils.getUniqueId(a.props.id),String(a.props.children?.type).toLowerCase().startsWith("oj-c-")&&(s=!0,a=a.props.children)),t.labelEdge!==p||s?t.labelEdge!==h||s?(m&&("inside"===t.labelEdge||s?(a.props.labelEdge=t.labelEdge,a.props.labelHint=t.labelText):a.props.labelEdge="none"),e.jsx(l.Fragment,{children:t.children})):e.jsx(i,{forid:o,...t}):e.jsx(r,{forid:o,...t})}return null}class j extends l.Component{render(t){let l="oj-flex-item";const o=this._getFullFlexItemWidth(this.props.colspan,this.props.totalColumns);let s={flexGrow:"1",flexShrink:"1",flexBasis:o,width:o,maxWidth:o};return this.props.labelEdge==p&&(s.display="flex"),"formLayout"===this.props.contentType&&(l+=" oj-formlayout-nested-formlayout"),e.jsx("div",{class:l,style:s,children:e.jsx(f,{labelText:this.props.labelText,labelEdge:this.props.labelEdge,labelWidth:this.props.labelWidth,colspan:this.props.colspan,totalColumns:this.props.totalColumns,children:this.props.children})},t.cellKey)}_getFullFlexItemWidth(t,e){if(t===e)return"100%";let l=(o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}).columnGap,s=(this.props.totalColumns,"calc(((100% / "+e+") - (("+l+" * ("+(e-1)+") / "+e+")))");return t>1&&(s+=" * "+t+" + ("+l+" * "+(t-1)+")"),s+=")",s}}j.defaultProps={colspan:1,totalColumns:1,labelEdge:"inside",labelWidth:"33%",labelText:""};class x extends l.Component{render(t){this._columns=t.columns>0?t.columns:t.maxColumns;const l="oj-form-layout oj-formlayout-max-cols-"+this._columns,o=this._getColumnFormContent(t.formControls,t.columns);return e.jsx("div",{class:l,children:o})}_getColumnFormContent(t,l){let s,n,a,r=[];for(const l of t)n="function"==typeof l.content?l.content():l.content,a=l.labelEdge,a||(this._themeDefault||(this._themeDefault=o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),a=this._themeDefault.labelEdge),s=e.jsx(j,{totalColumns:1,labelText:l.labelText,labelEdge:a,labelWidth:l.labelWidth,contentType:l.contentType,cellKey:l.key,children:n}),r.push(e.jsx("div",{class:"oj-flex","data-oj-internal":!0,children:s}));const i=this._getColumnStyling(l);return e.jsx("div",{class:i.formClassName,style:i.formStyle,"data-oj-context":!0,"data-oj-internal":!0,children:r})}_getColumnStyling(t){let e="oj-form";return this.props.readonly||(e+=" oj-enabled"),this.props.userAssistanceDensity===d&&(e+=" oj-efficient"),this.props.labelWrapping===c&&(e+=" oj-formlayout-labels-nowrap"),t>0&&(e+=" oj-form-layout-no-min-column-width"),e+=" oj-form-cols",{formClassName:e,formStyle:{columnCount:this._columns,webkitColumnCount:this._columns,MozColumnCount:this._columns}}}}x.defaultProps={colspanWrap:"nowrap",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"};class C extends l.Component{constructor(){super(...arguments),this.setFormDivRef=t=>{this.formDivRef=t},this.state={availableColumns:0},this._updateAvailableColumns=()=>{if(0===this._calculateColumns(0)){const t=this.formDivRef,e=t.class;t.class="oj-form-layout";const l=this._calculateAvailableColumns(t);t.class=e,this.state.availableColumns!==l&&this.setState({availableColumns:l})}}}render(t){const l="oj-form-layout oj-formlayout-max-cols-"+(t.columns>0?t.columns+" oj-form-layout-no-min-column-width":t.maxColumns),o=this._getRowFormContent(this.props.formControls);return e.jsx("div",{class:l,ref:this.setFormDivRef,children:o})}componentDidMount(){this._updateAvailableColumns(),a.addResizeListener(this.formDivRef,this._updateAvailableColumns,25)}componentDidUpdate(){this._updateAvailableColumns()}componentWillUnmount(){a.removeResizeListener(this.formDivRef,this._updateAvailableColumns)}_calculateAvailableColumns(t){let e=Math.max(this.props.maxColumns,1),l=parseFloat(window.getComputedStyle(t.querySelector(".oj-form")).columnWidth);if(!isNaN(l)){let t=this.formDivRef.getBoundingClientRect().width;e=Math.max(Math.floor(t/l),1)}return e}_calculateColumns(t){let e=Math.max(this.props.maxColumns,1);const l=this.props.columns;return l>0?e=l:e>1&&t<e&&(e=t),e}_getRowFormContent(t){let l,s=[];const n=this._calculateColumns(this.state.availableColumns);0===n&&(t=[]);let a,r,i,m,c=0,u=!1;for(const d of t){if(a=1,r=n,i="function"==typeof d.content?d.content():d.content,c%n==0&&(l&&this._addRowToForm(s,l,c),l=[]),d.colspan&&d.colspan>1){const t=c%n;let e=n-t;a=Math.floor(d.colspan),"wrap"===this.props.colspanWrap&&e<a&&t>0&&(this._addRowToForm(s,l,c),c+=e,l=[],e=n),a=Math.min(a,e),u=n>1}m=d.labelEdge,m||(this._themeDefault||(this._themeDefault=o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),m=this._themeDefault.labelEdge),l.push(e.jsx(j,{colspan:a,totalColumns:r,labelText:d.labelText,labelEdge:m,labelWidth:d.labelWidth,contentType:d.contentType,cellKey:d.key,children:i})),c+=a,c%n!=0&&this._addColumnGutter(l)}this._addRowToForm(s,l,c);const d=this._getRowStyling(u);return e.jsx("div",{class:d.formClassName,style:d.formStyle,"data-oj-context":!0,"data-oj-internal":!0,children:s})}_addColumnGutter(t){t.push(e.jsx("div",{class:"oj-formlayout-column-gutter"}))}_addRowToForm(t,l,o){this._addPaddingCells(l,o),t.push(e.jsx("div",{class:"oj-flex","data-oj-internal":!0,children:l}))}_addPaddingCells(t,l){const o=this._calculateColumns(this.state.availableColumns)||this.props.maxColumns,s=l%o;if(t&&s>0)for(let l=s;l<o;l++)l!==s&&this._addColumnGutter(t),t.push(e.jsx(j,{colspan:1,totalColumns:o,labelEdge:"none"}))}_getRowStyling(t){let e="oj-form";this.props.readonly||(e+=" oj-enabled"),this.props.userAssistanceDensity===d&&(e+=" oj-efficient"),this.props.labelWrapping===c&&(e+=" oj-formlayout-labels-nowrap"),t&&(e+=" oj-form-control-full-width"),e+=" oj-form-cols";return e+=" oj-formlayout-form-across",{formClassName:e,formStyle:{columnCount:1,webkitColumnCount:1,MozColumnCount:1}}}}C.defaultProps={colspanWrap:m,formControls:[],labelWrapping:u,columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:d};class y extends l.Component{render(t){const{direction:l,...o}=t;return"column"===l?e.jsx(x,{...o}):e.jsx(C,{...o})}}y.defaultProps={colspanWrap:m,direction:"row",formControls:[],labelWrapping:u,columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:d},t.VFormGenerator=y,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojvformgenerator.js.map