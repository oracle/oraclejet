/**
 * @license
 * Copyright (c) 2014, 2024, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","preact/jsx-runtime","preact","ojs/ojthemeutils","ojs/ojlabel","ojs/ojcustomelement-utils","ojs/ojdomutils"],function(e,o,t,l,s,n,a){"use strict";function r(e){const s=function(e,o){let t=e;if(o>1){const s=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/,n=e.match(s),a=parseFloat(n[1]);switch(n[2]){case"vw":case"vmin":case"vmax":case"%":if(o>1){t="calc((("+e+" / "+o+") - (("+l.parseJSONFromFontFamily("oj-form-layout-option-defaults").columnGap+" * ("+(o-1)+") * "+a/o/100+")))"}}}return t}(e.labelWidth,e.colspan),n="calc(100% - "+s+")",a={flexGrow:"0",flexShrink:"0",flexBasis:s,width:s,maxWidth:s},r={flexGrow:"1",flexShrink:"1",flexBasis:n,width:n,maxWidth:n};return Array.isArray(e.children)||(e.children.props.labelEdge="provided"),o.jsxs(t.Fragment,{children:[o.jsx("div",{class:"oj-formlayout-inline-label",style:a,children:o.jsx("oj-label",{for:e.forid,children:e.labelText})}),o.jsx("div",{class:"oj-formlayout-inline-value",style:r,children:e.children})]})}function i(e){return Array.isArray(e.children)||(e.children.props.labelEdge="provided"),o.jsxs(t.Fragment,{children:[o.jsx("oj-label",{for:e.forid,children:e.labelText}),e.children]})}const c="nowrap",m="truncate",d="wrap",u="efficient",p="start",h="top";function f(e){let l,s=!1,a=e.children;if(a){const c=!Array.isArray(a);return c&&(l=n.ElementUtils.getUniqueId(a.props.id),String(a.props.children?.type).toLowerCase().startsWith("oj-c-")&&(s=!0,a=a.props.children)),e.labelEdge!==p||s?e.labelEdge!==h||s?(c&&("inside"===e.labelEdge||s?(a.props.labelEdge=e.labelEdge,a.props.labelHint=e.labelText):a.props.labelEdge="none"),o.jsx(t.Fragment,{children:e.children})):o.jsx(i,{forid:l,...e}):o.jsx(r,{forid:l,...e})}return null}const y=e=>"string"!=typeof e&&isNaN(e);class j extends t.Component{render(e){let l="oj-flex-item";const s=this._getFullFlexItemWidth(e.colspan,e.totalColumns);let n={flexGrow:"1",flexShrink:"1",flexBasis:s,width:s,maxWidth:s};e.labelEdge==p&&(n.display="flex"),"formLayout"===e.contentType&&(l+=" oj-formlayout-nested-formlayout");return t.toChildArray(e.children).forEach(o=>{if(y(o)){const l=t.toChildArray(o.props.children);if(1===l.length){const o=l[0];if(y(o)&&String(o.type).toLowerCase().startsWith("oj-c-")){const t=o;t.props.containerReadonly=e.containerReadonly,void 0===t.props.readonly&&void 0===t.props.READONLY&&(t.props.readonly=e.containerReadonly)}}}}),o.jsx("div",{class:l,style:n,children:o.jsx(f,{containerReadonly:e.containerReadonly,labelText:e.labelText,labelEdge:e.labelEdge,labelWidth:e.labelWidth,colspan:e.colspan,totalColumns:e.totalColumns,children:e.children})},e.cellKey)}_getFullFlexItemWidth(e,o){if(e===o)return"100%";let t=(l.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}).columnGap,s=(this.props.totalColumns,"calc(((100% / "+o+") - (("+t+" * ("+(o-1)+") / "+o+")))");return e>1&&(s+=" * "+e+" + ("+t+" * "+(e-1)+")"),s+=")",s}}j.defaultProps={colspan:1,totalColumns:1,labelEdge:"inside",labelWidth:"33%",labelText:""};class C extends t.Component{render(e){this._columns=e.columns>0?e.columns:e.maxColumns;const t="oj-form-layout oj-formlayout-max-cols-"+this._columns,l=this._getColumnFormContent(e.formControls,e.columns,e.readonly);return o.jsx("div",{class:t,children:l})}_getColumnFormContent(e,t,s){let n,a,r,i=[];for(const t of e)a="function"==typeof t.content?t.content():t.content,r=t.labelEdge,r||(this._themeDefault||(this._themeDefault=l.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),r=this._themeDefault.labelEdge),n=o.jsx(j,{containerReadonly:s,totalColumns:1,labelText:t.labelText,labelEdge:r,labelWidth:t.labelWidth,contentType:t.contentType,cellKey:t.key,children:a}),i.push(o.jsx("div",{class:"oj-flex","data-oj-internal":!0,children:n}));const c=this._getColumnStyling(t);return o.jsx("div",{class:c.formClassName,style:c.formStyle,"data-oj-context":!0,"data-oj-internal":!0,children:i})}_getColumnStyling(e){let o="oj-form";return this.props.readonly||(o+=" oj-enabled"),this.props.userAssistanceDensity===u&&(o+=" oj-efficient"),this.props.labelWrapping===m&&(o+=" oj-formlayout-labels-nowrap"),e>0&&(o+=" oj-form-layout-no-min-column-width"),o+=" oj-form-cols",{formClassName:o,formStyle:{columnCount:this._columns,webkitColumnCount:this._columns,MozColumnCount:this._columns}}}}C.defaultProps={colspanWrap:"nowrap",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"};class x extends t.Component{constructor(){super(...arguments),this.setFormDivRef=e=>{this.formDivRef=e},this.state={availableColumns:0},this._updateAvailableColumns=()=>{if(0===this._calculateColumns(0)){const e=this.formDivRef,o=e.class;e.class="oj-form-layout";const t=this._calculateAvailableColumns(e);e.class=o,this.state.availableColumns!==t&&this.setState({availableColumns:t})}}}render(e){const t="oj-form-layout oj-formlayout-max-cols-"+(e.columns>0?e.columns+" oj-form-layout-no-min-column-width":e.maxColumns),l=this._getRowFormContent(this.props.formControls,this.props.readonly);return o.jsx("div",{class:t,ref:this.setFormDivRef,children:l})}componentDidMount(){this._updateAvailableColumns(),a.addResizeListener(this.formDivRef,this._updateAvailableColumns,25)}componentDidUpdate(){this._updateAvailableColumns()}componentWillUnmount(){a.removeResizeListener(this.formDivRef,this._updateAvailableColumns)}_calculateAvailableColumns(e){let o=Math.max(this.props.maxColumns,1),t=parseFloat(window.getComputedStyle(e.querySelector(".oj-form")).columnWidth);if(!isNaN(t)){let e=this.formDivRef.getBoundingClientRect().width;o=Math.max(Math.floor(e/t),1)}return o}_calculateColumns(e){let o=Math.max(this.props.maxColumns,1);const t=this.props.columns;return t>0?o=t:o>1&&e<o&&(o=e),o}_getRowFormContent(e,t){let s,n=[];const a=this._calculateColumns(this.state.availableColumns);0===a&&(e=[]);let r,i,c,m,d=0,u=!1;for(const p of e){if(r=1,i=a,c="function"==typeof p.content?p.content():p.content,d%a==0&&(s&&this._addRowToForm(n,s,d),s=[]),p.colspan&&p.colspan>1){const e=d%a;let o=a-e;r=Math.floor(p.colspan),"wrap"===this.props.colspanWrap&&o<r&&e>0&&(this._addRowToForm(n,s,d),d+=o,s=[],o=a),r=Math.min(r,o),u=a>1}m=p.labelEdge,m||(this._themeDefault||(this._themeDefault=l.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),m=this._themeDefault.labelEdge),s.push(o.jsx(j,{colspan:r,containerReadonly:t,totalColumns:i,labelText:p.labelText,labelEdge:m,labelWidth:p.labelWidth,contentType:p.contentType,cellKey:p.key,children:c})),d+=r,d%a!=0&&this._addColumnGutter(s)}this._addRowToForm(n,s,d);const p=this._getRowStyling(u);return o.jsx("div",{class:p.formClassName,style:p.formStyle,"data-oj-context":!0,"data-oj-internal":!0,children:n})}_addColumnGutter(e){e.push(o.jsx("div",{class:"oj-formlayout-column-gutter"}))}_addRowToForm(e,t,l){this._addPaddingCells(t,l),e.push(o.jsx("div",{class:"oj-flex","data-oj-internal":!0,children:t}))}_addPaddingCells(e,t){const l=this._calculateColumns(this.state.availableColumns)||this.props.maxColumns,s=t%l;if(e&&s>0)for(let t=s;t<l;t++)t!==s&&this._addColumnGutter(e),e.push(o.jsx(j,{colspan:1,totalColumns:l,labelEdge:"none"}))}_getRowStyling(e){let o="oj-form";this.props.readonly||(o+=" oj-enabled"),this.props.userAssistanceDensity===u&&(o+=" oj-efficient"),this.props.labelWrapping===m&&(o+=" oj-formlayout-labels-nowrap"),e&&(o+=" oj-form-control-full-width"),o+=" oj-form-cols";return o+=" oj-formlayout-form-across",{formClassName:o,formStyle:{columnCount:1,webkitColumnCount:1,MozColumnCount:1}}}}x.defaultProps={colspanWrap:c,formControls:[],labelWrapping:d,columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:u};class b extends t.Component{render(e){const{direction:t,...l}=e;return"column"===t?o.jsx(C,{...l}):o.jsx(x,{...l})}}b.defaultProps={colspanWrap:c,direction:"row",formControls:[],labelWrapping:d,columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:u},e.VFormGenerator=b,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ojvformgenerator.js.map