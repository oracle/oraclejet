/**
 * @license
 * Copyright (c) 2014, 2023, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["knockout","ojs/ojkoshared","ojs/ojcontext","ojs/ojtemplateengine-utils"],function(e,t,r,o){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;return new class{constructor(){this._defaultProps=new Map,this._bindingProvider={__ContextFor:e.contextFor,__ExtendBindingContext:t.extendBindingContext,__KoComputed:e.computed,__Observable:e.observable}}execute(e,t,r,n,a,d){const c=t.getAttribute("data-oj-as"),s=o.TemplateEngineUtils.getContext(this._bindingProvider,e,t,r,n,c,d);if(t.render)return this._executeVDomTemplate(e,t,s,d);throw new Error(`The render property is expected on the template for component ${e.id}`)}clean(t,r){let n=o.PreactTemplate.findTemplateRoots(t,r);return n.forEach(e=>{o.PreactTemplate.clean(e)}),0===n.length?e.cleanNode(t):null}resolveProperties(e,t,r,n,a,d,c,s){const l=t.render;if(l){const e=o.TemplateEngineUtils.getResolvedDefaultProps(this._defaultProps,r,n);return o.PreactTemplate.resolveVDomTemplateProps(t,l,r,n,a,e,c)}throw new Error(`The render property is expected on the template for component ${e.id}`)}defineTrackableProperty(e,t,r,n){o.TemplateEngineUtils.createPropertyBackedByObservable(this._bindingProvider,e,t,r,n)}_executeVDomTemplate(t,n,a,d){const c=r.getContext(n).getBusyContext(),s=e.pureComputed({read:()=>n.render(a.$current,d)}).extend({rateLimit:{timeout:0,method:(e,t)=>{let r;return()=>{if(!r){const o=c.addBusyState({description:"pending changes for the template element"});r=setTimeout(()=>{r=void 0,e(),o()},t)}}}}}),l=s();o.PreactTemplate.extendTemplate(n,o.PreactTemplate._ROW_CACHE_FACTORY,e=>{n._cachedRows.forEach(r=>{let n=e(r.currentContext,d);o.PreactTemplate.renderNodes(t,n,r,d)})});const i=document.createElement("div"),p={currentContext:a.$current,template:n,parentStub:i,computedVNode:s,vnode:void 0,nodes:void 0};return o.PreactTemplate.renderNodes(t,l,p,d),n._cachedRows.push(p),s.subscribe(e=>{const r=n._cachedRows.find(e=>e.computedVNode===s);r&&o.PreactTemplate.renderNodes(t,e,r,d)}),p.nodes}}});
//# sourceMappingURL=ojtemplateengine-preact-ko.js.map