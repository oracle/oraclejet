/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(['./DvtToolkit'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.

  // Map the D namespace to dvt, which is used to provide access across partitions.
  var D = dvt;
  
D.nQ=function(a,b,c){this.Init(a,b,c)};(0,D.ca)("DvtPictoChart",D.nQ);D.w.l(D.nQ,D.lj,"DvtPictoChart");D.nQ.newInstance=function(a,b,c){return new D.nQ(a,b,c)};D.nQ.prototype.Init=function(a,b,c){D.nQ.o.Init.call(this,a,b,c);this.Ia=new D.oQ(this);this.Ia.le(this);(0,D.Ef)()||(0,D.rj)(this.Ia,new D.pQ(this.Ia));this.pf=new D.qQ;this.Za=[]};D.nQ.prototype.rC=function(a,b){if(!a||!b){var c=D.rQ.$k(this,a,b);this.a7=c;a||(a=c.Rl?c.Mpa*c.BZ:0);b||(b=c.Rl?c.vta*c.K0:0)}return new D.wg(a,b)};
D.nQ.prototype.P=function(a,b,c){this.Mg=this.X;var d=this.jn,e=this.Ga?this.Ga:0,f=this.Ua?this.Ua:0;this.Ia.Ac();this.Za=[];this.jn=[];this.a7=null;this.en&&(this.X.removeChild(this.en),this.en=null);this.Sa&&(this.Rs=!0,this.Sa.stop());this.ud(a);var g=this.j();if(!b&&!c){if(g.Ka.style.display="block",b=this.rC(),D.A.tT(g,b.e,b.g),c=D.A.gba(g),b.e==c.e&&b.g!=c.g?(this.Ua=c.g,b=this.rC(null,this.Ua),D.A.tT(g,b.e,this.Ua),this.Ga=D.A.gba(g).e):b.e!=c.e&&b.g==c.g?(this.Ga=c.e,b=this.rC(this.Ga,null),
D.A.tT(g,this.Ga,b.g),this.Ua=D.A.gba(g).g):(this.Ga=c.e,this.Ua=c.g),this.Ga!=b.e||this.Ua!=b.g)this.a7=null}else this.Ga=b,this.Ua=c;this.X=new D.B(g);this.k(this.X);D.rQ.P(this,this.X,new D.y(0,0,this.Ga,this.Ua),this.a7);if(this.Mg)"none"!=this.D.animationOnDataChange&&a&&(a=new D.Hm(g,null),(0,D.Im)(a,d,this.jn),this.Sa=a.Mq());else{var h=this.D.animationOnDisplay,d=this.xa();a=this.j();b=new D.y(0,0,this.Ga,this.Ua);if(D.Xk.isSupported(h))d=D.Xk.$x(a,h,this.X,b,d);else{c=[];if("popIn"==h)for(h=
0;h<this.jn.length;h++){var i=this.jn[h];c.push(new D.dn(a,i,!0,d))}else if("none"!=h){for(h=0;h<this.jn.length;h++){var i=this.jn[h],k=new D.en(a,i,d),l,m;D.rQ.Ra(this)?(l=D.rQ.Yba(this)?this.Ga:0,m=i.Dg(),i.pu(l),(0,D.T)(k.J,"typeNumber",i,i.Dg,i.pu,m)):(l=D.rQ.Xba(this)?this.Ua:0,m=i.Eg(),i.qu(l),(0,D.T)(k.J,"typeNumber",i,i.Eg,i.qu,m));c.push(k)}c.push(D.Xk.$x(a,D.Xk.sw,this.X,b,d))}d=0<c.length?new D.cn(a,c):null}this.Sa=d}this.Sa?(D.A.tT(g,window.Math.max(e,this.Ga),window.Math.max(f,this.Ua)),
this.Ia.ei(this),this.en&&this.X.removeChild(this.en),this.Sa.he(this.RX,this),this.Sa.play()):this.RX()};D.nQ.prototype.render=D.nQ.prototype.P;D.u=D.nQ.prototype;D.u.ud=function(a){a?this.D=this.pf.Tj(a):this.D||(this.D=(0,D.tj)(this));(0,D.Sk)()||(this.D.animationOnDisplay="none",this.D.animationOnDataChange="none");a=this.D.selectionMode;this.Hb="single"==a?new D.Tk("s"):"multiple"==a?new D.Tk("m"):null;this.Ia.wu(this.Hb)};
D.u.RX=function(){this.Mg&&(this.removeChild(this.Mg),this.Mg.Q(),this.Mg=null);this.Sa&&(this.Sa=null,this.Ia.le(this),this.en&&this.X.k(this.en));D.A.tT(this.j(),this.Ga,this.Ua);(0,D.vj)(this.Ia,this.Za[0]);this.Hb&&(0,D.Al)(this.Hb,this.D.selection,this.Za);(0,D.jl)(this.D.highlightedCategories,this.Za,"any"==this.D.highlightMatch);this.Pn();this.Rs||(0,D.cl)(this);this.Rs=null};D.u.la=(0,D.s)("Ia");D.u.Pca=(0,D.q)("Za");D.u.yh=(0,D.s)("Za");
D.u.xa=function(){return(0,D.Po)(this.D.animationDuration)/1E3};D.u.Q=function(){this.Ia&&(this.Ia.ei(this),this.Ia.Q(),this.Ia=null);D.nQ.o.Q.call(this)};D.nQ.prototype.destroy=D.nQ.prototype.Q;D.nQ.prototype.Ee=function(a){var b=this.q();b.highlightedCategories=D.il.Y(a);(0,D.jl)(a,this.yh(),"any"==b.highlightMatch)};D.nQ.prototype.highlight=D.nQ.prototype.Ee;D.nQ.prototype.select=function(a){this.q().selection=D.il.Y(a);this.Hb&&(0,D.Al)(this.Hb,a,this.yh())};D.nQ.prototype.select=D.nQ.prototype.select;
D.nQ.prototype.Fj=function(){return(0,D.gk)(this.q(),"componentName","DvtUtilBundle","PICTOCHART")};D.nQ.prototype.Df=function(){this.Xha||(this.Xha=new D.sQ(this));return this.Xha};D.nQ.prototype.getAutomation=D.nQ.prototype.Df;
D.sQ=(0,D.q)("lg");(0,D.ca)("DvtPictoChartAutomation",D.sQ);D.w.l(D.sQ,D.xj,"DvtPictoChartAutomation");D.sQ.prototype.ol=function(a){return(a=(0,D.yj)(this.lg.la(),a))&&a instanceof D.tQ?"item["+this.lg.yh().indexOf(a)+"]":null};D.sQ.prototype.Ff=function(a){if("tooltip"==a)return(0,D.Rl)(this.lg);var b=a.indexOf("[");return 0<b&&"item"===a.substring(0,b)&&(a=(0,window.parseInt)(a.substring(b+1,a.length-1)),a=this.lg.yh()[a])?a.ta():null};D.sQ.prototype.getDomElementForSubId=D.sQ.prototype.Ff;
D.sQ.prototype.getItem=function(a){if(a=this.lg.yh()[a]){var b={};b.color=a.si();b.tooltip=a.zc();b.id=a.getId();b.name=a.getName();b.count=a.getCount();b.selected=a.Ca();return b}return null};D.sQ.prototype.getItem=D.sQ.prototype.getItem;D.sQ.prototype.UL=function(){return this.lg.yh().length};D.sQ.prototype.getItemCount=D.sQ.prototype.UL;
D.oQ=function(a){this.Init(a.j(),a.dispatchEvent,a);this.lg=a};D.w.l(D.oQ,D.Jj,"DvtPictoChartEventManager");D.u=D.oQ.prototype;D.u.dm=function(a,b,c){a=this.lg.q();"none"!=a.hoverBehavior&&(b=b.Lc?b.Lc():[],a.highlightedCategories=c?b.slice():null,c=new D.om(c?"categoryRollOver":"categoryRollOut",a.highlightedCategories),b=(0,D.Po)(a.hoverBehaviorDelay),this.DB.Od(c,this.lg.yh(),b,"any"==a.highlightMatch))};D.u.BI=function(a){(a=(0,D.yj)(this,a.target))&&(!a.Aa||!a.Aa())&&this.qs(a)};
D.u.Iy=function(a){(a=(0,D.yj)(this,a.target))&&a.Aa&&a.Aa()&&this.qs(a)};D.u.yN=function(a){(a=(0,D.yj)(this,a.target))&&(!a.Aa||!a.Aa())&&this.qs(a)};D.u.or=function(a){(a=(0,D.yj)(this,a.target))&&(!a.Aa||!a.Aa())&&this.qs(a)};D.u.tB=function(a){var b=(0,D.yj)(this,a.target);b&&(b.Aa&&b.Aa())&&(a.preventDefault(),a.stopPropagation(),this.qs(b))};D.u.qs=function(a){a instanceof D.tQ&&a.Sg()&&this.Fh(new D.Nj(a.getId()))};
D.qQ=function(){this.Init({alta:D.uQ})};D.w.l(D.qQ,D.Hj,"DvtPictoChartDefaults");
D.uQ={animationOnDisplay:"none",animationOnDataChange:"none",animationDuration:750,drilling:"off",hiddenCategories:[],highlightedCategories:[],highlightMatch:"all",hoverBehavior:"none",hoverBehaviorDelay:200,layout:"horizontal",layoutOrigin:"topStart",selection:[],selectionMode:"none",_defaultColor:"#a6acb1",_defaultSize:32,_defaultShape:"rectangle",_gapRatio:0.25,_textStyle:new D.F("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 13px; color: #252525;"),_statusMessageStyle:new D.F("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 13px; color: #252525;"),
_tooltipStyle:new D.F("border-collapse: separate; border-spacing: 1px"),_tooltipLabelStyle:new D.F("color: #737373; padding: 0px 2px"),_tooltipValueStyle:new D.F("color: #333333; padding: 0px 2px")};
D.vQ=function(a,b,c,d,e,f,g,h,i,k){D.vQ.o.Init.call(this,a.j(),b,c,d,e,f,g,h,i,k);this.lg=a};D.w.l(D.vQ,D.Xg,"DvtPictoChartImageMarker");D.u=D.vQ.prototype;D.u.ff=function(a,b){var c=new D.en(this.j(),this,0.75*this.lg.xa()),d=c.J,e=this.Qk();this.xm(b.Qk());(0,D.T)(d,"typeNumberArray",this,this.Qk,this.xm,e);b.B(0);a.add(c,1)};D.u.hh=function(a){a.add(new D.gn(this.j(),this,0.5*this.lg.xa()),0)};D.u.pg=function(a){this.B(0);a.add(new D.Km(this.j(),this,0.5*this.lg.xa()),2)};
D.u.Qk=function(){return[this.Dg(),this.Eg(),this.getWidth(),this.getHeight()]};D.u.xm=function(a){this.pu(a[0]);this.qu(a[1]);this.ma(a[2]);this.Da(a[3])};
D.tQ=function(a,b){this.Init(a,b)};D.w.l(D.tQ,D.B,"DvtPictoChartItem");D.wQ=0;D.tQ.prototype.Init=function(a,b){D.tQ.o.Init.call(this,a.j(),null,b.id);this.lg=a;this.Rk=b;this.Xa=null!=b.id?b.id:null!=b.name?b.name:"_defaultId"+D.wQ;D.wQ++;this.Ib=this.Rh=!1;this.wla=new D.E(0,0);(this.Aa()||this.Sg())&&this.setCursor("pointer");a.la().Fa(this,this)};D.xQ=function(a){a=a.Rk.columnSpan;return null!=a&&0<=a?a:1};D.yQ=function(a){a=a.Rk.rowSpan;return null!=a&&0<=a?a:1};D.u=D.tQ.prototype;
D.u.getCount=function(){var a=this.Rk.count;return null!=a?window.Math.max(a,0):1};D.u.sb=function(){return this.Rk.shape||this.lg.q()._defaultShape};D.u.rb=function(){return this.Rk.color||this.lg.q()._defaultColor};D.u.vk=function(){return this.Rk.borderColor};D.u.Qg=function(){return this.Rk.borderWidth};D.u.jS=function(){return this.Rk.source};D.u.tba=function(){return this.Rk.sourceSelected};D.u.rba=function(){return this.Rk.sourceHover};D.u.sba=function(){return this.Rk.sourceHoverSelected};
D.u.getName=function(){return this.Rk.name};D.u.getId=(0,D.s)("Xa");D.u.zc=function(){return this.Rk.shortDesc};D.u.Sg=function(){var a=this.Rk.drilling;return a&&"inherit"!=a?"on"==a:"on"==this.lg.q().drilling};D.u.Bh=function(){return this.Aa()&&this.Sg()};
D.u.Be=function(){var a=this.lg.q(),b=this.lg.q().tooltip;if(b){var a=this.lg.j().fe(),c={id:this.getId(),name:this.getName(),count:this.getCount(),color:this.rb()};return(0,D.Qo)(a,b,c)}if(null!=this.zc())return this.zc();b="";(c=this.getName())&&(b=(0,D.Zo)("td",a._tooltipLabelStyle)+c+"\x3c/td\x3e");c=(0,D.D)(this.lg.j());a._tooltipLabelStyle.W("text-align",c?"left":"right");a._tooltipValueStyle.W("text-align",c?"right":"left");return(0,D.Zo)("table",a._tooltipStyle)+"\x3ctr\x3e"+b+(0,D.Zo)("td",
a._tooltipValueStyle)+(0,D.zQ)(this)+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"};D.u.si=function(){return this.rb()};D.zQ=function(a){var b=a.lg.q(),c=a.getCount();a=a.lg;for(var d=0,e=0;e<a.Za.length;e++)d+=a.Za[e].getCount();return(0,D.gk)(b,"labelCountWithTotal","DvtUtilBundle","COUNT_WITH_TOTAL",[c,d])};D.u=D.tQ.prototype;D.u.Aa=function(){return"none"!=this.lg.q().selectionMode};D.u.Ca=(0,D.s)("Rh");
D.u.jb=function(a){this.Rh=a;this.Gq();for(var b=0;b<this.Ja();b++){var c=this.ha(b);(c instanceof D.AQ||c instanceof D.vQ)&&c.jb(a)}};D.u.Ob=function(){for(var a=0;a<this.Ja();a++){var b=this.ha(a);(b instanceof D.AQ||b instanceof D.vQ)&&b.Ob()}};D.u.Db=function(){for(var a=0;a<this.Ja();a++){var b=this.ha(a);(b instanceof D.AQ||b instanceof D.vQ)&&b.Db()}};D.u.Yc=function(){return[this]};
D.u.ec=function(){var a=[],b=this.lg.q();this.Aa()&&a.push((0,D.gk)(b,this.Ca()?"stateSelected":"stateUnselected","DvtUtilBundle",this.Ca()?"STATE_SELECTED":"STATE_UNSELECTED"));this.Sg()&&a.push((0,D.gk)(b,"stateDrillable","DvtUtilBundle","STATE_DRILLABLE"));b=this.getName();b=null!=this.zc()?this.zc():null==b?(0,D.zQ)(this):(0,D.P)("DvtUtilBundle","COLON_SEP_LIST",[b,(0,D.zQ)(this)]);return(0,D.hk)(b,a)};D.u.Gq=function(){(0,D.Ye)()||this.Zb("label",this.ec())};
D.u.Lc=function(){return this.Rk.categories||[this.getId()]};D.u.zd=function(a){var b=this.lg.la().Rf;if(a.type==D.dk||b.Zq(a))a=this;else if(b.sg(a)){var b=this.lg,c=D.rQ.Yba(b),d=D.rQ.Xba(b);a=37==a.keyCode&&c||39==a.keyCode&&!c||38==a.keyCode&&d||40==a.keyCode&&!d;b=b.yh();a=D.H.wa(b,this)+(a?1:-1);a=a<b.length&&0<=a?b[a]:this}else a=null;return a};D.u.Ce=function(a){return this.F(a)};D.u.wj=function(){return this.ta()};D.u.Ud=function(){this.Ib=!0;this.Ob()};D.u.ic=function(){this.Ib=!1;this.Db()};
D.u.oc=(0,D.s)("Ib");D.u.Yaa=(0,D.s)("wla");
D.pQ=function(a){this.Init(a)};D.w.l(D.pQ,D.ck,"DvtPictoChartKeyboardHandler");D.pQ.prototype.oy=function(a){return this.sg(a)&&!a.ctrlKey};D.pQ.prototype.Zq=function(a){return 32==a.keyCode&&a.ctrlKey};D.pQ.prototype.Ch=function(a){var b=this.ea.dd();return b&&13==a.keyCode?(this.ea.qs(b),(0,D.bi)(a),b):D.pQ.o.Ch.call(this,a)};
D.AQ=function(a,b,c,d,e,f,g){D.AQ.o.Init.call(this,a.j(),b,"alta",c,d,e,f,!0,g);this.lg=a};D.w.l(D.AQ,D.Yg,"DvtPictoChartShapeMarker");D.u=D.AQ.prototype;D.u.ff=function(a,b){var c=new D.en(this.j(),this,0.75*this.lg.xa()),d=c.J,e=this.Rb();this.L(b.Rb().Y());(0,D.T)(d,"typeFill",this,this.Rb,this.L,e);e=this.Qk();this.xm(b.Qk());(0,D.T)(d,"typeNumberArray",this,this.Qk,this.xm,e);b.B(0);a.add(c,1)};D.u.hh=function(a){a.add(new D.gn(this.j(),this,0.5*this.lg.xa()),0)};
D.u.pg=function(a){this.B(0);a.add(new D.Km(this.j(),this,0.5*this.lg.xa()),2)};D.u.Qk=function(){return[this.Dg(),this.Eg(),this.getWidth(),this.getHeight()]};D.u.xm=function(a){this.pu(a[0]);this.qu(a[1]);this.ma(a[2]);this.Da(a[3])};
D.rQ={};D.w.l(D.rQ,D.w,"DvtPictoChartRenderer");
D.rQ.P=function(a,b,c,d){var e=a.j(),f=new D.C(e,c.x,c.y,c.e,c.g);(0,D.qi)(f);b.k(f);d||(d=D.rQ.$k(a,c.e,c.g));if(d.Rl){a.Pca(d.Rl);for(var f=a.q()._gapRatio,g=D.rQ.Ra(a),h=D.rQ.Xba(a),i=D.rQ.Yba(a),k=new D.ml,l=0,m=0,n=0,o=0;o<d.Rl.length;o++){for(var p=d.Rl[o],r=(0,D.xQ)(p),t=(0,D.yQ)(p),v=r*d.BZ,z=t*d.K0,L=p.getCount(),J=0,G=!0,O;0<L;){if(r!=l||t!=m)n=0;0==n&&(O=D.rQ.Uja(k,r,t,d.Mpa,d.vta,g));if(null==O)break;var K=O.W$*d.BZ+v/2,U=O.bT*d.K0+z/2,K=c.x+(i?c.e-K:K),da=c.y+(h?c.g-U:U),U=window.Math.min(1-
n,L),pa,ta,Aa,kb;g?(pa=K-v/2,ta=h?da+z*(0.5-U-n):da+z*(n-0.5),Aa=v,kb=z*U):(pa=i?K+v*(0.5-U-n):K+v*(n-0.5),ta=da-z/2,Aa=v*U,kb=z);var Ha;1==U?(Ha=p.getId()+"_"+J,J++):Ha=window.Math.random();if(p.jS())Ha=new D.vQ(a,K,da,v,z,p.jS(),p.tba(),p.rba(),p.sba(),Ha+"_I");else{var fb=new D.C(e,pa,ta,Aa,kb);(0,D.qi)(fb);p.k(fb);Ha=new D.AQ(a,p.sb(),K,da,v-d.BZ*f,z-d.K0*f,Ha+"_S");Ha.pa(p.rb());Ha.Qa(p.vk(),null,p.Qg());Ha.ZH(p.rb())}1>U&&(fb=new D.og,(0,D.qg)(fb,pa,ta,Aa,kb),(0,D.rg)(Ha,fb));G&&(G=new D.E(K,
da),p.wla=G,G=!1);p.k(Ha);a.jn.push(Ha);L-=U;n=(n+U)%1}b.k(p);l=p;l.Td("img");l.Gq();l=r;m=t}}else D.rQ.Lm(a,b,c)};
D.rQ.$k=function(a,b,c){var d=a.q(),e=d.items;if(!e)return{};for(var f=D.H.VG(d.hiddenCategories),g=[],h=0,i=1,k=1,l=0;l<e.length;l++)if(null!=e[l]){var m=new D.tQ(a,e[l]);if(!f||!D.H.qM(f,m.Lc())){var n=(0,D.xQ)(m),o=(0,D.yQ)(m);n>i&&(i=n);o>k&&(k=o);h+=n*o*m.getCount();g.push(m)}}if(0==h)return{};e=d.columnWidth;f=d.rowHeight;if(!b||!c)e||(e=f?f:d._defaultSize),f||(f=e);a=D.rQ.Ra(a);l=d.columnCount;d=d.rowCount;!l&&!d&&(b&&c?a?d=D.rQ.mJ(window.Math.sqrt(h*c/b),k):l=D.rQ.mJ(window.Math.sqrt(h*b/
c),i):b?l=window.Math.max(window.Math.floor(b/e),1):c?d=window.Math.max(window.Math.floor(c/f),1):a?d=D.rQ.mJ(window.Math.sqrt(h),k):l=D.rQ.mJ(window.Math.sqrt(h),i));l?d||(d=D.rQ.mJ(h/l,k)):l=D.rQ.mJ(h/d,i);b&&c&&(e||(e=f?f:window.Math.min(b/l,c/d)),f||(f=e));return 0>=l||0>=d||0>=e||0>=f?{}:{Rl:g,Mpa:l,vta:d,BZ:e,K0:f}};D.rQ.mJ=function(a,b){return window.Math.ceil(a/b)*b};
D.rQ.Uja=function(a,b,c,d,e,f){if(f)return(a=D.rQ.Uja(a,c,b,e,d,!1))?{W$:a.bT,bT:a.W$}:null;for(f=0;f<e-c+1;f++)for(var g=0;g<d-b+1;g++)if(D.rQ.Gza(a,g,f,b,c))return D.rQ.IDa(a,g,f,b,c),{W$:g,bT:f};return null};D.rQ.Gza=function(a,b,c,d,e){for(var f=0;f<e;f++)for(var g=0;g<d;g++)if(a.get(b+g,c+f))return!1;return!0};D.rQ.IDa=function(a,b,c,d,e){for(var f=0;f<e;f++)for(var g=0;g<d;g++)a.put(b+g,c+f,!0)};
D.rQ.Lm=function(a,b,c){var d=a.q(),e=(0,D.gk)(d,"labelNoData","DvtUtilBundle","NO_DATA");b=D.Ve.Lm(b,e,c.Y(),a.la(),d._statusMessageStyle);a.en=b};D.rQ.Ra=function(a){return"vertical"==a.q().layout};D.rQ.Xba=function(a){a=a.q().layoutOrigin;return"bottomStart"==a||"bottomEnd"==a};D.rQ.Yba=function(a){var b=a.q().layoutOrigin,b="topEnd"==b||"bottomEnd"==b;return(0,D.D)(a.j())?!b:b};

  return D;
});