/**
 * @license
 * Copyright (c) 2014, 2024, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","jquery","ojs/ojdomutils","ojs/ojcore-base"],function(e,t,n,o){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;const s={_EVENT_NAMESPACE:".contextMenu",stopDetectContextMenuGesture:function(e){const n=o.AgentUtils.getAgentInfo().os===o.AgentUtils.OS.IOS,u=e._allowBrowserContextMenu;e._touchStartListener&&(document.removeEventListener("touchstart",e._touchStartListener,{passive:!0}),delete e._touchStartListener),e._touchCancelListener&&(document.removeEventListener("touchcancel",e._touchCancelListener,{passive:!0}),delete e._touchCancelListener),e._touchEndListener&&(document.removeEventListener("touchend",e._touchEndListener,{passive:!1}),delete e._touchEndListener),e._browserSelectionChangeListener&&(document.removeEventListener("selectionchange",e._browserSelectionChangeListener,{passive:!0}),delete e._browserSelectionChangeListener),e._touchMoveListener&&(u&&n?document.removeEventListener("touchmove",e._touchMoveListener,{passive:!0}):e.removeEventListener("touchmove",e._touchMoveListener,{passive:!0}),delete e._touchMoveListener),e._clickListener&&(t(e).off(s._EVENT_NAMESPACE).removeClass("oj-menu-context-menu-launcher")[0].removeEventListener("click",e._clickListener,!0),clearTimeout(e._contextMenuPressHoldTimer),delete e._clickListener,delete e._contextMenuPressHoldTimer),e._touchStartAndMouseDownListener&&(e.removeEventListener("touchstart",e._touchStartAndMouseDownListener,{passive:!1}),delete e._touchStartAndMouseDownListener),e._browserSelectStartListener&&(document.removeEventListener("selectstart",e._browserSelectStartListener,{passive:!0}),delete e._browserSelectStartListener,delete e._webKitUserSelectValue,delete e._userSelectValue)},startDetectContextMenuGesture:function(e,u,r){var c,i,a,l,d,v=n.PRESS_HOLD_THRESHOLD;n.isTouchSupported()&&t(e).addClass("oj-menu-context-menu-launcher");var m,h,p=!1,_=!1,L=null,f=s._EVENT_NAMESPACE,y=!1;const S=function(n,o,s){if((p=s)&&t(e).one("touchend"+f,function(){y=!0,setTimeout(function(){y=!1},50)}),"touchstart"===L&&"contextmenu"===n.type||"contextmenu"===L&&"touchstart"===n.type||"keydown"===L&&"contextmenu"===n.type)return"keydown"===L&&"contextmenu"===n.type&&n.preventDefault(),L=null,void clearTimeout(h);n.isDefaultPrevented&&n.isDefaultPrevented()||n.originalEvent&&n.originalEvent.defaultPrevented||n.defaultPrevented||("touchstart"!==n.type&&"touchmove"!==n.type||(n.originalEvent=n),r?.allowBrowserContextMenu&&d()||(u(n,o),(n.isDefaultPrevented&&n.isDefaultPrevented()||n.defaultPrevented)&&("touchstart"!==n.type&&"contextmenu"!==n.type&&"keydown"!==n.type||(L=n.type,h=setTimeout(function(){L=null},300)))))};t(e).on("keydown"+f+" contextmenu"+f,function(e){var t;("contextmenu"===e.type||("F10"===e.key||121===e.keyCode)&&e.shiftKey)&&(t=_?"touch":"keydown"===e.type?"keyboard":"mouse",S(e,t,!1));return!0});const w=o.AgentUtils.getAgentInfo().os===o.AgentUtils.OS.IOS,E=r?.allowBrowserContextMenu;if(E){e._allowBrowserContextMenu=!0,e.classList.add("oj-menu-allow-browser-context-menu"),l=!1,d=function(){if(l)return!0;const e=document.getSelection();return!("None"===e.type||e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset)};const t=function(e){"#text"===e.target.nodeName?(l=!0,setTimeout(()=>{l=!1},10)):l=!1};if(e._browserSelectStartListener=t,document.addEventListener("selectstart",t,{passive:!0}),w){let t,n,o,s,r;const l=function(n){n.preventDefault(),t=!0,e._webKitUserSelectValue=document.body.style["-webkit-user-select"],document.body.style["-webkit-user-select"]="none",e._userSelectValue=document.body.style.userSelect,document.body.style.userSelect="none",document.getSelection().empty(),u(n,"touch")},d=function(e){const t=e.touches[0];c=t.pageX,i=t.pageY;let u=2*v;null==n?(o=Date.now(),s=e):u=n+v,r=setTimeout(l.bind(null,e),u)};e._touchStartListener=d,document.addEventListener("touchstart",d,{passive:!0});const m=function(n){clearTimeout(r),t&&(n.preventDefault(),setTimeout(()=>{document.body.style["-webkit-user-select"]=e._webKitUserSelectValue,document.body.style.userSelect=e._userSelectValue,t=!1},500))};e._touchEndListener=m,document.addEventListener("touchend",m,{passive:!1});const h=function(){clearTimeout(r),t&&(document.body.style["-webkit-user-select"]=e._webKitUserSelectValue,document.body.style.userSelect=e._userSelectValue,t=!1)};e._touchCancelListener=h,document.addEventListener("touchcancel",h,{passive:!0}),a=function(e){const t=e.touches[0];(Math.abs(c-t.pageX)>5||Math.abs(i-t.pageY)>5)&&clearTimeout(r)},e._touchMoveListener=a,document.addEventListener("touchmove",a,{passive:!0});const p=function(){null!=o&&null==n&&"Range"===document.getSelection().type&&(clearTimeout(r),n=Date.now()-o,r=setTimeout(l.bind(null,s),v))};return e._browserSelectionChangeListener=p,void document.addEventListener("selectionchange",p,{passive:!0})}}var b=function(e){p&&(e.preventDefault(),e.stopPropagation(),p=!1)};e._clickListener=b,e.addEventListener("click",b,!0);var g=function(t){if("mousedown"!==t.type||!y){if(p=!1,"touchstart"===t.type&&1===t.touches.length){var n=t.touches[0];c=n.pageX,i=n.pageY,_=!0,m=setTimeout(S.bind(void 0,t,"touch",!0),v),e._contextMenuPressHoldTimer=m}return!0}};e._touchStartAndMouseDownListener=g,e.addEventListener("touchstart",g,{passive:!1}),a=function(e){var t=e.touches[0];return(Math.abs(c-t.pageX)>5||Math.abs(i-t.pageY)>5)&&(_=!1,clearTimeout(m)),!0},e._touchMoveListener=a,e.addEventListener("touchmove",a,{passive:!0}),t(e).on("touchend"+f+" touchcancel"+f,function(){return _=!1,clearTimeout(m),!0}).on("mousedown"+f,g)}},u=s.startDetectContextMenuGesture,r=s.stopDetectContextMenuGesture;e.startDetectContextMenuGesture=u,e.stopDetectContextMenuGesture=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ojgestureutils.js.map