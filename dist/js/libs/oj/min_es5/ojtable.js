/**
 * @license
 * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * @ignore
 */
define(["ojs/ojcore","jquery","ojs/ojcontext","ojs/ojconfig","ojs/ojtranslation","ojs/ojthemeutils","ojs/ojcomponentcore","ojs/ojdatacollection-common","ojs/ojanimation","ojs/ojmessaging","ojs/ojlogger","ojs/ojkeyset","ojs/ojvalidator-regexp","ojdnd","ojs/ojdomscroller","ojs/ojeditablevalue","ojs/ojinputnumber","ojs/ojmenu","ojs/ojpopup","ojs/ojbutton","ojs/ojdatasource-common","ojs/ojdataprovideradapter","ojs/ojlistdataproviderview","touchr"],function(e,t,l,o,i,s,n,a,r,_,d,u,h){"use strict";var c={properties:{accessibility:{type:"object",properties:{rowHeader:{type:"string"}}},as:{type:"string",value:""},columns:{type:"Array<Object>",writeback:!0},columnsDefault:{type:"object",properties:{className:{type:"string"},field:{type:"string"},footerClassName:{type:"string"},footerRenderer:{type:"function"},footerStyle:{type:"string"},footerTemplate:{type:"string"},headerClassName:{type:"string"},headerRenderer:{type:"function"},headerStyle:{type:"string"},headerTemplate:{type:"string"},headerText:{type:"string"},renderer:{type:"function"},resizable:{type:"string",enumValues:["disabled","enabled"],value:"disabled"},sortProperty:{type:"string"},sortable:{type:"string",enumValues:["auto","disabled","enabled"],value:"auto"},style:{type:"string"},template:{type:"string"},width:{type:"number"}}},currentRow:{type:"object",writeback:!0},data:{type:"object"},display:{type:"string",enumValues:["grid","list"],value:"list"},dnd:{type:"object",properties:{drag:{type:"object",properties:{rows:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragStart:{type:"function"},drag:{type:"function"},dragEnd:{type:"function"}}}}},drop:{type:"object",properties:{columns:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragOver:{type:"function"},dragLeave:{type:"function"},drop:{type:"function"}}},rows:{type:"object",properties:{dataTypes:{type:"string|Array<string>"},dragEnter:{type:"function"},dragOver:{type:"function"},dragLeave:{type:"function"},drop:{type:"function"}}}}},reorder:{type:"object",properties:{columns:{type:"string",enumValues:["disabled","enabled"],value:"disabled"}}}}},editMode:{type:"string",enumValues:["none","rowEdit"],value:"none"},editRow:{type:"object",writeback:!0,value:{rowKey:null,rowIndex:-1}},firstSelectedRow:{type:"object",writeback:!0,readOnly:!0,value:{key:null,data:null}},horizontalGridVisible:{type:"string",enumValues:["auto","disabled","enabled"],value:"auto"},rowRenderer:{type:"function"},scrollPolicy:{type:"string",enumValues:["auto","loadAll","loadMoreOnScroll"],value:"auto"},scrollPolicyOptions:{type:"object",properties:{fetchSize:{type:"number",value:25},maxCount:{type:"number",value:500}}},scrollPosition:{type:"object",writeback:!0,value:{x:0,y:0},properties:{x:{type:"number"},y:{type:"number"},columnIndex:{type:"number"},rowIndex:{type:"number"},columnKey:{type:"any"},rowKey:{type:"any"},offsetX:{type:"number"},offsetY:{type:"number"}}},selected:{type:"object",writeback:!0,properties:{column:{type:"KeySet",writeback:!0},row:{type:"KeySet",writeback:!0}}},selection:{type:"Array<Object>",writeback:!0,value:[]},selectionMode:{type:"Object<string, string>",properties:{column:{type:"string",enumValues:["multiple","none","single"]},row:{type:"string",enumValues:["multiple","none","single"]}}},selectionRequired:{type:"boolean",value:!1},translations:{type:"object",value:{},properties:{accessibleSortAscending:{type:"string"},accessibleSortDescending:{type:"string"},labelAccSelectionAffordanceBottom:{type:"string"},labelAccSelectionAffordanceTop:{type:"string"},labelDisableNonContiguousSelection:{type:"string"},labelEditRow:{type:"string"},labelEnableNonContiguousSelection:{type:"string"},labelResize:{type:"string"},labelResizePopupCancel:{type:"string"},labelResizePopupSpinner:{type:"string"},labelResizePopupSubmit:{type:"string"},labelSelectAndEditRow:{type:"string"},labelSelectColum:{type:"string"},labelSelectRow:{type:"string"},labelSort:{type:"string"},labelSortAsc:{type:"string"},labelSortDsc:{type:"string"},msgColumnResizeWidthValidation:{type:"string"},msgFetchingData:{type:"string"},msgInitializing:{type:"string"},msgNoData:{type:"string"},msgScrollPolicyMaxCountDetail:{type:"string"},msgScrollPolicyMaxCountSummary:{type:"string"},msgStatusSortAscending:{type:"string"},msgStatusSortDescending:{type:"string"}}},verticalGridVisible:{type:"string",enumValues:["auto","disabled","enabled"],value:"auto"}},methods:{getContextByNode:{},getDataForVisibleRow:{},refresh:{},refreshRow:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojAnimateStart:{},ojAnimateEnd:{},ojBeforeCurrentRow:{},ojBeforeRowEdit:{},ojBeforeRowEditEnd:{},ojSort:{}},extension:{}};e.__registerWidget("oj.ojTable",t.oj.baseComponent,{version:"1.0.0",defaultElement:"<table>",widgetEventPrefix:"oj",options:{accessibility:null,animateStart:null,animateEnd:null,as:"",currentRow:null,data:null,display:"list",dnd:{drag:null,drop:null,reorder:{columns:"disabled"}},editMode:"none",editRow:{rowKey:null,rowIndex:-1},emptyText:null,horizontalGridVisible:"auto",rowRenderer:null,scrollPolicy:"auto",scrollPolicyOptions:{fetchSize:25,maxCount:500},scrollPosition:{x:0,y:0},firstSelectedRow:{key:null,data:null},selection:[],selected:{row:new e.KeySetImpl,column:new e.KeySetImpl},selectionMode:null,selectionRequired:!1,verticalGridVisible:"auto",columns:[{renderer:null,className:null,field:null,footerClassName:null,footerRenderer:null,footerStyle:null,footerTemplate:null,headerClassName:null,headerRenderer:null,headerStyle:null,headerTemplate:null,headerText:null,id:null,resizable:"disabled",sortable:"auto",sortProperty:null,style:null,template:null,width:null}],columnsDefault:{renderer:null,className:null,field:null,footerClassName:null,footerRenderer:null,footerStyle:null,footerTemplate:null,headerClassName:null,headerRenderer:null,headerStyle:null,headerTemplate:null,headerText:null,resizable:"disabled",sortable:"auto",sortProperty:null,style:null,template:null,width:null},beforeCurrentRow:null,beforeRowEdit:null,beforeRowEditEnd:null,ready:null,sort:null},_BUNDLE_KEY:{_MSG_FETCHING_DATA:"msgFetchingData",_MSG_NO_DATA:"msgNoData",_MSG_INITIALIZING:"msgInitializing",_MSG_STATUS_SORT_ASC:"msgStatusSortAscending",_MSG_STATUS_SORT_DSC:"msgStatusSortDescending",_LABEL_SELECT_COLUMN:"labelSelectColumn",_LABEL_SELECT_ROW:"labelSelectRow",_LABEL_EDIT_ROW:"labelEditRow",_LABEL_SELECT_AND_EDIT_ROW:"labelSelectAndEditRow"},_LOGGER_MSG:{_ERR_PRECURRENTROW_ERROR_SUMMARY:"Did not change current row due to error.",_ERR_PRECURRENTROW_ERROR_DETAIL:"Error detail: {error}.",_ERR_CURRENTROW_UNAVAILABLE_INDEX_SUMMARY:"Did not change current row due to unavailable row index.",_ERR_CURRENTROW_UNAVAILABLE_INDEX_DETAIL:"Unavailable row index: {rowIdx}.",_ERR_REFRESHROW_INVALID_INDEX_SUMMARY:"Invalid row index value.",_ERR_REFRESHROW_INVALID_INDEX_DETAIL:"Row index: {rowIdx}.",_ERR_DATA_INVALID_TYPE_SUMMARY:"Invalid data type.",_ERR_DATA_INVALID_TYPE_DETAIL:"Please specify the appropriate data type.",_ERR_ELEMENT_INVALID_TYPE_SUMMARY:"Invalid element type.",_ERR_ELEMENT_INVALID_TYPE_DETAIL:"Only a <table> element can be specified for ojTable.",_ERR_WIDTH_INVALID_TYPE_SUMMARY:"Invalid data type for column width.",_ERR_WIDTH_INVALID_TYPE_DETAIL:"Please specify a valid number (not a string)."},_FIELD_ID:"id",_CONST_ATTRIBUTE:"attribute",_CONST_DATA:"data",_CONST_METADATA:"metadata",_CONST_INDEXES:"indexes",_CONST_INDEX:"index",_CONST_KEY:"key",_CONST_KEYS:"keys",_CONST_AFTERKEYS:"afterKeys",_CONST_ADDBEFOREKEYS:"addBeforeKeys",_CONST_STARTINDEX:"startIndex",_CONST_ENDINDEX:"endIndex",_CONST_PAGESIZE:"size",_CONST_OFFSET:"offset",_CONST_SILENT:"silent",_CONST_COLUMN:"column",_CONST_ROW:"row",_CONST_VALUE:"value",_CONST_SORTCRITERIA:"sortCriteria",_COLUMN_HEADER_ID:"_headerColumn",_COLUMN_HEADER_TEXT_ID:"_headerColumnText",_COLUMN_HEADER_ASC_ID:"_headerColumnAsc",_COLUMN_HEADER_DSC_ID:"_headerColumnDsc",_COLUMN_HEADER_ID_PREFIX:"_hdrCol",_FOCUS_CALLED:"_focusedCalled",_ROW_TEMPLATE:"rowTemplate",_CELL_TEMPLATE:"template",_HEADER_TEMPLATE:"headerTemplate",_FOOTER_TEMPLATE:"footerTemplate",_OPTION_AUTO:"auto",_OPTION_ENABLED:"enabled",_OPTION_DISABLED:"disabled",_OPTION_EDIT_MODE:{_NONE:"none",_ROW_EDIT:"rowEdit"},_OPTION_SELECTION_MODES:{_SINGLE:"single",_MULTIPLE:"multiple",_NONE:"none"},_OPTION_SCROLL_POLICY:{_AUTO:"auto",_LOADMORE_ON_SCROLL:"loadMoreOnScroll",_LOAD_ALL:"loadAll"},_COLUMN_SORT_ORDER:{_ASCENDING:"ascending",_DESCENDING:"descending"},_DND_REORDER_TABLE_ID_DATA_KEY:"oj-table-dnd-reorder-table-id",_KEYBOARD_CODES:{_KEYBOARD_CODE_SPACEBAR:32,_KEYBOARD_CODE_ENTER:13,_KEYBOARD_CODE_UP:38,_KEYBOARD_CODE_DOWN:40,_KEYBOARD_CODE_LEFT:37,_KEYBOARD_CODE_RIGHT:39,_KEYBOARD_CODE_HOME:36,_KEYBOARD_CODE_END:35,_KEYBOARD_CODE_TAB:9,_KEYBOARD_CODE_ESC:27,_KEYBOARD_CODE_F2:113,_KEYBOARD_MODIFIER_SHIFT:"shiftKey"},_CURRENT_ROW_STATUS:{_UPDATED:"updated",_IGNORED:"ignored",_VETOED:"vetoed",_ERROR:"error"},_BATCH_PROCESS_SIZE_WHEN_IDLE:5,getContextByNode:function(e){var t=this.getSubIdByNode(e,!0);if(t&&"oj-table-cell"===t.subId){var l=t.rowIndex,o=this._getRowKeyForRowIdx(l);t.key=o}return t},getDataForVisibleRow:function(e){var l=this._getTableDomUtils().getTableBodyRow(e);return null!=l?{key:t(l).data("rowKey"),data:t(l).data("rowData"),index:e}:null},getNodeBySubId:function(t){if(null==t)return this.element?this.element[0]:null;var l,o=this._getTableDomUtils(),i=t.subId;if("oj-table-cell"===i){var s=parseInt(t.rowIndex,10);return l=parseInt(t.columnIndex,10),o.getTableBodyLogicalCells(s)[l]}if("oj-table-header"===i||"oj-table-sort-ascending"===i||"oj-table-sort-descending"===i){l=t.index;var n=o.getTableHeaderLogicalColumns()[l];if(null!=n){if("oj-table-header"===i)return n;if("oj-table-sort-ascending"===i){var a=o.getTableElementsByClassName(n,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS);if(a.length>0)return a[0]}else{var r=o.getTableElementsByClassName(n,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS);if(r.length>0)return r[0]}}}else if("oj-table-footer"===i){l=t.index;var _=o.getTableFooterLogicalCells()[l];if(null!=_)return _}return null},getSubIdByNode:function(t,l){var o=this._getTableDomUtils(),i=o.getFirstAncestor(t,"."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);if(null!=i)return{subId:"oj-table-cell",rowIndex:o.getElementRowIdx(i),columnIndex:o.getElementColumnIdx(i)};var s=o.getFirstAncestor(t,"."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS,!0);if(null!=s)return{subId:l?"oj-table-header":"oj-table-sort-ascending",index:o.getElementColumnIdx(s)};var n=o.getFirstAncestor(t,"."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS,!0);if(null!=n)return{subId:l?"oj-table-header":"oj-table-sort-descending",index:o.getElementColumnIdx(n)};var a=o.getFirstAncestor(t,"."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);if(null!=a)return{subId:"oj-table-header",index:o.getElementColumnIdx(a)};var r=o.getFirstAncestor(t,"."+e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS,!0);return null!=r?{subId:"oj-table-footer",index:o.getElementColumnIdx(r)}:null},refresh:function(){this._super(),this._refresh()},refreshRow:function(e){return this._refreshRow(e,!0)},_refreshRow:function(e,l){var o=this._getData();if(!o)return Promise.resolve(!1);var s=this._getTableDomUtils().getTableBodyRows();if(isNaN(e)||e<0||null!=s&&e>=s.length||null==s||0===s.length){var n=this._LOGGER_MSG._ERR_REFRESHROW_INVALID_INDEX_SUMMARY,a=i.applyParameters(this._LOGGER_MSG._ERR_REFRESHROW_INVALID_INDEX_DETAIL,{rowIdx:e.toString()});throw new RangeError(n+"\n"+a)}var r=this._getRowKeyForRowIdx(e),_=this;return _._queueTask(function(){return o.fetchByKeys({keys:new Set([r])}).then(function(o){if(null==o||null==o.results||0===o.results.size)return Promise.resolve(!1);var i=_._getTableDomUtils().getTableBodyRow(e);l=l&&t.contains(i,document.activeElement);var s=o.results.get(r);return _._refreshTableBodyRow(e,{data:s.data,metadata:s.metadata,index:e,key:r}),l&&_._getTableDomUtils().getTable().focus(),(i=_._getTableDomUtils().getTableBodyRow(e))?_._finalizeRowRendering([i]):Promise.resolve(!0)})})},widget:function(){var e=this._getTableDomUtils().getTableContainer();return null!=e?t(e):this.element},_ComponentCreate:function(){this._super(),this._initTemplateEngine(),this._draw(),this._registerCustomEvents(),this._on(this._events),this._isTouchDevice()&&this._registerTouchEvents(),this._registerDomEventListeners(),this._cachedOptions=t.extend(!0,{},this.options),this._setEditableRowIdx(null),a.disableDefaultBrowserStyling(this.element[0])},_AfterCreate:function(){this._super(),this._getTableDomUtils().createContextMenu(this._handleContextMenuSelect.bind(this)),this._isInitFetch=!0},_SetupResources:function(){this._super(),this._registerResizeListener(),this._registerDataSourceEventListeners(),this._isInitFetch?(this._initFetch(),this._isInitFetch=!1):this._queueTask(function(){return this._invokeDataFetchRows(null)}.bind(this))},_ReleaseResources:function(){this._super(),this._cleanComponent()},_destroy:function(){this._cleanComponent(!0)},_cleanComponent:function(l){this._clearAllComponentTimeouts(),this._clearAllComponentBusyStates(),this._clearIdleCallback(),this._unregisterDomScroller(),l?(t(this._getTableDomUtils().getTableBody()).removeAttr(n._OJ_CONTAINER_ATTR),this.element.children().remove("."+e.TableDomUtils.CSS_CLASSES._TABLE_HEADER_CLASS),this.element.children().remove("."+e.TableDomUtils.CSS_CLASSES._TABLE_BODY_CLASS),this.element.children().remove("."+e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CLASS),this.element.children().remove("."+e.TableDomUtils.CSS_CLASSES._TABLE_STATUS_MESSAGE_CLASS),this.element.children().remove("."+e.TableDomUtils.CSS_CLASSES._TABLE_BODY_MESSAGE_ROW_CLASS),e.DomUtils.unwrap(this.element,t(this._getTableDomUtils().getTableContainer())),this.element[0].classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_CLASS),this._data instanceof e.TableDataSourceAdapter&&this._data.destroy(),(this._hasHeaderTemplate||this._hasCellTemplate||this._hasFooterTemplate)&&this._cleanTemplateNodes(this.element[0]),this._componentDestroyed=!0):(this._unregisterDataSourceEventListeners(),this._unregisterResizeListener())},_clearAllComponentTimeouts:function(){this._clearFocusoutTimeout(),this._clearShowStatusTimeout()},_clearFocusoutTimeout:function(){this._focusoutTimeout&&(clearTimeout(this._focusoutTimeout),this._focusoutTimeout=null)},_clearShowStatusTimeout:function(){this._showStatusTimeout&&(clearTimeout(this._showStatusTimeout),this._showStatusTimeout=null)},_NotifyAttached:function(){this._super();var e=this._getTableDomUtils(),t=e.getTableContainer();e.refreshTableDimensions(t.offsetWidth,t.offsetHeight)},_NotifyShown:function(){this._super();var e=this._getTableDomUtils(),t=e.getTableContainer();e.refreshTableDimensions(t.offsetWidth,t.offsetHeight)},_VerifyConnectedForSetup:function(){return!0},_GetDefaultContextMenu:function(){return this._defaultContextMenu},_NotifyContextMenuGesture:function(t,l,o){var i={};if(this._contextMenuEvent=l.originalEvent,!(this._isNodeEditable(this._contextMenuEvent.target)||this._isNodeClickable(this._contextMenuEvent.target)||"touch"===o&&this._isNodeDraggable(this._contextMenuEvent.target))){var s,n=this._getTableDomUtils(),a=n.getFirstAncestor(this._contextMenuEvent.target,"."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);if(null!=a){var r=n.getElementColumnIdx(a);s=n.getTableHeaderColumn(r)}else s=n.getFirstAncestor(this._contextMenuEvent.target,"."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);if("keydown"===this._contextMenuEvent.type){var _=this._tableDomUtils.getTable();if(null==s&&(s=n.getTableHeaderColumn(this._activeColumnIndex)),this._contextMenuEvent.target===_)if(null!=s)i.position={my:"start top",at:"start bottom",of:s};else{var d=this._getFocusedRowIdx();if(d>=0){var u=n.getTableBodyRow(d);i.position={my:"start top",at:"start bottom",of:u}}else i.position={my:"start top",at:"start bottom",of:this._contextMenuEvent.target}}else i.position={my:"start top",at:"start bottom",of:this._contextMenuEvent.target}}else{var h=n.getFirstAncestor(this._contextMenuEvent.target,"."+e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS,!0);if(null==s&&null==a&&null==h)return}this._contextMenuEventHeaderColumn=s;var c,T,S,m=t.element?t.element[0]:t;s&&s.getAttribute("data-oj-sortable")===this._OPTION_ENABLED?((c=m.querySelectorAll("[data-oj-command=oj-table-sortAsc]")).length>0&&(c=c[0]).classList.remove("oj-disabled"),(T=m.querySelectorAll("[data-oj-command=oj-table-sortDsc]")).length>0&&(T=T[0]).classList.remove("oj-disabled")):((c=m.querySelectorAll("[data-oj-command=oj-table-sortAsc]")).length>0&&(c=c[0]).classList.add("oj-disabled"),(T=m.querySelectorAll("[data-oj-command=oj-table-sortDsc]")).length>0&&(T=T[0]).classList.add("oj-disabled")),s&&s.getAttribute("data-oj-resizable")===this._OPTION_ENABLED?(S=m.querySelectorAll("[data-oj-command=oj-table-resize]")).length>0&&(S=S[0]).classList.remove("oj-disabled"):(S=m.querySelectorAll("[data-oj-command=oj-table-resize]")).length>0&&(S=S[0]).classList.add("oj-disabled"),this._OpenContextMenu(l,o,i)}},_draw:function(){if(this._setFinalTask(function(){this._skipRefreshTableDimension||this._syncTableSizing(),this._initialSelectionStateValidated?this._syncSelectionState():this._validateInitialSelectionState(),this._skipRefreshTableDimension=!1}),!this.element.is("table")){var t=this._LOGGER_MSG._ERR_ELEMENT_INVALID_TYPE_SUMMARY,l=this._LOGGER_MSG._ERR_ELEMENT_INVALID_TYPE_DETAIL;throw new RangeError(t+"\n"+l)}this.element[0].classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_ELEMENT_CLASS),this.element[0].setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"table"),this._getTableDomUtils().createInitialTable(this._isTableHeaderless(),this._isTableFooterless()),this._getTableDomUtils().styleInitialTable();var o=this;this._queueTask(function(){o._refreshTableHeader(),o._refreshTableFooter(),o._refreshTableBody(),o._processSlottedChildren()}),this.options.disabled&&this.disable()},_events:{focusout:function(l){this._clearFocusoutTimeout();for(var o=this._getTableDomUtils(),i=o.getTable(),s=e.ZOrderUtils.findOpenPopups(),n=0;n<s.length;n++){var a=s[n].firstElementChild,r=e.DomUtils.getLogicalParent(t(a));if(t(i).has(r.get(0)).length>0&&e.ZOrderUtils.getStatus(a)===e.ZOrderUtils.STATUS.OPEN)return}this._setFocusoutBusyState(),this._focusoutTimeout=setTimeout(function(){this._focusOutHandler(t(i)),this._focusOutHandler(t(o.getTableContainer())),this._clearKeyboardKeys(),this._clearFocusedHeaderColumn(),this._clearFocusedRow(!1),this._getTableResizeUtils().clearTableHeaderColumnsResize(),this._setTableEditable(!1,!1,0,!0,l,!0),this._focusEditCell&&(this._focusEditCell.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_EDIT_CLASS),this._focusEditCell=null),this._setTableActionableMode(!1,!0),this._clearFocusoutBusyState()}.bind(this),100)},focus:function(e){this._checkRowOrHeaderColumnFocus(e)},focusin:function(e){this._clearFocusoutTimeout(),this._clearFocusoutBusyState();var l=this._getTableDomUtils(),o=l.getTable(),i=l.getTableBody(),s=l.getTableContainer();if(this._focusInHandler(t(o)),this._focusInHandler(t(s)),t(i).has(e.target).length>0){var n=this._getFocusedRowIdx(),a=this._getFocusedHeaderColumnIdx();this._isNodeEditable(e.target)||this._isNodeClickable(e.target)||this._isTableActionableMode()||this._hasEditableRow()||this._temporaryTableChildElementFocus||null!=n||null!=a||setTimeout(function(){o.focus()},0)}else l._isFF()&&e.target===i&&setTimeout(function(){o.focus()},0)},"focus .oj-table-data-cell":function(t){var l=this._getEventTargetElement(t);this._getTableDomUtils().getElementRowIdx(l)===this._getEditableRowIdx()&&(this._focusEditCell&&this._focusEditCell!==l&&this._focusEditCell.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_EDIT_CLASS)&&this._focusEditCell.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_EDIT_CLASS),l.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_EDIT_CLASS),this._focusEditCell=l)},"click .oj-table-checkbox-acc-select-column":function(e){var l=this._getEventTargetElement(e),o=this._getTableDomUtils().getElementColumnIdx(l);t(l).is(":checked")&&this._setHeaderColumnFocus(o,!0,!1),this._handleSelectionGesture(o,!1,!0),e.stopPropagation()},"click .oj-table-checkbox-acc-select-row":function(e){var l=this._getEventTargetElement(e),o=this._getTableDomUtils().getElementRowIdx(l),i=!1;t(l).is(":checked")?i=this._setRowFocus(o,!0,!0,null,e,!0):this._setTableEditable(!1,!1,0,!0,e),i&&(this._handleSelectionGesture(o,!0,!0),this._setTableEditable(!0,!1,0,!0,e)),e.stopPropagation()},keydown:function(e){this._addKeyboardKey(e.keyCode);var l=this._getKeyboardKeys()[0];if((l===this._KEYBOARD_CODES._KEYBOARD_CODE_ESC||l===this._KEYBOARD_CODES._KEYBOARD_CODE_ENTER||l===this._KEYBOARD_CODES._KEYBOARD_CODE_F2||l===this._KEYBOARD_CODES._KEYBOARD_CODE_TAB||!(this._isNodeEditable(e.target)||null!=this._getTableDomUtils().getTableFooter()&&t(this._getTableDomUtils().getTableFooter()).has(e.target).length>0))&&(1===this._getKeyboardKeys().length||2===this._getKeyboardKeys().length&&e[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT])){(this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_UP)||this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_DOWN)||this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_HOME)||this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_END))&&(e.preventDefault(),e.stopPropagation());var o=e[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT];this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_UP)||this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_DOWN)?this._handleKeydownUpDown(e,o&&this._getRowSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE):this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_LEFT)||this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_RIGHT)?this._handleKeydownLeftRight(e,o&&this._getColumnSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE):this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_TAB)?this._handleKeydownTab(e):l===this._KEYBOARD_CODES._KEYBOARD_CODE_F2?this._handleKeydownF2(e):l===this._KEYBOARD_CODES._KEYBOARD_CODE_SPACEBAR?this._handleKeydownSpacebar(e):l===this._KEYBOARD_CODES._KEYBOARD_CODE_ENTER?this._handleKeydownEnter(e):l===this._KEYBOARD_CODES._KEYBOARD_CODE_HOME?this._handleKeydownHome(e):l===this._KEYBOARD_CODES._KEYBOARD_CODE_END?this._handleKeydownEnd(e):l===this._KEYBOARD_CODES._KEYBOARD_CODE_ESC&&this._handleKeydownEsc(e)}},keyup:function(e){if(1===this._getKeyboardKeys().length){var l=this._getKeyboardKeys()[0];if(this._isNodeEditable(e.target)||null!=this._getTableDomUtils().getTableFooter()&&t(this._getTableDomUtils().getTableFooter()).has(e.target).length>0)return void this._removeKeyboardKey(l);this._removeKeyboardKey(l)}this._removeKeyboardKey(e.keyCode)},"mouseleave .oj-table-element":function(){this._getTableResizeUtils().clearTableHeaderColumnsResize()},"mousedown .oj-table-body":function(e){if(1===e.which&&(this._mouseDownRowIdx=this._getTableDomUtils().getElementRowIdx(e.target),null!=this._mouseDownRowIdx)){var t=this._getTableDomUtils().getTableBodyRow(this._mouseDownRowIdx);null!=t&&t.draggable&&(this._mouseDownRowIdx=null)}},"mouseup .oj-table-body":function(){this._mouseDownRowIdx=null},"mouseenter .oj-table-body-row":function(t){var l=this._getEventTargetElement(t),o=this._getTableDomUtils(),i=o.getElementRowIdx(l);o.isTableOwned(l)?(l.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._HOVER),this._updateRowStateCellsClass(i,{hover:!0}),this._handleMouseEnterSelection(t.target)):(this._updateRowStateCellsClass(i,{hover:!1}),t.stopPropagation())},"mouseleave .oj-table-body-row":function(t){var l=this._getEventTargetElement(t),o=this._getTableDomUtils(),i=o.getElementRowIdx(l);o.isTableOwned(l)?(l.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._HOVER),this._updateRowStateCellsClass(i,{hover:!1})):(this._updateRowStateCellsClass(i,{hover:!0}),t.stopPropagation())},"mousedown .oj-table-column-header-cell":function(e){if(this._lastSelectedHeaderIdx=null,1===e.which&&!this._getTableResizeUtils().handleHeaderColumnResizeStart(e)){var l=this._getTableDomUtils().getElementColumnIdx(this._getEventTargetElement(e));e[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT]||(this._setHeaderColumnFocus(l,!0,!0),t(e.target).data(this._FOCUS_CALLED,!0))}},"mouseenter .oj-table-column-header-cell":function(e){if(!this._getTableResizeUtils().setResizeCursor(e)){var t=this._getEventTargetElement(e);this._handleMouseEnterColumnHeader(t)}},"mousemove .oj-table-header":function(e){this._getTableResizeUtils().setResizeCursor(e)},"mousemove .oj-table-column-header-cell":function(e){var t=this._getEventTargetElement(e);this._getTableResizeUtils().setResizeCursor(e)?this._handleMouseLeaveColumnHeader(t):this._handleMouseEnterColumnHeader(t)},"mouseleave .oj-table-column-header-cell":function(e){var t=this._getEventTargetElement(e);this._handleMouseLeaveColumnHeader(t)},"mouseup .oj-table-column-header-cell":function(e){this._getTableResizeUtils().handleHeaderColumnResizeEnd(e)},"mousedown .oj-table-data-cell":function(e){this._lastSelectedRowIdx=null;var l=this._getEventTargetElement(e),o=this._getTableDomUtils().getElementRowIdx(l);e[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT]||(this._setRowFocus(o,!0,!0,l,e),t(e.target).data(this._FOCUS_CALLED,!0))},"mouseup .oj-table-data-cell":function(e){this._getTableResizeUtils().handleHeaderColumnResizeEnd(e)},"click .oj-table-sort-icon-container":function(e){var l=this._getTableDomUtils().getElementColumnIdx(e.target),o=this._getTableDomUtils().getTableHeaderColumn(l);o&&(t(o).data("sorted")===this._COLUMN_SORT_ORDER._ASCENDING?this._handleSortTableHeaderColumn(l,!1,e):this._handleSortTableHeaderColumn(l,!0,e),e.preventDefault(),e.stopPropagation())},"click .oj-table-body-row":function(l){var o=this._getEventTargetElement(l),i=this._getTableDomUtils().getElementRowIdx(o),s=t(l.target).data(this._FOCUS_CALLED),n=l[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT];if(!s&&(!n||n&&null==this._getFocusedRowIdx())){var a=this._setRowFocus(i,!0,!0,o,l);if(t(l.target).data(this._FOCUS_CALLED,!1),!a)return}if(n){var r=this._getFocusedRowIdx();if(null!=r&&(window.getSelection().removeAllRanges(),this._getRowSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE))return void this._selectRange(r,i,!0);this._handleSelectionGesture(i,!0,!1)}else if(e.DomUtils.isMetaKeyPressed(l))this._handleSelectionGesture(i,!0,!0),this._lastSelectedRowIdxArray&&this._lastSelectedRowIdxArray.indexOf(i)>-1&&(this._selectionAnchorIdx=i);else if(0===this._getKeyboardKeys().length){var _=this._isTouchDevice();this._handleSelectionGesture(i,!0,_&&this._nonContiguousSelection),this._lastSelectedRowIdxArray&&this._lastSelectedRowIdxArray.indexOf(i)>-1&&(this._selectionAnchorIdx=i);var d=this._getRowSelection(i);_&&d&&!this._nonContiguousSelection&&this._getRowSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE&&this._getTableDomUtils().createTableBodyRowTouchSelectionAffordance(i)}},"dblclick .oj-table-data-cell":function(e){var t=this._getTableDomUtils().getElementColumnIdx(e.target);this._setTableEditable(!0,!1,t,!0,e)},"contextmenu .oj-table-data-cell":function(e){var t=this._getTableDomUtils().getElementRowIdx(this._getEventTargetElement(e)),l=this._getRowKeyForRowIdx(t);this._setCurrentRow({rowKey:l},e,!1)},"click .oj-table-column-header-cell":function(l){var o=this._getEventTargetElement(l);if("col-resize"!==o.style.cursor){var i=this._getTableDomUtils().getElementColumnIdx(o),s=t(l.target).data(this._FOCUS_CALLED),n=l[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT];if(s||n&&(!n||null!=this._getFocusedHeaderColumnIdx())||(this._setHeaderColumnFocus(i,!0,!1),t(l.target).data(this._FOCUS_CALLED,!1)),n){var a=this._getFocusedHeaderColumnIdx();null!=a&&this._getColumnSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE?this._selectRange(a,i,!1):this._handleSelectionGesture(i,!1,!0)}else e.DomUtils.isMetaKeyPressed(l)?this._handleSelectionGesture(i,!1,!0):0===this._getKeyboardKeys().length&&(this._handleSelectionGesture(i,!1,!1),this._getTableDndContext().setTableHeaderColumnDraggable(i,!0))}},"dragstart .oj-table-column-header-cell":function(e){if("col-resize"!==this._getEventTargetElement(e).style.cursor)return this._getTableDndContext().handleColumnDragStart(e)},"dragenter .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDragEnter(e)},"dragover .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDragOver(e)},"dragleave .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDragLeave(e)},"drop .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDrop(e)},"dragend .oj-table-column-header-cell":function(e){return this._getTableDndContext().handleColumnDragEnd(e)},"dragstart .oj-table-body-row":function(e){return this._getTableDndContext().handleRowDragStart(e)},"drag .oj-table-body-row":function(e){return this._getTableDndContext().handleRowDrag(e)},"dragend .oj-table-body-row":function(e){return this._getTableDndContext().handleRowDragEnd(e)},"dragenter .oj-table-body":function(e){return this._getTableDndContext().handleRowDragEnter(e)},"dragover .oj-table-body":function(e){return this._getTableDndContext().handleRowDragOver(e)},"dragleave .oj-table-body":function(e){return this._getTableDndContext().handleRowDragLeave(e)},"drop .oj-table-body":function(e){return this._getTableDndContext().handleRowDrop(e)}},_refresh:function(){var e=!1;this._dataOption!==this.options[this._CONST_DATA]&&(this._clearCachedDataMetadata(),null==this._data&&(e=!0));var t=this._GetContextMenu();if(null!=t&&t!==this._getTableDomUtils().getContextMenu()&&this._getTableDomUtils().createContextMenu(this._handleContextMenuSelect.bind(this)),this._getTableDomUtils().clearCachedDom(),this._getTableDomUtils().refreshContextMenu(),this._refreshTableStatusMessage(),this._clearIdleCallback(),e)return this._initFetch();var l=this;return this._queueTask(function(){var e=l._invokeDataFetchRows(null);return l=null,e})},_setOption:function(e,t){"selection"===e?(this._selectionSet=!0,this._syncRangeSelection(t),this._superApply(arguments),this._validateInitialSelectionState(!0)):"selected"===e?(this._selectionSet=!1,this._superApply(arguments),this._validateInitialSelectionState(!0)):"currentRow"===e?this._setCurrentRow(t,null,!0)===this._CURRENT_ROW_STATUS._UPDATED&&this._superApply(arguments):"scrollPosition"===e?this._syncScrollPosition(t):"editRow"===e?this._setEditRow(t):(this._superApply(arguments),this._isTableRefreshNeeded(e,t)&&("columns"===e?(this._clearCachedMetadata(),this._refreshTableHeader()):"data"===e&&this._beforeDataRefresh(),this._refresh()))},_invalidateRangeSelection:function(){var e=this.option("selection");if(null!=e)for(var t=0;t<e.length;t++){var l,o,i=e[t];if(null!=i.startKey&&(l=i.startKey[this._CONST_ROW]),null!=i.endKey&&(o=i.endKey[this._CONST_ROW]),l!==o||void 0===l){var s=this.option("selected.row"),n=this._getRowSelectionFromKeySet(s);this.option("selection",n,{_context:{writeback:!0,internalSet:!0}});break}}},_beforeDataRefresh:function(){this._clearIdleCallback(),this._adjustScrollPositionOnRefresh(),this._invalidateRangeSelection(),null!=this._lastSelectedRowIdxArray&&(this._lastSelectedRowIdxArray=[]),this._initialSelectionStateValidated=!1},_adjustScrollPositionOnRefresh:function(){var e=null==this.options.scrollPosition?{}:this.options.scrollPosition;if(!isNaN(e.rowIndex)&&void 0!==e.rowKey){var t=this._getSelectedRowIdxs();null!=t&&t.length>0&&this._isRowSelectionEnabled()?(!isNaN(this._selectionAnchorIdx)&&t.indexOf(this._selectionAnchorIdx)>-1?e.rowKey=this._getRowKeyForRowIdx(this._selectionAnchorIdx):e.rowKey=this._getRowKeyForRowIdx(t[0]),delete e.rowIndex):(e.y=0,e.rowIndex=0,delete e.rowKey),e.x=0,e.columnKey=null,e.columnIndex=0,e.offsetX=0,e.offsetY=0,this.option("scrollPosition",e,{_context:{internalSet:!0},changed:!1})}},_isScrollPositionAdjusted:function(){var e=this.options.scrollPosition;return null!=e&&void 0===e.rowIndex&&null!=e.rowKey},_findRowElementByKey:function(l){var o=this._getTableDomUtils().getTableBodyRows();if(null!=o)for(var i=0;i<o.length;i++)if(e.KeyUtils.equals(t(o[i]).data("rowKey"),l))return o[i];return null},_getColumnKeys:function(){var e=[],t=this._getColumnDefs();if(null!=t)for(var l=0;l<t.length;l++)e.push(t[l][this._FIELD_ID]);return e},_getLocalRowKeys:function(){var e=[],l=this._getTableDomUtils().getTableBodyRows();if(null!=l)for(var o=0;o<l.length;o++)e.push(t(l[o]).data("rowKey"));return e},_validateKeys:function(e){for(var t=0;t<e.length;t++)if(null!=this._findRowElementByKey(e[t]))return Promise.resolve(!0);var l=this._getData();return l&&l.containsKeys?new Promise(function(t){l.containsKeys({keys:new Set(e)}).then(function(e){t(e.results.size>0)},function(){t(!1)})}):null},_syncTableSizing:function(e){this._getTableDomUtils().refreshTableDimensions(null,null,e),this._isLoadMoreOnScroll()&&!this._dataFetching&&this._domScroller?(this._setDataWaitingState(!1),this._domScroller.checkViewport().then(this._domScrollerSuccessFunc,this._clearDataWaitingState)):this._syncScrollPosition()},_syncScrollPosition:function(e,t){if(!this._IsCustomElement()||this._noDataMessageShown||!this._isScrollableX()&&!this._isScrollableY())return!0;if(null!=this._scrollPosition?e=this._scrollPosition:void 0===e&&(e=this.options.scrollPosition),!t&&null!=e.rowKey){var l=this._validateKeys([e.rowKey]);if(l){var o=this._createComponentBusyState("is validating scroll position rowKey.");return l.then(function(t){t||delete e.rowKey,this._clearComponentBusyState(o),this._syncScrollPosition(e,!0)}.bind(this)),!1}}var i=this._getScrollCoordinates(e),s=i.x,n=i.y;if(isNaN(s)&&isNaN(n))return null!=this._scrollPosition&&(this.option("scrollPosition",this._getCurrentScrollPosition(),{_context:{originalEvent:null,internalSet:!0}}),this._scrollPosition=null),this._editRowCallback=null,!0;var a=isNaN(this._scrollTop)?0:this._scrollTop,r=isNaN(this._scrollLeft)?0:this._scrollLeft;if(!isNaN(s)&&isNaN(n)||!isNaN(s)&&n===a&&s!==r){if(!this._isScrollableX())return!0;this._setScrollX(s);var _=this.options.scrollPosition,d=this._getCurrentHorizontalScrollPosition(s);d.y=_.y,d.rowIndex=_.rowIndex,d.rowKey=_.rowKey,d.offsetY=_.offsetY,this.option("scrollPosition",d,{_context:{originalEvent:null,internalSet:!0}})}else if(n!==a){if(!this._isScrollableY())return!(!isNaN(s)&&s!==r)||(delete e.y,this._syncScrollPosition(e,t));var u=this._setScrollY(n);if(isNaN(s)||s===r||this._setScrollX(s),-1===n)return this._scrollPosition=e,u;this.option("scrollPosition",this._getCurrentScrollPosition(s,n),{_context:{originalEvent:null,internalSet:!0}})}else e&&(null==e.rowKey||isNaN(e.rowIndex))&&this.option("scrollPosition",this._getCurrentScrollPosition(s,n),{_context:{originalEvent:null,internalSet:!0}});return null!=this._scrollPosition&&(this._scrollPosition=null),this._editRowCallback&&(this._editRowCallback(),this._editRowCallback=null),!0},_isScrollableX:function(){return Math.abs(this._getScrollWidth()-this._getClientWidth())>1},_isScrollableY:function(){return Math.abs(this._getScrollHeight()-this._getClientHeight())>1},_getScrollWidth:function(){return null==this._scrollWidth&&(this._scrollWidth=this._getTableDomUtils().getScroller().scrollWidth),this._scrollWidth},_getScrollHeight:function(){return null==this._scrollHeight&&(this._scrollHeight=this._getTableDomUtils().getScroller().scrollHeight),this._scrollHeight},_getClientWidth:function(){return null==this._clientWidth&&(this._clientWidth=this._getTableDomUtils().getScroller().clientWidth),this._clientWidth},_getClientHeight:function(){return null==this._clientHeight&&(this._clientHeight=this._getTableDomUtils().getScroller().clientHeight),this._clientHeight},_setScrollX:function(t){var l=this._getTableDomUtils().getScroller();this._skipScrollUpdate=!0,e.DomUtils.setScrollLeft(l,t)},_setScrollY:function(e){var t=this._getTableDomUtils().getScroller();this._skipScrollUpdate=!0;var l=t.scrollTop;return t.scrollTop=-1===e?this._getScrollHeight()-this._getClientHeight():e,l!==t.scrollTop&&(this._setScrollPosBusyState(),!0)},_getScrollTopByIndex:function(e){if(0===e)return 0;if(!(this._isLoadMoreOnScroll()&&e>this.options.scrollPolicyOptions.maxCount)){var t=this._getTableDomUtils().getTableBodyRows()[e];return null!=t?t.offsetTop:this._hasMoreToFetch()?-1:void 0}},_getScrollTopByKey:function(e){var t=this._findRowElementByKey(e);if(null!=t){var l=this._getTableDomUtils().getTableBodyRows();return null!=l&&l.length>0?Math.max(0,t.offsetTop-l[0].offsetTop):void 0}if(this._hasMoreToFetch())return-1},_getScrollLeftByIndex:function(e){if(0===e)return 0;var t=this._getTableDomUtils().getTableHeaderColumn(e);return null!=t?t.offsetLeft:void 0},_getScrollLeftByKey:function(e){var t=this._getColumnIdxForColumnKey(e);return this._getScrollLeftByIndex(t)},_getScrollCoordinates:function(e){var t,l,o=e.rowKey;isNaN(t)&&null!=o&&(t=this._getScrollTopByKey(o));var i=e.columnKey;isNaN(l)&&null!=i&&(l=this._getScrollLeftByKey(i));var s=e.rowIndex;isNaN(t)&&!isNaN(s)&&(t=this._getScrollTopByIndex(s));var n=e.columnIndex;isNaN(l)&&!isNaN(n)&&(l=this._getScrollLeftByIndex(n));var a=e.offsetX;!isNaN(l)&&!isNaN(a)&&l>=0&&(l+=a);var r=e.offsetY;return!isNaN(t)&&!isNaN(r)&&t>=0&&(t+=r),isNaN(l)&&!isNaN(e.x)&&(l=Math.max(0,e.x)),isNaN(t)&&!isNaN(e.y)&&(t=e.y>this._getScrollHeight()?this._hasMoreToFetch()?-1:this._getScrollHeight()-this._getClientHeight():Math.max(0,e.y)),{x:l,y:t}},_getCurrentHorizontalScrollPosition:function(e){var t={};t.x=void 0===e?this._scrollLeft:e;var l=this.option("scrollPosition"),o=Math.abs(l.x-t.x);if(o<1&&null!=l.columnKey&&!isNaN(l.columnIndex))return t.columnKey=l.columnKey,t.columnIndex=l.columnIndex,t.offsetX=l.offsetX+o,t;var i=this._getColumnLocations();if(i&&i.length>0){var s,n=i.length-1;for(s=0;s<i.length-1;s++)if(t.x>=i[s]&&t.x<i[s+1]){n=s;break}t.columnKey=this._getColumnDefs()[n].id,t.columnIndex=n,t.offsetX=t.x-i[n]}return t},_getCurrentVerticalScrollPosition:function(e){var t={};t.y=void 0===e?this._scrollTop:e;var l=this._getTableDomUtils().getTableBody();if(isNaN(this._rowHeight)&&l.rows.length>1&&(this._rowHeight=l.rows[1].offsetHeight),!isNaN(this._rowHeight)&&this._rowHeight>0){var o=this._findClosestElementToTop(t,e);null!=o&&(t.rowIndex=o.index,t.rowKey=this._getRowKeyForRowIdx(o.index),t.offsetY=o.offset)}return t},_getCurrentScrollPosition:function(e,t){var l=this._getCurrentHorizontalScrollPosition(e),o=this._getCurrentVerticalScrollPosition(t);return Object.keys(o).forEach(function(e){l[e]=o[e]}),l},_getColumnLocations:function(){if(null==this._columnOffsets){this._columnOffsets=[];var e,t,l=this._getTableDomUtils().getTableHeaderColumns();if(l&&l.length>0)for(e=l[0].offsetLeft,this._columnOffsets.push(0),t=1;t<l.length;t++)this._columnOffsets.push(l[t].offsetLeft-e)}return this._columnOffsets},_findClosestElementToTop:function(e,t){var l,o=this._getTableDomUtils().getTableBodyRows();if(null==o||0===o.length)return null;var i,s=this.option("scrollPosition");Math.abs(s.y-t)<this._rowHeight&&null!=s.rowKey&&!isNaN(s.rowIndex)&&(l=s.rowIndex),isNaN(l)&&(l=Math.floor(e.y/this._rowHeight));var n=o[l=Math.min(Math.max(l,0),o.length-1)];i=0===l?0:n.offsetTop-o[0].offsetTop;var a=e.y,r=a-i,_={index:l,elem:n,offsetTop:i,offset:r};if(Math.abs(r)<1)return _;var d=r>0;d?l+=1:l-=1;for(var u=!1;!u&&l>=0&&l<o.length;){var h=i;if(i=(n=o[l]).offsetTop,u=(r=Math.abs(a-i))<1||(d?a<=i:a>=i)){_=r<1||!d?{index:l,elem:n,offsetTop:i,offset:r}:{index:l-1,elem:o[l-1],offsetTop:h,offset:a-h};break}d?l+=1:l-=1}return _},_hasMoreToFetch:function(){return!!this._isLoadMoreOnScroll()&&!this._noMoreData},_addKeyboardKey:function(e){for(var t=!1,l=Object.keys(this._KEYBOARD_CODES),o=0;o<l.length;o++){var i=l[o];this._KEYBOARD_CODES[i]===e&&(t=!0)}if(t){for(var s=this._getKeyboardKeys(),n=!1,a=s.length,r=0;r<a;r++)if(s[r]===e){n=!0;break}n||s.push(e)}},_addComponentBusyState:function(e){var t=l.getContext(this.element[0]).getBusyContext(),o={description:"The component identified by '"+this._getTableDomUtils().getTableId()+"' "+e};return t.addBusyState(o)},_createComponentBusyState:function(e){var t=this._addComponentBusyState(e);return null==this._busyStateStack&&(this._busyStateStack=[]),this._busyStateStack.push(t),t},_clearComponentBusyState:function(e){if(e(),this._busyStateStack){var t=this._busyStateStack.indexOf(e);-1!==t&&this._busyStateStack.splice(t,1)}},_clearBusyStateStack:function(){if(this._busyStateStack){for(var e=0;e<this._busyStateStack.length;e++)this._busyStateStack[e]();this._busyStateStack=null}},_setDelayRefreshTableDimensionsBusyState:function(){this._delayRefreshTableDimensionsResolveFunc||(this._delayRefreshTableDimensionsResolveFunc=this._addComponentBusyState("is waiting to refresh dimensions."))},_clearDelayRefreshTableDimensionsBusyState:function(){this._delayRefreshTableDimensionsResolveFunc&&(this._delayRefreshTableDimensionsResolveFunc(),this._delayRefreshTableDimensionsResolveFunc=null)},_setFocusoutBusyState:function(){this._focusoutResolveFunc||(this._focusoutResolveFunc=this._addComponentBusyState("is handling focusout."))},_clearFocusoutBusyState:function(){this._focusoutResolveFunc&&(this._focusoutResolveFunc(),this._focusoutResolveFunc=null)},_setIdleRenderBusyState:function(){this._idleRenderResolveFunc||(this._idleRenderResolveFunc=this._addComponentBusyState("is waiting for idle rendering."))},_clearIdleRenderBusyState:function(){this._idleRenderResolveFunc&&(this._idleRenderResolveFunc(),this._idleRenderResolveFunc=null)},_setScrollPosBusyState:function(){this._scrollPosResolveFunc||(this._scrollPosResolveFunc=this._addComponentBusyState("is handling scroll position."))},_clearScrollPosBusyState:function(){this._scrollPosResolveFunc&&(this._scrollPosResolveFunc(),this._scrollPosResolveFunc=null)},_clearAllComponentBusyStates:function(){this._clearBusyStateStack(),this._clearDataWaitingState(),this._clearDelayRefreshTableDimensionsBusyState(),this._clearFocusoutBusyState(),this._clearIdleRenderBusyState(),this._clearScrollPosBusyState(),this._setComponentReady()},_addSingleTableBodyRow:function(e,t,l,o){var i=this._getTableDomUtils().createTableBodyRow(e,t[this._CONST_KEY]);return this._getTableDomUtils().styleTableBodyRow(i,!0),this._getTableDomUtils().insertTableBodyRow(e,i,t,l),i=this._refreshTableBodyRow(e,t,i,l,o,!0),l||n.subtreeAttached(i),i},_animateVisibleRows:function(e,t,l){if(l=null==this._animationActionOverride?l:this._animationActionOverride,!this._hasPendingTasks()){this._animationActionOverride=null;var o,i=this._getVisibleRowIdxs(),s=[];for(o=0;o<t.length;o++)-1===i.indexOf(t[o])&&s.push(t[o]);for(s.sort(function(e,t){return e-t}),o=s.length-1;o>=0;o--)e.splice(s[o],1);this._unregisterResizeListener();var n=this;return this._getTableAnimationUtils().animateTableBodyRows(e,l).then(function(){n._registerResizeListener()})}return this._animationActionOverride="update",Promise.resolve()},_checkRowOrHeaderColumnFocus:function(e){var t=this._getFocusedRowIdx(),l=this._getFocusedHeaderColumnIdx();if(null==t&&null==l){var o=null,i=this._getCurrentRow(),s=null!=i?i.rowKey:null;if(null!=s&&(o=this._getRowIdxForRowKey(s)),null==o)if(this._isTableHeaderless())this._setRowFocus(0,!0,!0,null,e);else{var n=this._getFirstVisibleColumnIndex(0,!0);this._setHeaderColumnFocus(n,!0,!1)}else this._setRowFocus(o,!0,!0,null,e)}},_cleanTemplateNodes:function(e){var t=this._getTemplateEngine();null!=t&&t.clean(e)},_clearCachedMetadata:function(){this._columnDefArray=null,this._columnOffsets=null,this._setTableActionableMode(!1)},_clearCachedDataMetadata:function(){null!=this._data&&this._unregisterDataSourceEventListeners(),this._data=null},_clearCachedDimensions:function(){this._clientWidth=null,this._clientHeight=null,this._scrollWidth=null,this._scrollHeight=null},_clearDataWaitingState:function(){this._hideStatusMessage(),this._dataFetching=!1,this._dataResolveFunc&&(this._dataResolveFunc(),this._dataResolveFunc=null)},_clearKeyboardKeys:function(){this._keyboardKeys=[]},_clearFocusedHeaderColumn:function(){var e=this._getFocusedHeaderColumnIdx();null!=e&&this._setHeaderColumnFocus(e,!1,!1),this._activeColumnIndex=-1},_clearFocusedRow:function(e){null!=this._getFocusedRowIdx()&&this._setRowFocus(-1,!0,e,null,null)},_clearSelectedRows:function(){this._selectionAnchorIdx=null,this._lastSelectedRowIdx=null;var e=this.option("selected.row"),t=e.clear();if(t!==e){var l={row:t,column:this.option("selected.column")};this._setSelected(l)}},_clearSelectionState:function(){if(this._selectionAnchorIdx=null,this._lastSelectedRowIdx=null,this._lastSelectedHeaderIdx=null,this._hasSelected()){var t={row:new e.KeySetImpl,column:new e.KeySetImpl};this._setSelected(t)}},_clearSortedHeaderColumn:function(l){var o=this._getSortedTableHeaderColumnIdx();if(null!=o){var i=this._getTableDomUtils(),s=i.getTableHeaderColumn(o);if(this._sortInfo=null,t(s).data("sorted",null),null==l||o!==l)this._hideTableHeaderColumnSortIcon(o);else{var n=i.getSortIcon(s);null!=n&&n.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)}}},_executeTableBodyRowsAdd:function(e){var t=this,l=e[this._CONST_KEYS];l&&l.size>0&&this._queueTask(function(){var l=t._getRowsFromEventDetailAdd(e);if(0!==l.length){var o,i,s=!1,a=[],r=[];if(l.length>1){i=l.length;var _=!0;for(o=0;o<i;o++)0!==o&&l[o-1].rowIdx!==l[o].rowIdx-1&&(_=!1),r.push(l[o].rowIdx);if(_){var d=t._getTableDomUtils().getTableBody(),u=document.createDocumentFragment();for(i=l.length,o=0;o<i;o++)a.push(t._addSingleTableBodyRow(l[o].rowIdx,l[o].row,u,l[0].rowIdx));if(0===l[0].rowIdx)d.insertBefore(u,d.firstChild);else{var h=t._getTableDomUtils().getTableBodyRow(l[0].rowIdx);null!=h?d.insertBefore(u,h):d.appendChild(u,null)}t._getTableDomUtils().clearCachedDomRowData(),n.subtreeAttached(d),s=!0}}if(!s)for(i=l.length,o=0;o<i;o++)a.push(t._addSingleTableBodyRow(l[o].rowIdx,l[o].row));if(t._getTableDomUtils().clearCachedDomRowData(),t._refreshTableFooter(),t._isLoadMoreOnScroll()&&null==t._dataProviderAsyncIterator){var c=t._getData();if(c){var T=t._initializeFetchFirstOptions();t._dataProviderAsyncIterator=c.fetchFirst(T)[Symbol.asyncIterator](),t._registerDomScroller()}}return t._IsCustomElement()?t._animateVisibleRows(a,r,"add").then(function(){return t._finalizeRowRendering(a)}):t._finalizeRowRendering(a)}})},_executeTableBodyRowsChange:function(e,t){var l=this;this._queueTask(function(){var t=l._getRowsFromEventDetailChange(e);if(0!==t.length){for(var o=t.length,i=[],s=[],n=0;n<o;n++){var a=l._refreshTableBodyRow(t[n].rowIdx,t[n].row);a&&(i.push(a),s.push(t[n].rowIdx))}return l._refreshTableFooter(),l._IsCustomElement()?l._animateVisibleRows(i,s,"update").then(function(){return l._finalizeRowRendering(i)}):l._finalizeRowRendering(i)}})},_executeTableBodyRowsRemove:function(e){var l=this,o=e[this._CONST_KEYS];o&&o.size>0&&this._queueTask(function(){var o=l._getRowsFromEventDetailRemove(e);if(0!==o.length){o.sort(function(e,t){return t.rowIdx-e.rowIdx});var i,s,n,a=l._getCurrentRow(),r=null!=a?a.rowIndex:0,_=null!=a?a.rowKey:null,d=[],u=[],h=[],c=o.length,T=!1,S=l._getTableDomUtils().getTableBodyRows();if(null!=S&&S.length>0){for(n=0;n<S.length;n++)d.push(n);for(n=0;n<c;n++){s=o[n].rowIdx,u.push(s);for(var m=0;m<d.length;m++)if(d[m]===s){i=this._getTableDomUtils().getTableBodyRow(s),h.push(i),d.splice(m,1);break}}0===d.length&&(T=!0)}var b=this._getTableDomUtils().getTableBody(),C=t.contains(b,document.activeElement),E=!1;if(T)C&&(E=!0),this._clearSelectionState();else for(n=0;n<c;n++)if(s=o[n].rowIdx,i=this._getTableDomUtils().getTableBodyRow(s),C&&null!=i&&t.contains(i,document.activeElement)){E=!0,C=!1;break}if(!T)return new Promise(function(e){l._IsCustomElement()?l._animateVisibleRows(h,u,"remove").then(function(){D(),g(),e(!0)}):(D(),g(),e(!0))});l._getTableDomUtils().removeAllTableBodyRows(),g()}function D(){for(var e=0;e<c;e++){var t=o[e].rowIdx;l._getTableDomUtils().removeTableBodyRow(t)}}function g(){l._refreshTableFooter(),null!=(S=l._getTableDomUtils().getTableBodyRows())&&0!==S.length||l._showNoDataMessage(),null!=_&&(null==S||T||r>=S.length?l._setCurrentRow(null,null,!1):l._setCurrentRow({rowIndex:r,rowKey:null},null,!1)),E&&l._getTableDomUtils().getTable().focus()}})},_getColumnDefs:function(){return this._columnDefArray||(this._columnDefArray=this._getColumnMetadata()),this._columnDefArray},_getColumnMetadata:function(){var e=this.options.columns,l=this.options.columnsDefault;if((0===e.length||1===e.length&&null==e[0].id&&null==e[0].headerText&&null==e[0].field)&&null==l.headerText&&null==l.field)return[];var o,i=[],s=e.length;for(o=0;o<s;o++)i[o]=t.extend({},l,e[o]);var n=[],a=i.length;for(o=0;o<a;o++)n.push(i[o]);var r=this._getData(),_=!1;for(null!=r&&null!=r.getCapability("sort")&&(_=!0),o=0;o<a;o++)null==n[o][this._FIELD_ID]&&(n[o][this._FIELD_ID]=this._COLUMN_HEADER_ID_PREFIX+o),null!=n[o].sortable&&n[o].sortable!==this._OPTION_AUTO||!_||(n[o].sortable=this._OPTION_ENABLED);return n},_getColumnIdxForColumnKey:function(t){var l=this._getColumnDefs();if(null!=l)for(var o=l.length,i=0;i<o;i++){var s=l[i];if(e.KeyUtils.equals(s.id,t))return i}return null},_getColumnIdxsForElementsWithStyleClass:function(e){var t=this._getTableDomUtils(),l=t.tableQuerySelectorAll(t.getTable(),e),o=[];if(l&&l.length>0)for(var i=l.length,s=0;s<i;s++){for(var n=t.getElementColumnIdx(l[s]),a=!1,r=o.length,_=0;_<r;_++)o[_]===n&&(a=!0);a||o.push(n)}return o},_getFirstVisibleColumnIndex:function(e,t){var l,o=this._getColumnDefs(),i=e;if(t)for(;i<o.length;){if((l=this._getTableDomUtils().getTableHeaderColumn(i))&&l.clientWidth>0)return i;i+=1}else for(;i>-1;){if((l=this._getTableDomUtils().getTableHeaderColumn(i))&&l.clientWidth>0)return i;i-=1}return null},_getNextVisibleColumnIndex:function(e,t){var l;l=t?e+1:e-1;var o=this._getFirstVisibleColumnIndex(l,t);return null!==o?o:e},_getColumnKeyForColumnIdx:function(e){var t=this._getColumnDefs();return null!=t&&e<t.length?t[e][this._FIELD_ID]:null},_getColumnRenderer:function(e,t){var l=this._getColumnDefs()[e],o=null;return"cell"===t?o=l.renderer:"footer"===t?o=l.footerRenderer:"header"===t&&(o=l.headerRenderer),this._WrapCustomElementRenderer(o)},_getCurrentRow:function(){return this._getData()?this._currentRow:null},_getData:function(){if(!this._data&&null!=this.options.data){var t=this.options.data;if(e.TableDataSource&&t instanceof e.TableDataSource||e.PagingTableDataSource&&t instanceof e.PagingTableDataSource)this._data=new e.TableDataSourceAdapter(t);else{if(!e.DataProviderFeatureChecker.isDataProvider(t)){var l=this._LOGGER_MSG._ERR_DATA_INVALID_TYPE_SUMMARY,o=this._LOGGER_MSG._ERR_DATA_INVALID_TYPE_DETAIL;throw new Error(l+"\n"+o)}t instanceof e.ListDataProviderView||e.DataProviderFeatureChecker.isTreeDataProvider(t)?this._data=t:this._data=new e.ListDataProviderView(t)}this._dataOption=this.options.data,this._registerDataSourceEventListeners()}return this._data},_getFocusedHeaderColumnIdx:function(){return this._getColumnIdxsForElementsWithStyleClass("."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS+"."+e.TableDomUtils.MARKER_STYLE_CLASSES._FOCUS_HIGHLIGHT+",."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS+"."+e.TableDomUtils.MARKER_STYLE_CLASSES._FOCUS)[0]},_getFocusedRowIdx:function(){return this._getRowIdxsForElementsWithStyleClass("."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS+"."+e.TableDomUtils.MARKER_STYLE_CLASSES._FOCUS_HIGHLIGHT+",."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS+"."+e.TableDomUtils.MARKER_STYLE_CLASSES._FOCUS)[0]},_getHeaderColumnSelection:function(t){return this._getTableDomUtils().getTableHeaderColumn(t).classList.contains(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)},_getColumnSelectionMode:function(){return null==this.options.selectionMode?null:this.options.selectionMode[this._CONST_COLUMN]},_isColumnSelectionEnabled:function(){var e=this._getColumnSelectionMode();return e===this._OPTION_SELECTION_MODES._SINGLE||e===this._OPTION_SELECTION_MODES._MULTIPLE},_getKeyboardKeys:function(){return this._keyboardKeys||(this._keyboardKeys=[]),this._keyboardKeys.reverse()},_getRowIdxRowArray:function(e,t){var l=[];if(null!=e)for(var o=e[this._CONST_INDEXES].length,i=0;i<o;i++)l.push({row:{data:e[this._CONST_DATA][i],metadata:e[this._CONST_METADATA]?e[this._CONST_METADATA][i]:null,key:e[this._CONST_KEYS][i],index:e[this._CONST_INDEXES][i]},rowIdx:t+i});return l},_getRowIdxForRowKey:function(l){var o=this._getTableDomUtils().getTableBodyRows();if(null!=o&&o.length>0)for(var i=o.length,s=0;s<i;s++)if(e.KeyUtils.equals(t(o[s]).data("rowKey"),l))return s;return null},_getDataSourceRowIndexForRowKey:function(l){var o=this._getTableDomUtils().getTableBodyRows();if(null!=o&&o.length>0)for(var i=o.length,s=0;s<i;s++)if(e.KeyUtils.equals(t(o[s]).data("rowKey"),l)){var n=this._getData(),a=0;return this._isPagingModelDataProvider()&&(a=n.getStartItemIndex()),s+a}return null},_getEditableRowIdx:function(){var e=null;return null!=this._getEditableRowKey()&&null!==(e=this._getRowIdxForRowKey(this._getEditableRowKey()))?e:this._editableRowIdx},_getEditableRowKey:function(){return this._editableRowKey},_getEventTargetElement:function(e){return 0===e.type.indexOf("touch")?this._getTouchEventTargetElement(e):e.currentTarget},_getRowIdxsForElementsWithStyleClass:function(e){var t=this._getTableDomUtils(),l=t.tableQuerySelectorAll(t.getTable(),e),o=[];if(l&&l.length>0)for(var i=l.length,s=0;s<i;s++){for(var n=t.getElementRowIdx(l[s]),a=!1,r=o.length,_=0;_<r;_++)o[_]===n&&(a=!0);a||o.push(n)}return o},_getRowKeyForDataSourceRowIndex:function(e){var l=this._getTableDomUtils().getTableBodyRows();if(null!=l&&l.length>0){var o=this._getData(),i=0;this._isPagingModelDataProvider()&&(i=o.getStartItemIndex());for(var s=l.length,n=0;n<s;n++)if(i+n===e)return t(l[n]).data("rowKey")}return null},_getRowKeyForRowIdx:function(e){var l=this._getTableDomUtils().getTableBodyRow(e);return null!=l?t(l).data("rowKey"):null},_getRowKey:function(e,l){return null==e&&(e=this._getTableDomUtils().getTableBodyRow(l)),null!=e?t(e).data("rowKey"):null},_getRowRenderer:function(){return this._WrapCustomElementRenderer(this.options.rowRenderer)},_getRowSelection:function(t){return this._getTableDomUtils().getTableBodyRow(t).classList.contains(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)},_getRowSelectionMode:function(){return null==this.options.selectionMode?null:this.options.selectionMode[this._CONST_ROW]},_isRowSelectionEnabled:function(){var e=this._getRowSelectionMode();return e===this._OPTION_SELECTION_MODES._SINGLE||e===this._OPTION_SELECTION_MODES._MULTIPLE},_getSelectedHeaderColumnIdxs:function(){return this._getColumnIdxsForElementsWithStyleClass("."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS+"."+e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)},_getSelectedRowIdxs:function(){return this._getRowIdxsForElementsWithStyleClass("."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS+"."+e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)},_getSlotTemplate:function(t){if(this._IsCustomElement()&&t){var l=e.BaseCustomElementBridge.getSlotMap(this._getRootElement())[t];if(l&&l.length>0&&"template"===l[0].tagName.toLowerCase())return l[0]}return null},_isDefaultCellTemplateSlotValid:function(){return this._isDefaultTemplateSlotValid("cellTemplate")},_isDefaultHeaderTemplateSlotValid:function(){return this._isDefaultTemplateSlotValid("headerTemplate")},_isDefaultFooterTemplateSlotValid:function(){return this._isDefaultTemplateSlotValid("footerTemplate")},_isDefaultTemplateSlotValid:function(e){for(var t=this._getColumnDefs(),l=t.length,o=0;o<l;o++){var i=t[o][this._CELL_TEMPLATE],s=t[o][this._HEADER_TEMPLATE],n=t[o][this._FOOTER_TEMPLATE];if(e===i||e===s||e===n)return!1}return!0},_getSortedTableHeaderColumnIdx:function(){for(var e=this._getTableDomUtils().getTableHeaderColumns(),l=e?e.length:0,o=0;o<l;o++)if(null!=t(e[o]).data("sorted"))return o;return null},_getTabbableElements:function(e,l){var o=null;return null!=(o=l?t(e).find(":tabbable"):t(e).find(":tabbable").not(".oj-helper-hidden-accessible"))&&o.length>0?o.toArray():null},_getTableAnimationUtils:function(){return this._tableAnimationUtils||(this._tableAnimationUtils=new e.TableAnimationUtils(this)),this._tableAnimationUtils},_getTableDndContext:function(){return this._tableDndContext||(this._tableDndContext=new e.TableDndContext(this)),this._tableDndContext},_getTableDomUtils:function(){return this._tableDomUtils||(this._tableDomUtils=new e.TableDomUtils(this)),this._tableDomUtils},_getTableResizeUtils:function(){return this._tableResizeUtils||(this._tableResizeUtils=new e.TableResizeUtils(this)),this._tableResizeUtils},_getTemplateEngine:function(){return this._templateEngine},_getTouchEventTargetElement:function(e){var t=e.originalEvent.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)},_getVisibleRowIdxs:function(){var e=[],l=this._getTableDomUtils().getTableBody(),o=this._getTableDomUtils().getTableBodyRows();if(null!=o&&o.length>0&&l.offsetHeight>0){var i=t(window).height(),s=l.getBoundingClientRect();if(s.top>i)return e;var n=s.left>=0?s.left+1:s.right-1,a=s.top>=0?s.top:0,r=document.elementFromPoint(n,a),_=null;null!=r&&(_=this._getTableDomUtils().getElementRowIdx(r));var d,u,h=null!=_?_:0;if(s.bottom>i)_=null,null!=(u=document.elementFromPoint(n,i-1))&&(d=this._getTableDomUtils().getElementRowIdx(u));else{var c=parseInt(window.getComputedStyle(l).borderBottomWidth,10)||0,T=s.bottom>=0?s.bottom-c-1:0;null!=(u=document.elementFromPoint(n,T))&&(d=this._getTableDomUtils().getElementRowIdx(u))}null==d&&(d=o.length-1);for(var S=h;S<=d;S++)e.push(S)}return e},_selectRange:function(e,t,l){var o,i=this.option("selected"),s=i.row,n=i.column;if(l){if(n=n.clear(),this._isRowSelectionEnabled()){if(s=s.clear(),e<=t)for(o=e;o<=t;o++)s=s.add([this._getRowKeyForRowIdx(o)]);else for(o=e;o>=t;o--)s=s.add([this._getRowKeyForRowIdx(o)]);this._lastSelectedRowIdx=t}}else if(s=s.clear(),this._isColumnSelectionEnabled()){if(n=n.clear(),e<=t)for(o=e;o<=t;o++)n=n.add([this._getColumnKeyForColumnIdx(o)]);else for(o=e;o>=t;o--)n=n.add([this._getColumnKeyForColumnIdx(o)]);this._lastSelectedHeaderIdx=t}i.row===s&&i.column===n||(i={row:s,column:n},this._isSelectionRequiredSatisfied(i)&&this._setSelected(i))},_handleContextMenuSelect:function(l,o){var i,s=(i=o?o.item:t(l.target)).attr("data-oj-command"),n=this._getTableDomUtils(),a=n.getFirstAncestor(this._contextMenuEvent.target,"."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);a=null==a?this._contextMenuEventHeaderColumn:a;var r=n.getFirstAncestor(this._contextMenuEvent.target,"."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0),_=null;if(null!=a&&(_=n.getElementColumnIdx(a)),null!=r&&(_=n.getElementColumnIdx(r)),null!==_)if("oj-table-sortAsc"===s)this._handleSortTableHeaderColumn(_,!0,l);else if("oj-table-sortDsc"===s)this._handleSortTableHeaderColumn(_,!1,l);else if("oj-table-enableNonContiguousSelection"===s)this._nonContiguousSelection=!0,this._getTableDomUtils().removeTableBodyRowTouchSelectionAffordance(),i.attr("data-oj-command","oj-table-disableNonContiguousSelection"),i.children().first().text(this.getTranslatedString("labelDisableNonContiguousSelection"));else if("oj-table-disableNonContiguousSelection"===s)this._nonContiguousSelection=!1,i.attr("data-oj-command","oj-table-enableNonContiguousSelection"),i.children().first().text(this.getTranslatedString("labelEnableNonContiguousSelection"));else if("oj-table-resize"===s){var d=n.getContextMenuResizePopup();d.setAttribute("data-oj-columnIdx",_);var u=a||r,h=u.getBoundingClientRect().width,c=window.getComputedStyle(u);h=h-parseFloat(c["border-left-width"])-parseFloat(c["border-right-width"]);var T,S=document.getElementById(n.getTableId()+"_resize_popup_spinner");t(S).ojInputNumber("option","value",Math.round(h)),T=null!=a?a:null!=r?r:this.getTable(),t(d).ojPopup("open",T)}},_handleContextMenuResizePopup:function(){var e=this._getTableDomUtils(),l=document.getElementById(e.getTableId()+"_resize_popup_spinner"),o=t(l).ojInputNumber("option","value"),i=e.getContextMenuResizePopup(),s=parseInt(i.getAttribute("data-oj-columnIdx"),10);t(i).ojPopup("close");for(var n=[],a=this.options.columns.length,r=0;r<a;r++)n[r]=t.extend({},{},this.options.columns[r]);n[s].width=o,this.option("columns",n,{_context:{writeback:!0,internalSet:!0}}),this._clearCachedMetadata(),this._queueTask(function(){setTimeout(function(){e.getTable().focus()},0)})},_handleDataFetchStart:function(){this._setDataWaitingState()},_handleDataRefresh:function(){try{if(this._dataFetching)return;var e=this;this._queueTask(function(){e._beforeDataRefresh();var t=e._invokeDataFetchRows();return e=null,t})}catch(e){d.error(e)}finally{this._clearDataWaitingState()}},_handleDataRowMutate:function(e){this._dataFetching||(null!=e.detail.remove&&this._handleDataRowRemove(e.detail.remove),null!=e.detail.add&&this._handleDataRowAdd(e.detail.add),null!=e.detail.update&&this._handleDataRowChange(e.detail.update))},_getRowsFromEventDetailAdd:function(t){var l=this._getData(),o=t[this._CONST_DATA],i=t[this._CONST_METADATA],s=t[this._CONST_INDEXES],n=[];t[this._CONST_KEYS].forEach(function(e){n.push(e)});var a=[],r=t[this._CONST_ADDBEFOREKEYS]?t[this._CONST_ADDBEFOREKEYS]:t[this._CONST_AFTERKEYS];null!=r&&r.forEach(function(e){a.push(e)}),o instanceof Array||(o=[o]),i instanceof Array||(i=[i]);var _=0;this._isPagingModelDataProvider()&&(_=l.getStartItemIndex());var d=null;l instanceof e.TableDataSourceAdapter&&(e.FlattenedTreeTableDataSource&&l.tableDataSource instanceof e.FlattenedTreeTableDataSource?d=l.tableDataSource:e.PagingTableDataSource&&l.tableDataSource instanceof e.PagingTableDataSource&&e.FlattenedTreeTableDataSource&&l.tableDataSource.dataSource instanceof e.FlattenedTreeTableDataSource&&(d=l.tableDataSource.dataSource));var u,h,c,T,S=[],m=null,b=this._getTableDomUtils().getTableBodyRows(),C=null!=b?b.length:0,E=o.length,D=this.options.scrollPolicyOptions.fetchSize,g=Math.max(D,C);for(T=0;T<E;T++)if(c=null!=a?a[T]:"",null!=(u=this._getRowIdxForRowKey(c))&&u>=0?h=u+_:s&&T<s.length&&s[T]>=0?h=s[T]:0===T?h=C:isNaN(h)||(h+=1),!isNaN(h)){if(u=h-_,this._isLoadMoreOnScroll()&&u>g)continue;m=d&&d._getMetadata?d._getMetadata(u):i[T];var R={data:o[T],metadata:m,key:n[T],index:h};S.push({row:R,rowIdx:u})}return S},_handleDataRowAdd:function(e){try{this._executeTableBodyRowsAdd(e)}catch(e){d.error(e)}finally{this._clearDataWaitingState()}},_getRowsFromEventDetailChange:function(e){var t=e[this._CONST_DATA],l=e[this._CONST_METADATA],o=[];e[this._CONST_KEYS].forEach(function(e){o.push(e)}),t instanceof Array||(t=[t]),l instanceof Array||(l=[l]);for(var i=[],s=t.length,n=0;n<s;n++){var a=this._getRowIdxForRowKey(o[n]);if(void 0!==a){var r={data:t[n],key:o[n],index:a,metadata:l[n]};i.push({row:r,rowIdx:a})}}return i},_handleDataRowChange:function(e){try{this._executeTableBodyRowsChange(e)}catch(e){d.error(e)}finally{this._clearDataWaitingState()}},_getRowsFromEventDetailRemove:function(e){var t=this,l=[];return e[this._CONST_KEYS].forEach(function(e){var o=t._getRowIdxForRowKey(e);if(void 0!==o){var i={key:e,index:o};l.push({row:i,rowIdx:o})}}),l},_handleDataRowRemove:function(e){try{this._executeTableBodyRowsRemove(e)}catch(e){d.error(e)}finally{this._clearDataWaitingState()}},_handleKeydownEnd:function(e){if(!this._isTableActionableMode()&&!this._hasEditableRow()){var t=this._getFocusedHeaderColumnIdx();if(null!=t&&t!==this._getColumnDefs().length-1){var l=this._getFirstVisibleColumnIndex(this._getColumnDefs().length-1,!1);this._setHeaderColumnFocus(l,!0,!1)}else{var o=this._getFocusedRowIdx();if(null!=o){var i=this._getTableDomUtils().getTableBodyRows(),s=null!=i?i.length:0;o!==s-1&&s>0&&this._setRowFocus(s-1,!0,!0,null,e)}}}},_handleKeydownEnter:function(e){if(!this._isTableActionableMode()){var l=this._getFocusedHeaderColumnIdx();if(null!=l&&this._getColumnDefs()[l].sortable===this._OPTION_ENABLED){var o=this._getTableDomUtils().getTableHeaderColumn(l),i=t(o).data("sorted");null==i||i===this._COLUMN_SORT_ORDER._DESCENDING?this._handleSortTableHeaderColumn(l,!0,e):this._handleSortTableHeaderColumn(l,!1,e)}else{var s=this._getCurrentRow();if((s=s||{}).rowIndex>=0)if(this._isTableEditMode()){if(!this._hasEditableRow())return void this._setTableEditable(!0,!1,0,!0,e);var n=this._getTableDomUtils().getElementColumnIdx(e.target);e[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT]?this._setPreviousRowEditable(n,e):this._setNextRowEditable(n,e)}else this._setTableActionableMode(!0)}}},_handleKeydownEsc:function(e){this._hasEditableRow()?(e.preventDefault(),e.stopPropagation(),this._setTableEditable(!1,!0,0,!0,e),this._getTableDomUtils().getTable().focus()):this._isTableActionableMode()&&(e.preventDefault(),e.stopPropagation(),this._setTableActionableMode(!1),this._getTableDomUtils().getTable().focus()),this._getTableResizeUtils().clearTableHeaderColumnsResize()},_handleKeydownF2:function(e){e.preventDefault(),e.stopPropagation(),this._isTableEditMode()?this._hasEditableRow()?this._setTableEditable(!1,!1,0,!0,e):(this._setTableEditable(!0,!1,0,!0,e),this._hasEditableRow()||this._toggleTableActionableMode()):this._toggleTableActionableMode()},_handleKeydownHome:function(e){if(!this._isTableActionableMode()&&!this._hasEditableRow()){var t=this._getFocusedHeaderColumnIdx();if(null!=t&&0!==t){var l=this._getFirstVisibleColumnIndex(0,!0);this._setHeaderColumnFocus(l,!0,!1)}else{var o=this._getFocusedRowIdx();null!=o&&0!==o&&this._setRowFocus(0,!0,!0,null,e)}}},_handleKeydownLeftRight:function(e,t){if(!this._isTableActionableMode()&&!this._hasEditableRow()){var l=this._getFocusedHeaderColumnIdx();if(null!=l){var o,i="rtl"===this._GetReadingDirection(),s=this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_LEFT),n=i&&s||!i&&!s;o=!t||this._isNavigate||null==this._lastSelectedHeaderIdx?l:this._lastSelectedHeaderIdx;var a=this._getNextVisibleColumnIndex(o,n);t?(this._isNavigate=!1,this._selectRange(l,a,!1),this._scrollColumnIntoViewport(a)):(this._isNavigate=!0,a!==l&&this._setHeaderColumnFocus(a,!0,!1))}}},_handleKeydownSpacebar:function(e){if(!this._isTableActionableMode()&&!this._hasEditableRow()){e.preventDefault(),e.stopPropagation();var t=this._getFocusedRowIdx();if(null!=t)this._handleSelectionGesture(t,!0,!0);else{var l=this._getFocusedHeaderColumnIdx();null!=l&&this._handleSelectionGesture(l,!1,!0)}}},_handleKeydownTab:function(l){var o,i,s=!1,n=this._getFocusedRowIdx(),a=this._getFocusedHeaderColumnIdx();if((null!=n||null!=a)&&(this._isTableActionableMode()||this._hasEditableRow())){var r=document.activeElement,_=this._getTableDomUtils().getTableBody(),d=this._getTableDomUtils().getTableHeader();if(this._getEditableRowIdx()===n){var u=this._getTableDomUtils().getTableBodyRow(n),h=this._getTabbableElements(u),c=null!=h?h.length:0,T=t(h).index(r);if(T===c-1&&!l[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT])return this._setNextRowEditable(0,l),l.preventDefault(),void l.stopPropagation();if(0!==T||!l[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT])return;var S=this._getTableDomUtils().getTableHeaderColumns();if(S){var m=S.length;return this._setPreviousRowEditable(m-1,l),l.preventDefault(),void l.stopPropagation()}}else if(t.contains(_,r)||t.contains(d,r)){var b;if(i=null,t.contains(_,r)?i=this._getTableDomUtils().getTableBodyRow(n):t.contains(d,r)&&(i=this._getTableDomUtils().getTableHeader()),(o=this._getTabbableElements(i)).length>0){if(o.length>1){if(l[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT]){if(r===o[0])t(o[o.length-1]).focus(),l.preventDefault(),l.stopPropagation();else for(b=0;b<o.length;b++)if(r===o[b]){o[b-1].focus(),l.preventDefault(),l.stopPropagation();break}}else if(r===o[o.length-1])t(o[0]).focus(),l.preventDefault(),l.stopPropagation();else for(b=0;b<o.length;b++)if(r===o[b]){o[b+1].focus(),l.preventDefault(),l.stopPropagation();break}}else l.preventDefault(),l.stopPropagation();return}}if((null!=n&&!this._hasEditableRow()||null!=a)&&!l[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT]){if(s=!0,i=null,null!=n?i=this._getTableDomUtils().getTableBodyRow(n):null!=a&&(i=this._getTableDomUtils().getTableHeaderColumn(a)),null!=(o=this._getTabbableElements(i)))t(o[0]).focus();else if(null!=n){var C=this._getTabbableElements(_);t(C[0]).focus()}else if(null!=a){var E=this._getTabbableElements(d);t(E[0]).focus()}l.preventDefault(),l.stopPropagation()}}if(s)this._removeKeyboardKey(l.keyCode);else{var D=this._getTableDomUtils().getTable(),g=this._getTabbableElements(D,!0),R=null!=g?g.length:0,f=D;l[this._KEYBOARD_CODES._KEYBOARD_MODIFIER_SHIFT]||(this._getTableDomUtils()._isFF()?((f=document.createElement(e.TableDomUtils.DOM_ELEMENT._A)).setAttribute(e.TableDomUtils.DOM_ATTR._TABINDEX,"0"),f.setAttribute(e.TableDomUtils.DOM_ATTR._HREF,"#"),f.classList.add(e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),D.insertAdjacentElement("afterend",f),this._temporaryFocusForFF=f):R>0&&(f=g[R-1])),this._temporaryTableChildElementFocus=!0,f.focus();var A=this;setTimeout(function(){A._temporaryTableChildElementFocus=!1,A._temporaryFocusForFF&&(t(A._temporaryFocusForFF).remove(),A._temporaryFocusForFF=null)},0)}},_handleKeydownUpDown:function(e,t){if(!this._isTableActionableMode()&&!this._hasEditableRow()){var l=this._getFocusedRowIdx();if(null!=l){var o,i,s=this._getTableDomUtils().getTableBodyRows(),n=null!=s?s.length:0;if(o=!t||this._isNavigate||null==this._lastSelectedRowIdx?l:this._lastSelectedRowIdx,this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_UP)?i=o>0?o-1:o:this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_DOWN)&&(i=o<n-1?o+1:o),t)this._isNavigate=!1,this._selectRange(l,i,!0),this._scrollRowIntoViewport(i);else if(this._isNavigate=!0,i!==l){if(!this._setRowFocus(i,!0,!0,null,e))return;this._getTableDomUtils().getTable().focus()}else if(0===i&&this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_UP)){var a=this._getFirstVisibleColumnIndex(0,!0);this._setHeaderColumnFocus(a,!0,!1)}}else this._isKeyboardKeyPressed(this._KEYBOARD_CODES._KEYBOARD_CODE_DOWN)&&null!=this._getFocusedHeaderColumnIdx()&&this._setRowFocus(0,!0,!0,null,e)}},_handleMouseEnterColumnHeader:function(t){if(t){t.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._HOVER);var l=this._getTableDomUtils().getElementColumnIdx(t);(t.classList.contains(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS)||t.classList.contains(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS))&&t.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._HOVER),this._showTableHeaderColumnSortIcon(l)}},_handleMouseLeaveColumnHeader:function(t){if(t){t.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._HOVER);var l=this._getTableDomUtils().getElementColumnIdx(t);this._hideTableHeaderColumnSortIcon(l),this._hideTableHeaderColumnSortIcon(l)}},_handleMouseEnterSelection:function(e,t){if(this._isRowSelectionEnabled()){var l=this._getTableDomUtils().getElementRowIdx(e);null!=this._mouseDownRowIdx&&null!=l&&this._mouseDownRowIdx!==l?(this._getRowSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE?this._selectRange(this._mouseDownRowIdx,l,!0):this._selectRange(l,l,!0),l<this._mouseDownRowIdx?this._getTableDomUtils().moveTableBodyRowTouchSelectionAffordanceTop(l):this._getTableDomUtils().moveTableBodyRowTouchSelectionAffordanceBottom(l)):null!=l&&l===this._mouseDownRowIdx&&(t?(this._selectRange(l,l,!0),this._getTableDomUtils().moveTableBodyRowTouchSelectionAffordanceTop(l),this._getTableDomUtils().moveTableBodyRowTouchSelectionAffordanceBottom(l)):this._clearSelectedRows())}},_handleScrollerMaxRowCount:function(){var e=this.getTranslatedString("msgScrollPolicyMaxCountSummary"),t=this.getTranslatedString("msgScrollPolicyMaxCountDetail");d.warn(e+"\n"+t)},_handleScrollerScrollLeft:function(t){this._scrollLeft=t;var l=this._getTableDomUtils().getTableHeaderRow();l&&("rtl"===this._GetReadingDirection()?l.style[e.TableDomUtils.CSS_PROP._RIGHT]="-"+t+e.TableDomUtils.CSS_VAL._PX:l.style[e.TableDomUtils.CSS_PROP._LEFT]="-"+t+e.TableDomUtils.CSS_VAL._PX);var o=this._getTableDomUtils().getTableFooterRow();o&&("rtl"===this._GetReadingDirection()?o.style[e.TableDomUtils.CSS_PROP._RIGHT]="-"+t+e.TableDomUtils.CSS_VAL._PX:o.style[e.TableDomUtils.CSS_PROP._LEFT]="-"+t+e.TableDomUtils.CSS_VAL._PX)},_handleScrollerScrollTop:function(e){this._domScroller||this._clearScrollPosBusyState(),e<0&&(e=0),this._scrollTop=e,this._scrollY=this._skipScrollUpdate?e:null,this._getTableDomUtils().moveTableBodyRowTouchSelectionAffordanceTop(),this._getTableDomUtils().moveTableBodyRowTouchSelectionAffordanceBottom()},_handleSortTableHeaderColumn:function(e,t,l){this._clearSortedHeaderColumn(e);var o=this._getColumnDefs()[e],i=null==o.sortProperty?o.field:o.sortProperty;this._invokeDataSort(i,t,l),this._sortColumn=o,this._refreshSortTableHeaderColumn(i,t)},_hasEditableRow:function(){return!!this._isTableEditMode()&&null!==this._getEditableRowIdx()},_hasRowOrCellRendererOrTemplate:function(e){if(null!=this._getRowRenderer())return!0;var t=null,l=null,o=this._getColumnDefs();if(null!=e)t=this._getColumnRenderer(e,"cell"),l=this._getSlotTemplate(o[e][this._CELL_TEMPLATE]);else for(var i=o.length,s=0;s<i&&null==(t=this._getColumnRenderer(s,"cell"))&&null==(l=this._getSlotTemplate(o[s][this._CELL_TEMPLATE]));s++);return null!=t||null!=l||!(!this._isDefaultCellTemplateSlotValid()||null==this._getSlotTemplate("cellTemplate"))},_hideNoDataMessage:function(){if(this._noDataMessageShown){var e=this._getTableDomUtils().getTableBodyMessageRow();null!=e&&t(e).remove(),this._noDataMessageShown=!1}},_hideStatusMessage:function(){this._clearShowStatusTimeout(),this._statusMessageShown&&(this._getTableDomUtils().getTableStatusMessage().style[e.TableDomUtils.CSS_PROP._DISPLAY]=e.TableDomUtils.CSS_VAL._NONE,this._statusMessageShown=!1)},_hideTableHeaderColumnSortIcon:function(l){if(this._getColumnDefs()[l].sortable===this._OPTION_ENABLED){var o=this._getTableDomUtils(),i=o.getTableHeaderColumn(l);if(null==t(i).data("sorted")){var s=o.getSortIconContainer(i);null!=s&&s.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._ENABLED);var n=o.getSortIcon(i);null!=n&&(n.classList.remove(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS),n.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS),n.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._DISABLED),n.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._DEFAULT))}}},_initFetch:function(t,l){t=t||{};var o=this,i=this._getData();return null==i||!e.DataProviderFeatureChecker.isDataProvider(i)||this._isPagingModelDataProvider()&&!l?null==i?this._queueTask(function(){return Promise.resolve()}):void 0:this._queueTask(function(){return o._scrollTop=0,o._getTableDomUtils().getScroller().scrollTop=0,i instanceof e.TableDataSourceAdapter&&(t.fetchType="init",o._isLoadMoreOnScroll()&&(t[o._CONST_OFFSET]=0)),o._invokeDataFetchRows(t)})},_initTemplateEngine:function(){var e=this;this._queueTask(function(){var t;try{t=o.__getTemplateEngine().then(function(t){e._templateEngine=t},function(e){d.warn(e)})}catch(e){d.warn(e),t=Promise.resolve(null)}return t})},_initializeFetchFirstOptions:function(e){var t=e||{};return!t[this._CONST_PAGESIZE]&&this._isLoadMoreOnScroll()?t[this._CONST_PAGESIZE]=this.options.scrollPolicyOptions.fetchSize:t[this._CONST_PAGESIZE]=-1,t[this._CONST_SILENT]=!0,t},_invokeDataFetchRows:function(t){t=this._initializeFetchFirstOptions(t);var l=this._getData();if(null!=l){var o=this;return new Promise(function(i){o._noMoreData=!1,o._setDataWaitingState(),o._dataProviderAsyncIterator=l.fetchFirst(t)[Symbol.asyncIterator](),o._dataProviderAsyncIterator.next().then(function(t){var s=t[o._CONST_VALUE],n=s[o._CONST_DATA],a=s.metadata.map(function(e){return e[o._CONST_KEY]}),r=0;l instanceof e.TableDataSourceAdapter&&(r=l[o._CONST_OFFSET]);var _=0;o._isPagingModelDataProvider()&&(_=l.getStartItemIndex());for(var d=[],u=n.length,h=0;h<u;h++)d[h]=r+_+h;var c=s[o._CONST_METADATA];o._unregisterDomScroller(),t.maxCountLimit?(o._noMoreData=!0,o._handleScrollerMaxRowCount(),o._dataProviderAsyncIterator=null):t.done&&(o._noMoreData=!0,o._dataProviderAsyncIterator=null),o._refreshAll({data:n,metadata:c,keys:a,indexes:d},r).then(function(){o._clearDataWaitingState(),o._processFetchSort(s),o._isLoadMoreOnScroll()&&o._registerDomScroller(),o=null,i(t)})},function(){o._clearDataWaitingState();var e=o._getTableDomUtils().getTableBodyRows();null!=e&&0!==e.length||o._showNoDataMessage(),i(null)})})}return Promise.resolve(null)},_invokeDataSort:function(e,t,l){if(this._getData()){this._showStatusMessage();var o=[],i={};i[this._CONST_ATTRIBUTE]=e,i.direction=t?this._COLUMN_SORT_ORDER._ASCENDING:this._COLUMN_SORT_ORDER._DESCENDING,o.push(i),this._trigger("sort",l,{header:o[0][this._CONST_ATTRIBUTE],direction:o[0].direction}),this._beforeDataRefresh(),this._initFetch({sortCriteria:o},!0)}},_isColumnMetadataUpdated:function(){if(null!=this._columnDefArray){var e=this._getColumnMetadata();if(this._columnDefArray.length!==e.length)return!0;for(var t=e.length,l=0;l<t;l++)for(var o=Object.keys(e[l]),i=0;i<o.length;i++){var s=o[i];if(e[l][s]!==this._columnDefArray[l][s]&&("id"!==s||null==e[l][s]||0!==e[l][s].indexOf(this._COLUMN_HEADER_ID_PREFIX)||null==this._columnDefArray[l][s]||0!==this._columnDefArray[l][s].indexOf(this._COLUMN_HEADER_ID_PREFIX)))return!0}return!1}return!0},_isKeyboardKeyPressed:function(e){for(var t=this._getKeyboardKeys(),l=t.length,o=0;o<l;o++)if(t[o]===e)return!0;return!1},_isLoadMoreOnScroll:function(){return this.options.scrollPolicy===this._OPTION_SCROLL_POLICY._AUTO?!(this._data instanceof e.TableDataSourceAdapter):this.options.scrollPolicy!==this._OPTION_SCROLL_POLICY._LOAD_ALL},_isNodeEditable:function(e){return this._isNodeType(e,/^INPUT|TEXTAREA/)},_isNodeClickable:function(e){return this._isNodeType(e,/SELECT|OPTION|BUTTON|^A\b/)},_isNodeDraggable:function(e){return null!=this._getTableDomUtils().getFirstAncestor(e,"[draggable='true']",!0)},_isNodeType:function(t,l){for(var o=this._getTableDomUtils().getTable();null!=t&&t!==o;){var i=t.nodeName;if(i===e.TableDomUtils.DOM_ELEMENT._TD||i===e.TableDomUtils.DOM_ELEMENT._TH)break;if(3!==t.nodeType&&i.match(l)&&-1!==t.getAttribute(e.TableDomUtils.DOM_ATTR._TABINDEX))return!0;t=t.parentNode}return!1},_isPagingModelDataProvider:function(){var e=this._getData();return null!=e.getStartItemIndex&&null!==e.getStartItemIndex()&&e.getStartItemIndex()>=0},_isStatusMessageShown:function(){return this._statusMessageShown},_isTableActionableMode:function(){return this._tableActionableMode},_isTableEditMode:function(){return this.options.editMode===this._OPTION_EDIT_MODE._ROW_EDIT},_isTableFooterless:function(){for(var e=this._getColumnDefs(),t=e.length,l=0;l<t;l++){var o=this._getColumnRenderer(l,"footer"),i=this._getSlotTemplate(e[l][this._FOOTER_TEMPLATE]);if(null!=o)return!1;if(null!=i)return!1}return!this._isDefaultFooterTemplateSlotValid()||null==this._getSlotTemplate("footerTemplate")},_isTableHeaderless:function(){for(var e=this._getColumnDefs(),t=e.length,l=0;l<t;l++){var o=this._getSlotTemplate(e[l][this._HEADER_TEMPLATE]);if(null!=e[l].headerText||null!=e[l].headerStyle||null!=e[l].sortable&&e[l].sortable!==this._OPTION_DISABLED||null!=e[l].sortProperty||null!=e[l].headerRenderer||null!=o)return!1}return!this._isDefaultHeaderTemplateSlotValid()||null==this._getSlotTemplate("headerTemplate")},_isTableHeaderColumnsRendered:function(){return!0===this._renderedTableHeaderColumns},_isTableRefreshNeeded:function(l,o){var i=this._cachedOptions,s=!1;return"contextMenu"===l&&o==="#"+this._getTableDomUtils().getTableId()+"_contextmenu"?s=!1:"columns"!==l||this._isColumnMetadataUpdated()?"selection"===l||"currentRow"===l||e.Object.compareValues(o,i[l])||(s=!0):s=!1,this._cachedOptions=t.extend(!0,{},this.options),s},_isTableSortable:function(){for(var e=this._getColumnDefs(),t=e.length,l=0;l<t;l++)if(e[l].sortable===this._OPTION_ENABLED)return!0;return!1},_isTableColumnsResizable:function(){for(var e=this._getColumnDefs(),t=e.length,l=0;l<t;l++)if(e[l].resizable===this._OPTION_ENABLED)return!0;return!1},_isTouchDevice:function(){if(null==this._isTouch){var e=navigator.userAgent.toLowerCase();-1!==e.indexOf("mobile")||-1!==e.indexOf("android")?this._isTouch=!0:this._isTouch=!1}return this._isTouch},_processFetchSort:function(e){try{var t=this,l=e.fetchParameters,o=this._getColumnDefs(),i=l[this._CONST_SORTCRITERIA];if(null!=i&&i.length>0||null!=this._sortInfo){var s,n;this._sortInfo?(s=this._sortInfo.key,n=this._sortInfo.direction===this._COLUMN_SORT_ORDER._ASCENDING):(s=i[0].attribute,n=i[0].direction===this._COLUMN_SORT_ORDER._ASCENDING),this._refreshSortTableHeaderColumn(s,n),this._setCurrentRow(this.options.currentRow,null,!1);for(var a=null,r=o.length,_=0;_<r;_++){var u=o[_];if(s===(null==u.sortProperty?u.field:u.sortProperty)){a=_;break}}null!=a&&setTimeout(function(){t._scrollColumnIntoViewport(a),t=null,a=null},0)}else this._clearSortedHeaderColumn()}catch(e){d.error(e)}},_processSlottedChildren:function(){var l=this._getTableDomUtils().getTableBottomSlot();null!=l&&t(l).remove();for(var o=e.BaseCustomElementBridge.getSlotMap(this._getRootElement()),i=Object.keys(o),s=0;s<i.length;s++){var n=i[s];if("bottom"===n){var a=o[n];if(null!=a){l=this._getTableDomUtils().createTableBottomSlot();for(var r=0;r<a.length;r++)l.appendChild(a[r])}}}},_refreshAll:function(t,l){if((this._isColumnMetadataUpdated()||!this._isTableHeaderColumnsRendered()&&!this._isTableHeaderless())&&(this._clearCachedMetadata(),this._refreshTableHeader(),null!=this._sortColumn)){var o=!1,i=this._getColumnDefs();if(null!=i){for(var s=i.length,n=0;n<s;n++){var a=i[n];if(e.Object.compareValues(a,this._sortColumn)){o=!0;break}}o||this._initFetch(null,!0)}}return this._refreshTableFooter(),this._refreshTableBody(t,l)},_refreshSortTableHeaderColumn:function(l,o){for(var i,s,n=this._getColumnDefs(),a=null,r=n.length,_=0;_<r;_++){var d=n[_];if(l===(null==d.sortProperty?d.field:d.sortProperty)){a=_;break}}if(null!=a){this._clearSortedHeaderColumn(a);var u=this._getTableDomUtils(),h=u.getTableHeaderColumn(a);if(null!=h){var c=t(h).data("sorted");null!=(i=u.getSortIcon(h))&&(i.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._DEFAULT),i.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._DISABLED));var T=u.getSortIconContainer(h);o&&c!==this._COLUMN_SORT_ORDER._ASCENDING?(s=this.getTranslatedString("accessibleSortAscending",{id:l}),u.setTableStatusAccNotification(s),null!=T&&T.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._ENABLED),t(h).data("sorted",this._COLUMN_SORT_ORDER._ASCENDING),this._sortInfo={direction:this._COLUMN_SORT_ORDER._ASCENDING,columnIdx:a,key:l},null!=i&&(i.classList.remove(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS),i.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS))):o||c===this._COLUMN_SORT_ORDER._DESCENDING||(s=this.getTranslatedString("accessibleSortDescending",{id:l}),u.setTableStatusAccNotification(s),null!=T&&T.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._ENABLED),t(h).data("sorted",this._COLUMN_SORT_ORDER._DESCENDING),this._sortInfo={direction:this._COLUMN_SORT_ORDER._DESCENDING,columnIdx:a,key:l},null!=i&&(i.classList.remove(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS),i.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DSC_ICON_CLASS)))}}},_renderRow:function(e,t,l){var o=e.row,i=e.rowIdx;if(null!=o){var s=this._getTableDomUtils().createTableBodyRow(i,o[this._CONST_KEY]);this._getTableDomUtils().styleTableBodyRow(s,!0),this._getTableDomUtils().insertTableBodyRow(i,s,o,t),this._refreshTableBodyRow(i,o,s,t,l,!0)}},_delayRefreshTableDimensions:function(){this._setDelayRefreshTableDimensionsBusyState();var e=this._scrollTop,t=this;this._refreshTableDimensionsTimer=setTimeout(function(){var l=t._scrollTop;e!==l?t._delayRefreshTableDimensions():(t._queueTask(function(){t._refreshTableDimensionsTimer=null,t._skipRefreshTableDimension=!1}),t._clearDelayRefreshTableDimensionsBusyState())},250)},_afterRowsRendered:function(e,t){this._getTableDomUtils().clearCachedDomRowData(),t&&null==this._refreshTableDimensionsTimer&&this._delayRefreshTableDimensions(),this._clearIdleRenderBusyState(),this._hasRowOrCellRendererOrTemplate()&&n.subtreeAttached(e);var l=this._getTableDomUtils().getTableBodyRows();return l?this._finalizeRowRendering(l).then(function(){return isNaN(this._rowHeight)&&l.length>1&&(this._rowHeight=e.rows[1].offsetHeight),Promise.resolve(!0)}.bind(this)):Promise.resolve(!0)},_clearIdleCallback:function(){null!=this.m_idleCallback&&(window.requestIdleCallback&&window.cancelIdleCallback?(window.cancelIdleCallback(this.m_idleCallback),window.cancelAnimationFrame(this.m_idleCallback)):window.cancelAnimationFrame(this.m_idleCallback),this.m_idleCallback=null)},_requestIdleCallback:function(e,t){if(!e&&window.requestIdleCallback&&window.cancelIdleCallback){var l=window.setTimeout(function(){this.m_idleCallback=window.requestAnimationFrame(function(){t()}),l=null},250);this.m_idleCallback=window.requestIdleCallback(function(e){null!=l&&(window.clearTimeout(l),t(e))})}else this.m_idleCallback=window.requestAnimationFrame(function(){t()})},_renderRowsWhenIdle:function(t,l,o,i,s,n){if(0===t.length)return this.m_idleCallback=null,void this._afterRowsRendered(l,!0).then(function(e){i(e)},function(e){s(e)});var a,r=this,_=0;function d(){window.requestAnimationFrame(function(){r._getTableDomUtils().freezeColumnWidths(a),l.appendChild(a),r._renderRowsWhenIdle(t,l,o+_,i,s,n),n&&e.AgentUtils.getAgentInfo().browser===e.AgentUtils.BROWSER.FIREFOX&&l.scrollTop!==r._scrollTop&&(l.scrollTop=r._scrollTop)})}this._requestIdleCallback(n,function(i){void 0===i?function(){a=document.createDocumentFragment();for(var i=0;i<r._BATCH_PROCESS_SIZE_WHEN_IDLE&&0!==t.length;i++)0!==_||r._getTableDomUtils()._tableWidthConstrained||(l.style[e.TableDomUtils.CSS_PROP._OVERFLOW_X]="hidden"),r._renderRow(t.shift(),a,o),_+=1;d()}():function(i){var s=i.timeRemaining(),n=0;for(a=document.createDocumentFragment();s>n&&0!==t.length;)0!==_||r._getTableDomUtils()._tableWidthConstrained||(l.style[e.TableDomUtils.CSS_PROP._OVERFLOW_X]="hidden"),r._renderRow(t.shift(),a,o),_+=1,n=s-i.timeRemaining(),s=i.timeRemaining();d()}(i)})},_isOverflow:function(){return this._isLoadMoreOnScroll()&&this._domScroller&&this._domScroller.isOverflow()},_refreshTableBody:function(l,o){var i=this._getTableDomUtils().getTableBody();if(null==i)return Promise.resolve();var s,n,a,r=this._getRowIdxRowArray(l,o),_=t.contains(i,document.activeElement),d=!1;if(this._scrollLeft=void 0===this._scrollLeft?0:this._scrollLeft,this._scrollTop=void 0===this._scrollTop?0:this._scrollTop,0===o)_&&(d=!0),this._getTableDomUtils().removeAllTableBodyRows();else if(null!=(s=this._getTableDomUtils().getTableBodyRows())&&s.length>0)for(a=s.length-1;a>=o;a--)_&&null!=(n=this._getTableDomUtils().getTableBodyRow(a))&&t.contains(n,document.activeElement)&&(d=!0,_=!1),this._getTableDomUtils().removeTableBodyRow(a);if(d&&this._getTableDomUtils().getTable().focus(),this._getTableDomUtils().clearCachedDomRowData(),this._hideNoDataMessage(),s=i.children,0!==r.length||null!=s&&0!==s.length){var u;if(o>0&&this._isOverflow()&&!this._fetchBySyncScroll){var h=this;return new Promise(function(e,t){h._setIdleRenderBusyState(),h._renderRowsWhenIdle(r.slice(0),i,o,e,t,l.isMouseWheel)})}i.style[e.TableDomUtils.CSS_PROP._VISIBILITY]=e.TableDomUtils.CSS_VAL._HIDDEN,this._skipRefreshTableDimension=!1,u=document.createDocumentFragment();var c=r.length;for(a=0;a<c;a++)this._renderRow(r[a],u,o);return i.appendChild(u),this._afterRowsRendered(i)}return this._showNoDataMessage(),Promise.resolve()},_refreshTableBodyRow:function(l,o,i,s,n,a){var r=this._getTableDomUtils(),_=this._getRowRenderer(),u=r.getTableBody();(isNaN(l)||l<0)&&d.error("Error: Invalid rowIdx value: "+l);var h=r.hashCode(o[this._CONST_KEY]);if(null==i){if(!(i=r.getTableBodyRow(l)))return null;this._hasCellTemplate&&this._cleanTemplateNodes(i),t(i).empty(),r.createTableBodyCellAccSelect(l,o[this._CONST_KEY],h,i,!0)}this._hideNoDataMessage();var c=this._getCurrentRow();c=c||{};var T=e.TableRendererUtils.getRendererContextObject(this,i,{row:o,isCurrentRow:c.rowIndex===l}),S={rowContext:T,row:o[this._CONST_DATA],componentElement:T.componentElement,parentElement:T.parentElement,data:o[this._CONST_DATA]};if(null!=_){var m=_(S);null!=m?i.appendChild(m):(null==s?i=u.children[l]:(n=null==n?0:n,i=s.children?s.children[l-n]:t(s).children()[l-n]),r.clearCachedDomRowData(),r.setTableBodyRowAttributes(o,i),r.styleTableBodyRow(i,!1)),r.createTableBodyCellAccSelect(l,o[this._CONST_KEY],h,i,!1);var b,C,E=r.getTableElementsByTagName(i,e.TableDomUtils.DOM_ELEMENT._TD),D=E.length;for(b=1;b<D;b++)C=E[b],this._getTableDomUtils().setTableBodyCellAttributes(l,o[this._CONST_KEY],h,b-1,C),this._getTableDomUtils().styleTableBodyCell(b-1,C,!1);if(null!=this._columnsDestMap)for(b=0;b<this._columnsDestMap.length-1;b++)if(this._columnsDestMap[b]>b){var g=E[this._columnsDestMap[b]+1],R=E[b+1];g.parentNode.insertBefore(g,R),E=r.getTableElementsByTagName(i,e.TableDomUtils.DOM_ELEMENT._TD)}}else e.TableRendererUtils.tableBodyRowDefaultRenderer(this,l,o,S);return this._hasEditableRow()&&this._getEditableRowIdx()===l?i.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_EDIT_CLASS):i.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_EDIT_CLASS),i},_refreshTableFooter:function(){var l=this._getColumnDefs(),o=this._getTableDomUtils().getTableFooter();if(!o){if(this._isTableFooterless())return;o=this._getTableDomUtils().createTableFooter(),this._getTableDomUtils().styleTableFooter(o)}o.style[e.TableDomUtils.CSS_PROP._VISIBILITY]=e.TableDomUtils.CSS_VAL._HIDDEN;var i=this._getTableDomUtils().getTableFooterRow();if(this._hasFooterTemplate&&(this._cleanTemplateNodes(i),this._hasFooterTemplate=!1),t(i).empty(),l&&l.length>0){this._getTableDomUtils().createTableFooterAccSelect(i);for(var s=this._isDefaultFooterTemplateSlotValid(),n=l.length,a=0;a<n;a++){var r=l[a],_=this._getColumnRenderer(a,"footer"),d=this._getTableDomUtils().createTableFooterCell(a);if(this._getTableDomUtils().styleTableFooterCell(a,d),this._getTableDomUtils().insertTableFooterCell(a,d),_){var u=e.TableRendererUtils.getRendererContextObject(this,d,{}),h=_({footerContext:u,columnIndex:a,componentElement:u.componentElement,parentElement:u.parentElement});null!=h?(d.empty(),d.appendChild(h)):(d=t(i).children(":not(."+e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS+")")[a],this._getTableDomUtils().styleTableFooterCell(a,d))}else{var c=this._getSlotTemplate(r[this._FOOTER_TEMPLATE]);if(null==c&&s&&(c=this._getSlotTemplate("footerTemplate")),c){var T=this._getRootElement(),S=this._getTemplateEngine();if(null!=S){var m=e.TableRendererUtils.getSlotTemplateContextObject(this),b=S.execute(T,c,m,this.options.as);b instanceof Array||(b=[b]),b.map(function(e){d.appendChild(e)}),this._hasFooterTemplate=!0}}}}}},_refreshTableHeader:function(){var l=this,o=this._getColumnDefs(),i=this._getTableDomUtils().getTableHeader();if(!i){if(this._isTableHeaderless())return;i=this._getTableDomUtils().createTableHeader(),this._getTableDomUtils().styleTableHeader(i)}var s=this._getTableDomUtils().getTableHeaderRow();if(this._unregisterChildStateListeners(s),this._hasHeaderTemplate&&(this._cleanTemplateNodes(s),this._hasHeaderTemplate=!1),t(s).empty(),o&&o.length>0){var n=this._getTableDomUtils().createTableHeaderAccSelectRowColumn();s.appendChild(n);for(var a=this._isDefaultHeaderTemplateSlotValid(),r=o.length,_=0;_<r;_++){var d=o[_],u=this._getColumnRenderer(_,"header"),h=this._getTableDomUtils().createTableHeaderColumn(_);if(u){var c=e.TableRendererUtils.getRendererContextObject(this,h,{}),T={headerContext:c,columnIndex:_,data:d.headerText,componentElement:c.componentElement,parentElement:c.parentElement};d.sortable===e.TableDomUtils._OPTION_ENABLED?T.columnHeaderSortableIconRenderer=function(t,o){e.TableRendererUtils.columnHeaderSortableIconRenderer(l,this,t,o)}:T.columnHeaderDefaultRenderer=function(t,o){e.TableRendererUtils.columnHeaderDefaultRenderer(l,this,t,o)};var S=u(T);null!=S?(t(h).empty(),t(h).append(S)):(h=t(s).children(":not(."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ACC_SELECT_ROW_CLASS+")")[_],this._getTableDomUtils().setTableHeaderColumnAttributes(_,h),this._getTableDomUtils().styleTableHeaderColumn(_,h,!1))}else{var m=this._getSlotTemplate(d[this._HEADER_TEMPLATE]);if(null==m&&a&&(m=this._getSlotTemplate("headerTemplate")),m){var b=this._getRootElement(),C=this._getTemplateEngine();if(null!=C){h&&t(h).empty();var E=e.TableRendererUtils.getHeaderSlotTemplateContextObject(this,d.headerText,_),D=C.execute(b,m,E,this.options.as);D instanceof Array||(D=[D]),D.map(function(e){h.appendChild(e)}),this._hasHeaderTemplate=!0}}}this._getTableDomUtils().createTableHeaderColumnAccSelect(_,this._getColumnSelectionMode())}this._renderedTableHeaderColumns=!0}},_refreshTableStatusMessage:function(){var e=this._getTableDomUtils().getTableStatusMessage();null!=e&&t(e).remove(),this._getTableDomUtils().createTableStatusMessage()},_registerCustomEvents:function(){var e=t.event.special;e.ojtablebeforecurrentrow={handle:function(e){return e.handleObj.handler.apply(this,[e,arguments[1]])}},e.ojtablesort={handle:function(e){return e.handleObj.handler.apply(this,[e,arguments[1]])}}},_registerDataSourceEventListeners:function(){var e=this._getData();if(null!=e){this._unregisterDataSourceEventListeners(),this._dataProviderEventHandlers=[],this._dataProviderEventHandlers.push({eventType:"mutate",eventHandler:this._handleDataRowMutate.bind(this)}),this._dataProviderEventHandlers.push({eventType:"refresh",eventHandler:this._handleDataRefresh.bind(this)});for(var t=this._dataProviderEventHandlers.length,l=0;l<t;l++){var o=e.addEventListener(this._dataProviderEventHandlers[l].eventType,this._dataProviderEventHandlers[l].eventHandler);o&&(this._dataProviderEventHandlers[l].eventHandler=o)}}},_registerDomEventListeners:function(){var e=this._getTableDomUtils().getScroller();null!=e&&(null==this._scrollEventListener&&(this._scrollEventListener=function(e){if(this._handleScrollerScrollLeft(this._getTableDomUtils().getScrollLeft(e.target)),this._handleScrollerScrollTop(e.target.scrollTop),!this._isScrollPositionAdjusted()){var t=this;t._skipScrollUpdate||t._ticking||(window.requestAnimationFrame(function(){t._isScrollPositionAdjusted()||t._skipScrollUpdate||t.option("scrollPosition",t._getCurrentScrollPosition(),{_context:{originalEvent:e,internalSet:!0}}),t._ticking=!1}),this._ticking=!0),this._skipScrollUpdate=!1}}.bind(this)),t(e).off("scroll",this._scrollEventListener),t(e).on("scroll",this._scrollEventListener))},_registerDomScroller:function(){var t,l=this;this._unregisterDomScroller(),this._domScrollerSuccessFunc=function(e){if(l._clearDataWaitingState(),null!=e)if(l._noMoreData=!1,e.maxCountLimit)l._noMoreData=!0,l._handleScrollerMaxRowCount(),l._syncScrollPosition();else{var o=e[l._CONST_VALUE],i=o[l._CONST_DATA],s=o.metadata.map(function(e){return e[l._CONST_KEY]}),n=o[l._CONST_METADATA];for(t=s.length-1;t>=0;t--)null!==l._getRowIdxForRowKey(s[t])&&(i.splice(t,1),s.splice(t,1));l._queueTask(function(){l._skipRefreshTableDimension=!0;var o=this._getTableDomUtils().getTableBodyRows(),a=null!=o?o.length:0,r=[];for(t=0;t<i.length;t++)r[t]=a+t;return l._refreshAll({isMouseWheel:e.isMouseWheel,data:i,keys:s,metadata:n,indexes:r},a).then(function(){e.done&&(l._noMoreData=!0,l._syncScrollPosition())})})}else l._syncScrollPosition()};var o=this._getTableDomUtils().getTableBodyRows(),i=null!=o?o.length:0;this._domScroller=new e.DomScroller(this._getTableDomUtils().getScroller(),this._getData(),{asyncIterator:this._dataProviderAsyncIterator,fetchSize:this.options.scrollPolicyOptions.fetchSize,maxCount:this.options.scrollPolicyOptions.maxCount,initialRowCount:i,success:this._domScrollerSuccessFunc.bind(this),request:this._handleDataFetchStart.bind(this),localKeyValidator:function(e){return null!==l._findRowElementByKey(e)},beforeFetch:function(e){return null==l.m_idleCallback&&(l._fetchBySyncScroll=l._scrollY===e,l._setDataWaitingState(!1),!0)},onScrollTop:this._clearScrollPosBusyState.bind(this),fetchTrigger:1})},_unregisterDomScroller:function(){null!=this._domScroller&&(this._domScroller.destroy(),this._domScroller=null)},_registerResizeListener:function(){var t=this._getTableDomUtils().getTableContainer();this._resizeListener||(this._resizeListener=function(){var e=this._getTableDomUtils(),t=e.getTableContainer();e.isSizingRefreshRequired(t.offsetWidth,t.offsetHeight)&&(this._hasPendingTasks()||this._syncTableSizing(!0))}.bind(this)),this._isResizeListenerAdded||(e.DomUtils.addResizeListener(t,this._resizeListener,50),this._isResizeListenerAdded=!0)},_removeKeyboardKey:function(e){for(var t=this._getKeyboardKeys(),l=t.length,o=0;o<l;o++)t[o]===e&&t.splice(o,1)},_scrollColumnIntoViewport:function(l){var o=this._getTableDomUtils(),i=o.getTableHeaderColumn(l);if(i){var s,n,a,r,_="rtl"===this._GetReadingDirection(),d=o.getScroller(),u=t(d),h=o.getScrollBarWidth(),c=i.getBoundingClientRect(),T=d.getBoundingClientRect();if(_){n=(s=T.left-c.left+h)>=0,r=(a=c.right-T.right)>=0;var S=e.AgentUtils.getAgentInfo().browser;S!==e.AgentUtils.BROWSER.IE&&S!==e.AgentUtils.BROWSER.EDGE||(s*=-1,a*=-1)}else n=(s=T.left-c.left)>=0,r=(a=c.right-T.right+h)>=0;n&&r||(n?Math.abs(a)>Math.abs(s)?u.scrollLeft(u.scrollLeft()-s):u.scrollLeft(u.scrollLeft()+a):r&&(Math.abs(s)>Math.abs(a)?u.scrollLeft(u.scrollLeft()+a):u.scrollLeft(u.scrollLeft()-s)))}},_scrollRowIntoViewport:function(e){var l=this._getTableDomUtils(),o=l.getTableBodyRow(e),i=l.getScrollBarHeight(),s=o.getBoundingClientRect(),n=l.getScroller(),a=t(n),r=n.getBoundingClientRect(),_=r.top-s.top,d=_>=0,u=s.bottom-r.bottom+i,h=u>=0;d&&h||(h?Math.abs(_)>Math.abs(u)?a.scrollTop(a.scrollTop()+u):a.scrollTop(a.scrollTop()-_):d&&(Math.abs(u)>Math.abs(_)?a.scrollTop(a.scrollTop()-_):a.scrollTop(a.scrollTop()+u)))},_setCurrentRow:function(t,l,o){var s,n,a,r,_,u,h,c,T=this._currentRow,S=!0,m=this;if(null==t){if(null!=T){try{S=this._trigger("beforeCurrentRow",l,{currentRow:null,previousCurrentRow:this._currentRow})}catch(e){return _=this._LOGGER_MSG._ERR_PRECURRENTROW_ERROR_SUMMARY,u=i.applyParameters(this._LOGGER_MSG._ERR_PRECURRENTROW_ERROR_DETAIL,{error:e.toString()}),d.info(_+"\n"+u),this._CURRENT_ROW_STATUS._ERROR}if(!S)return this._CURRENT_ROW_STATUS._VETOED;if(n=T.rowIndex,a=this._getRowKeyForDataSourceRowIndex(n),r=this._getRowIdxForRowKey(a),!1===this._setTableEditable(!1,!1,0,!0,l))return this._currentRow=T,h=document.activeElement,c=this._getTableDomUtils().getElementColumnIdx(h),this._queueTask(function(){var e=r,t=c;null!=e&&null!=t?setTimeout(function(){m._setCellFocus(e,t)},0):null!=e&&setTimeout(function(){m._setRowFocus(e,!0,!1,null,null)},0)}),this._CURRENT_ROW_STATUS._IGNORED;this._currentRow=null,this.option("currentRow",null,{_context:{writeback:!0,originalEvent:l,internalSet:!0}}),null==l&&this._setRowFocus(-1,!0,!1,null,l),null!=(s=this._getTableDomUtils().getTableBodyRow(r))&&s.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CURRENT_ROW_CLASS)}return this._CURRENT_ROW_STATUS._UPDATED}var b=this._getData(),C=t.rowIndex,E=t.rowKey;null==E&&(E=this._getRowKeyForDataSourceRowIndex(C)),C=this._getDataSourceRowIndexForRowKey(E);var D=this._getRowIdxForRowKey(E);if(t={rowIndex:C,rowKey:E},-1!==D&&(!b||D<-1||null===D||null===E)){if(_=this._LOGGER_MSG._ERR_CURRENTROW_UNAVAILABLE_INDEX_SUMMARY,u=i.applyParameters(this._LOGGER_MSG._ERR_CURRENTROW_UNAVAILABLE_INDEX_DETAIL,{rowIdx:D}),o)throw new Error(_+"\n"+u);return d.info(_+"\n"+u),this._CURRENT_ROW_STATUS._IGNORED}var g=this._getFocusedRowIdx(),R=!e.Object.compareValues(this._currentRow,t);if(R){try{S=this._trigger("beforeCurrentRow",l,{currentRow:{rowIndex:C,rowKey:E},previousCurrentRow:this._currentRow})}catch(e){return _=this._LOGGER_MSG._ERR_PRECURRENTROW_ERROR_SUMMARY,u=i.applyParameters(this._LOGGER_MSG._ERR_PRECURRENTROW_ERROR_DETAIL,{error:e.toString()}),d.info(_+"\n"+u),this._CURRENT_ROW_STATUS._ERROR}if(!S)return this._CURRENT_ROW_STATUS._VETOED;if(this._currentRow={rowIndex:C,rowKey:E},null!=T&&(n=T.rowIndex,a=this._getRowKeyForDataSourceRowIndex(n),r=this._getRowIdxForRowKey(a)),!1===this._setTableEditable(!1,!1,0,!0,l))return this._currentRow=T,h=document.activeElement,c=this._getTableDomUtils().getElementColumnIdx(h),this._queueTask(function(){var e=r,t=c;null!=e&&null!=t?setTimeout(function(){m._setCellFocus(e,t)},0):null!=e&&setTimeout(function(){m._setRowFocus(e,!0,!1,null,null)},0)}),this._CURRENT_ROW_STATUS._IGNORED;this.option("currentRow",this._currentRow,{_context:{writeback:!0,originalEvent:l,internalSet:!0}}),null!=(s=this._getTableDomUtils().getTableBodyRow(D))&&s.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CURRENT_ROW_CLASS),null!=T&&null!=(s=this._getTableDomUtils().getTableBodyRow(r))&&s.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CURRENT_ROW_CLASS)}return(R||g!==t.rowIndex)&&null==l&&this._setRowFocus(D,!0,!1,null,l),this._CURRENT_ROW_STATUS._UPDATED},_setEditRow:function(e){if(this._isTableEditMode()){var t=e.rowKey,l=e.rowIndex;if(null!=t||l>-1){var o=this._setCurrentRow({rowKey:t,rowIndex:l},null,!1);if(o===this._CURRENT_ROW_STATUS._UPDATED)this._setTableEditable(!0,!1,0,!0,null);else if(o===this._CURRENT_ROW_STATUS._IGNORED){var i=this._scrollTop;if(!this._syncScrollPosition({rowKey:t,rowIndex:l})){var s=this;this._editRowCallback=function(){s._scrollTop!==i&&s._setEditRow(e)}}}}else this._setTableEditable(!1,!1,0,!0,null)}},_setDataWaitingState:function(e){!1!==e&&(this._showStatusMessage(),this._hideNoDataMessage()),this._dataFetching=!0,this._dataResolveFunc||(this._dataResolveFunc=this._addComponentBusyState("is waiting for data."))},_setCellFocus:function(e,t){var l=this._getTableDomUtils().getTableBodyCell(e,t);if(l){var o=a.getFocusableElementsInNode(l);if(o.length>0)return o[0].focus(),!0}return!1},_setCellInRowFocus:function(e,t,l){if(!this._setCellFocus(e,t)){var o=this._getTableDomUtils().getTableBodyCells(e);if(o)for(var i=o.length,s=0;s<i;s++){var n=s;if(l||(n=i-s-1),this._setCellFocus(e,n))return}}},_setComponentNotReady:function(){this._readyResolveFunc||(this._readyResolveFunc=this._addComponentBusyState("is being loaded."))},_setComponentReady:function(){this._readyResolveFunc&&(this._readyResolveFunc(),this._readyResolveFunc=null)},_setEditableRowIdx:function(e){this._editableRowKey=this._getRowKeyForRowIdx(e),this._editableRowIdx=e},_setFocusInHandler:function(e){this._focusInHandler=e},_setFocusOutHandler:function(e){this._focusOutHandler=e},_setHeaderColumnFocus:function(e,t,l){if(null!=e){if(t){this._clearFocusedRow(!0);var o=this._getFocusedHeaderColumnIdx();null!==o&&o!==e&&this._setHeaderColumnFocus(o,!1,l),l||this._scrollColumnIntoViewport(e),this._activeColumnIndex=e}this._setHeaderColumnState(e,{focused:t})}},_getColumnSelectionFromKeySet:function(e){var t=[];return(e.isAddAll()?e.deletedValues():e.values()).forEach(function(e){var l={startKey:{column:e},endKey:{column:e}},o=this._getColumnIdxForColumnKey(e);o>=0&&(l.startIndex={column:o},l.endIndex={column:o}),t.push(l)},this),t.inverted=e.isAddAll(),t},_applyColumnSelection:function(t,l){this._setHeaderColumnState(t,{selected:l});var o=this._getTableDomUtils(),i=o.getTableHeaderColumnAccSelect(t);i&&(o.getTableElementsByClassName(i,e.TableDomUtils.CSS_CLASSES._CHECKBOX_ACC_SELECT_COLUMN_CLASS)[0].checked=l)},_setHeaderColumnState:function(e,t){var l=this._getTableDomUtils().getTableHeaderColumn(e);l&&this._applyHeaderColumnState(l,e,t)},_applyHeaderColumnState:function(l,o,i){var s=i.focused,n=i.selected;null!=n&&l.classList.contains(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)!==n&&(n?l.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED):l.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)),null!=s&&(s?(this._focusInHandler(t(l)),this._showTableHeaderColumnSortIcon(o)):(this._focusOutHandler(t(l)),this._hideTableHeaderColumnSortIcon(o))),this._updateHeaderColumnStateCellsClass(o)},_setLastHeaderColumnSelection:function(e,t){this._lastSelectedColumnIdxArray||(this._lastSelectedColumnIdxArray=[]);for(var l=this._lastSelectedColumnIdxArray.length,o=0;o<l;o++)if(this._lastSelectedColumnIdxArray[o]===e){this._lastSelectedColumnIdxArray.splice(o,1);break}t&&this._lastSelectedColumnIdxArray.push(e)},_setLastRowSelection:function(e,t){this._lastSelectedRowIdxArray||(this._lastSelectedRowIdxArray=[]);for(var l=this._lastSelectedRowIdxArray.length,o=0;o<l;o++)if(this._lastSelectedRowIdxArray[o]===e){this._lastSelectedRowIdxArray.splice(o,1);break}t&&this._lastSelectedRowIdxArray.push(e)},_setNextRowEditable:function(e,t){var l=this._getTableDomUtils().getTableBodyRows(),o=null!=l?l.length:0,i=this._getEditableRowIdx(),s=this;i>=0&&i<o-1?!1===this._setTableEditable(!1,!1,e,!0,t)?this._queueTask(function(){setTimeout(function(){s._setCellFocus(i,e)},0)}):(this._setCurrentRow({rowIndex:i+1},t,!1),this._setTableEditable(!0,!1,e,!0,t)):i===o-1&&(this._setTableEditable(!1,!1,e,!0,t),this._getTableDomUtils().getTable().focus())},_setPreviousRowEditable:function(e,t){var l=this._getEditableRowIdx(),o=this;l>=1?!1===this._setTableEditable(!1,!1,e,!1,t)?this._queueTask(function(){setTimeout(function(){o._setCellFocus(l,e)},0)}):(this._setCurrentRow({rowIndex:l-1},t,!1),this._setTableEditable(!0,!1,e,!1,t)):0===l&&(this._setTableEditable(!1,!1,e,!1,t),this._getTableDomUtils().getTable().focus())},_setRowFocus:function(e,l,o,i,s){var n;if(-1===e)return!(o&&this._setCurrentRow(null,s,!1)!==this._CURRENT_ROW_STATUS._UPDATED||(null!=(n=this._getFocusedRowIdx())&&this._setRowFocus(n,!1,o,null,null),0));var a=this._getTableDomUtils().getTableBodyRow(e);if(!a)return!1;if(l){if(o){var r=this._getRowKeyForRowIdx(e);if(this._setCurrentRow({rowKey:r},s,!1)!==this._CURRENT_ROW_STATUS._UPDATED)return!1}null!=(n=this._getFocusedRowIdx())&&n!==e&&this._setRowFocus(n,!1,o,i,null),this._focusInHandler(t(a)),this._scrollRowIntoViewport(e),this._updateRowStateCellsClass(e,{focused:!0}),this._clearFocusedHeaderColumn(),this._setTableActionableMode(!1)}else this._focusOutHandler(t(a)),this._updateRowStateCellsClass(e,{focused:!1});return!0},_getRowSelectionFromKeySet:function(e){var t=[];return(e.isAddAll()?e.deletedValues():e.values()).forEach(function(e){var l={startKey:{row:e},endKey:{row:e}},o=this._getDataSourceRowIndexForRowKey(e);!isNaN(o)&&o>=0&&(l.startIndex={row:o},l.endIndex={row:o}),t.push(l)},this),t.inverted=e.isAddAll(),t},_applyRowSelection:function(t,l,o){if(l.classList.contains(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)!==o){o?l.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED):l.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED);var i=this.options.dnd.drag;i&&("rows"===i||i.rows)&&(l.draggable=o)}o?this._updateRowStateCellsClass(t,{hover:!1,focused:!1,selected:!0}):this._updateRowStateCellsClass(t,{selected:!1});var s=this._getTableDomUtils(),n=s.getTableBodyCellAccSelect(l);n&&(s.getTableElementsByClassName(n,e.TableDomUtils.CSS_CLASSES._CHECKBOX_ACC_SELECT_ROW_CLASS)[0].checked=o)},_getDataSourceLastFetchedRowIndex:function(){var e=this._getTableDomUtils().getTableBodyRows();if(null!=e&&e.length>0){var t=e.length,l=this._getData(),o=0;return this._isPagingModelDataProvider()&&(o=l.getStartItemIndex()),t+o-1}return 0},_processRowRangeSelection:function(e,t,l){var o,i,s,n,a,r,_,u=!0;if(null!=e.startKey&&null!=e.startKey[this._CONST_ROW]?(a=e.startKey[this._CONST_ROW],o=this._getDataSourceRowIndexForRowKey(a),isNaN(o)&&(u=void 0)):null!=e.startIndex&&null!=e.startIndex[this._CONST_ROW]&&(o=e.startIndex[this._CONST_ROW]),null!=e.endKey&&null!=e.endKey[this._CONST_ROW])r=e.endKey[this._CONST_ROW],null===(i=this._getDataSourceRowIndexForRowKey(r))&&this._isLoadMoreOnScroll()&&(i=this._getDataSourceLastFetchedRowIndex(),u=void 0);else if(null!=e.endIndex&&null!=e.endIndex[this._CONST_ROW]){i=e.endIndex[this._CONST_ROW];var h=this._getDataSourceLastFetchedRowIndex();this._isLoadMoreOnScroll()&&i>h&&(i=h,u=void 0)}if(void 0===o&&void 0===i)u=!1;else if(null!=o&&null!=i&&o<=i){for(a=this._getRowKeyForDataSourceRowIndex(o),r=this._getRowKeyForDataSourceRowIndex(i),s=this._getRowIdxForRowKey(a),n=this._getRowIdxForRowKey(r),_=s;_<=n;_++){var c=this._getRowKeyForRowIdx(_);t=t.add([c])}l=l.clear()}else d.warn("Error: Cannot resolve row range in selection - \n start row key: "+a+"\n end row key: "+r+"\n start row index: "+o+"\n end row index: "+i),null!=a&&null!=r&&(t=(t=t.add([a])).add([r]),l=l.clear());return{status:u,rowKeySet:t,columnKeySet:l}},_processColumnRangeSelection:function(e,t,l){var o,i,s,n,a=!0;if(null!=e.startKey&&null!=e.startKey[this._CONST_COLUMN]?(o=e.startKey[this._CONST_COLUMN],s=this._getColumnIdxForColumnKey(o)):null!=e.startIndex&&null!=e.startIndex[this._CONST_COLUMN]&&(s=e.startIndex[this._CONST_COLUMN]),null!=e.endKey&&null!=e.endKey[this._CONST_COLUMN]?(i=e.endKey[this._CONST_COLUMN],n=this._getColumnIdxForColumnKey(i)):null!=e.endIndex&&null!=e.endIndex[this._CONST_COLUMN]&&(n=e.endIndex[this._CONST_COLUMN]),void 0===s&&void 0===n)a=!1;else if(null!=s&&null!=n&&!isNaN(s)&&!isNaN(n)&&s<=n){for(var r=s;r<=n;r++){var _=this._getColumnKeyForColumnIdx(r);l=l.add([_])}t=t.clear()}else d.error("Error: Cannot resolve column range in selection - \n start column key: "+o+"\n end column key: "+i+"\n start column index: "+s+"\n end column index: "+n);return{status:a,rowKeySet:t,columnKeySet:l}},_syncRangeSelection:function(e){if(void 0===e&&(e=this.option("selection")),null!=e)for(var t=e.length,l=0;l<t;l++){var o,i,s,n,a=e[l];null!=a.startKey&&null!=a.startKey[this._CONST_ROW]?(o=a.startKey[this._CONST_ROW],i=this._getDataSourceRowIndexForRowKey(o),a.startIndex={},a.startIndex[this._CONST_ROW]=i):null!=a.startIndex&&null!=a.startIndex[this._CONST_ROW]&&(i=a.startIndex[this._CONST_ROW],null!=(o=this._getRowKeyForDataSourceRowIndex(i))&&(a.startKey={},a.startKey[this._CONST_ROW]=o)),null!=a.endKey&&null!=a.endKey[this._CONST_ROW]?(s=a.endKey[this._CONST_ROW],n=this._getDataSourceRowIndexForRowKey(s),a.endIndex={},a.endIndex[this._CONST_ROW]=n):null!=a.endIndex&&null!=a.endIndex[this._CONST_ROW]&&(n=a.endIndex[this._CONST_ROW],null!=(s=this._getRowKeyForDataSourceRowIndex(n))&&(a.endKey={},a.endKey[this._CONST_ROW]=s))}},_getSelectedEquivalent:function(t){var l;if(null!=t){for(var o=(l={row:new e.KeySetImpl,column:new e.KeySetImpl}).row,i=l.column,s=t.length,n=0;n<s;n++){var a=t[n];if(null==a.startKey&&null==a[this._CONST_STARTINDEX]||null==a.endKey&&null==a[this._CONST_ENDINDEX])d.error("Error: Invalid range object in selection. Both start and end objects must be specified");else{var r=this._processRowRangeSelection(a,o,i);o=r.rowKeySet,i=r.columnKeySet,!1===r.status&&(!1===(r=this._processColumnRangeSelection(a,o,i)).status&&d.error("Error: Invalid range object"),o=r.rowKeySet,i=r.columnKeySet)}}l.row===o&&l.column===i||(l={row:o,column:i})}else l={row:new e.KeySetImpl,column:new e.KeySetImpl};return l},_applySelected:function(e){var t=this._getTableDomUtils(),l=e.row,o=e.column;if(this._getSelectedRowIdxs().forEach(function(e){var o=t.getTableBodyRow(e);l.has(this._getRowKey(o))||this._applyRowSelection(e,o,!1)},this),this._isRowSelectionEnabled())if(l.isAddAll()){var i=t.getTableBodyRows();i.forEach(function(e,t){l.has(this._getRowKey(e))&&this._applyRowSelection(t,e,!0)},this);var s=i.length-1,n=this._getRowKeyForRowIdx(s);this._setLastRowSelection(s,l.has(n))}else l.values().forEach(function(e){var l=this._getRowIdxForRowKey(e);null!=l&&l>=0&&this._applyRowSelection(l,t.getTableBodyRow(l),!0)},this);if(0===this._getSelectedRowIdxs().length&&this._getTableDomUtils().removeTableBodyRowTouchSelectionAffordance(),this._getSelectedHeaderColumnIdxs().forEach(function(e){o.has(this._getColumnKeyForColumnIdx(e))||this._applyColumnSelection(e,!1)},this),this._isColumnSelectionEnabled())if(o.isAddAll()){var a=t.getTableHeaderColumns();a.forEach(function(e,t){o.has(this._getColumnKeyForColumnIdx(t))&&this._applyColumnSelection(t,!0)},this);var r=a.length-1,_=this._getColumnKeyForColumnIdx(r);this._setLastHeaderColumnSelection(r,o.has(_))}else o.values().forEach(function(e){var t=this._getColumnIdxForColumnKey(e);null!=t&&t>=0&&this._applyColumnSelection(t,!0)},this)},_setSelected:function(e,t){if(this._selectionSet=t,null!=e){var l,o=this.option("selected");if(this._selectionSet?a.areKeySetsEqual(o.row,e.row)&&a.areKeySetsEqual(o.column,e.column)||(l=!0):o.row===e.row&&o.column===e.column||(l=!0),l&&(this.option("selected",e,{_context:{writeback:!0,internalSet:!0}}),this._isSelectionRequired()&&this._validatedSelectedRowKeyData))for(var i=this._validatedSelectedRowKeyData.length-1;i>=0;i--){var s=this._validatedSelectedRowKeyData[i];e.row.has(s.key)||this._validatedSelectedRowKeyData.splice(i,1)}this._applySelected(e);var n=null,r=this._getRowSelectionFromKeySet(e.row);if(null!=r&&r.length>0){var _=r[0];null!=_.startKey&&(n=_.startKey[this._CONST_ROW])}if(this._setFirstSelectedRow(n),!t){var d=this._getSelectionEquivalent(e);this.option("selection",d,{_context:{writeback:!0,internalSet:!0}})}}},_setFirstSelectedRow:function(t){var l=this.option("firstSelectedRow");if(!e.KeyUtils.equals(t,l.key)){var o=null;if(null!=t){var i=this.getDataForVisibleRow(this._getRowIdxForRowKey(t));if(null!=i)o=i[this._CONST_DATA];else if(this._validatedSelectedRowKeyData)for(var s=0;s<this._validatedSelectedRowKeyData.length;s++){var n=this._validatedSelectedRowKeyData[s];if(e.KeyUtils.equals(t,n.key)){o=n.data;break}}}this.option("firstSelectedRow",{key:t,data:o},{_context:{writeback:!0,internalSet:!0}})}},_syncSelectionState:function(){var e=this.option("selected"),t=this.option("selection");this._selectionSet&&(e=this._getSelectedEquivalent(t),this._syncRangeSelection()),this._setSelected(e,this._selectionSet)},_validateInitialSelectionState:function(e){var t,l,o=this.option("selection"),i=this.option("selected"),s=i.row,n=i.column;if(this._validatedSelectedRowKeyData=null,(this._selectionSet||!e&&null!=o&&0!==o.length&&s===s.clear()&&n===n.clear())&&(i=this._getSelectedEquivalent(o),t=!0),this._isSelectionRequired())if((l=this._validateSelected(i)).isLocal)this._enforceSelectionRequired(i,l.result,t);else{var a=this._createComponentBusyState("is validating selection-required keys.");l.result.then(function(e){this._enforceSelectionRequired(i,e,t),this._clearComponentBusyState(a)}.bind(this))}else t&&this._syncRangeSelection(),this._setSelected(i,t);this._initialSelectionStateValidated=!0},_enforceSelectionRequired:function(e,t,l){l?this._hasSelected(t)?t.row===e.row&&t.column===e.column?(this._syncRangeSelection(),this._setSelected(t,!0)):this._setSelected(t):this._selectFirstRowOrColumn():this._hasSelected(t)?this._setSelected(t):this._selectFirstRowOrColumn()},_handleSelectionGesture:function(t,l,o){var i=this.option("selected"),s=i.row,n=i.column;if(l){if(n=n.clear(),this._isRowSelectionEnabled()){var a=this._getRowKeyForRowIdx(t);s=s.has(a)?!o&&this._getSelectedRowIdxs().length>1&&this._getRowSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE?new e.KeySetImpl([a]):s.delete([a]):o&&this._getRowSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE?s.add([a]):new e.KeySetImpl([a])}}else if(s=s.clear(),this._isColumnSelectionEnabled()){var r=this._getColumnKeyForColumnIdx(t);n=n.has(r)?!o&&this._getSelectedHeaderColumnIdxs().length>1&&this._getColumnSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE?new e.KeySetImpl([r]):n.delete([r]):o&&this._getColumnSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE?n.add([r]):new e.KeySetImpl([r])}i.row===s&&i.column===n||(i={row:s,column:n},this._isSelectionRequiredSatisfied(i)&&this._setSelected(i))},_hasSelected:function(e){null==e&&(e=this.option("selected"));var t=e.row,l=e.column;return t.isAddAll()||t.values().size>0||l.isAddAll()||l.values().size>0},_isSelectionRequiredSatisfied:function(e){return!this._isSelectionRequired()||this._hasSelected(e)},_isSelectionRequired:function(){return"true"===String(this.options.selectionRequired).toLowerCase()},_validateSelected:function(e){var t=e.column,l=t;if(!t.isAddAll()){var o=this._getColumnKeys(),i=[];t.values().forEach(function(e){-1===o.indexOf(e)&&i.push(e)}),i.length>0&&(l=l.delete(i))}var s=e.row,n=s;if(!s.isAddAll()){var a=this._getLocalRowKeys(),r=[];if(s.values().forEach(function(e){-1===a.indexOf(e)&&r.push(e)}),r.length>0){var _=this._fetchValidRowKeyData(r);if(_)return{isLocal:!1,result:new Promise(function(e){_.then(function(t){this._validatedSelectedRowKeyData=t,t.forEach(function(e){r.splice(r.indexOf(e.key),1)}),n=n.delete(r),e({row:n,column:l})}.bind(this))}.bind(this))};n=n.delete(r)}}return{isLocal:!0,result:{row:n,column:l}}},_fetchValidRowKeyData:function(e){var t=this._getData();if(t&&t.getCapability){var l=t.getCapability("fetchByKeys");if(l&&"lookup"===l.implementation)return new Promise(function(l){t.fetchByKeys({keys:new Set(e),scope:"global"}).then(function(e){var t=[];e.results.forEach(function(e,l){t.push({key:l,data:e.data})}),l(t)},function(){l([])})})}return null},_selectFirstRowOrColumn:function(){var t;this._isRowSelectionEnabled()||!this._isColumnSelectionEnabled()?(t=new e.KeySetImpl([this._getRowKeyForRowIdx(0)]),this._setSelected({row:t,column:new e.KeySetImpl})):(t=new e.KeySetImpl([this._getColumnKeyForColumnIdx(0)]),this._setSelected({row:new e.KeySetImpl,column:t}))},_getSelectionEquivalent:function(e){var t=this._getRowSelectionFromKeySet(e.row);return t.length>0||t.inverted?t:(t=this._getColumnSelectionFromKeySet(e.column)).length>0||t.inverted?t:[]},_toggleTableActionableMode:function(){this._isTableActionableMode()?this._setTableActionableMode(!1):this._setTableActionableMode(!0)},_setTableActionableMode:function(e,l){if(!(null!=this._tableActionableMode&&this._tableActionableMode===e||null==this._tableActionableMode&&!1===e))if(e){var o=null,i=this._getFocusedRowIdx();if(null!=i&&(o=this._getTableDomUtils().getTableBodyRow(i)),null==o){var s=this._getFocusedHeaderColumnIdx();null!=s&&(o=this._getTableDomUtils().getTableHeaderColumn(s))}if(null!=o){a.enableAllFocusableElements(o);var n=this._getTabbableElements(o);null!=n&&n.length>0&&(this._tableActionableMode=e,this._tableActionableElement=o,n[0].focus())}}else if(this._tableActionableMode=!1,this._isTableEditMode())this._tableActionableElement=null;else{var r=this._getTableDomUtils().getTableBody(),_=t.contains(r,document.activeElement);null!=this._tableActionableElement&&(a.disableAllFocusableElements(this._tableActionableElement),this._tableActionableElement=null),_&&!l&&this._getTableDomUtils().getTable().focus()}},_fireEditRowChangeEvent:function(e,t){var l=this;this._queueTask(function(){l.option("editRow",e,{_context:{originalEvent:t,internalSet:!0,writeback:!0}})})},_setTableEditable:function(t,l,o,i,s,n){if(this._isTableEditMode()){var a=this._getCurrentRow();if(null!=a){var r,_,d,u,h=a.rowKey,c=this._getRowIdxForRowKey(h);try{if(t&&!this._hasEditableRow())r=this._getTableDomUtils().getTableBodyRow(c),_=e.TableRendererUtils.getRendererContextObject(this,r,{row:{key:h,index:a.rowIndex},isCurrentRow:!0}),(d=this._trigger("beforeRowEdit",s,{rowContext:_}))&&(u={rowKey:h,rowIndex:c});else{if(t||!this._hasEditableRow())return;r=this._getTableDomUtils().getTableBodyRow(this._getEditableRowIdx()),h=this._getRowKeyForRowIdx(this._getEditableRowIdx()),_=e.TableRendererUtils.getRendererContextObject(this,r,{row:{key:h,index:this._getDataSourceRowIndexForRowKey(h)},isCurrentRow:!0}),(d=this._trigger("beforeRowEditEnd",s,{rowContext:_,cancelEdit:l}))&&(u={rowKey:null,rowIndex:-1})}}catch(e){return!1}if(!d)return!1;u&&this._fireEditRowChangeEvent(u,s);var T=this._getEditableRowIdx(),S=this;t?(this._setEditableRowIdx(c),this._refreshRow(c,!0).then(function(){S._queueTask(function(){S._setRowFocus(c,!0,!1),S._setCellInRowFocus(c,o,i)})})):(this._focusEditCell=null,this._setEditableRowIdx(null),n||this._getTableDomUtils().getTable().focus()),null!=T&&null!=this._getTableDomUtils().getTableBodyRow(T)&&this._refreshRow(T,!1)}}},_showNoDataMessage:function(){if(!this._noDataMessageShown){var e=this._getTableDomUtils().getTableBodyMessageRow(),t=this._getData(),l=null;l=null!=this.options.emptyText?this.options.emptyText:this.getTranslatedString(this._BUNDLE_KEY._MSG_NO_DATA);var o=null!=t?l:this.getTranslatedString(this._BUNDLE_KEY._MSG_INITIALIZING);null==e?this._getTableDomUtils().createTableBodyMessageRow(this._getColumnDefs().length,o):this._getTableDomUtils().setTableBodyMessage(o),this._noDataMessageShown=!0}},_showStatusMessage:function(){if(!this._showStatusTimeout&&!this._statusMessageShown){var t=this._getTableDomUtils().getTableStatusMessage(),l=this;this._showStatusTimeout=setTimeout(function(){t.style[e.TableDomUtils.CSS_PROP._DISPLAY]=e.TableDomUtils.CSS_VAL._INLINE,l._statusMessageShown=!0,l._getTableDomUtils().refreshTableStatusPosition()},this._getShowStatusDelay())}},_getShowStatusDelay:function(){null==this._defaultOptions&&(this._defaultOptions=s.parseJSONFromFontFamily("oj-table-option-defaults"));var e=parseInt(this._defaultOptions.showIndicatorDelay,10);return isNaN(e)?0:e},_showTableHeaderColumnSortIcon:function(l){if(this._getColumnDefs()[l].sortable===this._OPTION_ENABLED){var o=this._getTableDomUtils(),i=o.getTableHeaderColumn(l);if(!i)return;if(null==t(i).data("sorted")){var s=o.getTableElementsByClassName(i,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS),n=o.getSortIconContainer(i);null!=n&&s.length>0&&(s=s[0],n.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._ENABLED),s.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._DISABLED),s.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._DEFAULT))}}},_touchEventDoubleTapFunction:function(e,l){var o=t(e.target);null!=this._lastTapTime&&(new Date).getTime()-this._lastTapTime<250&&this._lastTapTarget[0]===o[0]?(this._lastTapTime=null,this._lastTapTarget=null,l()):(this._lastTapTarget=o,this._lastTapTime=(new Date).getTime())},_unregisterChildStateListeners:function(e){var t,l=this,o=e.querySelectorAll("*");for(t=0;t<o.length;t++)l._UnregisterChildNode(o[t]);l=null},_unregisterDataSourceEventListeners:function(){var e=this._getData();if(null!=this._dataProviderEventHandlers&&null!=e)for(var t=this._dataProviderEventHandlers.length,l=0;l<t;l++)e.removeEventListener(this._dataProviderEventHandlers[l].eventType,this._dataProviderEventHandlers[l].eventHandler)},_unregisterResizeListener:function(){var t=this._getTableDomUtils().getTableContainer();e.DomUtils.removeResizeListener(t,this._resizeListener),this._isResizeListenerAdded=!1},_updateHeaderColumnStateCellsClass:function(t){var l=this._getHeaderColumnSelection(t),o=this._getSelectedRowIdxs(),i=this._getTableDomUtils().getTableBodyRows();if(null!=i&&i.length>0)for(var s=i.length,n=0;n<s;n++){var a=this._getTableDomUtils().getTableBodyCell(n,t);if(a)if(l)a.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED);else{for(var r=!1,_=o.length,d=0;d<_;d++)if(n===o[d]){r=!0;break}r||a.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)}}},_updateRowStateCellsClass:function(l,o,i){var s,n=this._getTableDomUtils().getTableBodyCells(l),a=o.focused,r=o.selected,_=o.hover;if(n){var d=n.length;if(null!=_)for(s=0;s<d;s++)_?n[s].classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._HOVER):n[s].classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._HOVER);if(null!=a)for(s=0;s<d;s++)a?this._focusInHandler(t(n[s])):this._focusOutHandler(t(n[s]));if(null!=r)for(s=0;s<d;s++)r?n[s].classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED):n[s].classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._SELECTED)}},_finalizeRowRendering:function(t){return this._waitForAllElementsToResolve(t).then(function(){var l=this._hasEditableRow()?this._getEditableRowKey():null;return t.forEach(function(t){var o=this._getRowKey(t);null!=l&&e.KeyUtils.equals(o,l)||a.disableAllFocusableElements(t)}.bind(this)),Promise.resolve(!0)}.bind(this))},_waitForAllElementsToResolve:function(e){if(e.length>0&&this._hasRowOrCellRendererOrTemplate()){var t=[];return e.forEach(function(e){e&&t.push(l.getContext(e).getBusyContext().whenReady())}),Promise.all(t)}return Promise.resolve()},_setFinalTask:function(e){this._finalTask=e?e.bind(this):void 0},_hasPendingTasks:function(){return this._taskCount>1},_queueTask:function(e){var t=this;return this._pendingTasks||(this._taskCount=0,this._pendingTasks=Promise.resolve(),this._setComponentNotReady()),this._taskCount+=1,this._pendingTasks=this._pendingTasks.then(function(){if(!t._componentDestroyed)return e.bind(t)()}).then(function(e){if(t._taskCount-=1,0===t._taskCount){t._pendingTasks=void 0;try{t._componentDestroyed||(t._finalTask&&t._finalTask(),t._trigger("ready"))}catch(e){d.error(e)}t._setComponentReady(),t=null}return e},function(e){return t._taskCount-=1,0===t._taskCount&&(t._pendingTasks=void 0,d.error(e),t._setComponentReady(),t=null),Promise.reject(e)}),this._pendingTasks},_CompareOptionValues:function(t,l,o){switch(t){case"columns":case"currentRow":return e.Object.compareValues(l,o);case"selection":return l&&void 0===l.inverted&&(l.inverted=!1),o&&void 0===o.inverted&&(o.inverted=!1),(!l||!o||l.inverted===o.inverted)&&e.Object.compareValues(l,o);case"selected":return a.areKeySetsEqual(l.row,o.row)&&a.areKeySetsEqual(l.column,o.column);default:return this._super(t,l,o)}},_registerTouchEvents:function(){var l={"touchstart .oj-table-body-row-touch-selection-affordance-touch-area":function(l){1===l.originalEvent.touches.length&&this._getRowSelectionMode()===this._OPTION_SELECTION_MODES._MULTIPLE&&(l.target.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_CLASS)||l.target.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_ICON_CLASS)?(l.preventDefault(),this._mouseDownRowIdx=t(this._getTableDomUtils().getTableBodyRowTouchSelectionAffordanceBottom()).data("rowIdx")):(l.target.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_CLASS)||l.target.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_ICON_CLASS))&&(l.preventDefault(),this._mouseDownRowIdx=t(this._getTableDomUtils().getTableBodyRowTouchSelectionAffordanceTop()).data("rowIdx")))},"touchstart .oj-table-column-header-cell":function(e){1===e.originalEvent.touches.length&&this._isTableColumnsResizable()&&this._getTableResizeUtils().handleHeaderColumnResizeStart(e)&&e.preventDefault()},"touchmove .oj-table-header":function(e){this._isTableColumnsResizable()&&this._getTableResizeUtils().setResizeCursor(e)},"touchmove .oj-table-body-row-touch-selection-affordance-touch-area":function(e){if(null!=this._mouseDownRowIdx){e.preventDefault();var t=this._getEventTargetElement(e);this._handleMouseEnterSelection(t,!0)}}},o=this._getTableDomUtils().getTableContainer();if(this._on(t(o),{touchend:function(e){if(null!=this._mouseDownRowIdx){var t=this._getEventTargetElement(e);this._handleMouseEnterSelection(t,!0)}this._mouseDownRowIdx=null,this._getTableResizeUtils().handleHeaderColumnResizeEnd(e)&&e.preventDefault()},"touchend .oj-table-body":function(e){var t,l=this;this._touchEventDoubleTapFunction(e,(t=e,function(){var e=l._getEventTargetElement(t),o=l._getTableDomUtils().getElementColumnIdx(e);l._setTableEditable(!0,!1,o,!0,t),t.preventDefault()}))},touchcancel:function(){this._mouseDownRowIdx=null,this._getTableResizeUtils().clearTableHeaderColumnsResize()}}),this._IsCustomElement()){var i=function(e,l){return function(o){var i=o.currentTarget,s=o.target.closest(e);s&&i.contains(s)&&l(t.Event(o,{currentTarget:s}))}},s=".oj-table-body-row-touch-selection-affordance-touch-area";this._delegatedTouchStartTableBodyListener=i(s,l["".concat("touchstart"," ").concat(s)].bind(this)),this._delegatedTouchStartCellHeaderListener=i(".oj-table-column-header-cell",l["".concat("touchstart"," ").concat(".oj-table-column-header-cell")].bind(this)),this._delegatedTouchMoveTableHeaderListener=i(".oj-table-header",l["".concat("touchmove"," ").concat(".oj-table-header")].bind(this)),this._delegatedTouchMoveTableBodyListener=i(s,l["".concat("touchmove"," ").concat(s)].bind(this)),o.addEventListener("touchstart",this._delegatedTouchStartTableBodyListener,{passive:!1}),o.addEventListener("touchstart",this._delegatedTouchStartCellHeaderListener,{passive:!1}),o.addEventListener("touchmove",this._delegatedTouchMoveTableHeaderListener,{passive:!0}),o.addEventListener("touchmove",this._delegatedTouchMoveTableBodyListener,{passive:!1})}else this._on(t(o),l)}}),n.setDefaultOptions({ojTable:{display:n.createDynamicPropertyGetter(function(){return(s.parseJSONFromFontFamily("oj-table-option-defaults")||{}).display})}}),
/**
 * @preserve Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
e.TableAnimationUtils=function(e){this.component=e,this.options=e.options,this.Init()},e.Object.createSubclass(e.TableAnimationUtils,e.Object,"oj.TableAnimationUtils"),e.TableAnimationUtils.prototype.Init=function(){e.TableAnimationUtils.superclass.Init.call(this)},e.TableAnimationUtils.prototype.animateTableBodyRow=function(e,t){if(this._isAnimationDisabled(t))return Promise.resolve(!1);var l=this;return new Promise(function(o){l._startAnimation(e,t).then(function(){o(!0)})})},e.TableAnimationUtils.prototype.animateTableBodyRows=function(e,t){if(this._isAnimationDisabled(t))return Promise.resolve(!1);for(var l,o=this,i=[],s=0;s<e.length;s++){var n=e[s];i.push((l=n,o.animateTableBodyRow(l,t)))}return i.length>0?Promise.all(i):Promise.resolve(!1)},e.TableAnimationUtils.prototype._getAnimationEffect=function(e){var t;return null==this.defaultAnimations&&(t=s.parseJSONFromFontFamily("oj-table-option-defaults"),this.defaultAnimations=t.animation||{}),this.defaultAnimations[e]},e.TableAnimationUtils.prototype._isAnimationDisabled=function(e){var t=this._getAnimationEffect(e);return null==t||0===t.length},e.TableAnimationUtils.prototype._startAnimation=function(e,t,l){return null==l&&(l=this._getAnimationEffect(t)),r.startAnimation(e,t,l,this.component)},
/**
 * @preserve Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
e.TableDndContext=function(e){this.component=e,this.options=e.options,this.Init()},e.Object.createSubclass(e.TableDndContext,e.Object,"oj.TableDndContext"),e.TableDndContext.prototype.Init=function(){e.TableDndContext.superclass.Init.call(this)},e.TableDndContext.prototype._addDragMarkerClass=function(t){this._getTableDomUtils().getTableHeaderColumn(t).classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._DRAG),this._getTableDomUtils().setTableColumnCellsClass(t,!0,e.TableDomUtils.MARKER_STYLE_CLASSES._DRAG)},e.TableDndContext.prototype._removeDragMarkerClass=function(){var t=this._getTableDomUtils(),l=t.getTableElementsByClassName(t.getTableHeader(),e.TableDomUtils.MARKER_STYLE_CLASSES._DRAG);if(null!=l&&l.length>0)for(var o=l.length,i=0;i<o;i++)l[i].classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._DRAG);t.setTableColumnCellsClass(null,!1,e.TableDomUtils.MARKER_STYLE_CLASSES._DRAG)},e.TableDndContext.prototype._cloneTableContainer=function(l){var o,i=this._getTableDomUtils(),s=i.getTableElementsByTagName(l,e.TableDomUtils.DOM_ELEMENT._TBODY)[0],n=t(s).scrollLeft();o=l.cloneNode(!0);var a=i.getTableElementsByTagName(o,e.TableDomUtils.DOM_ELEMENT._TBODY,!0)[0];return o.style[e.TableDomUtils.CSS_PROP._BACKGROUND_COLOR]=e.TableDomUtils.CSS_VAL._TRANSPARENT,o.style[e.TableDomUtils.CSS_PROP._BORDER_COLOR]=e.TableDomUtils.CSS_VAL._TRANSPARENT,o.style[e.TableDomUtils.CSS_PROP._POSITION]=e.TableDomUtils.CSS_VAL._ABSOLUTE,o.style[e.TableDomUtils.CSS_PROP._HEIGHT]=s.scrollHeight+e.TableDomUtils.CSS_VAL._PX,o.style[e.TableDomUtils.CSS_PROP._TOP]=-1e4+e.TableDomUtils.CSS_VAL._PX,a.style[e.TableDomUtils.CSS_PROP._OVERFLOW]=e.TableDomUtils.CSS_VAL._HIDDEN,a.style[e.TableDomUtils.CSS_PROP._OVERFLOW_X]=e.TableDomUtils.CSS_VAL._HIDDEN,a.style[e.TableDomUtils.CSS_PROP._OVERFLOW_Y]=e.TableDomUtils.CSS_VAL._HIDDEN,a.style[e.TableDomUtils.CSS_PROP._BACKGROUND_COLOR]=e.TableDomUtils.CSS_VAL._TRANSPARENT,a.style[e.TableDomUtils.CSS_PROP._BORDER_COLOR]=e.TableDomUtils.CSS_VAL._TRANSPARENT,a.style[e.TableDomUtils.CSS_PROP._WIDTH]=t(s).width()+e.TableDomUtils.CSS_VAL._PX,a.style[e.TableDomUtils.CSS_PROP._HEIGHT]=s.scrollHeight+e.TableDomUtils.CSS_VAL._PX,document.body.appendChild(o),t(a).scrollLeft(1*n),o},e.TableDndContext.prototype._destroyDragImage=function(){this._dragImage&&(t(this._dragImage).remove(),this._dragImage=null)},e.TableDndContext.prototype._getEventColumnIndex=function(e){return this._getTableDomUtils().getElementColumnIdx(e.currentTarget)},e.TableDndContext.prototype._getOverRowIndex=function(l){var o,i=this._getTableDomUtils(),s=i.getFirstAncestor(l.target,e.TableDomUtils.DOM_ELEMENT._TR,!0),n=i.getFirstAncestor(l.target,"."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);if(null!=n){var a=i.getFirstAncestor(n,"."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS,!0);null!=a&&(o=t(a).index())}else if(t(s).hasClass(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_BEFORE_CLASS))o=this._dropRowIndex;else{var r=i.getTableBodyRows();o=r?r.length:0}return o},e.TableDndContext.prototype._getTableDomUtils=function(){return this.component._getTableDomUtils()},e.TableDndContext.prototype.handleColumnDragStart=function(e){if(this._isColumnReorderEnabled()){var t=this._getEventColumnIndex(e);return this._dragStartColumnIdx=t,this._setReorderColumnsDataTransfer(e,t),this.component._clearSelectionState(),setTimeout(function(){window.getSelection().removeAllRanges()},0),this._addDragMarkerClass(t),!0}},e.TableDndContext.prototype.handleColumnDragEnd=function(e){this._isColumnReorderEnabled()&&(this.setTableHeaderColumnDraggable(null,!1),this._dragStartColumnIdx=null,this._getTableDomUtils().removeDragOverIndicatorColumn(),this._getTableDomUtils().removeTableHeaderColumnDragImage(),this._removeDragMarkerClass())},e.TableDndContext.prototype.handleColumnDragEnter=function(e){if(!this._isColumnReordering()){var t=this._getEventColumnIndex(e);return this._invokeDropCallback("columns","dragEnter",e,{columnIndex:t})}},e.TableDndContext.prototype.handleColumnReorderDragOver=function(e){var t=this._getEventColumnIndex(e),l=this._dragStartColumnIdx;null!=l&&l!==t&&(this._currentDropColumnBefore=this._isDragOverBeforeColumn(e),this._currentDropColumnBefore&&l===t-1||!this._currentDropColumnBefore&&l===t+1||this._getTableDomUtils().displayDragOverIndicatorColumn(t,this._currentDropColumnBefore),e.preventDefault())},e.TableDndContext.prototype.handleColumnDragOver=function(e){if(this._isColumnReordering())return this.handleColumnReorderDragOver(e);var t=this._getEventColumnIndex(e);this._currentDropColumnBefore=this._isDragOverBeforeColumn(e);var l=this._invokeDropCallback("columns","dragOver",e,{columnIndex:t});return(!1===l||e.isDefaultPrevented())&&this._getTableDomUtils().displayDragOverIndicatorColumn(t,this._isDragOverBeforeColumn(e)),l},e.TableDndContext.prototype.handleColumnDragLeave=function(e){if(!this._isColumnReordering()){this._getTableDomUtils().removeDragOverIndicatorColumn();var t=this._getEventColumnIndex(e);return this._invokeDndCallback("drop","columns","dragLeave",e,{columnIndex:t})}},e.TableDndContext.prototype.handleColumnReorderDrop=function(e){var t=this._getTableDomUtils();t.removeDragOverIndicatorColumn();var l=this._getEventColumnIndex(e);this._currentDropColumnBefore||(l+=1),this.component._columnsDestMap=t.moveTableHeaderColumn(this._dragStartColumnIdx,l,e),e.preventDefault()},e.TableDndContext.prototype.handleColumnDrop=function(e){if(this._isColumnReordering())return this.handleColumnReorderDrop(e);this._getTableDomUtils().removeDragOverIndicatorColumn();var t=this._getEventColumnIndex(e);return this._currentDropColumnBefore||(t+=1),this._invokeDropCallback("columns","drop",e,{columnIndex:t})},e.TableDndContext.prototype.handleRowDragStart=function(e){var t=this.options.dnd.drag;if(t&&t.rows){var l=this._setDragRowsDataTransfer(e,t.rows.dataTypes,this.component._getSelectedRowIdxs());return!!l&&this._invokeDndCallback("drag","rows","dragStart",e,l)}},e.TableDndContext.prototype.handleRowDrag=function(e){return this._invokeDndCallback("drag","rows","drag",e)},e.TableDndContext.prototype.handleRowDragEnd=function(e){return this._destroyDragImage(),this._invokeDndCallback("drag","rows","dragEnd",e)},e.TableDndContext.prototype.handleRowDragEnter=function(e){var t=this._getOverRowIndex(e),l=this._invokeDropCallback("rows","dragEnter",e,{rowIndex:t});return(!1===l||e.isDefaultPrevented())&&this._updateDragRowsState(e,t),l},e.TableDndContext.prototype.handleRowDragOver=function(e){return this._invokeDropCallback("rows","dragOver",e,{rowIndex:this._dropRowIndex})},e.TableDndContext.prototype.handleRowDragLeave=function(e){var t=this._invokeDndCallback("drop","rows","dragLeave",e,{rowIndex:this._dropRowIndex});return this._isDndEventInElement(e,e.currentTarget)||(this._getTableDomUtils().removeDragOverIndicatorRow(),this._dropRowIndex=null),t},e.TableDndContext.prototype.handleRowDrop=function(e){var t=this._dropRowIndex;return this._destroyDragImage(),this._getTableDomUtils().removeDragOverIndicatorRow(),this._dropRowIndex=null,this._invokeDropCallback("rows","drop",e,{rowIndex:t})},e.TableDndContext.prototype._hideUnselectedRows=function(t,l){var o,i,s=null,n=this._getTableDomUtils(),a=n.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS,!0);for(o=a.length-1;o>=0;o--)if(-1===l.indexOf(o)){var r=a[o];r.style[e.TableDomUtils.CSS_PROP._VISIBILITY]=e.TableDomUtils.CSS_VAL._HIDDEN,r.style[e.TableDomUtils.CSS_PROP._BORDER_COLOR]=e.TableDomUtils.CSS_VAL._TRANSPARENT;var _=r.childNodes;for(i=0;i<_.length;i++)_[i].style[e.TableDomUtils.CSS_PROP._BORDER_COLOR]=e.TableDomUtils.CSS_VAL._TRANSPARENT}else s=o;var d=n.getTableElementsByTagName(t,e.TableDomUtils.DOM_ELEMENT._THEAD,!0);if(null!=d&&d.length>0){d[0].style[e.TableDomUtils.CSS_PROP._VISIBILITY]=e.TableDomUtils.CSS_VAL._HIDDEN,d[0].style[e.TableDomUtils.CSS_PROP._BORDER_COLOR]=e.TableDomUtils.CSS_VAL._TRANSPARENT;var u=d[0].childNodes[0];if(null!=u){var h=u.childNodes;for(o=0;o<h.length;o++)h[o].style[e.TableDomUtils.CSS_PROP._BORDER_COLOR]=e.TableDomUtils.CSS_VAL._TRANSPARENT}}var c=n.getTableElementsByTagName(t,e.TableDomUtils.DOM_ELEMENT._TFOOT,!0);return null!=c&&c.length>0&&(c[0].style[e.TableDomUtils.CSS_PROP._VISIBILITY]=e.TableDomUtils.CSS_VAL._HIDDEN),s},e.TableDndContext.prototype._invokeDndCallback=function(e,t,l,o,i){var s,n=this.options.dnd[e];if(n&&n[t]){var a=n[t][l];if(a&&"function"==typeof a)try{this.component._IsCustomElement()?a(o.originalEvent,i):(o.dataTransfer=o.originalEvent.dataTransfer,s=a(o,i))}catch(e){d.error("Error: "+e)}}return s},e.TableDndContext.prototype._invokeDropCallback=function(e,t,l,o){var i=this._invokeDndCallback("drop",e,t,l,o);return void 0===i&&this._matchDragDataType(l,e)&&l.preventDefault(),i},e.TableDndContext.prototype._isColumnReorderEnabled=function(){var e=this.options.dnd;return!(!e||!e.reorder||e.reorder.columns!==this.component._OPTION_ENABLED)},e.TableDndContext.prototype._isColumnReordering=function(){return null!=this._dragStartColumnIdx},e.TableDndContext.prototype._isDndEventInElement=function(e,t){var l=t.getBoundingClientRect(),o=e.originalEvent;return o.clientX>=Math.ceil(l.left)&&o.clientX<Math.floor(l.right)&&o.clientY>=Math.ceil(l.top)&&o.clientY<Math.floor(l.bottom)},e.TableDndContext.prototype._isDragOverBeforeColumn=function(t){var l=t.currentTarget.getBoundingClientRect();if(null!=t.originalEvent.clientX){var o=l.right-t.originalEvent.clientX<(l.right-l.left)/2;return"rtl"===e.DomUtils.getReadingDirection()?o:!o}return!1},e.TableDndContext.prototype._matchDragDataType=function(e,t){var l=e.originalEvent.dataTransfer.types,o=this.options.dnd.drop;if(o&&o[t]&&o[t].dataTypes)for(var i=o[t].dataTypes,s="string"==typeof i?[i]:i,n=0;n<l.length;n++)if(s.indexOf(l[n])>=0)return!0;return!1},e.TableDndContext.prototype._setHeaderColumnDraggable=function(t,l){t.draggable=l,l&&(t.style[e.TableDomUtils.CSS_PROP._CURSOR]=e.TableDomUtils.CSS_VAL._MOVE,t.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._DRAGGABLE))},e.TableDndContext.prototype._clearHeaderColumnDraggable=function(t){t.draggable="",t.style[e.TableDomUtils.CSS_PROP._CURSOR]=e.TableDomUtils.CSS_VAL._AUTO,t.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._DRAGGABLE)},e.TableDndContext.prototype._setDragRowsData=function(e,t,l){if(t){var o=e.dataTransfer,i=JSON.stringify(l);if("string"==typeof t)o.setData(t,i);else for(var s=0;s<t.length;s++)o.setData(t[s],i)}},e.TableDndContext.prototype._setDragRowsDataTransfer=function(l,o,i){for(var s=[],n=0;n<i.length;n++){var a=this.component.getDataForVisibleRow(i[n]);a&&s.push(a)}return s.length?(this._setDragRowsData(l.originalEvent,o,s),this._destroyDragImage(),this._dragImage=this._setDragRowsImage(l.originalEvent,t(this._getTableDomUtils().getFirstAncestor(l.currentTarget,e.TableDomUtils.DOM_ELEMENT._TABLE,!0)).parent()[0],i),{rows:s}):null},e.TableDndContext.prototype._setDragRowsImage=function(l,o,i){var s=this._cloneTableContainer(o);this._hideUnselectedRows(s,i);var n=o.getBoundingClientRect(),a=this._getTableDomUtils().getTableElementsByTagName(o,e.TableDomUtils.DOM_ELEMENT._TBODY)[0],r=t(a).scrollLeft(),_=t(a).scrollTop(),d=l.clientX-n.left+r,u=l.clientY-n.top+_;return l.dataTransfer.setDragImage(s,d,u),s},e.TableDndContext.prototype._setReorderColumnsDataTransfer=function(e,t){var l=e.originalEvent.dataTransfer,o=this._getTableDomUtils().hashCode(this._getTableDomUtils().getTableUID());l.setData("Text",this.component._DND_REORDER_TABLE_ID_DATA_KEY+":"+o+":"+t);var i=this._getTableDomUtils().createTableHeaderColumnDragImage(t);try{l.setDragImage(i,0,0)}catch(e){}},e.TableDndContext.prototype.setTableHeaderColumnDraggable=function(e,t){if(this._isColumnReorderEnabled()){var l,o=this._getTableDomUtils().getTableHeaderColumns();if(null!=o&&o.length>0)for(l=0;l<o.length;l++){var i=o[l];null!=e&&l===e?this._setHeaderColumnDraggable(i,t):this._clearHeaderColumnDraggable(i)}}},e.TableDndContext.prototype._updateDragRowsState=function(t,l){if(this._dropRowIndex!==l){var o=this._getTableDomUtils(),i=o.getFirstAncestor(t.target,e.TableDomUtils.DOM_ELEMENT._TR,!0);this._dropRowIndex=l,o.displayDragOverIndicatorRow(this._dropRowIndex,!0,i)}},
/**
 * @preserve Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
e.TableDomUtils=function(e){this.component=e,this.options=e.options,this.element=e.element[0],this.OuterWrapper=e.OuterWrapper,this.Init(),this._cacheDomDimensions={}},e.Object.createSubclass(e.TableDomUtils,e.Object,"oj.TableDomUtils"),e.TableDomUtils.prototype.Init=function(){e.TableDomUtils.superclass.Init.call(this)},e.TableDomUtils.prototype.clearCachedDom=function(){this.clearCachedDomRowData(),this._clearCachedDom(null)},e.TableDomUtils.prototype.clearCachedDomRowData=function(){this._cachedDomTableBodyRows=null},e.TableDomUtils.prototype.createContextMenu=function(l){var o=this.component._GetContextMenu(),i=!!this.component._isTouchDevice()&&this.component._getRowSelectionMode()===this.component._OPTION_SELECTION_MODES._MULTIPLE;if(o){var s=o.querySelectorAll("[data-oj-command]");if(s.length>0){var n,a,r;for(a=0;a<s.length;a++)"OJ-OPTION"!==s[a].tagName&&0!==s[a].getElementsByTagName(e.TableDomUtils.DOM_ELEMENT._A).length||(n=s[a].getAttribute("data-oj-command").split("-"),r=this.createContextMenuItem(n[n.length-1],this.component._IsCustomElement()),"OJ-OPTION"===s[a].tagName?s[a].innerHTML=r.innerHTML:t(s[a]).replaceWith(r));this._menuContainer=o,t(o).data("oj-ojMenu")&&(this.component._IsCustomElement()?o.refresh():t(o).ojMenu("refresh")),this.component._IsCustomElement()?o.addEventListener("ojAction",l):t(o).on("ojselect",l)}}else if(this.component._isTableSortable()||i||this.component._isTableColumnsResizable()){if((o=document.createElement(e.TableDomUtils.DOM_ELEMENT._UL)).style[e.TableDomUtils.CSS_PROP._DISPLAY]=e.TableDomUtils.CSS_VAL._NONE,o.setAttribute(e.TableDomUtils.DOM_ATTR._ID,this.getTableId()+"_contextmenu"),this.getTableContainer().appendChild(o),this.component._isTableSortable()){var _=this.createContextMenuItem("sort");o.appendChild(_)}if(i){var d=this.createContextMenuItem("enableNonContiguousSelection");o.appendChild(d)}if(this.component._isTableColumnsResizable()){var u=this.createContextMenuItem("resize");o.appendChild(u)}t(o).ojMenu(),this._menuContainer=o,t(o).on("ojselect",l),this.component.option("contextMenu","#"+o.getAttribute(e.TableDomUtils.DOM_ATTR._ID),{_context:{internalSet:!0}}),this.component._defaultContextMenu=o}return o},e.TableDomUtils.prototype.createContextMenuItem=function(t,l){if("sort"===t){var o=this.createContextMenuListItem(t,l),i=document.createElement(e.TableDomUtils.DOM_ELEMENT._UL);return o.appendChild(i),i.appendChild(this.createContextMenuListItem("sortAsc",l)),i.appendChild(this.createContextMenuListItem("sortDsc",l)),o}return"sortAsc"===t?this.createContextMenuListItem(t,l):"sortDsc"===t?this.createContextMenuListItem(t,l):"enableNonContiguousSelection"===t?this.createContextMenuListItem(t,l):"disableNonContiguousSelection"===t?this.createContextMenuListItem(t,l):"resize"===t?(this.createContextMenuResizePopup(0),this.createContextMenuListItem(t,l)):null},e.TableDomUtils.prototype.createContextMenuListItem=function(e,t){var l=document.createElement(t?"oj-option":"li");return l.setAttribute("data-oj-command","oj-table-"+e),l.appendChild(this.createContextMenuLabel(e,t)),l},e.TableDomUtils.prototype.createContextMenuLabel=function(t,l){var o=null;"sort"===t?o=this.component.getTranslatedString("labelSort"):"sortAsc"===t?o=this.component.getTranslatedString("labelSortAsc"):"sortDsc"===t?o=this.component.getTranslatedString("labelSortDsc"):"enableNonContiguousSelection"===t?o=this.component.getTranslatedString("labelEnableNonContiguousSelection"):"disableNonContiguousSelection"===t?o=this.component.getTranslatedString("labelDisableNonContiguousSelection"):"resize"===t&&(o=this.component.getTranslatedString("labelResize"));var i=document.createTextNode(o);if(l)return i;var s=document.createElement(e.TableDomUtils.DOM_ELEMENT._A);return s.setAttribute(e.TableDomUtils.DOM_ATTR._HREF,"#"),s.appendChild(i),s},e.TableDomUtils.prototype.createContextMenuResizePopup=function(l){l=Math.round(l);var o,i=this.getContextMenuResizePopup();if(null==i){var s=this.getTableContainer();(i=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV)).setAttribute("id",this.getTableId()+"_resize_popup"),i.setAttribute("data-oj-context",""),s.appendChild(i);var n=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV),a=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);a.classList.add(e.TableDomUtils.CSS_CLASSES._TEXT_ALIGN_END),i.appendChild(n),i.appendChild(a),(o=document.createElement(e.TableDomUtils.DOM_ELEMENT._INPUT)).setAttribute("id",this.getTableId()+"_resize_popup_spinner");var r=document.createElement(e.TableDomUtils.DOM_ELEMENT._LABEL);r.setAttribute("for",this.getTableId()+"_resize_popup_spinner"),r.textContent=this.component.getTranslatedString("labelResizePopupSpinner");var _=document.createElement(e.TableDomUtils.DOM_ELEMENT._BUTTON);_.setAttribute("id",this.getTableId()+"_resize_popup_popupcancel"),_.style.margin="5px";var d=document.createElement(e.TableDomUtils.DOM_ELEMENT._BUTTON);d.setAttribute("id",this.getTableId()+"_resize_popup_popupsubmit"),d.style.margin="5px",n.appendChild(r),n.appendChild(o),a.appendChild(d),a.appendChild(_),t(d).ojButton({component:"ojButton",label:this.component.getTranslatedString("labelResizePopupSubmit")}),t(_).ojButton({component:"ojButton",label:this.component.getTranslatedString("labelResizePopupCancel")});t(d).on("click",this.component._handleContextMenuResizePopup.bind(this.component)),t(_).on("click",function(){t(d).ojButton({disabled:!1}),t(o).ojInputNumber({value:0}),t(i).ojPopup("close")}),t(o).ojInputNumber({component:"ojInputNumber",max:1e4,min:10,step:1,value:l,displayOptions:{messages:["notewindow"]},validators:[new h({pattern:"^[1-9][0-9]*$",messageDetail:this.component.getTranslatedString("msgColumnResizeWidthValidation")})]}),t(i).ojPopup({modality:"modal",position:{my:"start top",at:"start bottom",collision:"flipfit"}}),t(o).on("change",function(){t(d).ojButton({disabled:!t(o).ojInputNumber("validate")})}),this._cacheDomElement(this.getTableId()+"_resize_popup",i)}else o=document.getElementById(this.getTableId()+"_resize_popup_spinner"),t(o).ojInputNumber("option","value",l);return i},e.TableDomUtils.prototype.createInitialTable=function(e,t){var l=this.getTable();return this.createTableContainer(),e||this.createTableHeader(),t||this.createTableFooter(),this.createTableBody(),this.createTableStatusMessage(),this.createTableStatusAccNotification(),l},e.TableDomUtils.prototype.createTableBody=function(){var t=this.getTable(),l=document.createElement(e.TableDomUtils.DOM_ELEMENT._TBODY);return t.appendChild(l),this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_BODY_CLASS,l),l},e.TableDomUtils.prototype.createTableBodyCell=function(t,l){return document.createElement(e.TableDomUtils.DOM_ELEMENT._TD)},e.TableDomUtils.prototype.createTableBodyCellAccSelect=function(t,l,o,i,s){var n=null;if(s||(n=this.getTableBodyCellAccSelect(i)),null!=n)return n;var a=null!=l?l.toString():t.toString(),r=null==o?this.hashCode(a):o;if((n=document.createElement(e.TableDomUtils.DOM_ELEMENT._TD)).classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_ACC_SELECT_CLASS),n.style.padding="0",n.style.border="0",n.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"cell"),!this.component._isTableHeaderless()){var _=this.options.accessibility,d=null;d=null!=_&&null!=_.rowHeader?_.rowHeader:this.component._getColumnDefs()[0].id;var u=this.getTableId()+":"+d+"_"+r;n.setAttribute(e.TableDomUtils.DOM_ATTR._HEADERS,this.getTableId()+":"+e.TableDomUtils._COLUMN_HEADER_ROW_SELECT_ID+" "+u)}var h=document.createElement(e.TableDomUtils.DOM_ELEMENT._INPUT);h.setAttribute(e.TableDomUtils.DOM_ATTR._ID,this.getTableId()+":acc_sel_row_"+r),h.setAttribute(e.TableDomUtils.DOM_ATTR._TYPE,"checkbox"),h.setAttribute(e.TableDomUtils.DOM_ATTR._TABINDEX,"-1");var c=null,T=this.options.editMode,S=this.component._isRowSelectionEnabled();return c=T===this.component._OPTION_EDIT_MODE._ROW_EDIT?S?this.component.getTranslatedString(this.component._BUNDLE_KEY._LABEL_SELECT_AND_EDIT_ROW):this.component.getTranslatedString(this.component._BUNDLE_KEY._LABEL_EDIT_ROW):this.component.getTranslatedString(this.component._BUNDLE_KEY._LABEL_SELECT_ROW),h.setAttribute(e.TableDomUtils.DOM_ATTR._TITLE,c),h.classList.add(e.TableDomUtils.CSS_CLASSES._CHECKBOX_ACC_SELECT_ROW_CLASS),h.classList.add(e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),this.component._getEditableRowIdx()===t?h.checked=!0:h.checked=!1,n.appendChild(h),i.insertBefore(n,i.firstChild),n},e.TableDomUtils.prototype.createTableBodyMessageCell=function(t,l,o){var i=document.createElement(e.TableDomUtils.DOM_ELEMENT._TD);return i.setAttribute(e.TableDomUtils.DOM_ATTR._COLSPAN,l+1),i.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_BODY_MESSAGE_CLASS),i.appendChild(document.createTextNode(o)),t.appendChild(i),i},e.TableDomUtils.prototype.createTableBodyMessageRow=function(t,l){var o=this.getTableBody(),i=document.createElement(e.TableDomUtils.DOM_ELEMENT._TR);return i.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_BODY_MESSAGE_ROW_CLASS),this.createTableBodyMessageCell(i,t,l),o.appendChild(i),i},e.TableDomUtils.prototype.createTableBodyRow=function(t,l){var o=document.createElement(e.TableDomUtils.DOM_ELEMENT._TR);return this.createTableBodyCellAccSelect(t,l,null,o,!0),o},e.TableDomUtils.prototype.getTouchAffordanceGlassPane=function(){var t=this.getTableContainer(),l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_TOUCH_AFFORDANCE_GLASS_PANE_CLASS);return l.length>0?l[0]:null},e.TableDomUtils.prototype.createTouchAffordanceGlassPane=function(){var t=this.getTouchAffordanceGlassPane();if(!t){var l=this.getTableContainer();(t=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV)).classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_TOUCH_AFFORDANCE_GLASS_PANE_CLASS),l.appendChild(t),this.refreshTouchAffordanceGlassPanePosition()}return t},e.TableDomUtils.prototype.createTableBodyRowTouchSelectionAffordance=function(t){var l=this.createTouchAffordanceGlassPane(),o=this.getTableBodyRowTouchSelectionAffordanceTop();if(!o){(o=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV)).classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_CLASS),o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOUCH_AREA_CLASS);var i=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);i.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_ICON_CLASS),i.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"button"),i.setAttribute(e.TableDomUtils.DOM_ATTR._ARIA_LABEL,this.component.getTranslatedString("labelAccSelectionAffordanceTop")),o.appendChild(i),l.appendChild(o)}var s=this.getTableBodyRowTouchSelectionAffordanceBottom();if(!s){(s=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV)).classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_CLASS),s.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOUCH_AREA_CLASS);var n=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);n.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_ICON_CLASS),n.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"button"),n.setAttribute(e.TableDomUtils.DOM_ATTR._ARIA_LABEL,this.component.getTranslatedString("labelAccSelectionAffordanceBottom")),s.appendChild(n),l.appendChild(s)}this.moveTableBodyRowTouchSelectionAffordanceTop(t),this.moveTableBodyRowTouchSelectionAffordanceBottom(t)},e.TableDomUtils.prototype.createTableBottomSlot=function(){var t=this.getTableContainer(),l=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);return l.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_BOTTOM_SLOT_CLASS),t.appendChild(l),this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_BOTTOM_SLOT_CLASS,l),l},e.TableDomUtils.prototype.createTableContainer=function(){var t;return this.OuterWrapper?t=this.OuterWrapper:(t=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV),this.element.parentNode.replaceChild(t,this.element),t.insertBefore(this.element,t.firstChild)),this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_CONTAINER_CLASS,t),t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_CLASS),t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_CONTAINER_CLASS),t.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._WIDGET),t},e.TableDomUtils.prototype.createTableFooter=function(){var t=this.getTable(),l=document.createElement(e.TableDomUtils.DOM_ELEMENT._TFOOT),o=document.createElement(e.TableDomUtils.DOM_ELEMENT._TR);this.createTableFooterAccSelect(o),l.appendChild(o);var i=this.getTableHeader();if(null!=i)i.parentNode.insertBefore(l,i.nextSibling);else{var s=this.getTableBody();null!=s?s.parentNode.insertBefore(l,s):t.appendChild(l)}return this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CLASS,l),l},e.TableDomUtils.prototype.createTableFooterAccSelect=function(t){var l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS);return l.length>0?l[0]:((l=document.createElement(e.TableDomUtils.DOM_ELEMENT._TD)).classList.add(e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),l.setAttribute(e.TableDomUtils.DOM_ATTR._TABINDEX,"-1"),l.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"cell"),t.insertBefore(l,t.firstChild),l)},e.TableDomUtils.prototype.createTableFooterCell=function(t){return document.createElement(e.TableDomUtils.DOM_ELEMENT._TD)},e.TableDomUtils.prototype.createTableHeader=function(){var t=this.getTable(),l=document.createElement(e.TableDomUtils.DOM_ELEMENT._THEAD),o=document.createElement(e.TableDomUtils.DOM_ELEMENT._TR);l.appendChild(o);var i=this.getTableFooter();if(null!=i)i.parentNode.insertBefore(l,i);else{var s=this.getTableBody();null!=s?s.parentNode.insertBefore(l,s):t.appendChild(l)}return this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_HEADER_ROW_CLASS,o),this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_HEADER_CLASS,l),l},e.TableDomUtils.prototype.createTableHeaderAccSelectRowColumn=function(){var t,l=document.createElement(e.TableDomUtils.DOM_ELEMENT._TH);l.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ACC_SELECT_ROW_CLASS),l.setAttribute(e.TableDomUtils.DOM_ATTR._ID,this.getTableId()+":"+e.TableDomUtils._COLUMN_HEADER_ROW_SELECT_ID),l.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"columnHeader");var o=this.options.editMode,i=this.component._isRowSelectionEnabled();t=o===this.component._OPTION_EDIT_MODE._ROW_EDIT?i?this.component.getTranslatedString(this.component._BUNDLE_KEY._LABEL_SELECT_AND_EDIT_ROW):this.component.getTranslatedString(this.component._BUNDLE_KEY._LABEL_EDIT_ROW):this.component.getTranslatedString(this.component._BUNDLE_KEY._LABEL_SELECT_ROW),l.setAttribute(e.TableDomUtils.DOM_ATTR._TITLE,t),l.style.padding="0",l.style.border="0";var s=document.createElement(e.TableDomUtils.DOM_ELEMENT._SPAN);return s.appendChild(document.createTextNode(t)),s.classList.add(e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),l.appendChild(s),l},e.TableDomUtils.prototype.createTableHeaderColumn=function(t){var l=this.component._getColumnDefs()[t],o=document.createElement(e.TableDomUtils.DOM_ELEMENT._TH);this.styleTableHeaderColumn(t,o,!0),o.setAttribute("abbr",l.headerText),o.setAttribute(e.TableDomUtils.DOM_ATTR._TITLE,l.headerText),this.insertTableHeaderColumn(t,o);var i={columnIndex:t,headerContext:{component:this.component,parentElement:o}};return l.resizable===e.TableDomUtils._OPTION_ENABLED&&o.setAttribute("data-oj-resizable",e.TableDomUtils._OPTION_ENABLED),l.sortable===e.TableDomUtils._OPTION_ENABLED?(o.setAttribute("data-oj-sortable",e.TableDomUtils._OPTION_ENABLED),e.TableRendererUtils.columnHeaderSortableIconRenderer(this.component,i,null,null)):e.TableRendererUtils.columnHeaderDefaultRenderer(this.component,i,null,null),o},e.TableDomUtils.prototype.createTableHeaderColumnDragImage=function(t){var l=this.getTableHeaderColumn(t).cloneNode(!0);return l.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._DRAG),l.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._FOCUS),l.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._FOCUS_HIGHLIGHT),l.classList.remove(e.TableDomUtils.MARKER_STYLE_CLASSES._HOVER),l.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_IMAGE),l.style[e.TableDomUtils.CSS_PROP._POSITION]=e.TableDomUtils.CSS_VAL._ABSOLUTE,l.style[e.TableDomUtils.CSS_PROP._TOP]="0",l.style[e.TableDomUtils.CSS_PROP._LEFT]="-999em",l.style[e.TableDomUtils.CSS_PROP._ZINDEX]="-999",document.body.appendChild(l),l},e.TableDomUtils.prototype.createTableHeaderColumnAccSelect=function(t,l){if(l!==e.TableDomUtils._OPTION_SELECTION_MODES._SINGLE&&l!==e.TableDomUtils._OPTION_SELECTION_MODES._MULTIPLE)return null;var o=this.getTableHeaderColumn(t),i=this.getTableHeaderColumnAccSelect(t);if(null!=i)return i;(i=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV)).classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ACC_SELECT_COLUMN_CLASS),i.classList.add(e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS);var s=document.createElement(e.TableDomUtils.DOM_ELEMENT._INPUT);s.setAttribute(e.TableDomUtils.DOM_ATTR._ID,this.getTableId()+":acc_sel_col"+t),s.setAttribute(e.TableDomUtils.DOM_ATTR._TYPE,"checkbox"),s.setAttribute(e.TableDomUtils.DOM_ATTR._TABINDEX,"-1");var n=this.component.getTranslatedString(this.component._BUNDLE_KEY._LABEL_SELECT_COLUMN);return s.setAttribute(e.TableDomUtils.DOM_ATTR._TITLE,n),s.classList.add(e.TableDomUtils.CSS_CLASSES._CHECKBOX_ACC_SELECT_COLUMN_CLASS),i.appendChild(s),o.insertBefore(i,o.firstChild),i},e.TableDomUtils.prototype.createTableHeaderColumnResizeIndicator=function(){var t=this.getTableHeaderColumnResizeIndicator();if(!t){var l=this.getTableContainer();t=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV),l.appendChild(t),t.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_RESIZE_INDICATOR_CLASS),this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_RESIZE_INDICATOR_CLASS,t)}return t},e.TableDomUtils.prototype.createTableStatusAccNotification=function(){var t=this.getTableContainer(),l=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);return l.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"status"),l.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_STATUS_ACC_NOTIFICATION_CLASS),l.classList.add(e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS),t.appendChild(l),this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_STATUS_ACC_NOTIFICATION_CLASS,l),l},e.TableDomUtils.prototype.createTableStatusMessage=function(){var t=this.getTableContainer(),l=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);l.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_STATUS_MESSAGE_CLASS),l.style[e.TableDomUtils.CSS_PROP._DISPLAY]=e.TableDomUtils.CSS_VAL._NONE;var o=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);return o.classList.add(e.TableDomUtils.CSS_CLASSES._ICON_CLASS),o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_LOADING_ICON_CLASS),o.setAttribute("aria-label",this.component.getTranslatedString(this.component._BUNDLE_KEY._MSG_FETCHING_DATA)),l.appendChild(o),t.appendChild(l),this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_STATUS_MESSAGE_CLASS,l),l},e.TableDomUtils.prototype.displayDragOverIndicatorColumn=function(t,l){this.removeDragOverIndicatorColumn();var o=this.getTableHeaderRow(),i=this.getTableHeaderColumn(t);if(null!=i)l?i.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS):i.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS);else{var s=this.component._getColumnDefs();null!=s&&0!==s.length||(l?o.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS):o.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS))}},e.TableDomUtils.prototype.displayDragOverIndicatorRow=function(l,o,i){this.removeDragOverIndicatorRow();var s=document.createElement(e.TableDomUtils.DOM_ELEMENT._TR);o?s.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_BEFORE_CLASS):s.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_AFTER_CLASS),i&&t(s).height(parseInt(t(i).height(),10));var n=document.createElement(e.TableDomUtils.DOM_ELEMENT._TD),a=this.component._getColumnDefs();n.setAttribute(e.TableDomUtils.DOM_ATTR._COLSPAN,a.length+1),s.appendChild(n);var r=this.getTableBodyRow(l);if(null!=r)o?r.parentNode.insertBefore(s,r):r.parentNode.insertBefore(s,r.nextSibling);else{var _=this.getTableBodyRows();null!=_&&0!==_.length||this.component._hideNoDataMessage(),this.getTableBody().appendChild(s)}},e.TableDomUtils.prototype.getContextMenu=function(){return this._menuContainer},e.TableDomUtils.prototype.getContextMenuResizePopup=function(){var e=this.getTableId()+"_resize_popup";if(!this._isCachedDomElement(e)){var t=document.getElementById(e);this._cacheDomElement(e,t)}return this._getCachedDomElement(e)},e.TableDomUtils.prototype.getElementColumnIdx=function(l){var o=this.getFirstAncestor(l,"."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS,!0);if(null!=o)return t(o.parentNode).children("."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS).index(o);var i=this.getFirstAncestor(l,"."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS,!0);if(null!=i)return t(i.parentNode).children("."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS).index(i);var s=this.getFirstAncestor(l,"."+e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS,!0);return null!=s?t(s.parentNode).children("."+e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS).index(s):null},e.TableDomUtils.prototype.getElementRowIdx=function(l){var o=this.getFirstAncestor(l,"."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS,!0);if(null!=o){var i=this.getTableBodyRows(),s=t(i).index(o);return s>-1?s:null}return null},e.TableDomUtils.prototype.getFirstAncestor=function(e,l,o){var i;if(null==e)return null;if(this._isIE()&&!Element.prototype.matches?e.msMatchesSelector(l):e.matches(l))return o&&!this.isTableOwned(e)?this.getFirstAncestor(e.parentNode,l,o):e;if(i=t(e).parents(l),o){for(var s=0;s<i.length;s++)if(this.isTableOwned(i[s]))return i[s];return null}return i.length>0?i[0]:null},e.TableDomUtils.prototype.getScrollBarHeight=function(){return this._tableWidthConstrained?this.getDefaultScrollBarSize():0},e.TableDomUtils.prototype.getScrollBarWidth=function(){return this._tableHeightConstrained&&!this._isVerticalScrollBarHidden()?this.getDefaultScrollBarSize():0},e.TableDomUtils.prototype.getDefaultScrollBarSize=function(){return null==this._defaultScrollBarSize&&(this._defaultScrollBarSize=a.getDefaultScrollBarWidth(this.getScroller())),this._defaultScrollBarSize},e.TableDomUtils.prototype._isVerticalScrollBarHidden=function(){return!this.component._isTouchDevice()&&this.getTableContainer().classList.contains(e.TableDomUtils.MARKER_STYLE_CLASSES._HIDE_VERTICAL_SCROLLBAR)},e.TableDomUtils.prototype.getScroller=function(){return this.getTableBody()},e.TableDomUtils.prototype.getScrollLeft=function(e){var t=e.scrollLeft;"rtl"===this.component._GetReadingDirection()&&(t=Math.abs(t),this._isWebkit()&&(t=e.scrollWidth-e.clientWidth-t));return t},e.TableDomUtils.prototype.getTable=function(){return this.element},e.TableDomUtils.prototype.getTableBody=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._TABLE_BODY_CLASS,!0)},e.TableDomUtils.prototype.getTableBodyCell=function(e,t,l){var o=this.getTableBodyCells(e,l);return o&&o.length>t?o[t]:null},e.TableDomUtils.prototype.getTableBodyCellAccSelect=function(t){if(null!=t){var l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_ACC_SELECT_CLASS);if(l.length>0)return l[0]}return null},e.TableDomUtils.prototype.getTableBodyLogicalCells=function(e,t){var l=this.getTableBodyCells(e,t);return l?this._getColspanLogicalElements(l):null},e.TableDomUtils.prototype.getTableBodyCells=function(t,l){if(l||(l=this.getTableBodyRow(t)),!l)return null;var o=this.getTableElementsByClassName(l,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS);return o.length>0?o:null},e.TableDomUtils.prototype.getTableBodyMessageCell=function(){var t=this.getTableBody();if(t){var l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_BODY_MESSAGE_CLASS);if(l.length>0)return l[0]}return null},e.TableDomUtils.prototype.getTableBodyMessageRow=function(){var t=this.getTableBody();if(t){var l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_BODY_MESSAGE_ROW_CLASS);if(l.length>0)return l[0]}return null},e.TableDomUtils.prototype.getTableBodyRow=function(e){var t=this.getTableBodyRows();return t?null==e?null:t.length>e?t[e]:null:null},e.TableDomUtils.prototype.getTableBodyRows=function(){if(!this._cachedDomTableBodyRows){var t=this.getTableBody();if(null!=t){var l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS);l.length>0&&(this._cachedDomTableBodyRows=l)}}return this._cachedDomTableBodyRows},e.TableDomUtils.prototype.getTableBodyRowTouchSelectionAffordanceTop=function(){var t=this.getTableContainer(),l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_CLASS);return l.length>0?l=l[0]:null},e.TableDomUtils.prototype.getTableBodyRowTouchSelectionAffordanceBottom=function(){var t=this.getTableContainer(),l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_CLASS);return l.length>0?l=l[0]:null},e.TableDomUtils.prototype.getTableBottomSlot=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._TABLE_BOTTOM_SLOT_CLASS,!0)},e.TableDomUtils.prototype.getTableContainer=function(){return this._isCachedDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_CONTAINER_CLASS)||this._cacheDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_CONTAINER_CLASS,this.element.parentNode),this._getCachedDomElement(e.TableDomUtils.CSS_CLASSES._TABLE_CONTAINER_CLASS)},e.TableDomUtils.prototype.getTableFooter=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CLASS,!0)},e.TableDomUtils.prototype.getTableFooterCell=function(e){var t=this.getTableFooterCells();return null!=t&&t.length>e?t[e]:null},e.TableDomUtils.prototype.getTableFooterCells=function(){var t=this.getTableFooterRow(),l=null!=t?this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS):null;return null!=l&&l.length>0?l:null},e.TableDomUtils.prototype.getTableFooterLogicalCells=function(){var e=this.getTableFooterCells();return e?this._getColspanLogicalElements(e):null},e.TableDomUtils.prototype.getTableFooterRow=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_ROW_CLASS)},e.TableDomUtils.prototype.getTableHeader=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._TABLE_HEADER_CLASS,!0)},e.TableDomUtils.prototype.getTableHeaderColumn=function(e){var t=this.getTableHeaderColumns();return t&&t.length>e&&e>=0?t[e]:null},e.TableDomUtils.prototype.getTableHeaderColumnAccSelect=function(t){var l=this.getTableHeaderColumn(t);if(null!=l){var o=this.getTableElementsByClassName(l,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ACC_SELECT_COLUMN_CLASS);if(o.length>0)return o[0]}return null},e.TableDomUtils.prototype.getTableHeaderColumnResizeIndicator=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_RESIZE_INDICATOR_CLASS,!0)},e.TableDomUtils.prototype.getTableHeaderColumns=function(){var t=this.getTableHeaderRow();if(null!=t){var l=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS);if(l.length>0)return l}return null},e.TableDomUtils.prototype.getTableHeaderLogicalColumns=function(){var e=this.getTableHeaderColumns();return e?this._getColspanLogicalElements(e):null},e.TableDomUtils.prototype.getTableHeaderRow=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._TABLE_HEADER_ROW_CLASS)},e.TableDomUtils.prototype.getTableId=function(){if(!this._tableId){var t=this.component._IsCustomElement()?this.getTableContainer():this.getTable();this._tableId=t.getAttribute(e.TableDomUtils.DOM_ATTR._ID)}return this._tableId},e.TableDomUtils.prototype.getTableStatusAccNotification=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._TABLE_STATUS_ACC_NOTIFICATION_CLASS,!0)},e.TableDomUtils.prototype.getTableStatusMessage=function(){return this._getTableElementByClassName(e.TableDomUtils.CSS_CLASSES._TABLE_STATUS_MESSAGE_CLASS,!0)},e.TableDomUtils.prototype.getTableUID=function(){if(!this._tableUID){var e=this.getTableId();null==e&&(e=(1e32*Math.random()).toString(36)),this._tableUID=e}return this._tableUID},e.TableDomUtils.prototype.hashCode=function(e){if(null==e)return 0;"string"!==t.type(e)&&(e=e.toString());var l=0;if(0===e.length)return l;for(var o=e.length,i=0;i<o;i++){l=(l<<5)-l+e.charCodeAt(i),l&=l}return l},e.TableDomUtils.prototype.insertTableBodyCell=function(t,l,o,i,s,n,a){if(this.setTableBodyCellAttributes(t,l,o,i,s),a)return n.appendChild(s),s;if(0===i){var r=this.getTableElementsByClassName(n,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_ACC_SELECT_CLASS);r.length>0?(r=r[0]).parentNode.insertBefore(s,r.nextSibling):n.insertBefore(s,n.firstChild)}else{var _=this.getTableElementsByClassName(n,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS);if(_.length>=i){var d=_[i-1];d.parentNode.insertBefore(s,d.nextSibling)}else n.appendChild(s)}return s},e.TableDomUtils.prototype.insertTableBodyRow=function(e,t,l,o){if(this.setTableBodyRowAttributes(l,t),null==o){var i=this.getTableBody(),s=this.getTableBodyRows(!0);if(0===e)i.insertBefore(t,i.firstChild);else if(s.length>=e){var n=s[e-1];n.parentNode.insertBefore(t,n.nextSibling)}else i.appendChild(t)}else o.appendChild(t);this.clearCachedDomRowData()},e.TableDomUtils.prototype.insertTableFooterCell=function(t,l){var o=this.getTableFooterRow(),i=this.getTableElementsByClassName(o,e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS);if(0===t){var s=this.getTableElementsByClassName(o,e.TableDomUtils.CSS_CLASSES._HIDDEN_CONTENT_ACC_CLASS);s.length>0?(s=s[0]).parentNode.insertBefore(l,s.nextSibling):o.insertBefore(l,o.firstChild)}else if(o.length>=t){var n=i[t-1];n.parentNode.insertBefore(l,n.nextSibling)}else o.appendChild(l);return l},e.TableDomUtils.prototype.insertTableHeaderColumn=function(l,o){var i=this.getTableHeaderRow(),s=this.getTableHeaderColumns();this.setTableHeaderColumnAttributes(l,o);var n=this.getTableHeaderColumn(l);if(n)t(n).replaceWith(t(o));else if(0===l){var a=this.getTableElementsByClassName(i,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ACC_SELECT_ROW_CLASS);a.length>0?(a=a[0]).parentNode.insertBefore(o,a.nextSibling):i.insertBefore(o,i.firstChild)}else if(s&&s.length>=l){var r=s[l-1];r.parentNode.insertBefore(o,r.nextSibling)}else i.appendChild(o)},e.TableDomUtils.prototype.getTableContainerScrollableState=function(){var e=this.getTableContainer(),t=this.getTable(),l=this.component._isStatusMessageShown();l&&this.component._hideStatusMessage();var o=[];return e.clientHeight>0?t.clientHeight>e.clientHeight?o[0]=1:e.clientHeight-t.clientHeight>1?o[0]=-1:o[0]=0:o[0]=0,e.clientWidth>0?t.clientWidth>e.clientWidth?o[1]=1:e.clientWidth-t.clientWidth>1?o[1]=-1:o[1]=0:o[1]=0,l&&this.component._showStatusMessage(),o},e.TableDomUtils.prototype.moveTableBodyRowTouchSelectionAffordanceTop=function(l){var o=this.getTableBodyRowTouchSelectionAffordanceTop();if(null!=o){null!=l?(t(o).data("rowIdx",l),t(o.children[0]).data("rowIdx",l)):l=t(o).data("rowIdx");var i=this.getTableBody(),s=this.getTableBodyRow(l).getBoundingClientRect(),n=this.getTouchAffordanceGlassPane().getBoundingClientRect();o.style[e.TableDomUtils.CSS_PROP._TOP]=s.top-n.top-o.clientHeight/2+e.TableDomUtils.CSS_VAL._PX,o.style[e.TableDomUtils.CSS_PROP._LEFT]=i.clientWidth/2+e.TableDomUtils.CSS_VAL._PX}},e.TableDomUtils.prototype.moveTableBodyRowTouchSelectionAffordanceBottom=function(l){var o=this.getTableBodyRowTouchSelectionAffordanceBottom();if(null!=o){null!=l?(t(o).data("rowIdx",l),t(o.children[0]).data("rowIdx",l)):l=t(o).data("rowIdx");var i=this.getTableBody(),s=this.getTableBodyRow(l).getBoundingClientRect(),n=this.getTouchAffordanceGlassPane().getBoundingClientRect();o.style[e.TableDomUtils.CSS_PROP._TOP]=s.top-n.top+s.height-o.clientHeight/2+e.TableDomUtils.CSS_VAL._PX,o.style[e.TableDomUtils.CSS_PROP._LEFT]=i.clientWidth/2+e.TableDomUtils.CSS_VAL._PX}},e.TableDomUtils.prototype.moveTableHeaderColumn=function(l,o,i){var s=this.component._getColumnDefs(),n=this.getTableHeaderColumn(l),a=this.getTableFooterCell(l),r=null,_=null,d=null,u=null,h=null,c=!1;o===s.length&&(o-=1,c=!0),null!=n&&(h=n.getAttribute(e.TableDomUtils.DOM_ATTR._COLSPAN),null==(_=this.getTableHeaderColumn(o))||null!=h&&1!==h||(c?_.parentNode.insertBefore(n,_.nextSibling):_.parentNode.insertBefore(n,_))),null!=a&&(h=a.getAttribute(e.TableDomUtils.DOM_ATTR._COLSPAN),null==(d=this.getTableFooterCell(o))||null!=h&&1!==h||(c?d.parentNode.insertBefore(a,d.nextSibling):d.parentNode.insertBefore(a,d)));var T,S=this.getTableBodyRows();if(null!=S)for(T=0;T<S.length;T++)null!=(r=this.getTableBodyCell(T,l,null))&&(u=this.getTableBodyCell(T,o,null),h=r.getAttribute(e.TableDomUtils.DOM_ATTR._COLSPAN),null==u||null!=h&&1!==h||(c?u.parentNode.insertBefore(r,u.nextSibling):u.parentNode.insertBefore(r,u)));var m=[],b=this.options.columns.length;for(T=0;T<b;T++)m[T]=t.extend({},{},this.options.columns[T]);var C=l<o&&!c?o-1:o,E=m.splice(l,1);m.splice(C,0,E[0]);var D=this.component._columnDefArray.splice(l,1);if(this.component._columnDefArray.splice(C,0,D[0]),!this._columnsDestMap)for(this._columnsDestMap=[],T=0;T<m.length;T++)this._columnsDestMap[T]=T;var g=this._columnsDestMap.splice(l,1);return this._columnsDestMap.splice(C,0,g[0]),this.component.option("columns",m,{_context:{writeback:!0,originalEvent:i,internalSet:!0}}),this.component._queueTask(function(){}),this._columnsDestMap},e.TableDomUtils.prototype.refreshContextMenu=function(){var l=this._menuContainer;if(l){var o,i=l.querySelectorAll("[data-oj-command]");for(o=0;o<i.length;o++){var s=t(i[o]).children(e.TableDomUtils.DOM_ELEMENT._A);if(s.length>0){var n,a=i[o].getAttribute("data-oj-command").split("-");"sort"===(a=a[a.length-1])?n=this.component.getTranslatedString("labelSort"):"sortAsc"===a?n=this.component.getTranslatedString("labelSortAsc"):"sortDsc"===a?n=this.component.getTranslatedString("labelSortDsc"):"resize"===a&&(n=this.component.getTranslatedString("labelResize")),s.contents().filter(function(){return 3===this.nodeType})[0].nodeValue=n}}}},e.TableDomUtils.prototype.removeDragOverIndicatorColumn=function(){var t=this.getTable(),l=this.tableQuerySelectorAll(t,"."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS+",."+e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS),o=0,i=l.length;for(o=0;o<i;o++)l[o].classList.remove(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS),l[o].classList.remove(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS)},e.TableDomUtils.prototype.removeDragOverIndicatorRow=function(){var l,o=this.getTableBody(),i=this.getTableElementsByClassName(o,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_BEFORE_CLASS),s=this.getTableElementsByClassName(o,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_DRAG_INDICATOR_AFTER_CLASS),n=i.length;for(l=0;l<n;l++)t(i[l]).remove();var a=s.length;for(l=0;l<a;l++)t(s[l]).remove();var r=this.getTableBodyRows();null!=r&&0!==r.length||this.component._showNoDataMessage()},e.TableDomUtils.prototype.removeTableBodyRow=function(e){var l=this.getTableBodyRow(e);null!=l&&(n.subtreeDetached(l),this.component._hasCellTemplate&&this.component._cleanTemplateNodes(l),t(l).remove(),this.clearCachedDomRowData())},e.TableDomUtils.prototype.removeAllTableBodyRows=function(){var e=this.getTableBodyRows();if(null!=e&&e.length>0){var l=this.getTableBody();null!=l&&(n.subtreeDetached(l),this.component._hasCellTemplate&&(this.component._cleanTemplateNodes(l),this.component._hasCellTemplate=!1,this.component._registerDomEventListeners()),t(l).empty()),this.clearCachedDomRowData()}},e.TableDomUtils.prototype.removeTableBodyRowTouchSelectionAffordance=function(){var l,o=this.getTableContainer(),i=this.getTableElementsByClassName(o,e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOUCH_AREA_CLASS);for(l=0;l<i.length;l++)t(i[l]).remove()},e.TableDomUtils.prototype.removeTableHeaderColumnDragImage=function(){for(var l=this.getTableContainer(),o=this.getTableElementsByClassName(l,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_DRAG_IMAGE),i=o.length,s=0;s<i;s++)t(o[s]).remove()},e.TableDomUtils.prototype.removeTableHeaderColumnResizeIndicator=function(){var l=this.getTableHeaderColumnResizeIndicator();l&&(t(l).remove(),this._clearCachedDom(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_RESIZE_INDICATOR_CLASS))},e.TableDomUtils.prototype.setScrollLeft=function(e,t){"rtl"===this.component._GetReadingDirection()&&(t=Math.abs(t),this._isWebkit()?t=e.scrollWidth-e.clientWidth-t:this._isFF()&&(t*=-1));e.scrollLeft!==t&&(e.scrollLeft=t)},e.TableDomUtils.prototype.setTableBodyCellAttributes=function(t,l,o,i,s){var n=s.getAttribute(e.TableDomUtils.DOM_ATTR._ID);if(!(null!=n&&n.length>0)){var a=this.options.accessibility,r=this.component._getColumnDefs()[i];if(null!=r){var _=null,d=this.component._isTableHeaderless();_=null!=a&&null!=a.rowHeader?a.rowHeader:this.component._getColumnDefs()[0].id;var u=null!=l?l.toString():t.toString(),h=null==o?this.hashCode(u):o,c=this.getTableId()+":"+_+"_"+h,T=this.getTableId()+":"+r.id;_===r.id?(n=c,d&&(T="")):(n=c+"_"+i,T=d?c:T+" "+c),s.setAttribute(e.TableDomUtils.DOM_ATTR._ID,n),s.getAttribute(e.TableDomUtils.DOM_ATTR._HEADERS)||s.setAttribute(e.TableDomUtils.DOM_ATTR._HEADERS,T)}}},e.TableDomUtils.prototype.setTableBodyRowAttributes=function(e,l){t(l).data("rowKey",e.key),t(l).data("rowData",e.data)},e.TableDomUtils.prototype.setTableHeaderColumnAttributes=function(t,l){var o=this.component._getColumnDefs()[t];l.getAttribute(e.TableDomUtils.DOM_ATTR._ID)||l.setAttribute(e.TableDomUtils.DOM_ATTR._ID,this.getTableId()+":"+o.id)},e.TableDomUtils.prototype.setTableColumnCellsClass=function(t,l,o){var i,s=this.getTableBodyRows();if(null!=s&&s.length>0)if(null===t){var n=null,a=this.getTableBody();if(null!=(n=l?this.getTableElementsByTagName(a,e.TableDomUtils.DOM_ELEMENT._TD):this.getTableElementsByClassName(a,o))&&n.length>0){var r=n.length;for(i=0;i<r;i++)l?n[i].classList.add(o):n[i].classList.remove(o)}}else{var _=s.length;for(i=0;i<_;i++){var d=this.getTableBodyCell(i,t,null);l?d.classList.add(o):d.classList.remove(o)}}},e.TableDomUtils.prototype.setTableBodyMessage=function(e){var l=this.getTableBodyMessageCell();t(l).empty(),l.appendChild(document.createTextNode(e))},e.TableDomUtils.prototype.setTableStatusAccNotification=function(e){var l=this.getTableStatusAccNotification();t(l).empty(),l.appendChild(document.createTextNode(e))},e.TableDomUtils.prototype.styleInitialTable=function(){var t=this.getTable(),l=this.getTableElementsByTagName(t,e.TableDomUtils.DOM_ELEMENT._THEAD);l=l.length>0?l[0]:null;var o=this.getTableElementsByTagName(t,e.TableDomUtils.DOM_ELEMENT._TFOOT);o=o.length>0?o[0]:null;var i=this.getTableElementsByTagName(t,e.TableDomUtils.DOM_ELEMENT._TBODY);if(i=i.length>0?i[0]:null,-1!==parseInt(this.component._getRootElement().getAttribute(e.TableDomUtils.DOM_ATTR._TABINDEX),10))t.setAttribute(e.TableDomUtils.DOM_ATTR._TABINDEX,"0"),this.component._focusable({element:t,applyHighlight:!0,setupHandlers:this._focusSetupHandlers.bind(this)});else{t.setAttribute(e.TableDomUtils.DOM_ATTR._TABINDEX,"-1");var s=function(){};this._focusSetupHandlers(s,s)}this.styleTableHeader(l),this.styleTableFooter(o),this.styleTableBody(i)},e.TableDomUtils.prototype.styleTableBody=function(t){t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_BODY_CLASS),t.setAttribute(n._OJ_CONTAINER_ATTR,this.component.widgetName),t.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"rowgroup")},e.TableDomUtils.prototype.styleTableBodyCell=function(l,o,i){var s=this.component._getColumnDefs()[l];o.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"cell"),!i&&o.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS)||(o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_CLASS),o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATE_CELL_FORM_CONTROL_CLASS)),null==s||null==s.style||!i&&o.getAttribute(e.TableDomUtils.DOM_ATTR._STYLE)===s.style||o.setAttribute(e.TableDomUtils.DOM_ATTR._STYLE,s.style),null==s||null==s.className||!i&&t(o).hasClass(s.className)||t(o).addClass(s.className),!this._isVerticalGridEnabled()||!i&&o.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)||o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)},e.TableDomUtils.prototype.styleTableBodyRow=function(t,o){t.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"row"),t.setAttribute(l._OJ_CONTEXT_ATTRIBUTE,""),!o&&t.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS)||t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_DATA_ROW_CLASS)},e.TableDomUtils.prototype.styleTableContainer=function(t){this.options.display===e.TableDomUtils._OPTION_DISPLAY._GRID?t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_COMPACT_CLASS):t.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_COMPACT_CLASS);var l=this.options.editMode;null!=l&&l!==this.component._OPTION_EDIT_MODE._NONE?t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_EDIT_CLASS):t.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_EDIT_CLASS),this._isHorizontalGridEnabled()?t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_HGRID_CLASS):t.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_HGRID_CLASS)},e.TableDomUtils.prototype.styleTableFooter=function(t){if(t){t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CLASS);var l=this.getTableElementsByTagName(t,e.TableDomUtils.DOM_ELEMENT._TR)[0];l.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_ROW_CLASS),t.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"rowgroup"),l.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"row")}},e.TableDomUtils.prototype.styleTableFooterCell=function(l,o){var i=this.component._getColumnDefs()[l];null!=i.footerStyle&&o.setAttribute(e.TableDomUtils.DOM_ATTR._STYLE,i.footerStyle),o.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS)||o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_FOOTER_CELL_CLASS),this._isVerticalGridEnabled()&&!o.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)&&o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_VGRID_LINES_CLASS),i.footerClassName&&t(o).addClass(i.footerClassName),o.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"cell")},e.TableDomUtils.prototype.styleTableHeader=function(t){if(t){t.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_HEADER_CLASS),t.style[e.TableDomUtils.CSS_PROP._DISPLAY]="table-header-group";var l=this.getTableElementsByTagName(t,e.TableDomUtils.DOM_ELEMENT._TR)[0];l.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_HEADER_ROW_CLASS),l.style[e.TableDomUtils.CSS_PROP._POSITION]=e.TableDomUtils.CSS_VAL._RELATIVE,t.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"rowgroup"),l.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"row")}},e.TableDomUtils.prototype.styleTableHeaderColumn=function(l,o,i){var s=this.component._getColumnDefs()[l];o.setAttribute(e.TableDomUtils.DOM_ATTR._ROLE,"columnheader"),!i&&o.classList.contains(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS)||(o.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CELL_CLASS),s.sortable===e.TableDomUtils._OPTION_ENABLED&&o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_SORT_CLASS),this._isVerticalGridEnabled()&&(!i&&o.classList.contains(e.TableDomUtils.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)||o.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_VGRID_LINES_CLASS)),null==s.headerStyle||!i&&o.getAttribute(e.TableDomUtils.DOM_ATTR._STYLE)===s.headerStyle||o.setAttribute(e.TableDomUtils.DOM_ATTR._STYLE,s.headerStyle),null==s.headerClassName||!i&&t(o).hasClass(s.headerClassName)||t(o).addClass(s.headerClassName))},e.TableDomUtils.prototype._getColspanLogicalElements=function(t){for(var l=0,o=[],i=t.length,s=0;s<i;s++){var n=t[s].getAttribute(e.TableDomUtils.DOM_ATTR._COLSPAN);if(null!=n){n=parseInt(n,10);for(var a=0;a<n;a++)o[l+a]=t[s];l+=n}else o[l]=t[s],l+=1}return o},e.TableDomUtils.prototype._isHorizontalGridEnabled=function(){return this.options.horizontalGridVisible===e.TableDomUtils._OPTION_ENABLED||this.options.horizontalGridVisible===e.TableDomUtils._OPTION_AUTO},e.TableDomUtils.prototype._isVerticalGridEnabled=function(){return this.options.verticalGridVisible===e.TableDomUtils._OPTION_ENABLED||this.options.verticalGridVisible===e.TableDomUtils._OPTION_AUTO&&this.options.display===e.TableDomUtils._OPTION_DISPLAY._GRID},e.TableDomUtils.prototype._isFF=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},e.TableDomUtils.prototype._isIE=function(){if(void 0===this._browserIsIE){var e=navigator.userAgent;if("Microsoft Internet Explorer"===navigator.appName){var t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e);null!=t&&(this._browserIsIE=parseFloat(t[1]))}else e.indexOf("Trident")>=0?this._browserIsIE=11:this._browserIsIE=null}return this._browserIsIE},e.TableDomUtils.prototype._isWebkit=function(){if(void 0===this._browserIsWebkit){var e=navigator.userAgent.toLowerCase();this._browserIsWebkit=/webkit/.test(e)&&!/edge/.test(e)}return this._browserIsWebkit},e.TableDomUtils.prototype.isSizingRefreshRequired=function(e,t){if(null!=e&&null!=t)return null!=this._cacheDomDimensions?e>0&&t>0&&(e!==this._cacheDomDimensions.tableContainerWidth||t!==this._cacheDomDimensions.tableContainerHeight):e>0&&t>0;var l=this.getTableContainer();return l.offsetWidth>0&&l.offsetHeight>0},e.TableDomUtils.prototype.refreshTableDimensions=function(l,o,i){if(i||this.isSizingRefreshRequired(l,o)){var s=this.getTable(),n=this.getTableContainer(),a=this.getTableHeader(),r=this.getTableBody(),_=this.getTableFooter(),d=this.getTableBottomSlot(),u=null,h=null;null!=this.component._scrollTop&&this.component._scrollTop>0&&(u=this.component._scrollTop),null!=this.component._scrollLeft&&this.component._scrollLeft>0&&(h=this.component._scrollLeft),this.component._clearCachedDimensions(),this._removeTableDimensionsStyling(),this.styleTableContainer(n),this._setForcedColumnWidths();var c=this.getTableContainerScrollableState();if(1===c[0]?this._tableHeightConstrained=!0:this._tableHeightConstrained=!1,1===c[1]?this._tableWidthConstrained=!0:this._tableWidthConstrained=!1,null!=r){if(this._tableHeightConstrained||this._tableWidthConstrained){n.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_SCROLL_CLASS);var T=n.clientWidth,S=n.clientHeight,m=this.getDefaultScrollBarSize();m>0&&(this._tableWidthConstrained||this._isVerticalScrollBarHidden()?this._tableHeightConstrained||(s.style[e.TableDomUtils.CSS_PROP._HEIGHT]=S+m+e.TableDomUtils.CSS_VAL._PX,n.clientHeight<S+m?(S=n.clientHeight,s.style[e.TableDomUtils.CSS_PROP._HEIGHT]=S-m+e.TableDomUtils.CSS_VAL._PX,S-m<s.clientHeight&&(this._tableHeightConstrained=!0)):(S=n.clientHeight,s.style[e.TableDomUtils.CSS_PROP._HEIGHT]="")):(s.style[e.TableDomUtils.CSS_PROP._WIDTH]=T+m+e.TableDomUtils.CSS_VAL._PX,n.clientWidth<T+m?(T=n.clientWidth,s.style[e.TableDomUtils.CSS_PROP._WIDTH]=T-m+e.TableDomUtils.CSS_VAL._PX,T-m<s.clientWidth&&(this._tableWidthConstrained=!0)):(T=n.clientWidth,s.style[e.TableDomUtils.CSS_PROP._WIDTH]=""))),this._tableHeightConstrained&&this._isVerticalScrollBarHidden()&&(r.style[e.TableDomUtils.CSS_PROP._OVERFLOW_Y]="hidden");var b=this.getScrollBarWidth();this._setColumnWidths(b),this._tableHeightConstrained&&n.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_SCROLL_VERTICAL_CLASS),this._tableWidthConstrained&&n.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_SCROLL_HORIZONTAL_CLASS);var C=0,E=this.getTableElementsByTagName(s,"caption");if(E.length>0&&(E=E[0],C=t(E).outerHeight(),E.style[e.TableDomUtils.CSS_PROP._DISPLAY]=e.TableDomUtils.CSS_VAL._INLINE,null!=a)){var D=window.getComputedStyle(n);a.style[e.TableDomUtils.CSS_PROP._BORDER_TOP]=D[e.TableDomUtils.CSS_PROP._BORDER_TOP]}var g=0;null!=a&&(g=t(a).outerHeight());var R=r.offsetHeight-r.clientHeight;r.style[e.TableDomUtils.CSS_PROP._WIDTH]=T+e.TableDomUtils.CSS_VAL._PX;var f=0;null!=_&&(f=t(_).outerHeight(),r.style[e.TableDomUtils.CSS_PROP._TOP]=-1*f+e.TableDomUtils.CSS_VAL._PX);var A=0;null!=d&&d.style[e.TableDomUtils.CSS_PROP._DISPLAY]!==e.TableDomUtils.CSS_VAL._NONE&&d.clientHeight>0&&(A=t(d).outerHeight());var p=S-g-f-C-A-R;if(p>0&&(r.style[e.TableDomUtils.CSS_PROP._HEIGHT]=p+e.TableDomUtils.CSS_VAL._PX,r.style[e.TableDomUtils.CSS_PROP._MIN_HEIGHT]=p+e.TableDomUtils.CSS_VAL._PX),this._tableWidthConstrained){var L=this.getTableBodyRows();null!=L&&L.length>0?null!=a&&(a.style[e.TableDomUtils.CSS_PROP._WIDTH]=b>0?T-b+e.TableDomUtils.CSS_VAL._PX:T+e.TableDomUtils.CSS_VAL._PX):r.style[e.TableDomUtils.CSS_PROP._OVERFLOW_X]=e.TableDomUtils.CSS_VAL._HIDDEN}else null!=a&&(a.style[e.TableDomUtils.CSS_PROP._WIDTH]=T+e.TableDomUtils.CSS_VAL._PX);null!=_&&(_.style[e.TableDomUtils.CSS_PROP._TOP]=p+e.TableDomUtils.CSS_VAL._PX)}else this._isTableColumnsWidthSet()&&(this._setColumnWidths(0),this._isAllTableColumnsWidthSet()&&(s.style[e.TableDomUtils.CSS_PROP._WIDTH]=e.TableDomUtils.CSS_VAL._AUTO));if(this._setHeaderColumnOverflowWidths(),this.refreshTableStatusPosition(),this.refreshTouchAffordanceGlassPanePosition(),null!=u){var O=this.getScroller().scrollHeight-this.getScroller().clientHeight;u=u>O?O:u,this.component._isLoadMoreOnScroll()&&O===u&&(u-=1),this.component._skipScrollUpdate=!0,this.getScroller().scrollTop=u,t(this.getScroller()).scroll()}null!=h&&(this.component._skipScrollUpdate=!0,this.setScrollLeft(this.getScroller(),h),t(this.getScroller()).scroll()),this._cacheDomDimensions.tableContainerWidth=n.offsetWidth,this._cacheDomDimensions.tableContainerHeight=n.offsetHeight,r&&(r.style[e.TableDomUtils.CSS_PROP._VISIBILITY]=""),_&&(_.style[e.TableDomUtils.CSS_PROP._VISIBILITY]="")}}},e.TableDomUtils.prototype.refreshTouchAffordanceGlassPanePosition=function(){var t=this.getTouchAffordanceGlassPane();if(t){var l=this.getTableBody().getBoundingClientRect(),o=this.getTableContainer().getBoundingClientRect();t.style[e.TableDomUtils.CSS_PROP._TOP]=l.top-o.top+e.TableDomUtils.CSS_VAL._PX,t.style[e.TableDomUtils.CSS_PROP._BOTTOM]=l.bottom-o.bottom+e.TableDomUtils.CSS_VAL._PX,this.moveTableBodyRowTouchSelectionAffordanceTop(),this.moveTableBodyRowTouchSelectionAffordanceBottom()}},e.TableDomUtils.prototype.refreshTableStatusPosition=function(){if(this.component._isStatusMessageShown()){var l=this.getTableContainer(),o=this.getTableBody(),i=this.getTableStatusMessage(),s=l;o.clientHeight>0&&(s=o),i.style[e.TableDomUtils.CSS_PROP._HEIGHT]=o.clientHeight+e.TableDomUtils.CSS_VAL._PX,i.style[e.TableDomUtils.CSS_PROP._WIDTH]=o.clientWidth+e.TableDomUtils.CSS_VAL._PX;var n=i.children[0],a="rtl"===this.component._GetReadingDirection(),r={my:"center",at:"center",collision:"none",of:s};r=e.PositionUtils.normalizeHorizontalAlignment(r,a),t(i).position(r);var _={my:"center",at:"center",collision:"none",of:i};_=e.PositionUtils.normalizeHorizontalAlignment(_,a),t(n).position(_)}},e.TableDomUtils.prototype._cacheDomElement=function(e,t){this._domCache||(this._domCache={}),this._domCache[e]=t},e.TableDomUtils.prototype._clearCachedDom=function(e){e&&this._domCache?delete this._domCache[e]:this._domCache={},this._cacheDomDimensions={}},e.TableDomUtils.prototype._getCachedDomElement=function(e){return this._domCache?this._domCache[e]:null},e.TableDomUtils.prototype._isCachedDomElement=function(e){return this._domCache||(this._domCache={}),-1!==Object.keys(this._domCache).indexOf(e)},e.TableDomUtils.prototype._getTableElementByClassName=function(e,t){if(!this._isCachedDomElement(e)){var l=this.getTableContainer();if(l)if(this._cacheDomElement(e,null),t){if(this._cacheDomElement(e,this._getChildElementByClassName(l,e)),null==this._getCachedDomElement(e)){var o=this.getTable();this._cacheDomElement(e,this._getChildElementByClassName(o,e))}}else{var i=this.getTableElementsByClassName(l,e);i.length>0&&this._cacheDomElement(e,i[0])}}return this._getCachedDomElement(e)},e.TableDomUtils.prototype._getChildElementByClassName=function(e,t){if(null!=e.childNodes&&e.childNodes.length>0)for(var l=0;l<e.childNodes.length;l++)if(null!=e.childNodes[l].classList&&e.childNodes[l].classList.contains(t))return e.childNodes[l];return null},e.TableDomUtils.prototype.getTableElementsByClassName=function(e,t,l){var o=e.getElementsByClassName(t);return this._filterTableOwnedElements(o,l?e:null)},e.TableDomUtils.prototype.getTableElementsByTagName=function(e,t,l){var o=e.getElementsByTagName(t);return this._filterTableOwnedElements(o,l?e:null)},e.TableDomUtils.prototype.tableQuerySelectorAll=function(e,t,l){var o=e.querySelectorAll(t);return this._filterTableOwnedElements(o,l?e:null)},e.TableDomUtils.prototype._filterTableOwnedElements=function(t,l){var o,i;if(l){o=l;for(var s=l.getElementsByTagName(e.TableDomUtils.DOM_ELEMENT._TABLE),n=0;n<s.length;n++)if(s[n].parentNode===l){i=s[n];break}}else o=this.getTableContainer(),i=this.getTable();var a=this;return Array.prototype.filter.call(t,function(e){return a.isTableOwned(e,o,i)})},e.TableDomUtils.prototype.isTableOwned=function(t,l,o){var i=l||this.getTableContainer(),s=l?o:this.getTable();if(i){if(s){var n=this.getFirstAncestor(t,s.tagName);if(n===s)return!0;if(n)return!1}var a=this.getFirstAncestor(t,"."+e.TableDomUtils.CSS_CLASSES._TABLE_CONTAINER_CLASS);if(a===i)return!0;if(a)return!1;if(!i.contains(t))return!0}return!1},e.TableDomUtils.prototype._focusSetupHandlers=function(e,t){this.component._setFocusInHandler(e),this.component._setFocusOutHandler(t)},e.TableDomUtils.prototype._removeHeaderColumnAndCellColumnWidths=function(){var e,t=this.component._getColumnDefs().length;for(e=0;e<t;e++){var l=this.getTableHeaderColumn(e);null!=l&&this._applyForcedColumnWidth(l,"")}this.unfreezeColumnWidths();var o=this.getTableBodyRows();if(null!=o&&o.length>0)for(e=0;e<t;e++){var i;if(null!=this._forcedWidthColumns&&!1!==this._forcedWidthColumns[e])for(var s=0;s<o.length;s++)null!==(i=this.getTableBodyCell(s,e,null))&&this._applyForcedColumnWidth(i,"");else null!=(i=this.getTableBodyCell(0,e,null))&&this._applyForcedColumnWidth(i,"")}for(e=0;e<t;e++){var n=this.getTableFooterCell(e);null!=n&&this._applyForcedColumnWidth(n,"")}},e.TableDomUtils.prototype._removeTableDimensionsStyling=function(){var t=this.getTable(),l=this.getTableContainer(),o=this.getTableHeader(),i=this.getTableHeaderRow(),s=this.getTableFooter(),n=this.getTableFooterRow(),a=this.getTableBody();if(l.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_SCROLL_CLASS),l.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_SCROLL_VERTICAL_CLASS),l.classList.remove(e.TableDomUtils.CSS_CLASSES._TABLE_SCROLL_HORIZONTAL_CLASS),null!=o){o.removeAttribute(e.TableDomUtils.DOM_ATTR._STYLE),i.removeAttribute(e.TableDomUtils.DOM_ATTR._STYLE);for(var r=this.getTableElementsByClassName(i,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS),_=r.length,d=0;d<_;d++)r[d].style[e.TableDomUtils.CSS_PROP._WIDTH]=""}null!=s&&(s.removeAttribute(e.TableDomUtils.DOM_ATTR._STYLE),n.removeAttribute(e.TableDomUtils.DOM_ATTR._STYLE)),t.style[e.TableDomUtils.CSS_PROP._DISPLAY]="",t.style[e.TableDomUtils.CSS_PROP._WIDTH]="",null!=a&&a.removeAttribute(e.TableDomUtils.DOM_ATTR._STYLE),this._removeHeaderColumnAndCellColumnWidths()},e.TableDomUtils.prototype._getBoxStyle=function(t){return{boxSizing:t[e.TableDomUtils.CSS_PROP._BOX_SIZING],borderWidth:(parseFloat(t[e.TableDomUtils.CSS_PROP._BORDER_RIGHT_WIDTH])||0)+(parseFloat(t[e.TableDomUtils.CSS_PROP._BORDER_LEFT_WIDTH])||0),paddingWidth:(parseFloat(t[e.TableDomUtils.CSS_PROP._PADDING_RIGHT])||0)+(parseFloat(t[e.TableDomUtils.CSS_PROP._PADDING_LEFT])||0)}},e.TableDomUtils.prototype._applyColumnHeaderHeight=function(t,l){var o=this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CLASS);o.length>0&&(o[0].style[e.TableDomUtils.CSS_PROP._MIN_HEIGHT]=l+e.TableDomUtils.CSS_VAL._PX)},e.TableDomUtils.prototype._getForcedColumnWidth=function(e,t){return e+("border-box"===t.boxSizing?t.borderWidth:-t.paddingWidth)},e.TableDomUtils.prototype._applyForcedColumnWidth=function(t,l){var o=t;""!==l&&(l+=e.TableDomUtils.CSS_VAL._PX),o.style[e.TableDomUtils.CSS_PROP._MIN_WIDTH]=l,o.style[e.TableDomUtils.CSS_PROP._WIDTH]=l,o.style[e.TableDomUtils.CSS_PROP._MAX_WIDTH]=l},e.TableDomUtils.prototype._setForcedColumnWidths=function(){var e,t,l,o,s,n,a,r,_=this.component._getColumnDefs(),u=_.length,h=this.getTableBodyRows();this._forcedWidthColumns=[];for(var c=0;c<u;c++){var T=_[c].width;if(T>0){if("number"!=typeof T&&(a=this.component._LOGGER_MSG._ERR_WIDTH_INVALID_TYPE_SUMMARY,r=i.applyParameters(this.component._LOGGER_MSG._ERR_WIDTH_INVALID_TYPE_DETAIL,{width:T}),d.warn(a+"\n"+r),T=parseFloat(T)),null!=(e=this.getTableHeaderColumn(c))){var S=this._getBoxStyle(window.getComputedStyle(e)),m=this._getForcedColumnWidth(T,S);this._applyForcedColumnWidth(e,m),this._forcedWidthColumns[c]=m}else this._forcedWidthColumns[c]=!0;if(null!=(t=0===this.component._editableRowIdx&&h.length>1?this.getTableBodyCell(1,c,null):this.getTableBodyCell(0,c,null))){this.component._hasRowOrCellRendererOrTemplate(c)||(l=this._getBoxStyle(window.getComputedStyle(t)),o=this._getForcedColumnWidth(T,l));for(var b=0;b<h.length;b++)if(null!=(t=this.getTableBodyCell(b,c,null)))if(null==l){var C=this._getBoxStyle(window.getComputedStyle(t)),E=this._getForcedColumnWidth(T,C);this._applyForcedColumnWidth(t,E)}else this._applyForcedColumnWidth(t,o)}null!=(s=this.getTableFooterCell(c))&&(n=this._getBoxStyle(window.getComputedStyle(s)),this._applyForcedColumnWidth(s,this._getForcedColumnWidth(T,n)))}else this._forcedWidthColumns[c]=!1}},e.TableDomUtils.prototype._isTableColumnsWidthSet=function(){for(var e=this.component._getColumnDefs().length,t=0;t<e;t++)if(!1!==this._forcedWidthColumns[t])return!0;return!1},e.TableDomUtils.prototype._isAllTableColumnsWidthSet=function(){for(var e=this.component._getColumnDefs().length,t=0;t<e;t++)if(!1===this._forcedWidthColumns[t])return!1;return!0},e.TableDomUtils.prototype.unfreezeColumnWidths=function(){if(this._frozenWidthRows)for(var e=0;e<this._frozenWidthRows.length;e++)for(var t=this.getTableBodyCells(null,this._frozenWidthRows[e]),l=0;l<t.length;l++){var o=t[l];this._applyForcedColumnWidth(o,""),this.styleTableBodyCell(l,o)}this._frozenWidthRows=[]},e.TableDomUtils.prototype.freezeColumnWidths=function(t){var l,o=this.component._getColumnDefs().length;this._frozenWidthRows||(this._frozenWidthRows=[]);for(var i=[],s=0;s<o;s++){l=this.getTableBodyCell(0,s,null);var n=parseFloat(l.style[e.TableDomUtils.CSS_PROP._MIN_WIDTH]);isNaN(n)?i.push(null):i.push(n)}for(var a=t.childNodes,r=0;r<a.length;r++)if("TR"===a[r].nodeName){for(var _=a[r],d=this.getTableBodyCells(null,_),u=0;u<d.length;u++){var h=i[u];isNaN(h)||this._applyForcedColumnWidth(d[u],h)}this._frozenWidthRows.push(_)}},e.TableDomUtils.prototype._setColumnWidths=function(t){var l,o,i,s,n=[],a=[],r=[],_=[],d=this.component._getColumnDefs().length;for(l=0;l<d;l++)if(!1!==this._forcedWidthColumns[l])n[l]=null,r[l]=null,_[l]=null;else{if(null!=(o=this.getTableHeaderColumn(l))){var u=this._getBoxStyle(window.getComputedStyle(o));n[l]=this._getForcedColumnWidth(o.offsetWidth,u);var h=this.getTableElementsByClassName(o,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS);h.length>0&&(a[l]=h[0].clientHeight)}if(null!=(i=this.getTableBodyCell(0,l,null))){var c=this._getBoxStyle(window.getComputedStyle(i));r[l]=this._getForcedColumnWidth(i.offsetWidth,c)}if(null!=(s=this.getTableFooterCell(l))){var T=this._getBoxStyle(window.getComputedStyle(s));_[l]=this._getForcedColumnWidth(s.offsetWidth,T)}}for(l=0;l<d;l++)!1!==this._forcedWidthColumns[l]?null!=(o=this.getTableHeaderColumn(l))&&(this._applyColumnHeaderHeight(o,a[l]),l===d-1&&!this._tableWidthConstrained&&t>0&&this._applyForcedColumnWidth(o,this._forcedWidthColumns[l]+t)):(null!=(o=this.getTableHeaderColumn(l))&&(l===d-1&&!this._tableWidthConstrained&&t>0?this._applyForcedColumnWidth(o,n[l]+t):this._applyForcedColumnWidth(o,n[l]),this._applyColumnHeaderHeight(o,a[l])),null!=(i=this.getTableBodyCell(0,l,null))&&this._applyForcedColumnWidth(i,r[l]),null!=(s=this.getTableFooterCell(l))&&this._applyForcedColumnWidth(s,_[l]))},e.TableDomUtils.prototype._setHeaderColumnOverflowWidths=function(){for(var t=this.component._getColumnDefs().length,l=0;l<t;l++){var o=this.getTableHeaderColumn(l);if(null!=o){var i=this.getTableElementsByClassName(o,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CLASS);if(i.length>0){i=i[0];var s=this.getTableElementsByClassName(o,e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS);if(s.length>0&&i.clientWidth>0&&s[0].clientWidth>i.clientWidth){s[0].style[e.TableDomUtils.CSS_PROP._WIDTH]="";var n=s[0].clientWidth,a=i.clientWidth;n>a+1&&(s[0].style[e.TableDomUtils.CSS_PROP._WIDTH]=a+e.TableDomUtils.CSS_VAL._PX)}}}}},e.TableDomUtils.prototype.getSortIconContainer=function(t){return this.getTableElementsByClassName(t,e.TableDomUtils.CSS_CLASSES._TABLE_SORT_ICON_CONTAINER_CLASS)[0]},e.TableDomUtils.prototype.getSortIcon=function(e){var t=this.getSortIconContainer(e);return null!=t?t.firstChild:null},e.TableDomUtils.CSS_CLASSES={_CHECKBOX_ACC_SELECT_COLUMN_CLASS:"oj-table-checkbox-acc-select-column",_CHECKBOX_ACC_SELECT_ROW_CLASS:"oj-table-checkbox-acc-select-row",_TABLE_CONTAINER_CLASS:"oj-table-container",_TABLE_SCROLLER_CLASS:"oj-table-scroller",_TABLE_CLASS:"oj-table",_TABLE_COMPACT_CLASS:"oj-table-grid-display",_TABLE_HGRID_CLASS:"oj-table-horizontal-grid",_TABLE_EDIT_CLASS:"oj-table-editable",_TABLE_SCROLL_CLASS:"oj-table-scroll",_TABLE_SCROLL_VERTICAL_CLASS:"oj-table-scroll-vertical",_TABLE_SCROLL_HORIZONTAL_CLASS:"oj-table-scroll-horizontal",_TABLE_SORT_CLASS:"oj-table-sort",_TABLE_ELEMENT_CLASS:"oj-table-element",_TABLE_FOOTER_CLASS:"oj-table-footer",_TABLE_FOOTER_ROW_CLASS:"oj-table-footer-row",_TABLE_HEADER_CLASS:"oj-table-header",_TABLE_HEADER_ROW_CLASS:"oj-table-header-row",_TABLE_BOTTOM_SLOT_CLASS:"oj-table-slot-bottom",_TABLE_SORT_ICON_CONTAINER_CLASS:"oj-table-sort-icon-container",_COLUMN_HEADER_CELL_CLASS:"oj-table-column-header-cell",_COLUMN_HEADER_DROP_EMPTY_CELL_CLASS:"oj-table-column-header-drop-empty-cell",_COLUMN_HEADER_ACC_SELECT_COLUMN_CLASS:"oj-table-column-header-acc-select-column",_COLUMN_HEADER_ACC_SELECT_ROW_CLASS:"oj-table-column-header-acc-select-row",_COLUMN_HEADER_ACC_SELECT_ROW_TEXT_CLASS:"oj-table-column-header-acc-select-row-text",_COLUMN_HEADER_CLASS:"oj-table-column-header",_COLUMN_HEADER_TEXT_CLASS:"oj-table-column-header-text",_COLUMN_HEADER_ASC_ICON_CLASS:"oj-table-column-header-asc-icon",_COLUMN_HEADER_DSC_ICON_CLASS:"oj-table-column-header-dsc-icon",_COLUMN_HEADER_DRAG_INDICATOR_BEFORE_CLASS:"oj-table-column-header-drag-indicator-before",_COLUMN_HEADER_DRAG_INDICATOR_AFTER_CLASS:"oj-table-column-header-drag-indicator-after",_COLUMN_HEADER_DRAG_IMAGE:"oj-table-column-header-cell-drag-image",_COLUMN_HEADER_RESIZE_INDICATOR_CLASS:"oj-table-column-header-resize-indicator",_TABLE_BODY_CLASS:"oj-table-body",_TABLE_DATA_ROW_CLASS:"oj-table-body-row",_TABLE_DATA_ROW_DRAG_INDICATOR_BEFORE_CLASS:"oj-table-body-row-drag-indicator-before",_TABLE_DATA_ROW_DRAG_INDICATOR_AFTER_CLASS:"oj-table-body-row-drag-indicator-after",_TABLE_TOUCH_AFFORDANCE_GLASS_PANE_CLASS:"oj-table-touch-affordance-glass-pane",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_CLASS:"oj-table-body-row-touch-selection-affordance-top",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_CLASS:"oj-table-body-row-touch-selection-affordance-bottom",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOP_ICON_CLASS:"oj-table-body-row-touch-selection-affordance-top-icon",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_BOTTOM_ICON_CLASS:"oj-table-body-row-touch-selection-affordance-bottom-icon",_TABLE_DATA_ROW_TOUCH_SELECTION_AFFORDANCE_TOUCH_AREA_CLASS:"oj-table-body-row-touch-selection-affordance-touch-area",_TABLE_DATA_ROW_EDIT_CLASS:"oj-table-body-row-edit",_TABLE_DATA_CURRENT_ROW_CLASS:"oj-table-body-current-row",_TABLE_DATA_CELL_CLASS:"oj-table-data-cell",_TABLE_DATA_CELL_ACC_SELECT_CLASS:"oj-table-data-cell-acc-select",_TABLE_DATA_CELL_EDIT_CLASS:"oj-table-data-cell-edit",_TABLE_DATE_CELL_FORM_CONTROL_CLASS:"oj-form-control-inherit",_TABLE_VGRID_LINES_CLASS:"oj-table-vgrid-lines",_TABLE_FOOTER_CELL_CLASS:"oj-table-footer-cell",_TABLE_FOOTER_DROP_EMPTY_CELL_CLASS:"oj-table-footer-drop-empty-cell",_TABLE_STATUS_ACC_NOTIFICATION_CLASS:"oj-table-status-acc-notification",_TABLE_STATUS_MESSAGE_CLASS:"oj-table-status-message",_TABLE_STATUS_MESSAGE_TEXT_CLASS:"oj-table-status-message-text",_TABLE_LOADING_ICON_CLASS:"oj-table-loading-icon",_TABLE_BODY_MESSAGE_CLASS:"oj-table-body-message",_TABLE_BODY_MESSAGE_ROW_CLASS:"oj-table-body-message-row",_ICON_CLASS:"oj-icon",_WIDGET_ICON_CLASS:"oj-component-icon",_HIDDEN_CONTENT_ACC_CLASS:"oj-helper-hidden-accessible",_TEXT_ALIGN_END:"oj-helper-text-align-end"},e.TableDomUtils.CSS_PROP={_DISPLAY:"display",_VISIBILITY:"visibility",_POSITION:"position",_HEIGHT:"height",_WIDTH:"width",_TOP:"top",_BOTTOM:"bottom",_LEFT:"left",_RIGHT:"right",_PADDING_TOP:"padding-top",_PADDING_LEFT:"padding-left",_PADDING_RIGHT:"padding-right",_OVERFLOW:"overflow",_OVERFLOW_X:"overflow-x",_OVERFLOW_Y:"overflow-y",_MIN_WIDTH:"min-width",_MAX_WIDTH:"max-width",_MIN_HEIGHT:"min-height",_FLOAT:"float",_BORDER_TOP:"border-top",_BORDER_BOTTOM_WIDTH:"border-bottom-width",_BORDER_LEFT_WIDTH:"border-left-width",_BORDER_RIGHT_WIDTH:"border-right-width",_BORDER_COLOR:"border-color",_MARGIN_BOTTOM:"margin-bottom",_VERTICAL_ALIGN:"vertical-align",_CURSOR:"cursor",_ZINDEX:"z-index",_BACKGROUND_COLOR:"background-color",_BOX_SIZING:"box-sizing"},e.TableDomUtils.CSS_VAL={_NONE:"none",_BLOCK:"block",_INLINE_BLOCK:"inline-block",_RELATIVE:"relative",_ABSOLUTE:"absolute",_INLINE:"inline",_AUTO:"auto",_HIDDEN:"hidden",_SCROLL:"scroll",_VISIBLE:"visible",_LEFT:"left",_PX:"px",_MIDDLE:"middle",_MOVE:"move",_FIXED:"fixed",_TRANSPARENT:"transparent",_BORDER_BOX:"border-box"},e.TableDomUtils.DOM_ATTR={_STYLE:"style",_TABINDEX:"tabindex",_TYPE:"type",_ID:"id",_TITLE:"title",_HREF:"href",_HEADERS:"headers",_COLSPAN:"colspan",_ROLE:"role",_ARIA_LABEL:"aria-label",_ARIA_HIDDEN:"aria-hidden"},e.TableDomUtils.DOM_ELEMENT={_DIV:"div",_A:"a",_TR:"tr",_TD:"td",_TH:"th",_TABLE:"table",_TBODY:"tbody",_THEAD:"thead",_TFOOT:"tfoot",_INPUT:"input",_UL:"ul",_SPAN:"span",_BUTTON:"button",_LABEL:"label"},e.TableDomUtils.MARKER_STYLE_CLASSES={_WIDGET:"oj-component",_ACTIVE:"oj-active",_CLICKABLE_ICON:"oj-clickable-icon-nocontext",_DISABLED:"oj-disabled",_ENABLED:"oj-enabled",_FOCUS:"oj-focus",_FOCUS_HIGHLIGHT:"oj-focus-highlight",_HOVER:"oj-hover",_SELECTED:"oj-selected",_DEFAULT:"oj-default",_WARNING:"oj-warning",_DRAGGABLE:"oj-draggable",_DRAG:"oj-drag",_HIDE_VERTICAL_SCROLLBAR:"oj-table-hide-vertical-scrollbar"},e.TableDomUtils._COLUMN_HEADER_ROW_SELECT_ID="_hdrColRowSel",e.TableDomUtils._OPTION_AUTO="auto",e.TableDomUtils._OPTION_ENABLED="enabled",e.TableDomUtils._OPTION_DISABLED="disabled",e.TableDomUtils._OPTION_SELECTION_MODES={_SINGLE:"single",_MULTIPLE:"multiple"},e.TableDomUtils._OPTION_DISPLAY={_LIST:"list",_GRID:"grid"},
/**
 * @preserve Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
e.TableRendererUtils={},e.TableRendererUtils.columnHeaderDefaultRenderer=function(l,o,i,s){var n=o.headerContext.parentElement,a=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);a.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CLASS),t(n).empty(),n.appendChild(a);var r=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);r.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS),a.insertBefore(r,a.firstChild),null!=s?s(t(r)):this.columnHeaderDefaultTextRenderer(l,r,o)},e.TableRendererUtils.columnHeaderSortableIconRenderer=function(l,o,i,s){var n=o.headerContext.parentElement,a=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);a.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_CLASS),t(n).empty(),n.appendChild(a);var r=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);r.classList.add(e.TableDomUtils.CSS_CLASSES._TABLE_SORT_ICON_CONTAINER_CLASS),a.appendChild(r);var _=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);_.classList.add(e.TableDomUtils.CSS_CLASSES._WIDGET_ICON_CLASS),_.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_ASC_ICON_CLASS),_.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._DISABLED),_.classList.add(e.TableDomUtils.MARKER_STYLE_CLASSES._CLICKABLE_ICON),l._AddHoverable(t(_)),r.appendChild(_);var d=document.createElement(e.TableDomUtils.DOM_ELEMENT._DIV);d.classList.add(e.TableDomUtils.CSS_CLASSES._COLUMN_HEADER_TEXT_CLASS),a.insertBefore(d,a.firstChild),null!=s?s(t(d)):this.columnHeaderDefaultTextRenderer(l,d,o)},e.TableRendererUtils.columnHeaderDefaultTextRenderer=function(e,t,l){var o=l.columnIndex,i=e._getColumnDefs()[o],s=null==i.headerText?"":i.headerText;t.appendChild(document.createTextNode(s))},e.TableRendererUtils.tableBodyRowDefaultRenderer=function(e,t,l,o){var i=o.rowContext.parentElement,s=e._getTableDomUtils().hashCode(l.key),n=e._getColumnDefs();e._getTableDomUtils().setTableBodyRowAttributes(l,i);for(var a=n.length,r=0;r<a;r++)this.tableBodyCellDefaultRenderer(e,t,r,l,s,o)},e.TableRendererUtils.tableBodyCellDefaultRenderer=function(l,o,i,s,n,a){var r=a.rowContext.parentElement,_=l._getColumnDefs()[i],d=l._getTableDomUtils().createTableBodyCell(o,i);l._getTableDomUtils().styleTableBodyCell(i,d,!0),l._getTableDomUtils().insertTableBodyCell(o,s.key,n,i,d,r,!0);var u=null;null!=_.field&&(u=e.TableRendererUtils._getObjectPath(s.data,_.field));var h=l._getColumnRenderer(i,"cell"),c=l._getSlotTemplate(_.template);if(null==c&&l._isDefaultCellTemplateSlotValid()&&(c=l._getSlotTemplate("cellTemplate")),h||c){var T=this.getRendererContextObject(l,d,{row:s}),S={cellContext:T,columnIndex:i,data:u,row:s.data,componentElement:T.componentElement,parentElement:T.parentElement};if(h){var m=h(S);null!=m?t(d).append(m):(d=t(r).children(":not(."+e.TableDomUtils.CSS_CLASSES._TABLE_DATA_CELL_ACC_SELECT_CLASS+")")[i],l._getTableDomUtils().setTableBodyCellAttributes(o,s.key,n,i,d),l._getTableDomUtils().styleTableBodyCell(i,d,!1))}else{var b=l._getRootElement(),C=l._getTemplateEngine();if(null!=C){var E=e.TableRendererUtils.getCellSlotTemplateContextObject(l,S),D=C.execute(b,c,E,l.options.as);D instanceof Array||(D=[D]),D.map(function(e){d.appendChild(e)}),l._hasCellTemplate=!0}}}else{var g=null==(u=e.TableRendererUtils._getVal(u))?"":u;d.appendChild(document.createTextNode(g))}},e.TableRendererUtils.getRendererContextObject=function(t,l,o){var i={};i.component=n.__GetWidgetConstructor(t.element,"ojTable");var s=t.options.data;if(e.PagingTableDataSource&&s instanceof e.PagingTableDataSource&&(s=s.getWrappedDataSource()),i.datasource=s,i.parentElement=l,null!=o.row){var a=o.row,r=a.key;if(i.status=this.getRendererStatusObject(t,a),t._hasEditableRow()){var _=t._getEditableRowKey();e.Object.compareValues(r,_)?i.mode="edit":i.mode="navigation"}else i.mode="navigation";this._copyMetadata(i,a,s)}return t._FixRendererContext(i)},e.TableRendererUtils.getRendererStatusObject=function(e,l){return{rowIndex:l.index,rowKey:l.key,currentRow:t.extend({},e._getCurrentRow())}},e.TableRendererUtils.getCellSlotTemplateContextObject=function(e,t){var l=this.getSlotTemplateContextObject(e),o=t.cellContext.status.rowIndex,i=t.cellContext.status.rowKey,s=t.columnIndex;return l[e._CONST_DATA]=t.data,l.row=t.row,l[e._CONST_INDEX]=o,l.columnIndex=s,l.mode=t.cellContext.mode,l[e._CONST_KEY]=i,l},e.TableRendererUtils.getHeaderSlotTemplateContextObject=function(e,t,l){var o=this.getSlotTemplateContextObject(e);return o[e._CONST_DATA]=t,o.columnIndex=l,o},e.TableRendererUtils.getSlotTemplateContextObject=function(e){return{componentElement:e._getRootElement()}},e.TableRendererUtils._copyMetadata=function(e,t,l){var o=t.metadata;if(l._getMetadata&&(o=l._getMetadata(t.index)),o)for(var i=Object.keys(o),s=0;s<i.length;s++){var n=i[s];e[n]=o[n]}},e.TableRendererUtils._getObjectPath=function(e,t){if(null!=e&&("string"==typeof t||t instanceof String)&&(-1!==t.indexOf(".")||-1!==t.indexOf("[")&&-1!==t.indexOf("]"))){var l=e,o=!1;if(t.split(".").map(function(e){if(null!=l&&-1!==e.indexOf("[")&&-1!==e.indexOf("]")){var t=e.substr(0,e.indexOf("[")),i=parseInt(e.substr(e.indexOf("[")+1,e.indexOf("]")-e.indexOf("[")-1),10);l=l[t][i],o=!0}else null!==l&&void 0!==l[e]&&(l=l[e],o=!0)}),o)return l}else if(null==e)return null;return e[t]},e.TableRendererUtils._getVal=function(e){return"function"==typeof e?e():e},
/**
 * @preserve Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
e.TableResizeUtils=function(e){this.component=e,this.options=e.options,this.Init()},e.Object.createSubclass(e.TableResizeUtils,e.Object,"oj.TableResizeUtils"),e.TableResizeUtils.prototype.Init=function(){e.TableResizeUtils.superclass.Init.call(this)},e.TableResizeUtils.prototype.setResizeCursor=function(e){var t=this.component._getTableDomUtils(),l=this.component._getEventTargetElement(e),o=t.getElementColumnIdx(l);if(null==o)return!1;if(this.component._getColumnDefs()[o].resizable===this.component._OPTION_DISABLED&&this._resizeStartColumnIdx!==o-1&&this._resizeStartColumnIdx!==o+1)return!1;if(null==this._resizeStartColumnIdx)return null!==this._isHeaderColumnResizeStart(e)?(l.style.cursor="col-resize",!0):(l.style.cursor="",!1);if(!t.getTableHeaderColumns())return!1;if(o===this._resizeStartColumnIdx||this._resizeColumnStart&&o===this._resizeStartColumnIdx-1||!this._resizeColumnStart&&o===this._resizeStartColumnIdx+1){var i=t.getTableHeaderColumnResizeIndicator();if(null!=i){var s=t.getTable().getBoundingClientRect();return i.style.left=this._getPageX(e)-s.left+"px",!0}}return!1},e.TableResizeUtils.prototype.handleHeaderColumnResizeStart=function(e){var t=this.component._getEventTargetElement(e),l=this.component._getTableDomUtils().getElementColumnIdx(t);if(null!=l){var o=this.component._getColumnDefs()[l];if(this._resizeColumnStart=this._isHeaderColumnResizeStart(e),o.resizable===this.component._OPTION_ENABLED&&null!==this._resizeColumnStart)return this._resizeStartColumnIdx=l,this._resizeStartPageX=this._getPageX(e),this._setTableHeaderColumnsResizeStyling(),this._setTableHeaderColumnResizeIndicator(l),!0}return this._resizeStartColumnIdx=null,this._resizeStartPageX=null,!1},e.TableResizeUtils.prototype.handleHeaderColumnResizeEnd=function(e){var l=this.component._getTableDomUtils(),o=this.options.columns.length,i=this.component._getEventTargetElement(e),s=l.getElementColumnIdx(i);if(null!==s&&s===this._resizeStartColumnIdx||this._resizeColumnStart&&s===this._resizeStartColumnIdx-1||!this._resizeColumnStart&&s===this._resizeStartColumnIdx+1){var n=l.getTableHeaderColumn(this._resizeStartColumnIdx);if(null!=n){var a,r=n.getBoundingClientRect().width;if(this._resizeStartColumnIdx===o-1&&l._tableHeightConstrained&&(r-=l.getScrollBarWidth()),a="rtl"===this.component._GetReadingDirection()&&this._resizeColumnStart||"ltr"===this.component._GetReadingDirection()&&!this._resizeColumnStart?this._getPageX(e)-this._resizeStartPageX:this._resizeStartPageX-this._getPageX(e),Math.abs(a)>2){for(var _=r+a,d=[],u=0;u<o;u++)d[u]=t.extend({},{},this.options.columns[u]);d[this._resizeStartColumnIdx].width=_;var h=this._resizeColumnStart?this._resizeStartColumnIdx-1:this._resizeStartColumnIdx+1;h===o-1&&l._tableHeightConstrained&&(a+=l.getScrollBarWidth());var c=l.getTableHeaderColumn(h);if(c){var T=c.getBoundingClientRect().width;d[h].width=T-a}return this.component.option("columns",d,{_context:{writeback:!0,internalSet:!0}}),this.component._clearCachedMetadata(),this.component._queueTask(function(){setTimeout(function(){this.clearTableHeaderColumnsResize()}.bind(this),0)}.bind(this)),!0}}}return this.clearTableHeaderColumnsResize(),!1},e.TableResizeUtils.prototype.clearTableHeaderColumnsResize=function(){this._resizeStartColumnIdx=null,this._resizeColumnStart=null,this._resizeStartPageX=null,this._clearTableHeaderColumnsResizeStyling(),this.component._getTableDomUtils().removeTableHeaderColumnResizeIndicator()},e.TableResizeUtils.prototype._getPageX=function(e){return void 0!==e.pageX?e.pageX:void 0!==e.changedTouches?e.changedTouches[0].pageX:0},e.TableResizeUtils.prototype._isHeaderColumnResizeStart=function(t){var l=null,o=this.options.columns.length,i=this.component._getTableDomUtils().getElementColumnIdx(t.target),s=this.component._getTableDomUtils().getTableHeaderColumn(i);if(null!==s){var n=this.component._GetReadingDirection(),a=s.getBoundingClientRect(),r=Math.abs(this._getPageX(t)-a.left),_=Math.abs(this._getPageX(t)-a.right);r<=e.TableResizeUtils.RESIZE_OFFSET?"rtl"===n&&i!==o-1?l=!1:"ltr"===n&&0!==i&&(l=!0):_<=e.TableResizeUtils.RESIZE_OFFSET&&("ltr"===n&&i!==o-1?l=!1:"rtl"===n&&0!==i&&(l=!0))}return l},e.TableResizeUtils.prototype._setTableHeaderColumnResizeIndicator=function(e){var t=this.component._getTableDomUtils().getTableHeaderColumnResizeIndicator();null==t&&(t=this.component._getTableDomUtils().createTableHeaderColumnResizeIndicator());var l=this.component._getTableDomUtils().getTable().getBoundingClientRect(),o=this.component._getTableDomUtils().getTableHeaderColumn(e).getBoundingClientRect();t.style.height=l.height+"px",this._resizeColumnStart?("rtl"===this.component._GetReadingDirection()?t.style.left=o.left+o.width-l.left+"px":t.style.left=o.left-l.left+"px",t.style.borderLeftWidth="2px",t.style.borderRightWidth="0"):("rtl"===this.component._GetReadingDirection()?t.style.left=o.left-l.left+"px":t.style.left=o.left+o.width-l.left+"px",t.style.borderRightWidth="2px",t.style.borderLeftWidth="0")},e.TableResizeUtils.prototype._setTableHeaderColumnsResizeStyling=function(){this.component._getTableDomUtils().getTable().classList.add(e.TableResizeUtils.CSS_CLASSES._COLUMN_HEADER_RESIZING_CLASS)},e.TableResizeUtils.prototype._clearTableHeaderColumnsResizeStyling=function(){var t,l=this.component._getTableDomUtils().getTableHeaderColumns();if(l)for(t=0;t<l.length;t++)l[t].style.cursor="";this.component._getTableDomUtils().getTable().classList.remove(e.TableResizeUtils.CSS_CLASSES._COLUMN_HEADER_RESIZING_CLASS)},e.TableResizeUtils.RESIZE_OFFSET=10,e.TableResizeUtils.CSS_CLASSES={_COLUMN_HEADER_RESIZING_CLASS:"oj-table-column-header-resizing"},c.extension._WIDGET_NAME="ojTable",c.extension._GLOBAL_TRANSFER_ATTRS=["aria-label","aria-labelledby"],c.extension._INNER_ELEM="table",e.CustomElementBridge.register("oj-table",{metadata:c})});