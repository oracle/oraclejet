/**
 * @license
 * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * @ignore
 */
"use strict";define(["ojs/ojcore","jquery","ojs/ojtranslation","ojs/ojarraytreedataprovider","ojs/ojarraydataprovider","ojs/ojindexer"],function(t,e,i,n,s){function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function e(n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=n,this.options=r;var a=r.sections;if(null==a){var o=i.getTranslatedString("oj-ojIndexer.indexerCharacters");a=o.split("|")}a.push(t.IndexerModel.SECTION_OTHERS);var u,l=r.groupingStrategy;if(null==l){var h=this.options.groupingAttribute;l=function(e){var i=(e[h]?e[h]:e).toString().toUpperCase()[0];return a.indexOf(i)>-1?i:t.IndexerModel.SECTION_OTHERS}}n=n.sort(function(t,e){var i=l(t),n=l(e);return a.indexOf(i)-a.indexOf(n)});for(var c=0;c<this.data.length;c++){var v=l(this.data[c]);u!==v&&(u=v,this._set(v,c))}var f=this,d=a.filter(function(t){return null!=f._get(t)});this.sections=a,this.baseDataProvider=new s(d,{keys:d})}var a,o,u;return a=e,(o=[{key:"_set",value:function(t,e){null==this.pos&&(this.pos=[]),this.pos.push({key:t,value:e})}},{key:"_get",value:function(t){for(var e=0;e<this.pos.length;e++)if(this.pos[e].key===t)return this.pos[e].value;return null}},{key:"getIndexableSections",value:function(){return this.sections.slice(0,this.sections.length-1)}},{key:"getMissingSections",value:function(){if(null==this.missing){for(var t=[],e=0;e<this.sections.length-1;e++){var i=this.sections[e];null==this._get(i)&&t.push(i)}this.missing=t}return this.missing}},{key:"setSection",value:function(t){return this.options.sectionChangeHandler?this.options.sectionChangeHandler.call(this,t):Promise.resolve(t)}},{key:"getChildDataProvider",value:function(t,e){if(null===t)return this;var i=t,s=this.sections.indexOf(i);if(s>-1){var r,a=this._get(t);if(null!=a)if(s===this.sections.length-1)r=this.data.slice(a);else{s+=1;for(var o=this.sections[s],u=this._get(o);null==u&&s<this.sections.length;)s+=1,o=this.sections[s],u=this._get(o);(isNaN(u)||null==u)&&(u=this.data.length),r=this.data.slice(a,u)}else r=[];return new n(r,{keyAttributes:this.options.keyAttributes,sortComparators:this.options.sortComparators,implicitSort:this.options.implicitSort})}return null}},{key:"getCapability",value:function(t){return this.baseDataProvider.getCapability(t)}},{key:"getTotalSize",value:function(){return this.baseDataProvider.getTotalSize()}},{key:"containsKeys",value:function(t){return this.baseDataProvider.containsKeys(t)}},{key:"fetchByKeys",value:function(t){return this.baseDataProvider.fetchByKeys(t)}},{key:"fetchByOffset",value:function(t){return this.baseDataProvider.fetchByOffset(t)}},{key:"fetchFirst",value:function(t){return this.baseDataProvider.fetchFirst(t)}},{key:"isEmpty",value:function(){return this.baseDataProvider.isEmpty()}},{key:"addEventListener",value:function(t,e){this.baseDataProvider.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.baseDataProvider.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){return this.baseDataProvider.dispatchEvent(t)}}])&&r(a.prototype,o),u&&r(a,u),e}();return t.IndexerModelTreeDataProvider=a,t.IndexerModelTreeDataProvider=a,a});