!function(){function e(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function t(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=l(e);if(t){var s=l(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return a(this,o)}}function a(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */define(["exports","ojs/ojdomutils","ojs/ojlistdataproviderview","jquery","ojs/ojcore-base","ojs/ojcontext","ojs/ojlogger","ojs/ojthemeutils","ojs/ojtimerutils","ojs/ojhighlighttext","ojs/ojvcomponent","ojs/ojvcomponent-element","ojs/ojpopupcore"],function(t,s,a,l,d,h,c,p,f,v,g,_,y){"use strict";l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h;var m=function(e,t,o,n){var s,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(a=(i<3?s(a):i>3?s(t,o,a):s(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},x=function(t){n(l,t);var a=i(l);function l(e){var t;return r(this,l),(t=a.call(this,e))._fireSuggestionActionEvent=function(e,o){var n,s;null===(s=(n=t.props).onOjSuggestionAction)||void 0===s||s.call(n,{text:e,itemContext:o})},t.state={hover:!1},t}return o(l,[{key:"fireSuggestionAction",value:function(){this._fireSuggestionActionEvent(this.props.formattedText,this.props.suggestionItemContext)}},{key:"getFormattedText",value:function(){return this.props.formattedText}},{key:"render",value:function(){var e=this.props,t={"oj-listbox-result":!0,"oj-listbox-result-selectable":!0,"oj-hover":this.state.hover,"oj-focus":e.focus},o=this._renderContent();return g.h("li",{role:"presentation",class:t,onClick:this._handleClick,onMouseenter:this._handleMouseenter,onMouseleave:this._handleMouseleave},g.h("div",{id:e.labelId,class:"oj-listbox-result-label",role:"option"},o))}},{key:"_renderContent",value:function(){var e,t=this.props,o=t.suggestionItemTemplate;return o?o({data:t.suggestionItemContext.data,key:t.suggestionItemContext.key,metadata:t.suggestionItemContext.metadata,index:t.index,searchText:t.searchText}):g.h(v.HighlightText,{"data-oj-internal":!0,text:this.props.formattedText,matchText:null!==(e=t.searchText)&&void 0!==e?e:""})}},{key:"_handleMouseenter",value:function(t){s.recentTouchEnd()||this.updateState(e({},"hover",!0))}},{key:"_handleMouseleave",value:function(t){this.updateState(e({},"hover",!1))}},{key:"_handleClick",value:function(e){0===e.button&&this._fireSuggestionActionEvent(this.props.formattedText,this.props.suggestionItemContext)}}]),l}(g.VComponent);x.metadata={extension:{_DEFAULTS:function e(){r(this,e),this.focus=!1,this.formattedText="",this.index=-1,this.labelId="",this.searchText=null}}},m([g.listener()],x.prototype,"_handleMouseenter",null),m([g.listener()],x.prototype,"_handleMouseleave",null),m([g.listener()],x.prototype,"_handleClick",null);var S,w=function(e,t,o,n){var s,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(a=(i<3?s(a):i>3?s(t,o,a):s(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};t.InputSearch=S=function(e){n(a,e);var t=i(a);function a(e){var o;r(this,a),(o=t.call(this,e))._CLASS_NAMES="oj-inputsearch-input",o._KEYS={TAB:9,ENTER:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40},o._isComposing=!1,o._counter=0,o._queryCount=0,o._renderedSuggestions=[],o._handleMousedown=function(e){0===e.button&&(o.updateState({focus:!0,dropdownOpen:!0}),e.target!==o._inputElem?e.preventDefault():o.state.showAutocompleteText&&(o.state.autocompleteFloatingText?o.updateState({showAutocompleteText:!1,filterText:o.state.autocompleteFloatingText,displayValue:o.state.autocompleteFloatingText}):o.updateState({showAutocompleteText:!1,filterText:o.state.displayValue})))},o._handleDropdownMousedown=function(e){0===e.button&&(o.updateState({focus:!0}),e.preventDefault())},o._handleDropdownMousemove=function(e){o.updateState({lastEventType:"mouse"})},o._handleDropdownMouseleave=function(e){o.updateState({lastEventType:null})},o._setRootElem=function(e){o._rootElem=e},o._setDropdownElem=function(e){o._dropdownElem=e},o._setInputElem=function(e){o._inputElem=e},o._setInputContainerElem=function(e){o._inputContainerElem=e},o._setRenderedSuggestion=function(e,t){o._renderedSuggestions[e]=t},o._getRenderedSuggestionsCount=function(){var e=o._renderedSuggestions.length,t=o._renderedSuggestions.indexOf(null);return-1===t?e:t};var n=(p.parseJSONFromFontFamily("oj-inputsearch-option-defaults")||{}).showIndicatorDelay;return n=parseInt(n,10),n=isNaN(n)?250:n,o._showIndicatorDelay=n,e.suggestions&&(o._dataProvider=o._wrapDataProviderIfNeeded(o.props.suggestions)),o.state={dropdownOpen:!1,dropdownAbove:!1,valueSubmitted:!1,focus:!1,hover:!1,active:!1,displayValue:null,filterText:null,lastFetchedFilterText:null,fetchedData:null,labelIds:[],fetchedInitial:!1,loading:!1,focusedSuggestionIndex:-1,activeDescendantId:null,scrollFocusedSuggestionIntoView:null,actionDetail:null,lastEventType:null,showAutocompleteText:!1,autocompleteFloatingText:null},o}return o(a,[{key:"render",value:function(){var e=this.state,t={"oj-inputsearch":!0,"oj-form-control":!0,"oj-text-field":!0,"oj-component":!0,"oj-hover":e.hover,"oj-active":e.active,"oj-focus":e.focus,"oj-listbox-dropdown-open":e.dropdownOpen,"oj-listbox-drop-above":e.dropdownOpen&&e.dropdownAbove},o=this._CLASS_NAMES+" oj-text-field-input",n=e.displayValue||"";return this._renderEnabled(t,"oj-text-field-start-end-icon oj-inputsearch-search-icon oj-component-icon",n,o)}},{key:"mounted",value:function(){var e,t;null!==this.props.value&&(null===(t=(e=this.props).onRawValueChanged)||void 0===t||t.call(e,this.props.value)),this._dataProvider&&this._addDataProviderEventListeners(this._dataProvider)}},{key:"updated",value:function(e,t){var o,n,s,i,a,l;if((t.focus&&!this.state.focus||this.state.valueSubmitted)&&(this.props.value!==this.state.displayValue&&(null===(n=(o=this.props).onValueChanged)||void 0===n||n.call(o,this.state.displayValue)),t.focus&&!this.state.focus&&t.filterText!==this.state.displayValue&&this.updateState({filterText:this.state.displayValue}),this.state.valueSubmitted&&(null===(i=(s=this.props).onOjValueAction)||void 0===i||i.call(s,{value:this.state.displayValue,itemContext:this.state.actionDetail,previousValue:this.props.value}),this.updateState({valueSubmitted:!1}),this._testPromiseResolve&&(this._testPromiseResolve(),this._testPromiseResolve=null))),t.displayValue!=this.state.displayValue&&(null===(l=(a=this.props).onRawValueChanged)||void 0===l||l.call(a,this.state.displayValue)),e.suggestions!=this.props.suggestions&&(e.suggestions&&this._removeDataProviderEventListeners(this._dataProvider),this.props.suggestions?(this._dataProvider=this._wrapDataProviderIfNeeded(this.props.suggestions),this._addDataProviderEventListeners(this._dataProvider)):(this._dataProvider=null,this._resolveFetching())),this.state.dropdownOpen){this.state.lastFetchedFilterText==this.state.filterText&&this.state.fetchedInitial||(this.updateState({lastFetchedFilterText:this.state.filterText}),this._fetchData(this.state.filterText)),t.dropdownOpen&&this.state.filterText===t.filterText?this.state.fetchedData&&this.updateState(function(e,t){return{focusedSuggestionIndex:Math.min(e.fetchedData.length-1,e.focusedSuggestionIndex)}}):this.updateState(function(e,t){var o;return{focusedSuggestionIndex:(null===(o=e.filterText)||void 0===o?void 0:o.length)>0?0:-1}});var r=this._resolveFetchBusyState?-1:this.state.focusedSuggestionIndex;if(r>=0&&this.state.labelIds.length>r){this.updateState({activeDescendantId:this.state.labelIds[r]});var u=this.state.filterText||"";if(0===r&&this.state.showAutocompleteText&&u.length>0){var d=this._renderedSuggestions[0].getFormattedText(),h=d.toLowerCase(),c=u.toLowerCase();if(h.startsWith(c)){var p=u.length,f=d.substr(p);this.updateState({displayValue:u+f,autocompleteFloatingText:null}),this._inputElem.setSelectionRange(p,p+f.length)}else this.updateState({autocompleteFloatingText:d,displayValue:u})}}else this.updateState({activeDescendantId:null});this._resolveFetchBusyState||0!==this.state.labelIds.length||this.updateState({dropdownOpen:!1})}else t.dropdownOpen&&(this.updateState({focusedSuggestionIndex:-1}),this._resolveFetching());var v=this.state.scrollFocusedSuggestionIntoView;if(v){var g=this.state.activeDescendantId;if(g){var _="top"===v;this._scrollSuggestionIntoView(g,_),this.updateState({scrollFocusedSuggestionIntoView:null})}}}},{key:"unmounted",value:function(){this._dataProvider&&this._removeDataProviderEventListeners(this._dataProvider),this._resolveFetching()}},{key:"_handleMouseenter",value:function(e){s.recentTouchEnd()||this.updateState({hover:!0})}},{key:"_handleMouseleave",value:function(e){this.updateState({hover:!1})}},{key:"_handleFocusin",value:function(e){this.updateState({focus:!0})}},{key:"_handleFocusout",value:function(){this.updateState({focus:!1})}},{key:"_handleCompositionstart",value:function(e){this._isComposing=!0}},{key:"_handleCompositionend",value:function(e){this._isComposing=!1,this.updateState({filterText:e.target.value,displayValue:e.target.value})}},{key:"_handleInput",value:function(e){if(!this._isComposing){var t,o=this.state.filterText||"",n=o.toLowerCase(),s=e.target.value.toLowerCase();t=!(this.state.showAutocompleteText&&!this.state.autocompleteFloatingText&&o===e.target.value)&&(!(!this.state.showAutocompleteText&&s.length<n.length&&n.startsWith(s))&&e.target.value.length>0),this.updateState({filterText:e.target.value,displayValue:e.target.value,dropdownOpen:!0,showAutocompleteText:t})}}},{key:"focus",value:function(){var e;null===(e=this._inputElem)||void 0===e||e.focus()}},{key:"blur",value:function(){var e;null===(e=this._inputElem)||void 0===e||e.blur()}},{key:"_handleFocus",value:function(e){var t;null===(t=this._rootElem)||void 0===t||t.dispatchEvent(new FocusEvent("focus",{relatedTarget:e.relatedTarget}))}},{key:"_handleBlur",value:function(e){var t;null===(t=this._rootElem)||void 0===t||t.dispatchEvent(new FocusEvent("blur",{relatedTarget:e.relatedTarget}))}},{key:"_handleKeydown",value:function(e){var t,o={lastEventType:"keyboard"},n=e.keyCode;switch(n){case this._KEYS.ENTER:var s=this.state.focusedSuggestionIndex;this.state.dropdownOpen&&s>=0&&this._getRenderedSuggestionsCount()>s&&!this._resolveFetchBusyState?this._renderedSuggestions[s].fireSuggestionAction():Object.assign(o,{dropdownOpen:!1,valueSubmitted:!0,actionDetail:null});break;case this._KEYS.TAB:Object.assign(o,{dropdownOpen:!1,focus:!1,actionDetail:null}),this.state.showAutocompleteText&&Object.assign(o,{showAutocompleteText:!1,displayValue:this.state.filterText});break;case this._KEYS.ESC:this.state.dropdownOpen&&(o.dropdownOpen=!1,this.state.showAutocompleteText&&Object.assign(o,{showAutocompleteText:!1,displayValue:this.state.filterText}),e.preventDefault());break;case this._KEYS.UP:case this._KEYS.DOWN:if(this.state.dropdownOpen){if(!this._resolveFetchBusyState&&this._getRenderedSuggestionsCount()>0){var i=this.state.focusedSuggestionIndex;n===this._KEYS.DOWN||-1===i?(i+=1,o.scrollFocusedSuggestionIntoView="bottom"):i>0&&(i-=1,o.scrollFocusedSuggestionIntoView="top"),i=Math.min(this._getRenderedSuggestionsCount()-1,i),o.focusedSuggestionIndex=i;var a=0===i&&(null===(t=this.state.filterText)||void 0===t?void 0:t.length)>0;o.showAutocompleteText=a,a?o.displayValue=this.state.filterText:i>-1&&(o.displayValue=this._renderedSuggestions[i].getFormattedText())}}else o.dropdownOpen=!0;break;case this._KEYS.LEFT:case this._KEYS.RIGHT:this.state.showAutocompleteText&&!this.state.autocompleteFloatingText&&Object.assign(o,{showAutocompleteText:!1,filterText:this.state.displayValue})}this.updateState(o)}},{key:"_getDropdownElemId",value:function(){return"searchDropdown_"+this.uniqueId()}},{key:"_getInputContainerId",value:function(){return"searchInputContainer_"+this.uniqueId()}},{key:"_getListboxId",value:function(){return"searchSuggestionsListbox_"+this.uniqueId()}},{key:"_clickAwayHandler",value:function(e){var t=e.target;if(!t.closest("#"+l.escapeSelector(this._getDropdownElemId()))&&!t.closest("#"+l.escapeSelector(this._getInputContainerId()))){var o={dropdownOpen:!1};this.state.showAutocompleteText&&Object.assign(o,{showAutocompleteText:!1,displayValue:this.state.filterText}),this.updateState(o)}}},{key:"_getDropdownPosition",value:function(){var e={my:"start top",at:"start bottom",of:this._inputContainerElem,collision:"flip",using:this._usingHandler.bind(this)},t="rtl"===s.getReadingDirection();return e=d.PositionUtils.normalizeHorizontalAlignment(e,t)}},{key:"_usingHandler",value:function(e,t){d.PositionUtils.isAligningPositionClipped(t)?this.updateState({dropdownOpen:!1}):(t.element.element.css(e),this.updateState({dropdownAbove:"bottom"===t.vertical}))}},{key:"_renderEnabled",value:function(e,t,o,n){var s=this.props,i=this.state,a=null;s["aria-label"]&&(a=s["aria-label"]);var l=i.dropdownOpen?this._renderDropdown():null,r=this._dataProvider?this._getListboxId():null,u=d.AgentUtils.getAgentInfo(),h=u.os===d.AgentUtils.OS.ANDROID||u.os===d.AgentUtils.OS.IOS||u.os===d.AgentUtils.OS.WINDOWSPHONE?"search":"text",c=i.autocompleteFloatingText?this._renderAutocompleteFloatingText(i.autocompleteFloatingText,o):null;return _.h("oj-input-search",{ref:this._setRootElem,class:e,onMousedown:this._handleMousedown,onMouseenter:this._handleMouseenter,onMouseleave:this._handleMouseleave},_.h("div",{role:"presentation",class:"oj-text-field-container",id:this._getInputContainerId(),ref:this._setInputContainerElem},_.h("span",{class:"oj-text-field-start"},_.h("span",{class:t,role:"presentation"})),_.h("div",{class:"oj-text-field-middle",role:this._dataProvider?"combobox":null,"aria-label":this._dataProvider?a:null,"aria-owns":r,"aria-haspopup":this._dataProvider?"listbox":"false","aria-expanded":i.dropdownOpen?"true":"false"},_.h("input",{type:h,ref:this._setInputElem,value:o,class:n,placeholder:s.placeholder,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",autofocus:"false","aria-label":a,"aria-autocomplete":this._dataProvider?"list":null,"aria-controls":r,"aria-busy":i.dropdownOpen&&i.loading,"aria-activedescendant":this._dataProvider?i.activeDescendantId:null,onFocusin:this._handleFocusin,onFocusout:this._handleFocusout,onFocus:this._handleFocus,onBlur:this._handleBlur,onInput:this._handleInput,onCompositionstart:this._handleCompositionstart,onCompositionend:this._handleCompositionend,onKeydown:this._handleKeydown}),c)),l)}},{key:"_renderDropdown",value:function(){var e=this._getDropdownPosition(),t={minWidth:this._rootElem.offsetWidth+"px"},o=this.state.loading?this._renderDropdownSkeleton():this._renderDropdownSuggestions(this.state.filterText),n=this.state,s={"oj-listbox-drop":!0,"oj-listbox-inputsearch":!0,"oj-listbox-hide-hover":"keyboard"===n.lastEventType,"oj-listbox-hide-focus":"mouse"===n.lastEventType,"oj-listbox-drop-above":n.dropdownAbove};return _.h(y.VPopup,{position:e,layerSelectors:"oj-listbox-drop-layer",autoDismiss:this._clickAwayHandler},_.h("div",{id:this._getDropdownElemId(),ref:this._setDropdownElem,class:s,role:"presentation",style:t,onMousedown:this._handleDropdownMousedown,onMousemove:this._handleDropdownMousemove,onMouseleave:this._handleDropdownMouseleave},o))}},{key:"_renderAutocompleteFloatingText",value:function(e,t){var o="Â - "+e;return _.h("div",{class:"oj-inputsearch-autocomplete-floating-container"},_.h("span",{style:{visibility:"hidden"}},t),_.h("span",{class:"oj-inputsearch-autocomplete-floating-text"},o))}},{key:"_scrollSuggestionIntoView",value:function(e,t){var o=document.getElementById(e),n=o.closest(".oj-listbox-result"),s=o.closest(".oj-listbox-results"),i=n.offsetTop,a=n.offsetHeight,l=s.scrollTop,r=s.offsetHeight;(i<l||i+a>l+r)&&(s.scrollTop=t?i:i+a-r)}},{key:"_generateId",value:function(){return this.uniqueId()+"-"+this._counter++}},{key:"_handleDataProviderRefreshEventListener",value:function(e){this.updateState({fetchedInitial:!1})}},{key:"_fetchData",value:function(e){this._queryCount+=1;var t=this._queryCount,o=e;""===o&&(o=null);var n={size:12};if(o){var s=this._dataProvider.getCapability("filter");s&&s.textFilter||c.error("InputSearch: DataProvider does not support text filter. Filtering results in dropdown may not work correctly."),n.filterCriterion=d.FilterFactory.getFilter({filterDef:{text:o}})}if(!this._loadingTimer){var i=f.getTimer(this._showIndicatorDelay);i.getPromise().then(function(e){this._loadingTimer=null,e&&this._dataProvider&&this.state.dropdownOpen&&this.updateState({loading:!0})}.bind(this)),this._loadingTimer=i}var a=[];this._resolveFetchBusyState||(this._resolveFetchBusyState=this._addBusyState("InputSearch: fetching suggestions"));var l=this._dataProvider.fetchFirst(n)[Symbol.asyncIterator](),r=12,u=function(e){if(t===this._queryCount){for(var o=e.done,n=e.value,s=n.data,i=n.metadata,d=0;d<s.length;d++){var h=s[d],c=i[d],p=c.key;if(a.push({data:h,metadata:c,key:p}),0===(r-=1)){o=!0;break}}if(o){for(var f=[],v=0;v<a.length;v++)f.push("oj-inputsearch-result-label-"+this._generateId());this.updateState({fetchedInitial:!0,labelIds:f,fetchedData:a}),this._resolveFetching()}else l.next().then(u)}}.bind(this);l.next().then(u)}},{key:"_renderDropdownSkeleton",value:function(){var e=1,t=0;if(this._dropdownElem){var o=this._dropdownElem.querySelectorAll(".oj-listbox-result");if(e=Math.max(1,o.length),o.length>0)t=this._dropdownElem.querySelector(".oj-listbox-results").offsetWidth}for(var n=t>0?{width:t+"px"}:null,s=[],i=0;i<e;i++)s.push(_.h("li",{role:"presentation",class:"oj-listbox-result",style:n},_.h("div",{class:"oj-listbox-result-label oj-listbox-skeleton-line-height oj-animation-skeleton"})));return _.h("ul",{role:"listbox",id:this._getListboxId(),class:"oj-listbox-results oj-inputsearch-results"},s)}},{key:"_renderDropdownSuggestions",value:function(e){var t,o=this.props,n=this.state;if((null===(t=n.fetchedData)||void 0===t?void 0:t.length)>0){for(var s=[],i=0;i<n.fetchedData.length;i++){var a=i===n.focusedSuggestionIndex,l=S._formatItemText(o.suggestionItemText,n.fetchedData[i]),r=_.h(x,{ref:this._setRenderedSuggestion.bind(this,i),labelId:n.labelIds[i],focus:a,index:i,formattedText:l,searchText:e,suggestionItemContext:n.fetchedData[i],suggestionItemTemplate:o.suggestionItemTemplate,onOjSuggestionAction:this._handleSuggestionAction});s.push(r)}return _.h("ul",{role:"listbox",id:this._getListboxId(),class:"oj-listbox-results oj-inputsearch-results"},s)}return null}},{key:"_handleSuggestionAction",value:function(e){this.updateState({filterText:e.text,displayValue:e.text,dropdownOpen:!1,valueSubmitted:!0,actionDetail:e.itemContext})}},{key:"_addBusyState",value:function(e){var t=this._rootElem,o={description:'The component identified by "'+t.id+'" '+e};return h.getContext(t).getBusyContext().addBusyState(o)}},{key:"_isDataProvider",value:function(e){return!!(null==e?void 0:e.fetchFirst)}},{key:"_wrapDataProviderIfNeeded",value:function(e){if(this._isDataProvider(e)){var t=e;return t instanceof d.ListDataProviderView||(t=new d.ListDataProviderView(t)),t}return null}},{key:"_addDataProviderEventListeners",value:function(e){e.addEventListener("mutate",this._handleDataProviderRefreshEventListener),e.addEventListener("refresh",this._handleDataProviderRefreshEventListener)}},{key:"_removeDataProviderEventListeners",value:function(e){e.removeEventListener("mutate",this._handleDataProviderRefreshEventListener),e.removeEventListener("refresh",this._handleDataProviderRefreshEventListener)}},{key:"_resolveFetching",value:function(){this._loadingTimer&&(this._loadingTimer.clear(),this._loadingTimer=null),this._resolveFetchBusyState&&(this._resolveFetchBusyState(),this._resolveFetchBusyState=null),this.state.loading&&this.updateState({loading:!1})}},{key:"_testChangeValue",value:function(e){var t=this,o=new Promise(function(e){t._testPromiseResolve=e});return this.updateState({filterText:e,displayValue:e,dropdownOpen:!1,valueSubmitted:!0,actionDetail:null}),o}},{key:"_testChangeValueByKey",value:function(e){var t=this,o=new Promise(function(e){t._testPromiseResolve=e}),n=function(){throw this._testPromiseResolve&&(this._testPromiseResolve(),this._testPromiseResolve=null),new Error("oj-input-search: No row found in DataProvider for key: ".concat(e))};return this._dataProvider.fetchByKeys({keys:new Set([e])}).then(function(t){var o=t.results.get(e);if(o&&null!=o.data&&null!=o.metadata){var s={data:o.data,metadata:o.metadata,key:o.metadata.key},i=S._formatItemText(this.props.suggestionItemText,s);this.updateState({filterText:i,displayValue:i,dropdownOpen:!1,valueSubmitted:!0,actionDetail:s})}else n()}.bind(this),n),o}}],[{key:"initStateFromProps",value:function(e,t){return{displayValue:e.value,filterText:e.value}}},{key:"updateStateFromProps",value:function(e,t,o){var n={};return e.value!==o.value&&e.value!==t.displayValue&&(n.displayValue=e.value,n.filterText=e.value),o.suggestions!=e.suggestions&&(n.fetchedInitial=!1),e.suggestions||(n.dropdownOpen=!1,n.fetchedData=null),!1!==t.dropdownOpen&&!1!==n.dropdownOpen||(n.lastEventType=null,n.showAutocompleteText=!1),t.showAutocompleteText&&!1!==n.showAutocompleteText||(n.autocompleteFloatingText=null),n}},{key:"_formatItemText",value:function(e,t){var o,n;return(null==t?void 0:t.data)&&("string"==typeof e?((null===(o=t.data)||void 0===o?void 0:o.hasOwnProperty(e))||c.error("oj-input-search: No '".concat(e,"' property found in DataProvider with key: ").concat(null==t?void 0:t.key)),n=t.data[e]):n=e(t)),n||""}}]),a}(_.ElementVComponent),t.InputSearch.metadata={extension:{_DEFAULTS:function e(){r(this,e),this.suggestions=null,this.suggestionItemText="label",this.placeholder="",this.rawValue=null,this.value=null},_ROOT_PROPS_MAP:{"aria-label":1},_WRITEBACK_PROPS:["rawValue","value"],_READ_ONLY_PROPS:["rawValue"]},properties:{suggestions:{type:"object|null",value:null},suggestionItemText:{type:"string | number|function",value:"label"},placeholder:{type:"string",value:""},rawValue:{type:"string|null",value:null,readOnly:!0,writeback:!0},value:{type:"string|null",value:null,writeback:!0}},events:{ojValueAction:{bubbles:!1}},slots:{suggestionItemTemplate:{data:{}}},methods:{focus:{},blur:{},_testChangeValue:{},_testChangeValueByKey:{}}},w([_.listener()],t.InputSearch.prototype,"_handleMouseenter",null),w([_.listener()],t.InputSearch.prototype,"_handleMouseleave",null),w([_.listener()],t.InputSearch.prototype,"_handleFocusin",null),w([_.listener()],t.InputSearch.prototype,"_handleFocusout",null),w([_.listener()],t.InputSearch.prototype,"_handleCompositionstart",null),w([_.listener()],t.InputSearch.prototype,"_handleCompositionend",null),w([_.listener()],t.InputSearch.prototype,"_handleInput",null),w([_.listener()],t.InputSearch.prototype,"_handleFocus",null),w([_.listener()],t.InputSearch.prototype,"_handleBlur",null),w([_.listener()],t.InputSearch.prototype,"_handleKeydown",null),w([_.listener()],t.InputSearch.prototype,"_clickAwayHandler",null),w([_.listener()],t.InputSearch.prototype,"_handleDataProviderRefreshEventListener",null),w([_.listener()],t.InputSearch.prototype,"_handleSuggestionAction",null),t.InputSearch=S=w([_.customElement("oj-input-search")],t.InputSearch),Object.defineProperty(t,"__esModule",{value:!0})})}();
//# sourceMappingURL=ojinputsearch.js.map