{"version":3,"file":"MessageFormattingUtils-ce5ff913.js","sources":["../../src/UNSAFE_Message/MessageFormattingUtils.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { getLocale } from '../utils/UNSAFE_getLocale';\nimport { isEmptyOrUndefined } from '../utils/UNSAFE_stringUtils';\nimport { severities } from './Message.types';\n\n// Types of properties that can be formatted\ntype PropFormat = 'severity' | 'string' | 'timestamp';\n\n/**\n * Options for creating an Intl.DateTimeFormat instance.\n */\nconst DATE_FORMAT_OPTIONS = Object.freeze({\n  TODAY: {\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: true\n  },\n  DEFAULT: {\n    day: '2-digit',\n    month: '2-digit',\n    year: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: true\n  }\n});\n\n/**\n * Regex for validating ISO timestamp\n */\nconst ISO_DATE_REGEX =\n  /^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z)?$/;\n\n/**\n * Checks if the provided date is today\n *\n * @param isoDate Date to be tested for today\n *\n * @returns boolean indicating if the provided date is today\n */\nfunction isDateToday(isoDate: string) {\n  const today = new Date();\n  const provided = new Date(isoDate);\n\n  return (\n    today.getUTCFullYear() === provided.getUTCFullYear() &&\n    today.getUTCMonth() === provided.getUTCMonth() &&\n    today.getUTCDate() === provided.getUTCDate()\n  );\n}\n\n/**\n * Creates an instance of Intl.DateTimeFormat\n *\n * @param isToday A boolean to indicate whether a formatter is needed for the date\n *                that is the current day.\n *\n * @returns the formatter instance\n */\nfunction getDateTimeFormatter(isToday: boolean) {\n  const locale = getLocale();\n  const { DateTimeFormat } = Intl;\n  if (isToday) {\n    return new DateTimeFormat(locale, DATE_FORMAT_OPTIONS.TODAY as Intl.DateTimeFormatOptions);\n  }\n\n  return new DateTimeFormat(locale, DATE_FORMAT_OPTIONS.DEFAULT as Intl.DateTimeFormatOptions);\n}\n\n/**\n * Checks if the provided value is valid for the prop specified.\n * By default, this method just checks for the value to be a valid string.\n *\n * @param value The value to be checked\n * @param prop The property for which the value needs to be evaluated\n *\n * @returns the result of the validation\n */\nfunction isValidValueForProp<T>(\n  value: T | null | undefined,\n  prop: PropFormat = 'string'\n): value is T {\n  switch (prop) {\n    case 'severity':\n      // Should be one of the allowed severity\n      return typeof value === 'string' && severities.includes(value as any);\n\n    case 'timestamp':\n      // Should be a valid ISO Datetime string\n      return typeof value === 'string' && ISO_DATE_REGEX.test(value);\n\n    case 'string':\n    default:\n      // anything other than null, undefined and '' is a valid string\n      return typeof value === 'string' && !isEmptyOrUndefined(value);\n  }\n}\n\n/**\n * Formats the timestamp in the required format based on the current\n * locale.\n *\n * @param isoTime Timestamp in ISO format\n */\nfunction formatTimestamp(isoTime: string) {\n  const isToday = isDateToday(isoTime);\n  const formatter = getDateTimeFormatter(isToday);\n\n  return formatter.format(new Date(isoTime));\n}\n\nexport { formatTimestamp, isValidValueForProp };\n"],"names":["DATE_FORMAT_OPTIONS","Object","freeze","TODAY","hour","minute","hour12","DEFAULT","day","month","year","ISO_DATE_REGEX","isoTime","formatter","isToday","locale","getLocale","DateTimeFormat","Intl","getDateTimeFormatter","isoDate","today","Date","provided","getUTCFullYear","getUTCMonth","getUTCDate","isDateToday","format","value","prop","severities","includes","test","isEmptyOrUndefined"],"mappings":"iKAiBA,MAAMA,EAAsBC,OAAOC,OAAO,CACxCC,MAAO,CACLC,KAAM,UACNC,OAAQ,UACRC,QAAQ,GAEVC,QAAS,CACPC,IAAK,UACLC,MAAO,UACPC,KAAM,UACNN,KAAM,UACNC,OAAQ,UACRC,QAAQ,KAONK,EACJ,uJAyEF,SAAyBC,GACvB,MACMC,EA/CR,SAA8BC,GAC5B,MAAMC,EAASC,EAAAA,aACTC,eAAEA,GAAmBC,KAC3B,OACS,IAAID,EAAeF,EADxBD,EACgCd,EAAoBG,MAGtBH,EAAoBO,SAwCpCY,CAlEpB,SAAqBC,GACnB,MAAMC,EAAQ,IAAIC,KACZC,EAAW,IAAID,KAAKF,GAE1B,OACEC,EAAMG,mBAAqBD,EAASC,kBACpCH,EAAMI,gBAAkBF,EAASE,eACjCJ,EAAMK,eAAiBH,EAASG,aA0DlBC,CAAYf,IAG5B,OAAOC,EAAUe,OAAO,IAAIN,KAAKV,2BA9BnC,SACEiB,EACAC,EAAmB,UAEnB,OAAQA,GACN,IAAK,WAEH,MAAwB,iBAAVD,GAAsBE,EAAUA,WAACC,SAASH,GAE1D,IAAK,YAEH,MAAwB,iBAAVA,GAAsBlB,EAAesB,KAAKJ,GAG1D,QAEE,MAAwB,iBAAVA,IAAuBK,EAAkBA,mBAACL"}