define(["exports","preact/jsx-runtime","preact/hooks","./UNSAFE_Collection","./utils/UNSAFE_arrayUtils","./hooks/UNSAFE_useViewportIntersect","./Collection-81a37433"],(function(e,t,o,n,i,r,l){"use strict";i.stringLiteralArray(["topPlaceholder","bottomPlaceholder"]);const c="oj-collection-placeholder",a=({context:e,placeholderHeight:o})=>{const{fromIndex:n,toIndex:i,which:r,estimateItemSize:l}=e;let a=0;if(o)a=o(e);else{const e=0===l?48:l;a=Math.max(0,i-n)*e}const s="topPlaceholder"===r?"_topPlaceholder":"_bottomPlaceholder",d={height:a+"px"};return 0===a&&(d.display="none"),t.jsx("div",{className:c,style:d},s)};function s(e){return function({itemSize:t,viewportHeight:o,scrollOffset:n,overscan:i=0}){if(void 0===t||0===t||void 0===o||void 0===n)return{offset:0,count:e};const r=Math.ceil(n/t),l=Math.ceil(o/t);return{offset:Math.max(0,r-i),count:l+i*(r>0?2:1)}}}const d=(e,t,o,n,i)=>{let r,l;if(e&&t){const o=t.getBoundingClientRect(),n=(e=>{let t,o;if(e===document.documentElement)t=0,o=document.documentElement.clientHeight;else{const n=e.getBoundingClientRect();t=n.top,o=n.bottom}return{top:t,bottom:o}})(e);o&&n&&(r=n.top-o.top-1,l=n.bottom-n.top+1)}if(void 0!==r&&void 0!==l){return n({scrollOffset:r,viewportHeight:l,overscan:o,itemSize:i})}return null},u="oj-collection-loadmore",f=s(25);e.PLACEHOLDER_STYLE_CLASS=c,e.VirtualizedCollection=function({data:e,children:n,viewportConfig:i,itemSelector:c,placeholderHeight:s,rangeExtractor:h=f,overscan:m=1,onLoadRange:g,loadMoreIndicator:p,suggestions:x}){var v,S,j;const z=o.useRef(null),E=o.useRef(0);if(r.useViewportIntersect(i,1,".oj-collection-loadmore, .oj-collection-placeholder",(()=>{var e;const t=d(i.scroller(),z.current,m,h,null!==(e=E.current)&&void 0!==e?e:0);t&&g(t)})),o.useEffect((()=>{if(0===E.current){let e=0;const t=z.current.querySelectorAll(c);t.length>0&&(t.forEach((t=>{e+=t.offsetHeight})),E.current=e/t.length)}})),!e||!(e=>e&&e.data&&e.offset>=0&&e.totalSize>=0)(e))return t.jsx("div",{ref:z});const I=((e,t)=>{if(t){const o=Math.min(t.offset,e.offset+e.totalSize),n=o-e.offset;n>0&&(e={offset:o,data:e.data.slice(n,n+t.count),totalSize:e.totalSize,sizePrecision:e.sizePrecision})}return e})(e,d(i.scroller(),z.current,m,h,null!==(v=E.current)&&void 0!==v?v:0)),P=I.data,b=I.offset,w=b+P.length,C=I.totalSize,H=b>=0?{fromIndex:0,toIndex:b,which:"topPlaceholder",estimateItemSize:null!==(S=E.current)&&void 0!==S?S:0}:void 0,A=w&&w<=C?{fromIndex:w,toIndex:C,which:"bottomPlaceholder",estimateItemSize:null!==(j=E.current)&&void 0!==j?j:0}:void 0,L="atLeast"===I.sizePrecision&&w<=C;return t.jsxs("div",Object.assign({ref:z,style:"will-change: contents"},{children:[x,H&&t.jsx(a,{context:H,placeholderHeight:s}),t.jsx(l.Collection,Object.assign({items:P},{children:(R=b,e=>{const t={index:R+e.index,metadata:e.data.metadata,data:e.data.data};return n(t)})})),A&&t.jsx(a,{context:A,placeholderHeight:s}),L&&t.jsx("div",Object.assign({class:u},{children:p}))]}));var R},e.getDefaultRangeExtractor=s}));
//# sourceMappingURL=VirtualizedCollection-2bc2dae6.js.map
