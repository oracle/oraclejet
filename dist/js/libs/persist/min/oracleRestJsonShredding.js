define(["./persistenceUtils","./impl/logger"],function(a,b){"use strict";function c(a,b){if(!a||1!==a.length)throw new Error({message:"shredded data is not in the correct format."});var c=a[0].data;return c&&1===c.length&&"single"===a[0].resourceType?c[0]:{items:c,count:c.length}}return{getShredder:function(a,c){return function(d){b.log("Offline Persistence Toolkit oracleRestJsonShredding: Shredding Response");var e=d.clone(),f=e.headers.get("X-ORACLE-DMS-ECID");return e.text().then(function(d){var e=[],g=[],h="collection";if(null!=d&&d.length>0)try{var i=JSON.parse(d);null!=i.items?(e=i.items.map(function(a){return a[c]}),g=i.items):(e[0]=i[c],g[0]=i,h="single")}catch(a){b.log("Offline Persistence Toolkit oracleRestJsonShredding: Error during shredding: "+a)}return[{name:a,resourceIdentifier:f,keys:e,data:g,resourceType:h}]})}},getUnshredder:function(){return function(d,e){b.log("Offline Persistence Toolkit oracleRestJsonShredding: Unshredding Response");var f=c(d,e);return a.setResponsePayload(e,f).then(function(a){return a.headers.set("x-oracle-jscpt-cache-expiration-date",""),a})}}}});
//# sourceMappingURL=oracleRestJsonShredding.js.map